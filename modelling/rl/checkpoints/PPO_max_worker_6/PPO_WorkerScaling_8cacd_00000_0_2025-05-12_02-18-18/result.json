{"timers": {"training_iteration": 38.34705401500105, "restore_env_runners": 3.6100000215810724e-05, "training_step": 38.34663851499863, "env_runner_sampling_timer": 28.735109909999665, "learner_update_timer": 9.603511004999746, "synch_weights": 0.0071059999991121}, "env_runners": {"episode_return_mean": -0.6024861111111104, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00020381782873575842, "get_actions": 0.0006650787718722251, "un_batch_to_individual_items": 5.937295890552764e-05, "listify_data_for_vector_env": 0.00011639637426387411, "tensor_to_numpy": 0.0002398800816191565, "remove_single_ts_time_rank_from_batch": 6.6925246031256475e-06}}, "connector_pipeline_timer": 0.001593530260351603}, "episode_return_max": -0.480444444444444, "num_episodes_lifetime": 8, "episode_duration_sec_mean": 20.396976313500318, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015315010006549577, "add_time_dim_to_batch_and_zero_pad": 3.492175952872053e-05, "add_states_from_episodes_to_batch": 1.567874490783362e-05, "batch_individual_items": 0.00011621309153964009, "add_observations_from_episodes_to_batch": 4.533638232812257e-05}}, "connector_pipeline_timer": 0.0006182461018475738}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "sample": 28.291076634250203, "num_env_steps_sampled_lifetime": 2000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.7321111111111104, "agent_episode_returns_mean": {"default_agent": -0.6024861111111104}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": -0.6024861111111104}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.59269498396193, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005815730991186844, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_in": 95.59269498396193, "env_step_timer": 0.10767257480715835, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"default_policy": {"num_trainable_parameters": 73223, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.01563488505780697, "weights_seq_no": 1.0, "vf_loss": 0.008750964887440205, "gradients_default_optimizer_global_norm": 0.34205999970436096, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 60544, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008750964887440205, "vf_explained_var": 0.09489816427230835, "entropy": 1.7757568359375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.11077278852462769, "policy_loss": 0.09889484196901321}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07959119999941322, "add_time_dim_to_batch_and_zero_pad": 3.200000173819717e-05, "add_states_from_episodes_to_batch": 1.089999932446517e-05, "general_advantage_estimation": 0.1272201009996934, "batch_individual_items": 0.0397224999996979, "add_observations_from_episodes_to_batch": 0.00033030000122380443, "add_one_ts_to_episodes_and_truncate": 0.007682700001168996, "numpy_to_tensor": 0.0011987999987468356}}, "connector_pipeline_timer": 0.256411101001504}, "num_env_steps_trained_lifetime": 953568, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 60544, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000, "learner_connector_sum_episodes_length_out": 2016, "num_env_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": NaN, "done": false, "training_iteration": 1, "trial_id": "8cacd_00000", "date": "2025-05-12_02-19-27", "timestamp": 1746980367, "time_this_iter_s": 38.363640785217285, "time_total_s": 38.363640785217285, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.363640785217285, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 76.6381818181818, "ram_util_percent": 45.58727272727275}}
{"timers": {"training_iteration": 38.30660985140103, "restore_env_runners": 3.5968000211141765e-05, "training_step": 38.30619358639864, "env_runner_sampling_timer": 28.70550900764967, "learner_update_timer": 9.592627680749755, "synch_weights": 0.007144723999135749, "synch_env_connectors": 0.008789699999397271}, "env_runners": {"episode_return_mean": -0.6792980769230762, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00019744803885166413, "get_actions": 0.0006645586827396233, "un_batch_to_individual_items": 5.93288784829344e-05, "listify_data_for_vector_env": 0.00011714589923881354, "tensor_to_numpy": 0.00023663698906053608, "remove_single_ts_time_rank_from_batch": 6.694763610577525e-06}}, "connector_pipeline_timer": 0.001582544467563736}, "episode_return_max": -0.45744444444444426, "num_episodes_lifetime": 16, "episode_duration_sec_mean": 20.039932232807534, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015205359982238062, "add_time_dim_to_batch_and_zero_pad": 3.471180698606892e-05, "add_states_from_episodes_to_batch": 1.5777943974153007e-05, "batch_individual_items": 0.00011433750585497912, "add_observations_from_episodes_to_batch": 4.475153280225112e-05}}, "connector_pipeline_timer": 0.0006119825582481448}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "sample": 28.288924285776453, "num_env_steps_sampled_lifetime": 4000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -1.074999999999998, "agent_episode_returns_mean": {"default_agent": -0.6792980769230762}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": -0.6792980769230762}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.08568675847273, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005757489461591145, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_in": 94.08568675847273, "env_step_timer": 0.10723269345682414, "time_between_sampling": 10.15095788074973, "num_env_steps_sampled_lifetime_throughput": 58.14229621179444}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.015275589190423489, "weights_seq_no": 2.0, "vf_loss": 0.013735570944845676, "gradients_default_optimizer_global_norm": 0.3923288881778717, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 121088, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013735570944845676, "vf_explained_var": 0.09901434183120728, "entropy": 1.7493410110473633, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.021862316876649857, "policy_loss": -0.03865300863981247}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07959068611941329, "add_time_dim_to_batch_and_zero_pad": 3.1999411737888294e-05, "add_states_from_episodes_to_batch": 1.0899919324583607e-05, "general_advantage_estimation": 0.12720847780959355, "batch_individual_items": 0.039738853689597994, "add_observations_from_episodes_to_batch": 0.00033029911122357586, "add_one_ts_to_episodes_and_truncate": 0.007682449601168991, "numpy_to_tensor": 0.001198826088746864}}, "connector_pipeline_timer": 0.2564150650613039}, "num_env_steps_trained_lifetime": 1907136, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 121088, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.14229621179444, "done": false, "training_iteration": 2, "trial_id": "8cacd_00000", "date": "2025-05-12_02-20-02", "timestamp": 1746980402, "time_this_iter_s": 34.3201265335083, "time_total_s": 72.68376731872559, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 72.68376731872559, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 77.79183673469389, "ram_util_percent": 49.31020408163266}}
{"timers": {"training_iteration": 38.266702923037016, "restore_env_runners": 3.593132021287601e-05, "training_step": 38.26628509468465, "env_runner_sampling_timer": 28.675508784913166, "learner_update_timer": 9.582739600752245, "synch_weights": 0.007124789759142914, "synch_env_connectors": 0.008799698999409883}, "env_runners": {"episode_return_mean": -0.5618440170940165, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00019029362841234418, "get_actions": 0.000660867847616874, "un_batch_to_individual_items": 5.961890683794335e-05, "listify_data_for_vector_env": 0.00011757057334874903, "tensor_to_numpy": 0.0002334278175555415, "remove_single_ts_time_rank_from_batch": 6.694207668430271e-06}}, "connector_pipeline_timer": 0.0015669190001935522}, "episode_return_max": -0.1655555555555552, "num_episodes_lifetime": 24, "episode_duration_sec_mean": 19.803607681451606, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015122780340328328, "add_time_dim_to_batch_and_zero_pad": 3.437746936802988e-05, "add_states_from_episodes_to_batch": 1.6036716850357903e-05, "batch_individual_items": 0.00011199889422328078, "add_observations_from_episodes_to_batch": 4.392476653352429e-05}}, "connector_pipeline_timer": 0.0006049548686851892}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "sample": 28.284479621642788, "num_env_steps_sampled_lifetime": 6000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -1.074999999999998, "agent_episode_returns_mean": {"default_agent": -0.5618440170940165}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": -0.5618440170940165}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.22256311007892, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005700739531379649, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_in": 92.22256311007892, "env_step_timer": 0.10634845958056208, "time_between_sampling": 10.149980919907884, "num_env_steps_sampled_lifetime_throughput": 58.13357954632985}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.019738802686333656, "weights_seq_no": 3.0, "vf_loss": 0.0058986651711165905, "gradients_default_optimizer_global_norm": 0.2117621749639511, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 181632, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0058986651711165905, "vf_explained_var": 0.005553245544433594, "entropy": 1.6903115510940552, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0847340002655983, "policy_loss": -0.09458043426275253}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07958997633691352, "add_time_dim_to_batch_and_zero_pad": 3.199836353728096e-05, "add_states_from_episodes_to_batch": 1.0899810924835039e-05, "general_advantage_estimation": 0.1271852003531959, "batch_individual_items": 0.03975488947570007, "add_observations_from_episodes_to_batch": 0.0003302987890231743, "add_one_ts_to_episodes_and_truncate": 0.007681975389168867, "numpy_to_tensor": 0.001198829226947084}}, "connector_pipeline_timer": 0.2564065819797076}, "num_env_steps_trained_lifetime": 2860704, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 181632, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.13357954632985, "done": false, "training_iteration": 3, "trial_id": "8cacd_00000", "date": "2025-05-12_02-20-36", "timestamp": 1746980436, "time_this_iter_s": 34.3327214717865, "time_total_s": 107.01648879051208, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.01648879051208, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 76.62857142857142, "ram_util_percent": 49.41020408163265}}
{"timers": {"training_iteration": 38.21375024573664, "restore_env_runners": 3.57760070179629e-05, "training_step": 38.21333210166782, "env_runner_sampling_timer": 28.642334858004045, "learner_update_timer": 9.562979179734713, "synch_weights": 0.007106170861553101, "synch_env_connectors": 0.008794571009413811}, "env_runners": {"episode_return_mean": -0.4883707264957263, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00018369122840984902, "get_actions": 0.0006576154150798551, "un_batch_to_individual_items": 5.994662275520599e-05, "listify_data_for_vector_env": 0.00011760963662623749, "tensor_to_numpy": 0.00023079261911631923, "remove_single_ts_time_rank_from_batch": 6.83457370941271e-06}}, "connector_pipeline_timer": 0.001552724444598265}, "episode_return_max": -0.1655555555555552, "num_episodes_lifetime": 32, "episode_duration_sec_mean": 19.627208499336067, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015043468978019985, "add_time_dim_to_batch_and_zero_pad": 3.447772581459912e-05, "add_states_from_episodes_to_batch": 1.6034227321354648e-05, "batch_individual_items": 0.00010973247712456892, "add_observations_from_episodes_to_batch": 4.331938082726769e-05}}, "connector_pipeline_timer": 0.0005999281476643906}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "sample": 28.278006724615018, "num_env_steps_sampled_lifetime": 8000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.8354444444444438, "agent_episode_returns_mean": {"default_agent": -0.4883707264957263}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": -0.4883707264957263}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 91.24592817976652, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005643535942478502, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_in": 91.24592817976652, "env_step_timer": 0.10539194843715322, "time_between_sampling": 10.148432876640943, "num_env_steps_sampled_lifetime_throughput": 60.53542751519581}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.018913187086582184, "weights_seq_no": 4.0, "vf_loss": 0.005067652557045221, "gradients_default_optimizer_global_norm": 0.28673428297042847, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 242176, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.005067652557045221, "vf_explained_var": 0.22398096323013306, "entropy": 1.6370055675506592, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.23885086178779602, "policy_loss": -0.24770116806030273}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07958871609145185, "add_time_dim_to_batch_and_zero_pad": 3.199666635949537e-05, "add_states_from_episodes_to_batch": 1.0899604701229474e-05, "general_advantage_estimation": 0.1271508510481453, "batch_individual_items": 0.039770566280711225, "add_observations_from_episodes_to_batch": 0.0003302981533557088, "add_one_ts_to_episodes_and_truncate": 0.007681280456448621, "numpy_to_tensor": 0.0011988074497744359}}, "connector_pipeline_timer": 0.2563858396532372}, "num_env_steps_trained_lifetime": 3814272, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 242176, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.53542751519581, "done": false, "training_iteration": 4, "trial_id": "8cacd_00000", "date": "2025-05-12_02-21-09", "timestamp": 1746980469, "time_this_iter_s": 32.98731708526611, "time_total_s": 140.0038058757782, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.0038058757782, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 79.5468085106383, "ram_util_percent": 49.41702127659576}}
{"timers": {"training_iteration": 38.17554639779928, "restore_env_runners": 3.5633246947808884e-05, "training_step": 38.17512780517114, "env_runner_sampling_timer": 28.616982148804016, "learner_update_timer": 9.550138136077377, "synch_weights": 0.007095866152947768, "synch_env_connectors": 0.008785043299331552}, "env_runners": {"episode_return_mean": -0.3696987179487178, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00017862580220469164, "get_actions": 0.0006551353977614177, "un_batch_to_individual_items": 5.9894716450109776e-05, "listify_data_for_vector_env": 0.00011763986706109822, "tensor_to_numpy": 0.0002287093776895404, "remove_single_ts_time_rank_from_batch": 6.827876363013047e-06}}, "connector_pipeline_timer": 0.0015420622860645532}, "episode_return_max": 0.008444444444444782, "num_episodes_lifetime": 40, "episode_duration_sec_mean": 19.80025672222104, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014927394388993884, "add_time_dim_to_batch_and_zero_pad": 3.431191534250069e-05, "add_states_from_episodes_to_batch": 1.5967852098702847e-05, "batch_individual_items": 0.00010765442000989577, "add_observations_from_episodes_to_batch": 4.359902730045162e-05}}, "connector_pipeline_timer": 0.0005948448211407565}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "sample": 28.27006243432418, "num_env_steps_sampled_lifetime": 10000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.6759999999999999, "agent_episode_returns_mean": {"default_agent": -0.3696987179487178}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": -0.3696987179487178}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 91.91104927924896, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005576161079518056, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_in": 91.91104927924896, "env_step_timer": 0.10442233183398571, "time_between_sampling": 10.145267492577073, "num_env_steps_sampled_lifetime_throughput": 58.02829135642015}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.02551908791065216, "weights_seq_no": 5.0, "vf_loss": 0.004140765871852636, "gradients_default_optimizer_global_norm": 0.554573655128479, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 302720, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.004140765871852636, "vf_explained_var": 0.18614459037780762, "entropy": 1.5518616437911987, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06437931209802628, "policy_loss": 0.055134739726781845}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795870036633657, "add_time_dim_to_batch_and_zero_pad": 3.1994483288945924e-05, "add_states_from_episodes_to_batch": 1.0899352621100955e-05, "general_advantage_estimation": 0.12710540362916042, "batch_individual_items": 0.039785855500674705, "add_observations_from_episodes_to_batch": 0.0003302955205226052, "add_one_ts_to_episodes_and_truncate": 0.007680355964843899, "numpy_to_tensor": 0.0011987688052225668}}, "connector_pipeline_timer": 0.2563528888151982}, "num_env_steps_trained_lifetime": 4767840, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 302720, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.02829135642015, "done": false, "training_iteration": 5, "trial_id": "8cacd_00000", "date": "2025-05-12_02-21-43", "timestamp": 1746980503, "time_this_iter_s": 34.40857696533203, "time_total_s": 174.41238284111023, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 174.41238284111023, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 79.27083333333333, "ram_util_percent": 49.42083333333333}}
{"timers": {"training_iteration": 38.14314175242128, "restore_env_runners": 3.550791447285904e-05, "training_step": 38.142722607719435, "env_runner_sampling_timer": 28.592090637875966, "learner_update_timer": 9.542633056756612, "synch_weights": 0.007086708491429037, "synch_env_connectors": 0.00877200886635307}, "env_runners": {"episode_return_mean": -0.17318376068376048, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00017327696302302134, "get_actions": 0.0006545792113745948, "un_batch_to_individual_items": 5.979256472029847e-05, "listify_data_for_vector_env": 0.00011921344204883643, "tensor_to_numpy": 0.0002261786130602623, "remove_single_ts_time_rank_from_batch": 7.009193517753716e-06}}, "connector_pipeline_timer": 0.00153331732764072}, "episode_return_max": 0.11866666666666695, "num_episodes_lifetime": 48, "episode_duration_sec_mean": 19.80885923119254, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000148624477851254, "add_time_dim_to_batch_and_zero_pad": 3.414878718880465e-05, "add_states_from_episodes_to_batch": 1.6121325172824912e-05, "batch_individual_items": 0.0001054250342715317, "add_observations_from_episodes_to_batch": 4.275561012024406e-05}}, "connector_pipeline_timer": 0.0005891483536938502}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "sample": 28.260742600796362, "num_env_steps_sampled_lifetime": 12000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.40388888888888874, "agent_episode_returns_mean": {"default_agent": -0.17318376068376048}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": -0.17318376068376048}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.6176970596285, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000553334708043083, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_in": 94.6176970596285, "env_step_timer": 0.10345512607866716, "time_between_sampling": 10.14136326219128, "num_env_steps_sampled_lifetime_throughput": 57.103719459246435}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.015815144404768944, "weights_seq_no": 6.0, "vf_loss": 0.003104889066889882, "gradients_default_optimizer_global_norm": 0.39116284251213074, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 363264, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.003104889066889882, "vf_explained_var": 0.055815935134887695, "entropy": 1.5112963914871216, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06513392925262451, "policy_loss": 0.05728448927402496}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795847616210322, "add_time_dim_to_batch_and_zero_pad": 3.199177421318875e-05, "add_states_from_episodes_to_batch": 1.0899075621990795e-05, "general_advantage_estimation": 0.12704942303325045, "batch_individual_items": 0.039800792469010735, "add_observations_from_episodes_to_batch": 0.0003302912805308614, "add_one_ts_to_episodes_and_truncate": 0.007679211404925654, "numpy_to_tensor": 0.0011987090828166932}}, "connector_pipeline_timer": 0.2563082509977547}, "num_env_steps_trained_lifetime": 5721408, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 363264, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.103719459246435, "done": false, "training_iteration": 6, "trial_id": "8cacd_00000", "date": "2025-05-12_02-22-18", "timestamp": 1746980538, "time_this_iter_s": 34.95109176635742, "time_total_s": 209.36347460746765, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 209.36347460746765, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 76.492, "ram_util_percent": 49.47}}
{"timers": {"training_iteration": 38.12367270846707, "restore_env_runners": 3.536783532815606e-05, "training_step": 38.123253082212244, "env_runner_sampling_timer": 28.586104188187196, "learner_update_timer": 9.52916058006905, "synch_weights": 0.007074819406512042, "synch_env_connectors": 0.008767649777686778}, "env_runners": {"episode_return_mean": -0.04341559829059803, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.000167823945914214, "get_actions": 0.0006528672735702512, "un_batch_to_individual_items": 5.9761445065537504e-05, "listify_data_for_vector_env": 0.00011919169155757616, "tensor_to_numpy": 0.00022367940802975664, "remove_single_ts_time_rank_from_batch": 6.984759240893797e-06}}, "connector_pipeline_timer": 0.0015216327698705078}, "episode_return_max": 0.39044444444444476, "num_episodes_lifetime": 64, "episode_duration_sec_mean": 19.898210992596432, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014833219346861677, "add_time_dim_to_batch_and_zero_pad": 3.3917279648412785e-05, "add_states_from_episodes_to_batch": 1.6212887594352946e-05, "batch_individual_items": 0.00010327971206797587, "add_observations_from_episodes_to_batch": 4.2120681564876324e-05}}, "connector_pipeline_timer": 0.0005835252610184987}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "sample": 28.251353659591313, "num_env_steps_sampled_lifetime": 14000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.3545555555555553, "agent_episode_returns_mean": {"default_agent": -0.04341559829059803}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": -0.04341559829059803}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.14056668820784, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000548933416495352, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_in": 96.14056668820784, "env_step_timer": 0.10357384544194669, "time_between_sampling": 10.137228846855363, "num_env_steps_sampled_lifetime_throughput": 55.143288770638264}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.01131095178425312, "weights_seq_no": 7.0, "vf_loss": 0.004085806664079428, "gradients_default_optimizer_global_norm": 0.2482721358537674, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 424064, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.004085806664079428, "vf_explained_var": 0.13505864143371582, "entropy": 1.4415796995162964, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03382834419608116, "policy_loss": -0.041307415813207626}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.079582301798879, "add_time_dim_to_batch_and_zero_pad": 3.198880987061394e-05, "add_states_from_episodes_to_batch": 1.0898764227592392e-05, "general_advantage_estimation": 0.12698271094879574, "batch_individual_items": 0.039815647092330035, "add_observations_from_episodes_to_batch": 0.00033030299578690187, "add_one_ts_to_episodes_and_truncate": 0.007677970320509237, "numpy_to_tensor": 0.0011986340179784018}}, "connector_pipeline_timer": 0.25625245946717856}, "num_env_steps_trained_lifetime": 6682808, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 424064, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0008, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 55.143288770638264, "done": false, "training_iteration": 7, "trial_id": "8cacd_00000", "date": "2025-05-12_02-22-55", "timestamp": 1746980575, "time_this_iter_s": 36.21366810798645, "time_total_s": 245.5771427154541, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 245.5771427154541, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 77.56538461538462, "ram_util_percent": 49.51730769230768}}
{"timers": {"training_iteration": 38.09745078712241, "restore_env_runners": 3.528715697998327e-05, "training_step": 38.09702807213012, "env_runner_sampling_timer": 28.577301437855326, "learner_update_timer": 9.511743722458347, "synch_weights": 0.007064503212438046, "synch_env_connectors": 0.00877107827992034}, "env_runners": {"episode_return_mean": 0.050670940170940426, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00016306068534324393, "get_actions": 0.0006519348293378128, "un_batch_to_individual_items": 5.96702463595104e-05, "listify_data_for_vector_env": 0.00011993940679423159, "tensor_to_numpy": 0.00022119897137009835, "remove_single_ts_time_rank_from_batch": 6.941423466682674e-06}}, "connector_pipeline_timer": 0.0015129626358012427}, "episode_return_max": 0.5501111111111117, "num_episodes_lifetime": 72, "episode_duration_sec_mean": 20.79250671382708, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014829482154115462, "add_time_dim_to_batch_and_zero_pad": 3.370341294099373e-05, "add_states_from_episodes_to_batch": 1.635983401800753e-05, "batch_individual_items": 0.00010122776147794789, "add_observations_from_episodes_to_batch": 4.1642298819407646e-05}}, "connector_pipeline_timer": 0.0005789611878672255}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "sample": 28.242006917199326, "num_env_steps_sampled_lifetime": 16000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.25544444444444436, "agent_episode_returns_mean": {"default_agent": 0.050670940170940426}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.050670940170940426}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.20888514806694, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005482099509501906, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_in": 95.20888514806694, "env_step_timer": 0.10363782478634284, "time_between_sampling": 10.13268917103598, "num_env_steps_sampled_lifetime_throughput": 56.20730790649726}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.007610287982970476, "weights_seq_no": 8.0, "vf_loss": 0.006186394486576319, "gradients_default_optimizer_global_norm": 0.32593682408332825, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 484608, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.006186394486576319, "vf_explained_var": 0.2453984022140503, "entropy": 1.4278244972229004, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07410376518964767, "policy_loss": -0.08257324993610382}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07957933425630673, "add_time_dim_to_batch_and_zero_pad": 3.198546563738503e-05, "add_states_from_episodes_to_batch": 1.0898409153617179e-05, "general_advantage_estimation": 0.12690555014362678, "batch_individual_items": 0.039830319143636016, "add_observations_from_episodes_to_batch": 0.0003303156376096287, "add_one_ts_to_episodes_and_truncate": 0.007676526536640612, "numpy_to_tensor": 0.0011985795835287212}}, "connector_pipeline_timer": 0.2561853204810142}, "num_env_steps_trained_lifetime": 7636376, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 484608, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0015839999999, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.20730790649726, "done": false, "training_iteration": 8, "trial_id": "8cacd_00000", "date": "2025-05-12_02-23-30", "timestamp": 1746980610, "time_this_iter_s": 35.51932644844055, "time_total_s": 281.09646916389465, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 281.09646916389465, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 80.708, "ram_util_percent": 49.51599999999999}}
{"timers": {"training_iteration": 38.06938679502119, "restore_env_runners": 3.517328541105795e-05, "training_step": 38.068952358178834, "env_runner_sampling_timer": 28.551267146156768, "learner_update_timer": 9.509709671323765, "synch_weights": 0.007055966180315565, "synch_env_connectors": 0.008764303497115973}, "env_runners": {"episode_return_mean": 0.05114423076923104, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00015973665918944546, "get_actions": 0.0006506388739348409, "un_batch_to_individual_items": 5.9608415675770174e-05, "listify_data_for_vector_env": 0.0001201190321424868, "tensor_to_numpy": 0.0002195919973989589, "remove_single_ts_time_rank_from_batch": 6.97570421697933e-06}}, "connector_pipeline_timer": 0.0015051532276273473}, "episode_return_max": 0.5501111111111117, "num_episodes_lifetime": 80, "episode_duration_sec_mean": 20.410062056971267, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014808065434036017, "add_time_dim_to_batch_and_zero_pad": 3.347994819528964e-05, "add_states_from_episodes_to_batch": 1.6802508490004747e-05, "batch_individual_items": 9.945963554661685e-05, "add_observations_from_episodes_to_batch": 4.091966392008545e-05}}, "connector_pipeline_timer": 0.000574225711646396}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "sample": 28.231358117225472, "num_env_steps_sampled_lifetime": 18000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.25544444444444436, "agent_episode_returns_mean": {"default_agent": 0.05114423076923104}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.05114423076923104}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.27697707852006, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005444469757290871, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_in": 93.27697707852006, "env_step_timer": 0.10328386160210218, "time_between_sampling": 10.127144230608256, "num_env_steps_sampled_lifetime_throughput": 56.54723609787004}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.012566200457513332, "weights_seq_no": 9.0, "vf_loss": 0.0044513242319226265, "gradients_default_optimizer_global_norm": 0.45920440554618835, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 545152, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0044513242319226265, "vf_explained_var": 0.16733664274215698, "entropy": 1.3819594383239746, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06779667735099792, "policy_loss": -0.07601787149906158}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795759118443059, "add_time_dim_to_batch_and_zero_pad": 3.1982369407740975e-05, "add_states_from_episodes_to_batch": 1.089805130473691e-05, "general_advantage_estimation": 0.12681809521336634, "batch_individual_items": 0.03984465073920658, "add_observations_from_episodes_to_batch": 0.00033032696629619495, "add_one_ts_to_episodes_and_truncate": 0.007674895141417389, "numpy_to_tensor": 0.0011985166543663172}}, "connector_pipeline_timer": 0.25610687037842655}, "num_env_steps_trained_lifetime": 8589944, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 545152, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.00235224, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.54723609787004, "done": false, "training_iteration": 9, "trial_id": "8cacd_00000", "date": "2025-05-12_02-24-06", "timestamp": 1746980646, "time_this_iter_s": 35.3102912902832, "time_total_s": 316.40676045417786, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 316.40676045417786, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 76.34, "ram_util_percent": 49.512}}
{"timers": {"training_iteration": 38.015672651070965, "restore_env_runners": 3.5072552558246336e-05, "training_step": 38.01523732659704, "env_runner_sampling_timer": 28.519471210385195, "learner_update_timer": 9.487810911920533, "synch_weights": 0.007034753518516172, "synch_env_connectors": 0.008764176462148048}, "env_runners": {"episode_return_mean": 0.11727991452991482, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00015592846587946337, "get_actions": 0.0006487547219212867, "un_batch_to_individual_items": 5.945011812900469e-05, "listify_data_for_vector_env": 0.00012032333655270399, "tensor_to_numpy": 0.000219150325994722, "remove_single_ts_time_rank_from_batch": 7.23673305068516e-06}}, "connector_pipeline_timer": 0.0014980273927668944}, "episode_return_max": 0.5321111111111116, "num_episodes_lifetime": 88, "episode_duration_sec_mean": 19.681065584759764, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001476933903478046, "add_time_dim_to_batch_and_zero_pad": 3.3569220575132564e-05, "add_states_from_episodes_to_batch": 1.6777100361082206e-05, "batch_individual_items": 9.857976162979464e-05, "add_observations_from_episodes_to_batch": 4.066447173438753e-05}}, "connector_pipeline_timer": 0.0005710648386908979}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "sample": 28.219147511123396, "num_env_steps_sampled_lifetime": 20000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.18088888888888877, "agent_episode_returns_mean": {"default_agent": 0.11727991452991482}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.11727991452991482}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 91.84458856570119, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005396354769737938, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_in": 91.84458856570119, "env_step_timer": 0.10258207517284962, "time_between_sampling": 10.121869343449003, "num_env_steps_sampled_lifetime_throughput": 61.02808907511096}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.013165278360247612, "weights_seq_no": 10.0, "vf_loss": 0.0029698582366108894, "gradients_default_optimizer_global_norm": 0.4289762079715729, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 605696, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0029698582366108894, "vf_explained_var": 0.11720597743988037, "entropy": 1.3404076099395752, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.07581420242786407, "policy_loss": 0.06889476627111435}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07957264285701947, "add_time_dim_to_batch_and_zero_pad": 3.1978756556067154e-05, "add_states_from_episodes_to_batch": 1.0897630771864014e-05, "general_advantage_estimation": 0.12672055865669685, "batch_individual_items": 0.039858681040951444, "add_observations_from_episodes_to_batch": 0.00033033885684522217, "add_one_ts_to_episodes_and_truncate": 0.007673191061445021, "numpy_to_tensor": 0.001198440585828749}}, "connector_pipeline_timer": 0.2560180792557426}, "num_env_steps_trained_lifetime": 9543512, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 605696, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0031049568, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 61.02808907511096, "done": false, "training_iteration": 10, "trial_id": "8cacd_00000", "date": "2025-05-12_02-24-38", "timestamp": 1746980678, "time_this_iter_s": 32.71367430686951, "time_total_s": 349.12043476104736, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 349.12043476104736, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 79.27234042553191, "ram_util_percent": 49.51489361702127}}
{"timers": {"training_iteration": 37.965282298100256, "restore_env_runners": 3.493782704030398e-05, "training_step": 37.96484639487106, "env_runner_sampling_timer": 28.492007970441357, "learner_update_timer": 9.464893471181325, "synch_weights": 0.007022950983323601, "synch_env_connectors": 0.008749616697525544}, "env_runners": {"episode_return_mean": 0.1999017094017096, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00015175797011124216, "get_actions": 0.0006446129978801776, "un_batch_to_individual_items": 5.972717700642199e-05, "listify_data_for_vector_env": 0.00011992208102604985, "tensor_to_numpy": 0.00021779023420796068, "remove_single_ts_time_rank_from_batch": 7.192472011490625e-06}}, "connector_pipeline_timer": 0.0014858585802044785}, "episode_return_max": 0.5321111111111116, "num_episodes_lifetime": 96, "episode_duration_sec_mean": 19.70569709345194, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014736877851934872, "add_time_dim_to_batch_and_zero_pad": 3.3435744784073235e-05, "add_states_from_episodes_to_batch": 1.6739519155606085e-05, "batch_individual_items": 9.728251323342911e-05, "add_observations_from_episodes_to_batch": 4.021255332801312e-05}}, "connector_pipeline_timer": 0.0005676412085442638}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 22000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 22000}, "sample": 28.205548218196732, "num_env_steps_sampled_lifetime": 22000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": -0.14522222222222209, "agent_episode_returns_mean": {"default_agent": 0.1999017094017096}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.1999017094017096}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 91.83773361341106, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005349126925154018, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_in": 91.83773361341106, "env_step_timer": 0.10168488841701834, "time_between_sampling": 10.11532111300362, "num_env_steps_sampled_lifetime_throughput": 60.27656124621299}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.008828931488096714, "weights_seq_no": 11.0, "vf_loss": 0.0036901915445923805, "gradients_default_optimizer_global_norm": 0.2513810694217682, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 666240, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0036901915445923805, "vf_explained_var": 0.08863502740859985, "entropy": 1.358978271484375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06742138415575027, "policy_loss": 0.061082493513822556}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07956884627829437, "add_time_dim_to_batch_and_zero_pad": 3.1974907724482144e-05, "add_states_from_episodes_to_batch": 1.0897168844433622e-05, "general_advantage_estimation": 0.1266131372616395, "batch_individual_items": 0.039872376361487626, "add_observations_from_episodes_to_batch": 0.00033035239688660107, "add_one_ts_to_episodes_and_truncate": 0.00767128817355795, "numpy_to_tensor": 0.001198346026996389}}, "connector_pipeline_timer": 0.2559182983083744}, "num_env_steps_trained_lifetime": 10497080, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 666240, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.00384238404, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.27656124621299, "done": false, "training_iteration": 11, "trial_id": "8cacd_00000", "date": "2025-05-12_02-25-12", "timestamp": 1746980712, "time_this_iter_s": 32.99258041381836, "time_total_s": 382.1130151748657, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 382.1130151748657, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 79.13617021276598, "ram_util_percent": 49.52127659574468}}
{"timers": {"training_iteration": 37.91632357518927, "restore_env_runners": 3.479744877880927e-05, "training_step": 37.915887429992345, "env_runner_sampling_timer": 28.464062896246936, "learner_update_timer": 9.44388762102952, "synch_weights": 0.007013971473489201, "synch_env_connectors": 0.008737183520549712}, "env_runners": {"episode_return_mean": 0.22984829059829087, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00014800221353947261, "get_actions": 0.0006425807415112234, "un_batch_to_individual_items": 5.9863394984670946e-05, "listify_data_for_vector_env": 0.00011994287475273895, "tensor_to_numpy": 0.0002157555102278532, "remove_single_ts_time_rank_from_batch": 7.205758427858848e-06}}, "connector_pipeline_timer": 0.0014764592186663635}, "episode_return_max": 0.441666666666667, "num_episodes_lifetime": 104, "episode_duration_sec_mean": 19.567397927240318, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000146168651502603, "add_time_dim_to_batch_and_zero_pad": 3.32431311752606e-05, "add_states_from_episodes_to_batch": 1.6620897597083896e-05, "batch_individual_items": 9.608266009005085e-05, "add_observations_from_episodes_to_batch": 3.9626654062045155e-05}}, "connector_pipeline_timer": 0.0005623632272848821}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 24000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 24000}, "sample": 28.19065462472192, "num_env_steps_sampled_lifetime": 24000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.04433333333333342, "agent_episode_returns_mean": {"default_agent": 0.22984829059829087}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.22984829059829087}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.7653292410754, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005302483084002057, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_in": 93.7653292410754, "env_step_timer": 0.10072484959716689, "time_between_sampling": 10.107698335363285, "num_env_steps_sampled_lifetime_throughput": 60.35166989382817}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.009640397503972054, "weights_seq_no": 12.0, "vf_loss": 0.004582392051815987, "gradients_default_optimizer_global_norm": 0.47000885009765625, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 726784, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.004582392051815987, "vf_explained_var": 0.07544445991516113, "entropy": 1.3063501119613647, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.07674767076969147, "policy_loss": 0.06927315890789032}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07956481232685803, "add_time_dim_to_batch_and_zero_pad": 3.197062799380164e-05, "add_states_from_episodes_to_batch": 1.0896636392525534e-05, "general_advantage_estimation": 0.12649615663861763, "batch_individual_items": 0.03988600012750891, "add_observations_from_episodes_to_batch": 0.000330366662241565, "add_one_ts_to_episodes_and_truncate": 0.0076691764643225125, "numpy_to_tensor": 0.0011982800952820938}}, "connector_pipeline_timer": 0.25580845095202803}, "num_env_steps_trained_lifetime": 11450648, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 726784, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0045647522393, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.35166989382817, "done": false, "training_iteration": 12, "trial_id": "8cacd_00000", "date": "2025-05-12_02-25-45", "timestamp": 1746980745, "time_this_iter_s": 33.08791255950928, "time_total_s": 415.200927734375, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 415.200927734375, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 79.03617021276594, "ram_util_percent": 49.52553191489361}}
{"timers": {"training_iteration": 37.89900802094738, "restore_env_runners": 3.466947429273947e-05, "training_step": 37.89857181420242, "env_runner_sampling_timer": 28.46178901203448, "learner_update_timer": 9.428828198579216, "synch_weights": 0.007031010758756233, "synch_env_connectors": 0.008747051685357913}, "env_runners": {"episode_return_mean": 0.39067414529914574, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00014474348291536034, "get_actions": 0.0006438550655663088, "un_batch_to_individual_items": 5.9726236728458176e-05, "listify_data_for_vector_env": 0.00011966660403040836, "tensor_to_numpy": 0.00021443269503155477, "remove_single_ts_time_rank_from_batch": 7.159124297467503e-06}}, "connector_pipeline_timer": 0.0014722447207874952}, "episode_return_max": 0.8994444444444454, "num_episodes_lifetime": 120, "episode_duration_sec_mean": 19.76881689096156, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014585096375282916, "add_time_dim_to_batch_and_zero_pad": 3.3343444700697005e-05, "add_states_from_episodes_to_batch": 1.6589632925070444e-05, "batch_individual_items": 9.480707119538053e-05, "add_observations_from_episodes_to_batch": 3.9578779213495654e-05}}, "connector_pipeline_timer": 0.0005601534139749744}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 26000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 26000}, "sample": 28.176662841384903, "num_env_steps_sampled_lifetime": 26000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.11711111111111117, "agent_episode_returns_mean": {"default_agent": 0.39067414529914574}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.39067414529914574}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.17526445655238, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005266960957183622, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_in": 96.17526445655238, "env_step_timer": 0.10145357632109324, "time_between_sampling": 10.099212564658735, "num_env_steps_sampled_lifetime_throughput": 55.158011769950924}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.011417139321565628, "weights_seq_no": 13.0, "vf_loss": 0.010179215110838413, "gradients_default_optimizer_global_norm": 0.2928580343723297, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 787584, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010179215110838413, "vf_explained_var": 0.08961647748947144, "entropy": 1.2686846256256104, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08435390144586563, "policy_loss": 0.07074954360723495}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795607420598225, "add_time_dim_to_batch_and_zero_pad": 3.196575636705143e-05, "add_states_from_episodes_to_batch": 1.0896044872716293e-05, "general_advantage_estimation": 0.12636974822433003, "batch_individual_items": 0.039899445710573515, "add_observations_from_episodes_to_batch": 0.00033039266704978866, "add_one_ts_to_episodes_and_truncate": 0.007666971480454305, "numpy_to_tensor": 0.001198192917599354}}, "connector_pipeline_timer": 0.25568883315297786}, "num_env_steps_trained_lifetime": 12412048, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 787584, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0060722888365, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 55.158011769950924, "done": false, "training_iteration": 13, "trial_id": "8cacd_00000", "date": "2025-05-12_02-26-21", "timestamp": 1746980781, "time_this_iter_s": 36.20076823234558, "time_total_s": 451.4016959667206, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 451.4016959667206, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 79.18653846153846, "ram_util_percent": 49.49230769230769}}
{"timers": {"training_iteration": 37.85777394181792, "restore_env_runners": 3.4606779547730804e-05, "training_step": 37.85733730514039, "env_runner_sampling_timer": 28.43494430478414, "learner_update_timer": 9.414443107803422, "synch_weights": 0.007025776651160348, "synch_env_connectors": 0.008743385168509662}, "env_runners": {"episode_return_mean": 0.3704529914529917, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00014292706270581113, "get_actions": 0.0006435261546785122, "un_batch_to_individual_items": 5.97272165720563e-05, "listify_data_for_vector_env": 0.00011946702329434272, "tensor_to_numpy": 0.0002132661584709733, "remove_single_ts_time_rank_from_batch": 7.161738941276059e-06}}, "connector_pipeline_timer": 0.001467155039751326}, "episode_return_max": 0.8994444444444454, "num_episodes_lifetime": 128, "episode_duration_sec_mean": 19.84452404445222, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014564427151008905, "add_time_dim_to_batch_and_zero_pad": 3.32693575140435e-05, "add_states_from_episodes_to_batch": 1.6534368075213644e-05, "batch_individual_items": 9.380081568038455e-05, "add_observations_from_episodes_to_batch": 3.917990239737859e-05}}, "connector_pipeline_timer": 0.000557366788545173}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 28000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 28000}, "sample": 28.161713032177026, "num_env_steps_sampled_lifetime": 28000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.13300000000000003, "agent_episode_returns_mean": {"default_agent": 0.3704529914529917}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.3704529914529917}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.05841105247367, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005234828357427196, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_in": 96.05841105247367, "env_step_timer": 0.10169545629909346, "time_between_sampling": 10.090276746487293, "num_env_steps_sampled_lifetime_throughput": 59.086514087739445}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.013477902859449387, "weights_seq_no": 14.0, "vf_loss": 0.006583090405911207, "gradients_default_optimizer_global_norm": 0.5985415577888489, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 848128, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.006583090405911207, "vf_explained_var": 0.1461888551712036, "entropy": 1.1736438274383545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0982590764760971, "policy_loss": -0.10888552665710449}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07955643434689513, "add_time_dim_to_batch_and_zero_pad": 3.196043511002447e-05, "add_states_from_episodes_to_batch": 1.0895475519672575e-05, "general_advantage_estimation": 0.12623410452266443, "batch_individual_items": 0.039927358031964094, "add_observations_from_episodes_to_batch": 0.0003304184950956827, "add_one_ts_to_episodes_and_truncate": 0.007664590618616941, "numpy_to_tensor": 0.001198105805460721}}, "connector_pipeline_timer": 0.2555740104148136}, "num_env_steps_trained_lifetime": 13365616, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 848128, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0075492182266, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.086514087739445, "done": false, "training_iteration": 14, "trial_id": "8cacd_00000", "date": "2025-05-12_02-26-55", "timestamp": 1746980815, "time_this_iter_s": 33.790531635284424, "time_total_s": 485.192227602005, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 485.192227602005, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 78.625, "ram_util_percent": 49.520833333333336}}
{"timers": {"training_iteration": 37.804545955799746, "restore_env_runners": 3.465871174510955e-05, "training_step": 37.80410565348899, "env_runner_sampling_timer": 28.407150563156282, "learner_update_timer": 9.389012476705384, "synch_weights": 0.007018380884643964, "synch_env_connectors": 0.008730144316824943}, "env_runners": {"episode_return_mean": 0.3675010683760687, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013996053396404847, "get_actions": 0.0006420592654127749, "un_batch_to_individual_items": 5.9992154342355876e-05, "listify_data_for_vector_env": 0.0001195378471513595, "tensor_to_numpy": 0.0002129976985593743, "remove_single_ts_time_rank_from_batch": 7.1106446596816155e-06}}, "connector_pipeline_timer": 0.0014633939301504496}, "episode_return_max": 0.6612222222222232, "num_episodes_lifetime": 136, "episode_duration_sec_mean": 19.72401297399053, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001464780320949719, "add_time_dim_to_batch_and_zero_pad": 3.319716480221311e-05, "add_states_from_episodes_to_batch": 1.6636567366296412e-05, "batch_individual_items": 9.296720048024717e-05, "add_observations_from_episodes_to_batch": 3.8816805855486456e-05}}, "connector_pipeline_timer": 0.0005578698096165458}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 30000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 30000}, "sample": 28.145934108603246, "num_env_steps_sampled_lifetime": 30000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.13322222222222244, "agent_episode_returns_mean": {"default_agent": 0.3675010683760687}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.3675010683760687}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.25729412036287, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005207840900819502, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_in": 94.25729412036287, "env_step_timer": 0.10160513402469028, "time_between_sampling": 10.080879525689319, "num_env_steps_sampled_lifetime_throughput": 61.3097711063329}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.018440967425704002, "weights_seq_no": 15.0, "vf_loss": 0.005843569990247488, "gradients_default_optimizer_global_norm": 0.15748076140880585, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 908672, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.005843569990247488, "vf_explained_var": 0.06347155570983887, "entropy": 1.1293867826461792, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.05835690721869469, "policy_loss": -0.06973275542259216}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07955202154412047, "add_time_dim_to_batch_and_zero_pad": 3.1954793702493214e-05, "add_states_from_episodes_to_batch": 1.0894937949287196e-05, "general_advantage_estimation": 0.12608940382020986, "batch_individual_items": 0.039954679442455884, "add_observations_from_episodes_to_batch": 0.00033044777731400476, "add_one_ts_to_episodes_and_truncate": 0.007662032106868256, "numpy_to_tensor": 0.001197994566273074}}, "connector_pipeline_timer": 0.25544921444829727}, "num_env_steps_trained_lifetime": 14319184, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 908672, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0089960017997, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 61.3097711063329, "done": false, "training_iteration": 15, "trial_id": "8cacd_00000", "date": "2025-05-12_02-27-27", "timestamp": 1746980847, "time_this_iter_s": 32.55575966835022, "time_total_s": 517.7479872703552, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 517.7479872703552, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 81.71304347826087, "ram_util_percent": 49.5195652173913}}
{"timers": {"training_iteration": 37.78050048886176, "restore_env_runners": 3.469112462135829e-05, "training_step": 37.78005819757409, "env_runner_sampling_timer": 28.384986518144725, "learner_update_timer": 9.387137129938342, "synch_weights": 0.00700865807579119, "synch_env_connectors": 0.008744708883647465}, "env_runners": {"episode_return_mean": 0.41583760683760695, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013793046816395552, "get_actions": 0.0006413524247820678, "un_batch_to_individual_items": 6.024546258097401e-05, "listify_data_for_vector_env": 0.00011993228693596647, "tensor_to_numpy": 0.00021181536477498565, "remove_single_ts_time_rank_from_batch": 7.124167491127587e-06}}, "connector_pipeline_timer": 0.0014585094216892653}, "episode_return_max": 0.825666666666667, "num_episodes_lifetime": 144, "episode_duration_sec_mean": 19.899133732490117, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014669774017968045, "add_time_dim_to_batch_and_zero_pad": 3.32405155270035e-05, "add_states_from_episodes_to_batch": 1.6585737091996557e-05, "batch_individual_items": 9.195897072298782e-05, "add_observations_from_episodes_to_batch": 3.8418390787530554e-05}}, "connector_pipeline_timer": 0.0005552997415491104}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 32000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 32000}, "sample": 28.12943604211614, "num_env_steps_sampled_lifetime": 32000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.1580000000000004, "agent_episode_returns_mean": {"default_agent": 0.41583760683760695}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.41583760683760695}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.49369475979925, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005180677868124199, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_in": 92.49369475979925, "env_step_timer": 0.10121908207320407, "time_between_sampling": 10.07006976940819, "num_env_steps_sampled_lifetime_throughput": 56.36767810279376}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.008274203166365623, "weights_seq_no": 16.0, "vf_loss": 0.0060519748367369175, "gradients_default_optimizer_global_norm": 0.21274696290493011, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 969216, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0060519748367369175, "vf_explained_var": 0.010937511920928955, "entropy": 1.0989781618118286, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.023853745311498642, "policy_loss": 0.015319503843784332}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07954846585396667, "add_time_dim_to_batch_and_zero_pad": 3.194890907958077e-05, "add_states_from_episodes_to_batch": 1.0894411582871903e-05, "general_advantage_estimation": 0.12593593845135223, "batch_individual_items": 0.03998250739893465, "add_observations_from_episodes_to_batch": 0.0003304928620384863, "add_one_ts_to_episodes_and_truncate": 0.007659638656292762, "numpy_to_tensor": 0.0011978911712885684}}, "connector_pipeline_timer": 0.2553171917900698}, "num_env_steps_trained_lifetime": 15272752, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 969216, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0104130947796, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.36767810279376, "done": false, "training_iteration": 16, "trial_id": "8cacd_00000", "date": "2025-05-12_02-28-03", "timestamp": 1746980883, "time_this_iter_s": 35.41606593132019, "time_total_s": 553.1640532016754, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 553.1640532016754, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 76.256, "ram_util_percent": 49.516000000000005}}
{"timers": {"training_iteration": 37.78364840933314, "restore_env_runners": 3.458021338955552e-05, "training_step": 37.78320567095834, "env_runner_sampling_timer": 28.408383997273276, "learner_update_timer": 9.366890586688955, "synch_weights": 0.006990799495019195, "synch_env_connectors": 0.008741378794798589}, "env_runners": {"episode_return_mean": 0.477738247863248, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013686161198064338, "get_actions": 0.0006540003308517803, "un_batch_to_individual_items": 6.250390821171573e-05, "listify_data_for_vector_env": 0.00012177910660972402, "tensor_to_numpy": 0.0002169064197388346, "remove_single_ts_time_rank_from_batch": 7.148348532900159e-06}}, "connector_pipeline_timer": 0.001484615126136002}, "episode_return_max": 0.825666666666667, "num_episodes_lifetime": 152, "episode_duration_sec_mean": 19.823967889259585, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014900843878826037, "add_time_dim_to_batch_and_zero_pad": 3.350051954617723e-05, "add_states_from_episodes_to_batch": 1.6797864563624074e-05, "batch_individual_items": 9.342337381895435e-05, "add_observations_from_episodes_to_batch": 3.920753509401409e-05}}, "connector_pipeline_timer": 0.0005609104859236506}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 34000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 34000}, "sample": 28.116070168033776, "num_env_steps_sampled_lifetime": 34000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.16488888888888892, "agent_episode_returns_mean": {"default_agent": 0.477738247863248}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.477738247863248}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 91.88701548554039, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005246492583648295, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_in": 91.88701548554039, "env_step_timer": 0.10234734760958854, "time_between_sampling": 10.060164880030799, "num_env_steps_sampled_lifetime_throughput": 52.3876963868127}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.00837617740035057, "weights_seq_no": 17.0, "vf_loss": 0.005013209767639637, "gradients_default_optimizer_global_norm": 0.4480946362018585, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1029760, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.005013209767639637, "vf_explained_var": 0.051891446113586426, "entropy": 1.0915558338165283, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.024589965119957924, "policy_loss": -0.03211602568626404}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07954450078546148, "add_time_dim_to_batch_and_zero_pad": 3.194326666975249e-05, "add_states_from_episodes_to_batch": 1.0894656249888684e-05, "general_advantage_estimation": 0.12577375312948968, "batch_individual_items": 0.0400099047083397, "add_observations_from_episodes_to_batch": 0.0003305376402907847, "add_one_ts_to_episodes_and_truncate": 0.007657059071517998, "numpy_to_tensor": 0.0011977654347471497}}, "connector_pipeline_timer": 0.2551753868235621}, "num_env_steps_trained_lifetime": 16226320, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1029760, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0118009463, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.3876963868127, "done": false, "training_iteration": 17, "trial_id": "8cacd_00000", "date": "2025-05-12_02-28-41", "timestamp": 1746980921, "time_this_iter_s": 38.111504316329956, "time_total_s": 591.2755575180054, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 591.2755575180054, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 82.5, "ram_util_percent": 49.51296296296296}}
{"timers": {"training_iteration": 37.747786387789816, "restore_env_runners": 3.44904112586516e-05, "training_step": 37.74734243679874, "env_runner_sampling_timer": 28.387828317740542, "learner_update_timer": 9.351584778932068, "synch_weights": 0.006987228500076482, "synch_env_connectors": 0.008735635006850179}, "env_runners": {"episode_return_mean": 0.4683568376068376, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001345074536383987, "get_actions": 0.0006556950144759768, "un_batch_to_individual_items": 6.277991794294326e-05, "listify_data_for_vector_env": 0.00012235207675490394, "tensor_to_numpy": 0.00021586384501151744, "remove_single_ts_time_rank_from_batch": 7.105337362001037e-06}}, "connector_pipeline_timer": 0.001484059389172423}, "episode_return_max": 0.7725555555555559, "num_episodes_lifetime": 160, "episode_duration_sec_mean": 23.07476279456745, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014904856334721123, "add_time_dim_to_batch_and_zero_pad": 3.3290362597454735e-05, "add_states_from_episodes_to_batch": 1.7404818465270227e-05, "batch_individual_items": 9.286379867822582e-05, "add_observations_from_episodes_to_batch": 3.91346293738591e-05}}, "connector_pipeline_timer": 0.0005602199847128965}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 36000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 36000}, "sample": 28.10212690869529, "num_env_steps_sampled_lifetime": 36000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.24877777777777788, "agent_episode_returns_mean": {"default_agent": 0.4683568376068376}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.4683568376068376}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.07395359352216, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005228256815175567, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_in": 93.07395359352216, "env_step_timer": 0.10176110663975269, "time_between_sampling": 10.04939332560009, "num_env_steps_sampled_lifetime_throughput": 58.36405315908901}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.006314332131296396, "weights_seq_no": 18.0, "vf_loss": 0.008472481742501259, "gradients_default_optimizer_global_norm": 0.5501181483268738, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1090304, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008472481742501259, "vf_explained_var": 0.012454807758331299, "entropy": 1.0559585094451904, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08421288430690765, "policy_loss": 0.07384608685970306}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07954028200174106, "add_time_dim_to_batch_and_zero_pad": 3.1937352217145474e-05, "add_states_from_episodes_to_batch": 1.0894836582428114e-05, "general_advantage_estimation": 0.12560307753021913, "batch_individual_items": 0.04003678203081669, "add_observations_from_episodes_to_batch": 0.0003305804136918413, "add_one_ts_to_episodes_and_truncate": 0.007654297884572982, "numpy_to_tensor": 0.00119763754381944}}, "connector_pipeline_timer": 0.2550241141272056}, "num_env_steps_trained_lifetime": 17179888, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1090304, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0131599994802, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.36405315908901, "done": false, "training_iteration": 18, "trial_id": "8cacd_00000", "date": "2025-05-12_02-29-15", "timestamp": 1746980955, "time_this_iter_s": 34.218952655792236, "time_total_s": 625.4945101737976, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 625.4945101737976, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 78.83265306122449, "ram_util_percent": 49.51632653061225}}
{"timers": {"training_iteration": 37.697895383331904, "restore_env_runners": 3.4400507159632124e-05, "training_step": 37.697450692850765, "env_runner_sampling_timer": 28.355296414903137, "learner_update_timer": 9.334241280222736, "synch_weights": 0.006969849215078586, "synch_env_connectors": 0.008756858656778114}, "env_runners": {"episode_return_mean": 0.5347393162393165, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013286137985922157, "get_actions": 0.000656607859151719, "un_batch_to_individual_items": 6.27530801794534e-05, "listify_data_for_vector_env": 0.00012213231741686306, "tensor_to_numpy": 0.0002139799337942077, "remove_single_ts_time_rank_from_batch": 7.068698953487999e-06}}, "connector_pipeline_timer": 0.0014809110725946266}, "episode_return_max": 0.9106666666666677, "num_episodes_lifetime": 168, "episode_duration_sec_mean": 22.004160230836412, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014849890862264506, "add_time_dim_to_batch_and_zero_pad": 3.3219842377576e-05, "add_states_from_episodes_to_batch": 1.73868469787739e-05, "batch_individual_items": 9.204955829387909e-05, "add_observations_from_episodes_to_batch": 3.8862875762363434e-05}}, "connector_pipeline_timer": 0.0005568883378385063}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 38000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 38000}, "sample": 28.08682099744397, "num_env_steps_sampled_lifetime": 38000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.2903333333333336, "agent_episode_returns_mean": {"default_agent": 0.5347393162393165}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.5347393162393165}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.3759050960455, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005189358275117812, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_in": 96.3759050960455, "env_step_timer": 0.10080754329552248, "time_between_sampling": 10.038291038683534, "num_env_steps_sampled_lifetime_throughput": 60.884260641197066}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.004212434869259596, "weights_seq_no": 19.0, "vf_loss": 0.005837361793965101, "gradients_default_optimizer_global_norm": 0.22483313083648682, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1150848, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.005837361793965101, "vf_explained_var": 0.03186964988708496, "entropy": 1.0646090507507324, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.15954925119876862, "policy_loss": -0.16665036976337433}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07953613071361641, "add_time_dim_to_batch_and_zero_pad": 3.1933801727055404e-05, "add_states_from_episodes_to_batch": 1.0894953842713042e-05, "general_advantage_estimation": 0.125424126117621, "batch_individual_items": 0.04006310849637326, "add_observations_from_episodes_to_batch": 0.00033062474786081387, "add_one_ts_to_episodes_and_truncate": 0.007651368475459825, "numpy_to_tensor": 0.0011975013641669795}}, "connector_pipeline_timer": 0.25486388588609404}, "num_env_steps_trained_lifetime": 18133456, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1150848, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0144906915023, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.884260641197066, "done": false, "training_iteration": 19, "trial_id": "8cacd_00000", "date": "2025-05-12_02-29-48", "timestamp": 1746980988, "time_this_iter_s": 32.77426075935364, "time_total_s": 658.2687709331512, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 658.2687709331512, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 78.67872340425532, "ram_util_percent": 49.51702127659575}}
{"timers": {"training_iteration": 37.68579141588859, "restore_env_runners": 3.438950207707693e-05, "training_step": 37.685345282312255, "env_runner_sampling_timer": 28.35637481507412, "learner_update_timer": 9.321070328490512, "synch_weights": 0.00695428372292198, "synch_env_connectors": 0.008741724070204578}, "env_runners": {"episode_return_mean": 0.6082414529914536, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013116781746485735, "get_actions": 0.0006542816163394805, "un_batch_to_individual_items": 6.262902404489128e-05, "listify_data_for_vector_env": 0.00012158476627063002, "tensor_to_numpy": 0.0002124590563411036, "remove_single_ts_time_rank_from_batch": 7.041455061143736e-06}}, "connector_pipeline_timer": 0.001472626978366905}, "episode_return_max": 1.0213333333333359, "num_episodes_lifetime": 184, "episode_duration_sec_mean": 19.74896136952867, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014763542480096122, "add_time_dim_to_batch_and_zero_pad": 3.3022405527257184e-05, "add_states_from_episodes_to_batch": 1.7230741668646836e-05, "batch_individual_items": 9.141440635134918e-05, "add_observations_from_episodes_to_batch": 3.919436451491299e-05}}, "connector_pipeline_timer": 0.0005543308484854949}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 40000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 40000}, "sample": 28.07228692218489, "num_env_steps_sampled_lifetime": 40000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.3318888888888888, "agent_episode_returns_mean": {"default_agent": 0.6082414529914536}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.6082414529914536}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.24655369937295, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005161842941555154, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_in": 97.24655369937295, "env_step_timer": 0.10107576458018047, "time_between_sampling": 10.026617033036436, "num_env_steps_sampled_lifetime_throughput": 54.70183549784534}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.011490803211927414, "weights_seq_no": 20.0, "vf_loss": 0.01562930829823017, "gradients_default_optimizer_global_norm": 0.38154563307762146, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 1211648, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01562930829823017, "vf_explained_var": 0.09127908945083618, "entropy": 0.9889967441558838, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.029524357989430428, "policy_loss": -0.046877287328243256}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795316755530542, "add_time_dim_to_batch_and_zero_pad": 3.192977851153304e-05, "add_states_from_episodes_to_batch": 1.0895019274231445e-05, "general_advantage_estimation": 0.12523712430552192, "batch_individual_items": 0.040088915484515604, "add_observations_from_episodes_to_batch": 0.00033068601730501843, "add_one_ts_to_episodes_and_truncate": 0.007648464864740498, "numpy_to_tensor": 0.0011973625343532758}}, "connector_pipeline_timer": 0.25469480691849217}, "num_env_steps_trained_lifetime": 19094856, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 1211648, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.016593453684, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.70183549784534, "done": false, "training_iteration": 20, "trial_id": "8cacd_00000", "date": "2025-05-12_02-30-25", "timestamp": 1746981025, "time_this_iter_s": 36.50322985649109, "time_total_s": 694.7720007896423, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 694.7720007896423, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 78.22115384615384, "ram_util_percent": 49.53076923076923}}
{"timers": {"training_iteration": 37.6459938557897, "restore_env_runners": 3.4257607069868076e-05, "training_step": 37.64554762554913, "env_runner_sampling_timer": 28.323716552853377, "learner_update_timer": 9.31395376233561, "synch_weights": 0.006931159885683907, "synch_env_connectors": 0.008735190829501591}, "env_runners": {"episode_return_mean": 0.6076303418803429, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012913718796861212, "get_actions": 0.0006532844947226205, "un_batch_to_individual_items": 6.218321720087858e-05, "listify_data_for_vector_env": 0.00012124950635338928, "tensor_to_numpy": 0.00021172108264225356, "remove_single_ts_time_rank_from_batch": 7.036954985029955e-06}}, "connector_pipeline_timer": 0.0014674235358369343}, "episode_return_max": 1.0213333333333359, "num_episodes_lifetime": 192, "episode_duration_sec_mean": 19.413911681009512, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014639445202314723, "add_time_dim_to_batch_and_zero_pad": 3.2922753455282256e-05, "add_states_from_episodes_to_batch": 1.7137075087777483e-05, "batch_individual_items": 9.041855804190559e-05, "add_observations_from_episodes_to_batch": 3.8627493486425126e-05}}, "connector_pipeline_timer": 0.0005498421730278906}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 42000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 42000}, "sample": 28.056319286018056, "num_env_steps_sampled_lifetime": 42000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.3000000000000003, "agent_episode_returns_mean": {"default_agent": 0.6076303418803429}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6076303418803429}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.75426675265321, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005132686559666602, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_in": 95.75426675265321, "env_step_timer": 0.1008494644671816, "time_between_sampling": 10.015383852387842, "num_env_steps_sampled_lifetime_throughput": 59.02917053806037}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.006993588525801897, "weights_seq_no": 21.0, "vf_loss": 0.010374143719673157, "gradients_default_optimizer_global_norm": 0.28916406631469727, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1272192, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010374143719673157, "vf_explained_var": 0.1771526336669922, "entropy": 1.012397289276123, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07245083153247833, "policy_loss": -0.08387400209903717}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07952687317283179, "add_time_dim_to_batch_and_zero_pad": 3.1925552380114926e-05, "add_states_from_episodes_to_batch": 1.08950939017438e-05, "general_advantage_estimation": 0.12504228247705296, "batch_individual_items": 0.04011432479214541, "add_observations_from_episodes_to_batch": 0.0003307442888855227, "add_one_ts_to_episodes_and_truncate": 0.007645402519488003, "numpy_to_tensor": 0.0011972420809994117}}, "connector_pipeline_timer": 0.25451698123205363}, "num_env_steps_trained_lifetime": 20048424, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1272192, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0186527115527, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.02917053806037, "done": false, "training_iteration": 21, "trial_id": "8cacd_00000", "date": "2025-05-12_02-30-59", "timestamp": 1746981059, "time_this_iter_s": 33.721922874450684, "time_total_s": 728.493923664093, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.493923664093, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 76.68124999999999, "ram_util_percent": 49.51666666666667}}
{"timers": {"training_iteration": 37.60137083753179, "restore_env_runners": 3.4125030997502324e-05, "training_step": 37.60092387459363, "env_runner_sampling_timer": 28.29599033423486, "learner_update_timer": 9.29707102210225, "synch_weights": 0.006914334286831206, "synch_env_connectors": 0.008717777921192908}, "env_runners": {"episode_return_mean": 0.5115972222222228, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001268979870281962, "get_actions": 0.000651690047774216, "un_batch_to_individual_items": 6.195077790666393e-05, "listify_data_for_vector_env": 0.00012060253491832969, "tensor_to_numpy": 0.00021173876206626263, "remove_single_ts_time_rank_from_batch": 7.163283904703166e-06}}, "connector_pipeline_timer": 0.0014615359757044024}, "episode_return_max": 0.8657777777777791, "num_episodes_lifetime": 200, "episode_duration_sec_mean": 19.331342443442527, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014572252840336402, "add_time_dim_to_batch_and_zero_pad": 3.2762398803374915e-05, "add_states_from_episodes_to_batch": 1.7049757397929685e-05, "batch_individual_items": 8.946222423814337e-05, "add_observations_from_episodes_to_batch": 3.825898732689531e-05}}, "connector_pipeline_timer": 0.0005470074995706891}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 44000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 44000}, "sample": 28.039541025954303, "num_env_steps_sampled_lifetime": 44000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.2782222222222225, "agent_episode_returns_mean": {"default_agent": 0.5115972222222228}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.5115972222222228}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.75815918851127, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005115509835358179, "weights_seq_no": 21.0, "env_to_module_sum_episodes_length_in": 93.75815918851127, "env_step_timer": 0.10053236223621664, "time_between_sampling": 10.00448650460079, "num_env_steps_sampled_lifetime_throughput": 60.13104045385543}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.008178675547242165, "weights_seq_no": 22.0, "vf_loss": 0.004579000174999237, "gradients_default_optimizer_global_norm": 0.2802841365337372, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1332736, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.004579000174999237, "vf_explained_var": 0.0868256688117981, "entropy": 0.9791374802589417, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.04894374683499336, "policy_loss": -0.05474954843521118}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07952162414265863, "add_time_dim_to_batch_and_zero_pad": 3.192082779352086e-05, "add_states_from_episodes_to_batch": 1.0895097534723614e-05, "general_advantage_estimation": 0.12483978772272275, "batch_individual_items": 0.04013934866207419, "add_observations_from_episodes_to_batch": 0.0003308070464328433, "add_one_ts_to_episodes_and_truncate": 0.007642157264654023, "numpy_to_tensor": 0.0011971153804591775}}, "connector_pipeline_timer": 0.254330470438652}, "num_env_steps_trained_lifetime": 21001992, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1332736, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0206691249189, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 44000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.13104045385543, "done": false, "training_iteration": 22, "trial_id": "8cacd_00000", "date": "2025-05-12_02-31-32", "timestamp": 1746981092, "time_this_iter_s": 33.19956874847412, "time_total_s": 761.6934924125671, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 761.6934924125671, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 79.59787234042552, "ram_util_percent": 49.51914893617022}}
{"timers": {"training_iteration": 37.56547386279646, "restore_env_runners": 3.4101780689680285e-05, "training_step": 37.56502603248768, "env_runner_sampling_timer": 28.27072908571251, "learner_update_timer": 9.286415785701227, "synch_weights": 0.006929085943969926, "synch_env_connectors": 0.00871006314198283}, "env_runners": {"episode_return_mean": 0.515123931623932, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.000125405258937256, "get_actions": 0.0006494696495696623, "un_batch_to_individual_items": 6.171592028239092e-05, "listify_data_for_vector_env": 0.00012043105343685711, "tensor_to_numpy": 0.00021116988150926295, "remove_single_ts_time_rank_from_batch": 7.1479121846252034e-06}}, "connector_pipeline_timer": 0.0014553602084563307}, "episode_return_max": 0.7782222222222227, "num_episodes_lifetime": 208, "episode_duration_sec_mean": 19.479915175865454, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014567940825101295, "add_time_dim_to_batch_and_zero_pad": 3.258852258712348e-05, "add_states_from_episodes_to_batch": 1.6973184068686574e-05, "batch_individual_items": 8.927731195126384e-05, "add_observations_from_episodes_to_batch": 3.797585113432098e-05}}, "connector_pipeline_timer": 0.0005463903339473782}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 46000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 46000}, "sample": 28.021993578420318, "num_env_steps_sampled_lifetime": 46000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.2782222222222225, "agent_episode_returns_mean": {"default_agent": 0.515123931623932}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.515123931623932}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.5933605761248, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005128274974286307, "weights_seq_no": 22.0, "env_to_module_sum_episodes_length_in": 92.5933605761248, "env_step_timer": 0.09992115471176109, "time_between_sampling": 9.993018866835758, "num_env_steps_sampled_lifetime_throughput": 58.66422091384119}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.012155169621109962, "weights_seq_no": 23.0, "vf_loss": 0.008300461806356907, "gradients_default_optimizer_global_norm": 0.4264083802700043, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1393280, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008300461806356907, "vf_explained_var": 0.03713059425354004, "entropy": 0.9249918460845947, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.16003373265266418, "policy_loss": -0.17015744745731354}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07951592018547153, "add_time_dim_to_batch_and_zero_pad": 3.191562514336176e-05, "add_states_from_episodes_to_batch": 1.0894971585505716e-05, "general_advantage_estimation": 0.12462974624523136, "batch_individual_items": 0.04016380796202515, "add_observations_from_episodes_to_batch": 0.00033086799440038787, "add_one_ts_to_episodes_and_truncate": 0.00763877597466476, "numpy_to_tensor": 0.0011969759797216604}}, "connector_pipeline_timer": 0.2541352202125952}, "num_env_steps_trained_lifetime": 21955560, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1393280, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0226433447465, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 46000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.66422091384119, "done": false, "training_iteration": 23, "trial_id": "8cacd_00000", "date": "2025-05-12_02-32-06", "timestamp": 1746981126, "time_this_iter_s": 34.02632784843445, "time_total_s": 795.7198202610016, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 795.7198202610016, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 77.86458333333333, "ram_util_percent": 49.51458333333334}}
{"timers": {"training_iteration": 37.536815145098494, "restore_env_runners": 3.3982762881540865e-05, "training_step": 37.53636693109282, "env_runner_sampling_timer": 28.25045104984539, "learner_update_timer": 9.278042413784213, "synch_weights": 0.006919183084520803, "synch_env_connectors": 0.008703587510554417}, "env_runners": {"episode_return_mean": 0.6135235042735043, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012388104154336895, "get_actions": 0.0006481791896601228, "un_batch_to_individual_items": 6.218603763711916e-05, "listify_data_for_vector_env": 0.00012069350645141559, "tensor_to_numpy": 0.0002101581691089017, "remove_single_ts_time_rank_from_batch": 7.085823719362552e-06}}, "connector_pipeline_timer": 0.0014527711249416792}, "episode_return_max": 1.0232222222222223, "num_episodes_lifetime": 216, "episode_duration_sec_mean": 19.65612899124043, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014507836817015496, "add_time_dim_to_batch_and_zero_pad": 3.2418137102979245e-05, "add_states_from_episodes_to_batch": 1.7032521944676894e-05, "batch_individual_items": 8.878304592478171e-05, "add_observations_from_episodes_to_batch": 3.769552339378672e-05}}, "connector_pipeline_timer": 0.0005446856243431712}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 48000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 48000}, "sample": 28.004336256847026, "num_env_steps_sampled_lifetime": 48000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.29344444444444473, "agent_episode_returns_mean": {"default_agent": 0.6135235042735043}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6135235042735043}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.04534696622203, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005131603993700537, "weights_seq_no": 23.0, "env_to_module_sum_episodes_length_in": 93.04534696622203, "env_step_timer": 0.09957653741018802, "time_between_sampling": 9.981716778924653, "num_env_steps_sampled_lifetime_throughput": 57.50836256466683}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.009000204503536224, "weights_seq_no": 24.0, "vf_loss": 0.008225846104323864, "gradients_default_optimizer_global_norm": 0.6030201315879822, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1453824, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008225846104323864, "vf_explained_var": 0.09312301874160767, "entropy": 0.9155148267745972, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.049232371151447296, "policy_loss": 0.03965648263692856}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07951025632501381, "add_time_dim_to_batch_and_zero_pad": 3.1911754463431244e-05, "add_states_from_episodes_to_batch": 1.0895078645565393e-05, "general_advantage_estimation": 0.12441251838851754, "batch_individual_items": 0.04018788291111094, "add_observations_from_episodes_to_batch": 0.00033092728270400133, "add_one_ts_to_episodes_and_truncate": 0.007635240884748781, "numpy_to_tensor": 0.001196828945460848}}, "connector_pipeline_timer": 0.25393226533401564}, "num_env_steps_trained_lifetime": 22909128, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1453824, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0245760132652, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 48000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.50836256466683, "done": false, "training_iteration": 24, "trial_id": "8cacd_00000", "date": "2025-05-12_02-32-41", "timestamp": 1746981161, "time_this_iter_s": 34.717177391052246, "time_total_s": 830.4369976520538, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 830.4369976520538, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 77.442, "ram_util_percent": 49.51200000000001}}
{"timers": {"training_iteration": 37.49907801587751, "restore_env_runners": 3.3861935246829254e-05, "training_step": 37.49862956601189, "env_runner_sampling_timer": 28.22516733853693, "learner_update_timer": 9.265604249686367, "synch_weights": 0.006903371253665879, "synch_env_connectors": 0.008698135635448438}, "env_runners": {"episode_return_mean": 0.6291506410256411, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012283523683816717, "get_actions": 0.000646724934317329, "un_batch_to_individual_items": 6.220273625900885e-05, "listify_data_for_vector_env": 0.0001206415268604876, "tensor_to_numpy": 0.00020964118324062983, "remove_single_ts_time_rank_from_batch": 7.179617099794312e-06}}, "connector_pipeline_timer": 0.0014511816027587743}, "episode_return_max": 1.0232222222222223, "num_episodes_lifetime": 224, "episode_duration_sec_mean": 20.036334793711568, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001457008626986597, "add_time_dim_to_batch_and_zero_pad": 3.244828045724887e-05, "add_states_from_episodes_to_batch": 1.6927044827265115e-05, "batch_individual_items": 8.835762623754959e-05, "add_observations_from_episodes_to_batch": 3.72812264112962e-05}}, "connector_pipeline_timer": 0.0005431228182796842}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 50000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 50000}, "sample": 27.986252286334125, "num_env_steps_sampled_lifetime": 50000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.3442222222222222, "agent_episode_returns_mean": {"default_agent": 0.6291506410256411}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6291506410256411}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.53058336733697, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.00051293403952855, "weights_seq_no": 24.0, "env_to_module_sum_episodes_length_in": 95.53058336733697, "env_step_timer": 0.09891484986374967, "time_between_sampling": 9.970537896830438, "num_env_steps_sampled_lifetime_throughput": 59.07414151356881}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.007193402387201786, "weights_seq_no": 25.0, "vf_loss": 0.011821706779301167, "gradients_default_optimizer_global_norm": 0.21842262148857117, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1514368, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011821706779301167, "vf_explained_var": 0.016900837421417236, "entropy": 0.8840475082397461, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.024425646290183067, "policy_loss": 0.011524934321641922}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07950437397974681, "add_time_dim_to_batch_and_zero_pad": 3.190733963469106e-05, "add_states_from_episodes_to_batch": 1.0895094067421961e-05, "general_advantage_estimation": 0.12418844201431356, "batch_individual_items": 0.04021167573041881, "add_observations_from_episodes_to_batch": 0.0003309889184420942, "add_one_ts_to_episodes_and_truncate": 0.007631607509033793, "numpy_to_tensor": 0.001196686714287214}}, "connector_pipeline_timer": 0.2537218500309863}, "num_env_steps_trained_lifetime": 23862696, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1514368, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.026467764079, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 50000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.07414151356881, "done": false, "training_iteration": 25, "trial_id": "8cacd_00000", "date": "2025-05-12_02-33-15", "timestamp": 1746981195, "time_this_iter_s": 33.7788610458374, "time_total_s": 864.2158586978912, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 864.2158586978912, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 79.09791666666666, "ram_util_percent": 49.52291666666667}}
{"timers": {"training_iteration": 37.49834365084874, "restore_env_runners": 3.3786315896084374e-05, "training_step": 37.497894736481776, "env_runner_sampling_timer": 28.23917180643157, "learner_update_timer": 9.250877955039497, "synch_weights": 0.006888143541125478, "synch_env_connectors": 0.00868660727910252}, "env_runners": {"episode_return_mean": 0.654460470085471, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012144975816179335, "get_actions": 0.0006459718940775664, "un_batch_to_individual_items": 6.214374098665809e-05, "listify_data_for_vector_env": 0.00012033093551877715, "tensor_to_numpy": 0.0002089114447925235, "remove_single_ts_time_rank_from_batch": 7.179739634216249e-06}}, "connector_pipeline_timer": 0.001446804404255033}, "episode_return_max": 0.9638888888888903, "num_episodes_lifetime": 240, "episode_duration_sec_mean": 20.837920857471282, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014539678967987805, "add_time_dim_to_batch_and_zero_pad": 3.230680428180263e-05, "add_states_from_episodes_to_batch": 1.6809408536493007e-05, "batch_individual_items": 8.768865669938932e-05, "add_observations_from_episodes_to_batch": 3.71042418750002e-05}}, "connector_pipeline_timer": 0.0005424927665330272}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 52000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 52000}, "sample": 27.97075762887533, "num_env_steps_sampled_lifetime": 52000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.24355555555555575, "agent_episode_returns_mean": {"default_agent": 0.654460470085471}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.654460470085471}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.10388082982128, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005133732244725136, "weights_seq_no": 25.0, "env_to_module_sum_episodes_length_in": 97.10388082982128, "env_step_timer": 0.0996533181834896, "time_between_sampling": 9.959079970692537, "num_env_steps_sampled_lifetime_throughput": 53.33896676315703}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.007232132833451033, "weights_seq_no": 26.0, "vf_loss": 0.015587427653372288, "gradients_default_optimizer_global_norm": 0.2546854019165039, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 1575168, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015587427653372288, "vf_explained_var": 0.060545384883880615, "entropy": 0.808784544467926, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.022122280672192574, "policy_loss": -0.03879452869296074}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07949850128575266, "add_time_dim_to_batch_and_zero_pad": 3.190269192710507e-05, "add_states_from_episodes_to_batch": 1.0895049672998116e-05, "general_advantage_estimation": 0.12395732145575489, "batch_individual_items": 0.04025003140484938, "add_observations_from_episodes_to_batch": 0.00033106477873703785, "add_one_ts_to_episodes_and_truncate": 0.007627946376744649, "numpy_to_tensor": 0.0011965268948424547}}, "connector_pipeline_timer": 0.25351891668728416}, "num_env_steps_trained_lifetime": 24824096, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 1575168, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.029119222275, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 52000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.33896676315703, "done": false, "training_iteration": 26, "trial_id": "8cacd_00000", "date": "2025-05-12_02-33-52", "timestamp": 1746981232, "time_this_iter_s": 37.440956354141235, "time_total_s": 901.6568150520325, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 901.6568150520325, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 81.57735849056604, "ram_util_percent": 49.533962264150944}}
{"timers": {"training_iteration": 37.46495834732025, "restore_env_runners": 3.37214527422323e-05, "training_step": 37.46450858309696, "env_runner_sampling_timer": 28.208999300837267, "learner_update_timer": 9.24767739999909, "synch_weights": 0.006875321105712864, "synch_env_connectors": 0.008678906206299774}, "env_runners": {"episode_return_mean": 0.5843696581196588, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011978089474407857, "get_actions": 0.0006432259869403505, "un_batch_to_individual_items": 6.203848702790239e-05, "listify_data_for_vector_env": 0.00012015364142295082, "tensor_to_numpy": 0.00020741878067173544, "remove_single_ts_time_rank_from_batch": 7.141432432482613e-06}}, "connector_pipeline_timer": 0.0014398288310747747}, "episode_return_max": 0.9638888888888903, "num_episodes_lifetime": 248, "episode_duration_sec_mean": 20.17590579090349, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014501502959433278, "add_time_dim_to_batch_and_zero_pad": 3.2266544499107775e-05, "add_states_from_episodes_to_batch": 1.6677421902831088e-05, "batch_individual_items": 8.700858262911213e-05, "add_observations_from_episodes_to_batch": 3.6744427698539195e-05}}, "connector_pipeline_timer": 0.0005413959095219467}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 54000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 54000}, "sample": 27.954091651355068, "num_env_steps_sampled_lifetime": 54000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.24355555555555575, "agent_episode_returns_mean": {"default_agent": 0.5843696581196588}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.5843696581196588}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.21435735165456, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005111532432787333, "weights_seq_no": 26.0, "env_to_module_sum_episodes_length_in": 96.21435735165456, "env_step_timer": 0.09969490984913269, "time_between_sampling": 9.94723962423016, "num_env_steps_sampled_lifetime_throughput": 58.42970768612959}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.005050845444202423, "weights_seq_no": 27.0, "vf_loss": 0.007644311524927616, "gradients_default_optimizer_global_norm": 0.3706268072128296, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1635712, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007644311524927616, "vf_explained_var": 0.11485826969146729, "entropy": 0.7546778917312622, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0824408307671547, "policy_loss": -0.09084277600049973}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0794921414883404, "add_time_dim_to_batch_and_zero_pad": 3.189771643969919e-05, "add_states_from_episodes_to_batch": 1.0894906657136498e-05, "general_advantage_estimation": 0.12371932955416602, "batch_individual_items": 0.04028762880821825, "add_observations_from_episodes_to_batch": 0.0003311380729343565, "add_one_ts_to_episodes_and_truncate": 0.007624136226350298, "numpy_to_tensor": 0.0011963547131151914}}, "connector_pipeline_timer": 0.25330768433555284}, "num_env_steps_trained_lifetime": 25777664, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1635712, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.031715004531, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.42970768612959, "done": false, "training_iteration": 27, "trial_id": "8cacd_00000", "date": "2025-05-12_02-34-26", "timestamp": 1746981266, "time_this_iter_s": 34.17455458641052, "time_total_s": 935.831369638443, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 935.831369638443, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 75.5673469387755, "ram_util_percent": 49.54489795918368}}
{"timers": {"training_iteration": 37.41651108271705, "restore_env_runners": 3.3608238210606453e-05, "training_step": 37.416060569136, "env_runner_sampling_timer": 28.178453977148905, "learner_update_timer": 9.229787909539104, "synch_weights": 0.006861833904659569, "synch_env_connectors": 0.008663238144237634}, "env_runners": {"episode_return_mean": 0.552452991452992, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011867436234987775, "get_actions": 0.000639888397908557, "un_batch_to_individual_items": 6.16961183703482e-05, "listify_data_for_vector_env": 0.00012013800262201694, "tensor_to_numpy": 0.00020628700724190316, "remove_single_ts_time_rank_from_batch": 7.092200514233028e-06}}, "connector_pipeline_timer": 0.0014324474718661006}, "episode_return_max": 0.9480000000000018, "num_episodes_lifetime": 256, "episode_duration_sec_mean": 19.290048418788395, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001456789423093495, "add_time_dim_to_batch_and_zero_pad": 3.2440092959727475e-05, "add_states_from_episodes_to_batch": 1.6570052535124463e-05, "batch_individual_items": 8.648387796059807e-05, "add_observations_from_episodes_to_batch": 3.634491250206877e-05}}, "connector_pipeline_timer": 0.0005398210591844008}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 56000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 56000}, "sample": 27.93641275393055, "num_env_steps_sampled_lifetime": 56000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.20455555555555577, "agent_episode_returns_mean": {"default_agent": 0.552452991452992}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.552452991452992}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.2239733662065, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005084706916293179, "weights_seq_no": 27.0, "env_to_module_sum_episodes_length_in": 94.2239733662065, "env_step_timer": 0.09941461207974758, "time_between_sampling": 9.936085097661687, "num_env_steps_sampled_lifetime_throughput": 61.18046809742023}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.005733465310186148, "weights_seq_no": 28.0, "vf_loss": 0.00901036337018013, "gradients_default_optimizer_global_norm": 0.3414285182952881, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1696256, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.00901036337018013, "vf_explained_var": 0.047405123710632324, "entropy": 0.744036078453064, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.050682567059993744, "policy_loss": 0.040812186896800995}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0794854729667479, "add_time_dim_to_batch_and_zero_pad": 3.189237019282366e-05, "add_states_from_episodes_to_batch": 1.0894706996646085e-05, "general_advantage_estimation": 0.12347462859846328, "batch_individual_items": 0.04032453331037924, "add_observations_from_episodes_to_batch": 0.0003312115547698719, "add_one_ts_to_episodes_and_truncate": 0.007620154954326186, "numpy_to_tensor": 0.0011961727223329935}}, "connector_pipeline_timer": 0.2530885476391875}, "num_env_steps_trained_lifetime": 26731232, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1696256, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0342559592195, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 56000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 61.18046809742023, "done": false, "training_iteration": 28, "trial_id": "8cacd_00000", "date": "2025-05-12_02-34-59", "timestamp": 1746981299, "time_this_iter_s": 32.63645386695862, "time_total_s": 968.4678235054016, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 968.4678235054016, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 79.97391304347826, "ram_util_percent": 49.52608695652174}}
{"timers": {"training_iteration": 37.37841740849988, "restore_env_runners": 3.354915582768734e-05, "training_step": 37.37796566905464, "env_runner_sampling_timer": 28.147122221977416, "learner_update_timer": 9.223037834453715, "synch_weights": 0.006848224565619949, "synch_env_connectors": 0.008658386762803309}, "env_runners": {"episode_return_mean": 0.6281431623931625, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011752572578121872, "get_actions": 0.0006370032632228194, "un_batch_to_individual_items": 6.128564032668446e-05, "listify_data_for_vector_env": 0.0001194545266105125, "tensor_to_numpy": 0.00020575584056668972, "remove_single_ts_time_rank_from_batch": 7.0478279637202054e-06}}, "connector_pipeline_timer": 0.0014255152370839048}, "episode_return_max": 1.0511111111111116, "num_episodes_lifetime": 264, "episode_duration_sec_mean": 19.081431644894618, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014501258921922902, "add_time_dim_to_batch_and_zero_pad": 3.240654987069735e-05, "add_states_from_episodes_to_batch": 1.6482917954424976e-05, "batch_individual_items": 8.619605328043978e-05, "add_observations_from_episodes_to_batch": 3.613767604106202e-05}}, "connector_pipeline_timer": 0.0005373914968660684}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 58000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 58000}, "sample": 27.917794063429156, "num_env_steps_sampled_lifetime": 58000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.20455555555555577, "agent_episode_returns_mean": {"default_agent": 0.6281431623931625}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6281431623931625}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.6670553459763, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000507553389123729, "weights_seq_no": 28.0, "env_to_module_sum_episodes_length_in": 92.6670553459763, "env_step_timer": 0.09891597359853338, "time_between_sampling": 9.924355156776281, "num_env_steps_sampled_lifetime_throughput": 59.335550953920205}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.008055818267166615, "weights_seq_no": 29.0, "vf_loss": 0.005738179665058851, "gradients_default_optimizer_global_norm": 0.2679133117198944, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1756800, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.005738179665058851, "vf_explained_var": 0.0399245023727417, "entropy": 0.7708494067192078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.013248879462480545, "policy_loss": -0.02019543945789337}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0794784612913386, "add_time_dim_to_batch_and_zero_pad": 3.1888301099335254e-05, "add_states_from_episodes_to_batch": 1.0894521838708358e-05, "general_advantage_estimation": 0.12322340243891927, "batch_individual_items": 0.04036070646951632, "add_observations_from_episodes_to_batch": 0.00033128201316140845, "add_one_ts_to_episodes_and_truncate": 0.007616032244120016, "numpy_to_tensor": 0.0011960398758951178}}, "connector_pipeline_timer": 0.25286170292811583}, "num_env_steps_trained_lifetime": 27684800, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1756800, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0367429233138, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.335550953920205, "done": false, "training_iteration": 29, "trial_id": "8cacd_00000", "date": "2025-05-12_02-35-33", "timestamp": 1746981333, "time_this_iter_s": 33.62235713005066, "time_total_s": 1002.0901806354523, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1002.0901806354523, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 76.97916666666667, "ram_util_percent": 49.520833333333336}}
{"timers": {"training_iteration": 37.33730975711489, "restore_env_runners": 3.3418664266050725e-05, "training_step": 37.33685795406409, "env_runner_sampling_timer": 28.114106181387655, "learner_update_timer": 9.214953701179184, "synch_weights": 0.006839607319966651, "synch_env_connectors": 0.008642734895173997}, "env_runners": {"episode_return_mean": 0.6986111111111112, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001170291241286534, "get_actions": 0.000634961107768479, "un_batch_to_individual_items": 6.126339549720566e-05, "listify_data_for_vector_env": 0.00011927311434123008, "tensor_to_numpy": 0.00020595913722425783, "remove_single_ts_time_rank_from_batch": 6.991211185866419e-06}}, "connector_pipeline_timer": 0.0014220137047976523}, "episode_return_max": 1.0511111111111116, "num_episodes_lifetime": 272, "episode_duration_sec_mean": 19.01796989250044, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001446075139871074, "add_time_dim_to_batch_and_zero_pad": 3.30469100429178e-05, "add_states_from_episodes_to_batch": 1.6380505563256944e-05, "batch_individual_items": 8.570937000995692e-05, "add_observations_from_episodes_to_batch": 3.5852795464131354e-05}}, "connector_pipeline_timer": 0.000535760254677052}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 60000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 60000}, "sample": 27.898128829684367, "num_env_steps_sampled_lifetime": 60000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4474444444444446, "agent_episode_returns_mean": {"default_agent": 0.6986111111111112}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6986111111111112}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.49943116261085, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005044709110440096, "weights_seq_no": 29.0, "env_to_module_sum_episodes_length_in": 92.49943116261085, "env_step_timer": 0.09818167344042893, "time_between_sampling": 9.912876526069823, "num_env_steps_sampled_lifetime_throughput": 59.99124061296961}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.00642308359965682, "weights_seq_no": 30.0, "vf_loss": 0.00845228973776102, "gradients_default_optimizer_global_norm": 0.5581763386726379, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1817344, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.00845228973776102, "vf_explained_var": 0.02531188726425171, "entropy": 0.7610323429107666, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.16039901971817017, "policy_loss": -0.16981476545333862}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07947118651164076, "add_time_dim_to_batch_and_zero_pad": 3.1883894150689206e-05, "add_states_from_episodes_to_batch": 1.0894300913221386e-05, "general_advantage_estimation": 0.12296580559960618, "batch_individual_items": 0.040396088891939685, "add_observations_from_episodes_to_batch": 0.0003313484511296261, "add_one_ts_to_episodes_and_truncate": 0.007611760972622583, "numpy_to_tensor": 0.0011958899991136177}}, "connector_pipeline_timer": 0.2526272435256017}, "num_env_steps_trained_lifetime": 28638368, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1817344, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.03917672253, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 60000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.99124061296961, "done": false, "training_iteration": 30, "trial_id": "8cacd_00000", "date": "2025-05-12_02-36-06", "timestamp": 1746981366, "time_this_iter_s": 33.28425908088684, "time_total_s": 1035.374439716339, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1035.374439716339, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 77.76382978723404, "ram_util_percent": 49.51914893617022}}
{"timers": {"training_iteration": 37.29146087896373, "restore_env_runners": 3.329147761706956e-05, "training_step": 37.29100864194344, "env_runner_sampling_timer": 28.080923764303783, "learner_update_timer": 9.202299176857395, "synch_weights": 0.006826373246756634, "synch_env_connectors": 0.008639698546229651}, "env_runners": {"episode_return_mean": 0.6421164529914533, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011563328584827977, "get_actions": 0.0006322911016806912, "un_batch_to_individual_items": 6.102147318509698e-05, "listify_data_for_vector_env": 0.00011854100456843005, "tensor_to_numpy": 0.00020463388813067297, "remove_single_ts_time_rank_from_batch": 6.998653630958517e-06}}, "connector_pipeline_timer": 0.0014147919881060678}, "episode_return_max": 0.9220000000000002, "num_episodes_lifetime": 280, "episode_duration_sec_mean": 19.076521628211786, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014432421544884093, "add_time_dim_to_batch_and_zero_pad": 3.30399334090379e-05, "add_states_from_episodes_to_batch": 1.6259012298488513e-05, "batch_individual_items": 8.552185361654356e-05, "add_observations_from_episodes_to_batch": 3.582131004815087e-05}}, "connector_pipeline_timer": 0.0005336781805831182}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 62000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 62000}, "sample": 27.877480317572537, "num_env_steps_sampled_lifetime": 62000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4014444444444444, "agent_episode_returns_mean": {"default_agent": 0.6421164529914533}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6421164529914533}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.24955833853917, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005015983023585726, "weights_seq_no": 30.0, "env_to_module_sum_episodes_length_in": 94.24955833853917, "env_step_timer": 0.09738179960125888, "time_between_sampling": 9.90165821111966, "num_env_steps_sampled_lifetime_throughput": 60.73665334824794}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.01123344898223877, "weights_seq_no": 31.0, "vf_loss": 0.007583744823932648, "gradients_default_optimizer_global_norm": 0.16110511124134064, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1877888, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007583744823932648, "vf_explained_var": 0.05182492733001709, "entropy": 0.8036956787109375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.029782650992274284, "policy_loss": -0.03905141353607178}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0794638362014078, "add_time_dim_to_batch_and_zero_pad": 3.187934651088958e-05, "add_states_from_episodes_to_batch": 1.089410495396312e-05, "general_advantage_estimation": 0.12270204114683544, "batch_individual_items": 0.04043079175526769, "add_observations_from_episodes_to_batch": 0.000331414122137218, "add_one_ts_to_episodes_and_truncate": 0.007607375033330766, "numpy_to_tensor": 0.0011957482158801728}}, "connector_pipeline_timer": 0.25238573693084504}, "num_env_steps_trained_lifetime": 29591936, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1877888, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.04155817147, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 62000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.73665334824794, "done": false, "training_iteration": 31, "trial_id": "8cacd_00000", "date": "2025-05-12_02-36-39", "timestamp": 1746981399, "time_this_iter_s": 32.76766538619995, "time_total_s": 1068.142105102539, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1068.142105102539, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 77.64255319148934, "ram_util_percent": 49.53829787234042}}
{"timers": {"training_iteration": 37.27161763251409, "restore_env_runners": 3.3161562840500027e-05, "training_step": 37.271165411864, "env_runner_sampling_timer": 28.076377052260742, "learner_update_timer": 9.187016717828824, "synch_weights": 0.006811678514299679, "synch_env_connectors": 0.008622122560771746}, "env_runners": {"episode_return_mean": 0.6374369658119664, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011424431019460858, "get_actions": 0.0006317723035903511, "un_batch_to_individual_items": 6.087799110058872e-05, "listify_data_for_vector_env": 0.00011818198317809846, "tensor_to_numpy": 0.00020397754281465744, "remove_single_ts_time_rank_from_batch": 6.958728905396072e-06}}, "connector_pipeline_timer": 0.0014122167879673955}, "episode_return_max": 0.9670000000000019, "num_episodes_lifetime": 296, "episode_duration_sec_mean": 19.277158295923126, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014385458719390145, "add_time_dim_to_batch_and_zero_pad": 3.2834141734257974e-05, "add_states_from_episodes_to_batch": 1.6283272875935392e-05, "batch_individual_items": 8.542692011129482e-05, "add_observations_from_episodes_to_batch": 3.5723183804227586e-05}}, "connector_pipeline_timer": 0.0005323008441808023}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 64000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 64000}, "sample": 27.8581058846622, "num_env_steps_sampled_lifetime": 64000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.3842222222222225, "agent_episode_returns_mean": {"default_agent": 0.6374369658119664}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.6374369658119664}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.78220194964169, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005016128917028211, "weights_seq_no": 31.0, "env_to_module_sum_episodes_length_in": 96.78220194964169, "env_step_timer": 0.09837849368263343, "time_between_sampling": 9.890250339428157, "num_env_steps_sampled_lifetime_throughput": 56.53249464290139}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.008931557647883892, "weights_seq_no": 32.0, "vf_loss": 0.014140956103801727, "gradients_default_optimizer_global_norm": 0.2805463671684265, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 1938688, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014140956103801727, "vf_explained_var": 0.027784526348114014, "entropy": 0.7763100266456604, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.053641729056835175, "policy_loss": -0.06912241876125336}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07945644560862833, "add_time_dim_to_batch_and_zero_pad": 3.187442143444582e-05, "add_states_from_episodes_to_batch": 1.0893863483714217e-05, "general_advantage_estimation": 0.12243214466256025, "batch_individual_items": 0.04046501011234, "add_observations_from_episodes_to_batch": 0.0003314904248795632, "add_one_ts_to_episodes_and_truncate": 0.007602947936727483, "numpy_to_tensor": 0.0011955964993114136}}, "connector_pipeline_timer": 0.25213751455343103}, "num_env_steps_trained_lifetime": 30553336, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 1938688, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0446880737586, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 64000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.53249464290139, "done": false, "training_iteration": 32, "trial_id": "8cacd_00000", "date": "2025-05-12_02-37-14", "timestamp": 1746981434, "time_this_iter_s": 35.322500467300415, "time_total_s": 1103.4646055698395, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1103.4646055698395, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 80.506, "ram_util_percent": 49.56}}
{"timers": {"training_iteration": 37.22743795818896, "restore_env_runners": 3.303994721042796e-05, "training_step": 37.226985797745364, "env_runner_sampling_timer": 28.049165032138138, "learner_update_timer": 9.170067524250536, "synch_weights": 0.006792851729144787, "synch_env_connectors": 0.00861989533516092}, "env_runners": {"episode_return_mean": 0.7341271367521381, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001132275141035466, "get_actions": 0.0006307359073360469, "un_batch_to_individual_items": 6.0567005607790814e-05, "listify_data_for_vector_env": 0.00011792375866965953, "tensor_to_numpy": 0.00020326986363795855, "remove_single_ts_time_rank_from_batch": 6.915784310722865e-06}}, "connector_pipeline_timer": 0.0014079245771961488}, "episode_return_max": 1.0497777777777806, "num_episodes_lifetime": 304, "episode_duration_sec_mean": 19.290559208394143, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014360781024040786, "add_time_dim_to_batch_and_zero_pad": 3.2890846115798145e-05, "add_states_from_episodes_to_batch": 1.6236872830188054e-05, "batch_individual_items": 8.56191429590813e-05, "add_observations_from_episodes_to_batch": 3.552547804478469e-05}}, "connector_pipeline_timer": 0.0005305530168138224}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 66000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 66000}, "sample": 27.838033104310163, "num_env_steps_sampled_lifetime": 66000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4073333333333332, "agent_episode_returns_mean": {"default_agent": 0.7341271367521381}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7341271367521381}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.7836601274671, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004996738609341415, "weights_seq_no": 32.0, "env_to_module_sum_episodes_length_in": 96.7836601274671, "env_step_timer": 0.09868970437493212, "time_between_sampling": 9.878497009240048, "num_env_steps_sampled_lifetime_throughput": 60.73567624464048}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.005926338955760002, "weights_seq_no": 33.0, "vf_loss": 0.015666088089346886, "gradients_default_optimizer_global_norm": 0.26161229610443115, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1999232, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015666088089346886, "vf_explained_var": 0.09077119827270508, "entropy": 0.7375133037567139, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06804010272026062, "policy_loss": -0.08459513634443283}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07944896464398443, "add_time_dim_to_batch_and_zero_pad": 3.186926692501132e-05, "add_states_from_episodes_to_batch": 1.0893627432489242e-05, "general_advantage_estimation": 0.12215629956385596, "batch_individual_items": 0.040498674683095356, "add_observations_from_episodes_to_batch": 0.00033156447015479667, "add_one_ts_to_episodes_and_truncate": 0.00759839181455288, "numpy_to_tensor": 0.0011954336022523483}}, "connector_pipeline_timer": 0.25188254043977226}, "num_env_steps_trained_lifetime": 31506904, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 1999232, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0477512221844, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 66000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.73567624464048, "done": false, "training_iteration": 33, "trial_id": "8cacd_00000", "date": "2025-05-12_02-37-47", "timestamp": 1746981467, "time_this_iter_s": 32.86862111091614, "time_total_s": 1136.3332266807556, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1136.3332266807556, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 78.52553191489362, "ram_util_percent": 49.55531914893616}}
{"timers": {"training_iteration": 37.18043652595707, "restore_env_runners": 3.2920547744271106e-05, "training_step": 37.17998433111791, "env_runner_sampling_timer": 28.01534998140675, "learner_update_timer": 9.156904391768036, "synch_weights": 0.006769354211840865, "synch_env_connectors": 0.008606921381823956}, "env_runners": {"episode_return_mean": 0.7411976495726511, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001120825870357382, "get_actions": 0.0006312818160123894, "un_batch_to_individual_items": 6.039868895820584e-05, "listify_data_for_vector_env": 0.00011755987500768133, "tensor_to_numpy": 0.00020326604316744798, "remove_single_ts_time_rank_from_batch": 7.045012261574666e-06}}, "connector_pipeline_timer": 0.0014067723603359103}, "episode_return_max": 1.0497777777777806, "num_episodes_lifetime": 312, "episode_duration_sec_mean": 19.14308110912477, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014282307014801542, "add_time_dim_to_batch_and_zero_pad": 3.369589444227699e-05, "add_states_from_episodes_to_batch": 1.613460782720029e-05, "batch_individual_items": 8.504462725964437e-05, "add_observations_from_episodes_to_batch": 3.526071481870166e-05}}, "connector_pipeline_timer": 0.0005290807305546075}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 68000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 68000}, "sample": 27.817072333326415, "num_env_steps_sampled_lifetime": 68000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4153333333333334, "agent_episode_returns_mean": {"default_agent": 0.7411976495726511}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7411976495726511}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.97919369905898, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004975240515081326, "weights_seq_no": 33.0, "env_to_module_sum_episodes_length_in": 94.97919369905898, "env_step_timer": 0.09852420036576884, "time_between_sampling": 9.86641902577428, "num_env_steps_sampled_lifetime_throughput": 61.35066087001591}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.07500000298023224, "mean_kl_loss": 0.0030012389179319143, "weights_seq_no": 34.0, "vf_loss": 0.007526651956140995, "gradients_default_optimizer_global_norm": 0.2447681576013565, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2059776, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007526651956140995, "vf_explained_var": 0.05917096138000488, "entropy": 0.7181581258773804, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.018396180123090744, "policy_loss": 0.010419346392154694}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07944106528397266, "add_time_dim_to_batch_and_zero_pad": 3.186378806353779e-05, "add_states_from_episodes_to_batch": 1.089339671587284e-05, "general_advantage_estimation": 0.12187463898265954, "batch_individual_items": 0.04053161371142433, "add_observations_from_episodes_to_batch": 0.00033164013548212223, "add_one_ts_to_episodes_and_truncate": 0.0075936929100281466, "numpy_to_tensor": 0.0011952505034845066}}, "connector_pipeline_timer": 0.2516204316168313}, "num_env_steps_trained_lifetime": 32460472, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2059776, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0507486388344, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 68000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 61.35066087001591, "done": false, "training_iteration": 34, "trial_id": "8cacd_00000", "date": "2025-05-12_02-38-20", "timestamp": 1746981500, "time_this_iter_s": 32.54423952102661, "time_total_s": 1168.8774662017822, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1168.8774662017822, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 78.95869565217392, "ram_util_percent": 49.5695652173913}}
{"timers": {"training_iteration": 37.138781381277504, "restore_env_runners": 3.280034227573673e-05, "training_step": 37.13832905238673, "env_runner_sampling_timer": 27.983338556982673, "learner_update_timer": 9.147276765040365, "synch_weights": 0.0067531086697171635, "synch_env_connectors": 0.008602600167998957}, "env_runners": {"episode_return_mean": 0.6774155982905987, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011182953188615729, "get_actions": 0.0006304999352312265, "un_batch_to_individual_items": 6.015665195801072e-05, "listify_data_for_vector_env": 0.00011725618455135722, "tensor_to_numpy": 0.00020261082094120451, "remove_single_ts_time_rank_from_batch": 7.0812201500922915e-06}}, "connector_pipeline_timer": 0.0014028060932839807}, "episode_return_max": 0.9116666666666693, "num_episodes_lifetime": 320, "episode_duration_sec_mean": 19.144958065942003, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014199067052209386, "add_time_dim_to_batch_and_zero_pad": 3.3516396807947234e-05, "add_states_from_episodes_to_batch": 1.6017875421019444e-05, "batch_individual_items": 8.478840857243716e-05, "add_observations_from_episodes_to_batch": 3.50963532969133e-05}}, "connector_pipeline_timer": 0.0005273669497010375}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 70000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 70000}, "sample": 27.795321215227894, "num_env_steps_sampled_lifetime": 70000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4153333333333334, "agent_episode_returns_mean": {"default_agent": 0.6774155982905987}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6774155982905987}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.13021025656352, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004959745350299877, "weights_seq_no": 34.0, "env_to_module_sum_episodes_length_in": 93.13021025656352, "env_step_timer": 0.09811995401894194, "time_between_sampling": 9.854066503751078, "num_env_steps_sampled_lifetime_throughput": 60.442990257447924}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.07500000298023224, "mean_kl_loss": 0.006470019463449717, "weights_seq_no": 35.0, "vf_loss": 0.007009669207036495, "gradients_default_optimizer_global_norm": 0.4791201949119568, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2120320, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007009669207036495, "vf_explained_var": 0.021725952625274658, "entropy": 0.6928032040596008, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.08490639925003052, "policy_loss": -0.09240130335092545}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07943304573469662, "add_time_dim_to_batch_and_zero_pad": 3.185805185261003e-05, "add_states_from_episodes_to_batch": 1.0893151250989473e-05, "general_advantage_estimation": 0.12158736462313074, "batch_individual_items": 0.04056412121171842, "add_observations_from_episodes_to_batch": 0.000331712391055991, "add_one_ts_to_episodes_and_truncate": 0.0075888517244123875, "numpy_to_tensor": 0.001195057833331843}}, "connector_pipeline_timer": 0.2513519863163052}, "num_env_steps_trained_lifetime": 33414040, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2120320, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0536813320293, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 70000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.442990257447924, "done": false, "training_iteration": 35, "trial_id": "8cacd_00000", "date": "2025-05-12_02-38-53", "timestamp": 1746981533, "time_this_iter_s": 33.0310218334198, "time_total_s": 1201.908488035202, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1201.908488035202, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 77.73829787234042, "ram_util_percent": 49.51914893617022}}
{"timers": {"training_iteration": 37.10331762405474, "restore_env_runners": 3.269533885935124e-05, "training_step": 37.10286502045287, "env_runner_sampling_timer": 27.956022993622838, "learner_update_timer": 9.139143031769967, "synch_weights": 0.006738678583014049, "synch_env_connectors": 0.008590907166330361}, "env_runners": {"episode_return_mean": 0.6037991452991451, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001113616289907929, "get_actions": 0.0006300194282648349, "un_batch_to_individual_items": 6.010487567218962e-05, "listify_data_for_vector_env": 0.00011727288706570065, "tensor_to_numpy": 0.0002024432545138543, "remove_single_ts_time_rank_from_batch": 7.078570674646549e-06}}, "connector_pipeline_timer": 0.0014013509605407808}, "episode_return_max": 0.8452222222222223, "num_episodes_lifetime": 328, "episode_duration_sec_mean": 19.314514680172717, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001419266498692087, "add_time_dim_to_batch_and_zero_pad": 3.337910360589021e-05, "add_states_from_episodes_to_batch": 1.5952372576216575e-05, "batch_individual_items": 8.490448581548396e-05, "add_observations_from_episodes_to_batch": 3.542450216982423e-05}}, "connector_pipeline_timer": 0.000527331730617869}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 72000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 72000}, "sample": 27.773314091641232, "num_env_steps_sampled_lifetime": 72000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.45111111111111146, "agent_episode_returns_mean": {"default_agent": 0.6037991452991451}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6037991452991451}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.39103991643049, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004957977888753368, "weights_seq_no": 35.0, "env_to_module_sum_episodes_length_in": 92.39103991643049, "env_step_timer": 0.09765707779524488, "time_between_sampling": 9.841841847786057, "num_env_steps_sampled_lifetime_throughput": 59.4146145530516}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.07500000298023224, "mean_kl_loss": 0.010469350963830948, "weights_seq_no": 36.0, "vf_loss": 0.007451487239450216, "gradients_default_optimizer_global_norm": 0.4559951722621918, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2180864, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007451487239450216, "vf_explained_var": 0.03280824422836304, "entropy": 0.7225608229637146, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07685020565986633, "policy_loss": -0.0850868970155716}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07942464246987777, "add_time_dim_to_batch_and_zero_pad": 3.185196398706941e-05, "add_states_from_episodes_to_batch": 1.0892921355740776e-05, "general_advantage_estimation": 0.12129456942689425, "batch_individual_items": 0.04059615326063548, "add_observations_from_episodes_to_batch": 0.00033178400750483823, "add_one_ts_to_episodes_and_truncate": 0.0075838815232179705, "numpy_to_tensor": 0.0011948577215318166}}, "connector_pipeline_timer": 0.25107700793862786}, "num_env_steps_trained_lifetime": 34367608, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2180864, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0565502964964, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 72000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.4146145530516, "done": false, "training_iteration": 36, "trial_id": "8cacd_00000", "date": "2025-05-12_02-39-27", "timestamp": 1746981567, "time_this_iter_s": 33.60761213302612, "time_total_s": 1235.5161001682281, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1235.5161001682281, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 77.89375, "ram_util_percent": 49.520833333333336}}
{"timers": {"training_iteration": 37.058184538214206, "restore_env_runners": 3.2645385469944684e-05, "training_step": 37.05773140064833, "env_runner_sampling_timer": 27.924139555056602, "learner_update_timer": 9.125904919482267, "synch_weights": 0.006725972797185346, "synch_env_connectors": 0.0085835580946688}, "env_runners": {"episode_return_mean": 0.7208835470085471, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011076438532971682, "get_actions": 0.0006281861296491421, "un_batch_to_individual_items": 5.974358567367561e-05, "listify_data_for_vector_env": 0.0001169815409936751, "tensor_to_numpy": 0.00020202200247877673, "remove_single_ts_time_rank_from_batch": 7.2303429866279715e-06}}, "connector_pipeline_timer": 0.0013973898750419794}, "episode_return_max": 0.9617777777777783, "num_episodes_lifetime": 336, "episode_duration_sec_mean": 19.257751825288445, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014220915485524928, "add_time_dim_to_batch_and_zero_pad": 3.405005615769486e-05, "add_states_from_episodes_to_batch": 1.592586775473859e-05, "batch_individual_items": 8.506656930176722e-05, "add_observations_from_episodes_to_batch": 3.532055482548162e-05}}, "connector_pipeline_timer": 0.0005271769315019918}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 74000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 74000}, "sample": 27.750666605249044, "num_env_steps_sampled_lifetime": 74000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.45111111111111146, "agent_episode_returns_mean": {"default_agent": 0.7208835470085471}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7208835470085471}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.42146948013593, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004942472254332736, "weights_seq_no": 36.0, "env_to_module_sum_episodes_length_in": 93.42146948013593, "env_step_timer": 0.09693759760851818, "time_between_sampling": 9.82974296895336, "num_env_steps_sampled_lifetime_throughput": 61.230382208028956}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.07500000298023224, "mean_kl_loss": 0.006532975006848574, "weights_seq_no": 37.0, "vf_loss": 0.009945619851350784, "gradients_default_optimizer_global_norm": 0.39186277985572815, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2241408, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009945619851350784, "vf_explained_var": 0.10020005702972412, "entropy": 0.6862508058547974, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.01875048130750656, "policy_loss": -0.02918606624007225}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07941598381578188, "add_time_dim_to_batch_and_zero_pad": 3.184536207360811e-05, "add_states_from_episodes_to_batch": 1.0892646743369373e-05, "general_advantage_estimation": 0.12099636642812016, "batch_individual_items": 0.04062769651645311, "add_observations_from_episodes_to_batch": 0.0003318549803857127, "add_one_ts_to_episodes_and_truncate": 0.007578786720875124, "numpy_to_tensor": 0.0011947105261845032}}, "connector_pipeline_timer": 0.2507957935498725}, "num_env_steps_trained_lifetime": 35321176, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2241408, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0593565135407, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 74000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 61.230382208028956, "done": false, "training_iteration": 37, "trial_id": "8cacd_00000", "date": "2025-05-12_02-39-59", "timestamp": 1746981599, "time_this_iter_s": 32.60544943809509, "time_total_s": 1268.1215496063232, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1268.1215496063232, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 79.16739130434784, "ram_util_percent": 49.5304347826087}}
{"timers": {"training_iteration": 37.023564271582075, "restore_env_runners": 3.2524931619499985e-05, "training_step": 37.02310938339185, "env_runner_sampling_timer": 27.894296517606023, "learner_update_timer": 9.121137649937449, "synch_weights": 0.006712157069218166, "synch_env_connectors": 0.00857448251371476}, "env_runners": {"episode_return_mean": 0.7804775641025644, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001104654813401115, "get_actions": 0.0006257328140755154, "un_batch_to_individual_items": 5.9362620354141976e-05, "listify_data_for_vector_env": 0.00011677669559074553, "tensor_to_numpy": 0.0002008814805787986, "remove_single_ts_time_rank_from_batch": 7.205781365906453e-06}}, "connector_pipeline_timer": 0.0013919254153714662}, "episode_return_max": 1.067555555555557, "num_episodes_lifetime": 344, "episode_duration_sec_mean": 19.141768594759785, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014159183478019762, "add_time_dim_to_batch_and_zero_pad": 3.417058842667619e-05, "add_states_from_episodes_to_batch": 1.593556540113463e-05, "batch_individual_items": 8.457153953749541e-05, "add_observations_from_episodes_to_batch": 3.529862361577848e-05}}, "connector_pipeline_timer": 0.0005260731314572001}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 76000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 76000}, "sample": 27.727464580821927, "num_env_steps_sampled_lifetime": 76000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5097777777777781, "agent_episode_returns_mean": {"default_agent": 0.7804775641025644}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7804775641025644}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.5574817301312, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004934379028188784, "weights_seq_no": 37.0, "env_to_module_sum_episodes_length_in": 96.5574817301312, "env_step_timer": 0.09616300397056812, "time_between_sampling": 9.817426085080989, "num_env_steps_sampled_lifetime_throughput": 59.38150673555881}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.07500000298023224, "mean_kl_loss": 0.007738250773400068, "weights_seq_no": 38.0, "vf_loss": 0.010613035410642624, "gradients_default_optimizer_global_norm": 0.23595230281352997, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2301952, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010613035410642624, "vf_explained_var": 0.05590498447418213, "entropy": 0.6483830809593201, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.11724879592657089, "policy_loss": 0.10605539381504059}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07940717018042097, "add_time_dim_to_batch_and_zero_pad": 3.1838437002068425e-05, "add_states_from_episodes_to_batch": 1.0892328331207244e-05, "general_advantage_estimation": 0.12069289429237876, "batch_individual_items": 0.04067219295172835, "add_observations_from_episodes_to_batch": 0.00033193875540825867, "add_one_ts_to_episodes_and_truncate": 0.007573808056426842, "numpy_to_tensor": 0.0011945454589718802}}, "connector_pipeline_timer": 0.2505222088678984}, "num_env_steps_trained_lifetime": 36274744, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2301952, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0621009512145, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 76000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.38150673555881, "done": false, "training_iteration": 38, "trial_id": "8cacd_00000", "date": "2025-05-12_02-40-33", "timestamp": 1746981633, "time_this_iter_s": 33.61063599586487, "time_total_s": 1301.732185602188, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1301.732185602188, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 76.22500000000001, "ram_util_percent": 49.52708333333334}}
{"timers": {"training_iteration": 36.99816363904625, "restore_env_runners": 3.240868229402342e-05, "training_step": 36.99770876873793, "env_runner_sampling_timer": 27.888075563709965, "learner_update_timer": 9.101961186338073, "synch_weights": 0.006708896498524708, "synch_env_connectors": 0.008557422688565065}, "env_runners": {"episode_return_mean": 0.7202179487179502, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010977858022761708, "get_actions": 0.0006231020286024501, "un_batch_to_individual_items": 5.9225959822154674e-05, "listify_data_for_vector_env": 0.00011640144181978264, "tensor_to_numpy": 0.00020035270194388482, "remove_single_ts_time_rank_from_batch": 7.146528362501744e-06}}, "connector_pipeline_timer": 0.0013861226022844203}, "episode_return_max": 1.0947777777777803, "num_episodes_lifetime": 360, "episode_duration_sec_mean": 19.126345924913338, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001421404210156113, "add_time_dim_to_batch_and_zero_pad": 3.396729901790538e-05, "add_states_from_episodes_to_batch": 1.5894761114161937e-05, "batch_individual_items": 8.41364051501235e-05, "add_observations_from_episodes_to_batch": 3.515192334199979e-05}}, "connector_pipeline_timer": 0.0005254696224668172}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 78000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 78000}, "sample": 27.705594989307073, "num_env_steps_sampled_lifetime": 78000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.3728888888888891, "agent_episode_returns_mean": {"default_agent": 0.7202179487179502}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.7202179487179502}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.50600678223321, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004913605481549239, "weights_seq_no": 38.0, "env_to_module_sum_episodes_length_in": 97.50600678223321, "env_step_timer": 0.09673692751619786, "time_between_sampling": 9.805680919597927, "num_env_steps_sampled_lifetime_throughput": 57.86428755959495}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.07500000298023224, "mean_kl_loss": 0.009263777174055576, "weights_seq_no": 39.0, "vf_loss": 0.016726426780223846, "gradients_default_optimizer_global_norm": 0.3940674066543579, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 2362752, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.016726426780223846, "vf_explained_var": 0.05851858854293823, "entropy": 0.5968430042266846, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03239297866821289, "policy_loss": -0.04981419816613197}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0793980399193857, "add_time_dim_to_batch_and_zero_pad": 3.1831085895875164e-05, "add_states_from_episodes_to_batch": 1.0891917022512612e-05, "general_advantage_estimation": 0.12038427993270945, "batch_individual_items": 0.04071568287864643, "add_observations_from_episodes_to_batch": 0.0003320343294323588, "add_one_ts_to_episodes_and_truncate": 0.007568785406595459, "numpy_to_tensor": 0.0011943737720508704}}, "connector_pipeline_timer": 0.25024210447020867}, "num_env_steps_trained_lifetime": 37236144, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 2362752, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0655845644835, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 78000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.86428755959495, "done": false, "training_iteration": 39, "trial_id": "8cacd_00000", "date": "2025-05-12_02-41-08", "timestamp": 1746981668, "time_this_iter_s": 34.49872398376465, "time_total_s": 1336.2309095859528, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1336.2309095859528, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 81.00408163265305, "ram_util_percent": 49.53877551020408}}
{"timers": {"training_iteration": 36.955339754845795, "restore_env_runners": 3.237559548592358e-05, "training_step": 36.954883658240554, "env_runner_sampling_timer": 27.858431282992864, "learner_update_timer": 9.088768058744702, "synch_weights": 0.0067225175335232715, "synch_env_connectors": 0.008554482461670645}, "env_runners": {"episode_return_mean": 0.692993589743591, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010930450443836639, "get_actions": 0.0006227643260034658, "un_batch_to_individual_items": 5.9073279134130166e-05, "listify_data_for_vector_env": 0.00011641327812394911, "tensor_to_numpy": 0.0002001564037116112, "remove_single_ts_time_rank_from_batch": 7.10268986128788e-06}}, "connector_pipeline_timer": 0.001384372561690987}, "episode_return_max": 0.9974444444444468, "num_episodes_lifetime": 368, "episode_duration_sec_mean": 19.167315558644393, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014189921713044895, "add_time_dim_to_batch_and_zero_pad": 3.381533637479931e-05, "add_states_from_episodes_to_batch": 1.586657171466048e-05, "batch_individual_items": 8.390675727970114e-05, "add_observations_from_episodes_to_batch": 3.552394011711086e-05}}, "connector_pipeline_timer": 0.0005243612708219124}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 80000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 80000}, "sample": 27.683108427015135, "num_env_steps_sampled_lifetime": 80000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.40688888888888897, "agent_episode_returns_mean": {"default_agent": 0.692993589743591}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.692993589743591}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.07493121357064, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004895345809575412, "weights_seq_no": 39.0, "env_to_module_sum_episodes_length_in": 96.07493121357064, "env_step_timer": 0.09679042334333189, "time_between_sampling": 9.79332261681257, "num_env_steps_sampled_lifetime_throughput": 61.00691277689878}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.03750000149011612, "mean_kl_loss": 0.003205052111297846, "weights_seq_no": 40.0, "vf_loss": 0.00895084161311388, "gradients_default_optimizer_global_norm": 0.2715238034725189, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2423296, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.00895084161311388, "vf_explained_var": 0.08845043182373047, "entropy": 0.5636395812034607, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0025925792288035154, "policy_loss": -0.006598650943487883}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07938878159655316, "add_time_dim_to_batch_and_zero_pad": 3.1823427968156644e-05, "add_states_from_episodes_to_batch": 1.0891444707103883e-05, "general_advantage_estimation": 0.12007071095080431, "batch_individual_items": 0.04075825713773101, "add_observations_from_episodes_to_batch": 0.00033212699810042303, "add_one_ts_to_episodes_and_truncate": 0.007563633988955129, "numpy_to_tensor": 0.0011942220743222983}}, "connector_pipeline_timer": 0.24995587900958613}, "num_env_steps_trained_lifetime": 38189712, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2423296, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.068992295392, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 80000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 61.00691277689878, "done": false, "training_iteration": 40, "trial_id": "8cacd_00000", "date": "2025-05-12_02-41-40", "timestamp": 1746981700, "time_this_iter_s": 32.730467081069946, "time_total_s": 1368.9613766670227, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1368.9613766670227, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 77.70851063829788, "ram_util_percent": 49.52340425531915}}
{"timers": {"training_iteration": 36.91234774297733, "restore_env_runners": 3.225883952474369e-05, "training_step": 36.91189181333816, "env_runner_sampling_timer": 27.82629873848294, "learner_update_timer": 9.07792017651725, "synch_weights": 0.006710206358199233, "synch_env_connectors": 0.008544657637058304}, "env_runners": {"episode_return_mean": 0.7158418803418815, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010879318059475959, "get_actions": 0.0006209070970430903, "un_batch_to_individual_items": 5.918543910502836e-05, "listify_data_for_vector_env": 0.00011607566441799086, "tensor_to_numpy": 0.00019945739797070272, "remove_single_ts_time_rank_from_batch": 7.035041337303248e-06}}, "connector_pipeline_timer": 0.0013807236440488838}, "episode_return_max": 0.9630000000000022, "num_episodes_lifetime": 376, "episode_duration_sec_mean": 18.945125803057635, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014199998968019448, "add_time_dim_to_batch_and_zero_pad": 3.353463069047851e-05, "add_states_from_episodes_to_batch": 1.5799749199641574e-05, "batch_individual_items": 8.343332768577236e-05, "add_observations_from_episodes_to_batch": 3.547595257228619e-05}}, "connector_pipeline_timer": 0.0005226008612935318}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 82000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 82000}, "sample": 27.659984834026982, "num_env_steps_sampled_lifetime": 82000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.533222222222222, "agent_episode_returns_mean": {"default_agent": 0.7158418803418815}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7158418803418815}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.04901843575085, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004895276635042723, "weights_seq_no": 40.0, "env_to_module_sum_episodes_length_in": 94.04901843575085, "env_step_timer": 0.09659835588747412, "time_between_sampling": 9.780988323880733, "num_env_steps_sampled_lifetime_throughput": 60.897558639978094}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.01875000074505806, "mean_kl_loss": 0.004660537000745535, "weights_seq_no": 41.0, "vf_loss": 0.008796222507953644, "gradients_default_optimizer_global_norm": 0.6241308450698853, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2483840, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008796222507953644, "vf_explained_var": 0.027317941188812256, "entropy": 0.6111645698547363, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.023354502394795418, "policy_loss": -0.03232550621032715}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07937921301618535, "add_time_dim_to_batch_and_zero_pad": 3.1815510090394775e-05, "add_states_from_episodes_to_batch": 1.0890942646292741e-05, "general_advantage_estimation": 0.11975228102054405, "batch_individual_items": 0.040799913653345996, "add_observations_from_episodes_to_batch": 0.0003322180799621994, "add_one_ts_to_episodes_and_truncate": 0.007558348461126928, "numpy_to_tensor": 0.0011940512231710916}}, "connector_pipeline_timer": 0.24966339538772908}, "num_env_steps_trained_lifetime": 39143280, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2483840, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.072325313226, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 82000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.897558639978094, "done": false, "training_iteration": 41, "trial_id": "8cacd_00000", "date": "2025-05-12_02-42-13", "timestamp": 1746981733, "time_this_iter_s": 32.67178726196289, "time_total_s": 1401.6331639289856, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1401.6331639289856, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 77.44042553191488, "ram_util_percent": 49.51914893617022}}
{"timers": {"training_iteration": 36.861560471137544, "restore_env_runners": 3.257925113253399e-05, "training_step": 36.86110332379477, "env_runner_sampling_timer": 27.792561623528115, "learner_update_timer": 9.060883289912073, "synch_weights": 0.006694613294621684, "synch_env_connectors": 0.008537828060686934}, "env_runners": {"episode_return_mean": 0.7605299145299149, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010862159710193565, "get_actions": 0.0006190361049536377, "un_batch_to_individual_items": 5.906243936291734e-05, "listify_data_for_vector_env": 0.00011557494069986775, "tensor_to_numpy": 0.0001992250748596974, "remove_single_ts_time_rank_from_batch": 7.007586147965471e-06}}, "connector_pipeline_timer": 0.0013780646948332535}, "episode_return_max": 1.097555555555556, "num_episodes_lifetime": 384, "episode_duration_sec_mean": 18.876442943932314, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001416174833500556, "add_time_dim_to_batch_and_zero_pad": 3.3296571660461076e-05, "add_states_from_episodes_to_batch": 1.5819569799688473e-05, "batch_individual_items": 8.280469156443506e-05, "add_observations_from_episodes_to_batch": 3.5258804028865066e-05}}, "connector_pipeline_timer": 0.0005207824762709832}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 84000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 84000}, "sample": 27.6360993155466, "num_env_steps_sampled_lifetime": 84000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5534444444444446, "agent_episode_returns_mean": {"default_agent": 0.7605299145299149}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7605299145299149}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.79468189226147, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004884287832125914, "weights_seq_no": 41.0, "env_to_module_sum_episodes_length_in": 92.79468189226147, "env_step_timer": 0.09610462601814185, "time_between_sampling": 9.768642335361768, "num_env_steps_sampled_lifetime_throughput": 62.68988735731364}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.01875000074505806, "mean_kl_loss": 0.007192273158580065, "weights_seq_no": 42.0, "vf_loss": 0.007011910900473595, "gradients_default_optimizer_global_norm": 0.25641950964927673, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2544384, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007011910900473595, "vf_explained_var": 0.07258236408233643, "entropy": 0.5385372638702393, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06032392755150795, "policy_loss": -0.06747069954872131}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07936947713926525, "add_time_dim_to_batch_and_zero_pad": 3.180718822733242e-05, "add_states_from_episodes_to_batch": 1.0890361482201849e-05, "general_advantage_estimation": 0.11942915747779392, "batch_individual_items": 0.04084065161293502, "add_observations_from_episodes_to_batch": 0.000332312037486922, "add_one_ts_to_episodes_and_truncate": 0.007553089060456352, "numpy_to_tensor": 0.0011938620968354927}}, "connector_pipeline_timer": 0.24936513318040812}, "num_env_steps_trained_lifetime": 40096848, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2544384, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0755847714736, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 84000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 62.68988735731364, "done": false, "training_iteration": 42, "trial_id": "8cacd_00000", "date": "2025-05-12_02-42-45", "timestamp": 1746981765, "time_this_iter_s": 31.84902548789978, "time_total_s": 1433.4821894168854, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1433.4821894168854, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 79.52222222222223, "ram_util_percent": 49.57333333333333}}
{"timers": {"training_iteration": 36.821950681686175, "restore_env_runners": 3.2462458630116986e-05, "training_step": 36.82149313381682, "env_runner_sampling_timer": 27.762421702602825, "learner_update_timer": 9.051426578962952, "synch_weights": 0.0066812681616750845, "synch_env_connectors": 0.008527151780081772}, "env_runners": {"episode_return_mean": 0.678, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010853085220974156, "get_actions": 0.0006191527860164931, "un_batch_to_individual_items": 5.996546018321391e-05, "listify_data_for_vector_env": 0.00011535919993984019, "tensor_to_numpy": 0.00019884315515875084, "remove_single_ts_time_rank_from_batch": 6.970056693507212e-06}}, "connector_pipeline_timer": 0.0013794776518919485}, "episode_return_max": 1.097555555555556, "num_episodes_lifetime": 392, "episode_duration_sec_mean": 18.93122398646168, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014142677706675033, "add_time_dim_to_batch_and_zero_pad": 3.297620214526638e-05, "add_states_from_episodes_to_batch": 1.617947510107465e-05, "batch_individual_items": 8.235484248357381e-05, "add_observations_from_episodes_to_batch": 3.546246079463694e-05}}, "connector_pipeline_timer": 0.0005195894657023621}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 86000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 86000}, "sample": 27.611835854356602, "num_env_steps_sampled_lifetime": 86000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4537777777777777, "agent_episode_returns_mean": {"default_agent": 0.678}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.678}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.12388493351914, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0004866419474190336, "weights_seq_no": 42.0, "env_to_module_sum_episodes_length_in": 93.12388493351914, "env_step_timer": 0.09560345236885846, "time_between_sampling": 9.755859617098523, "num_env_steps_sampled_lifetime_throughput": 60.65348331129498}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.00937500037252903, "mean_kl_loss": 0.004676519427448511, "weights_seq_no": 43.0, "vf_loss": 0.008868127129971981, "gradients_default_optimizer_global_norm": 0.4110201597213745, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2604928, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008868127129971981, "vf_explained_var": 0.08202964067459106, "entropy": 0.49087193608283997, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.02832977846264839, "policy_loss": -0.037285588681697845}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07935983699848186, "add_time_dim_to_batch_and_zero_pad": 3.1802081250484935e-05, "add_states_from_episodes_to_batch": 1.0889832847183273e-05, "general_advantage_estimation": 0.11910144156779684, "batch_individual_items": 0.04088051515196702, "add_observations_from_episodes_to_batch": 0.00033240218405312385, "add_one_ts_to_episodes_and_truncate": 0.007547724312953234, "numpy_to_tensor": 0.001193652917904228}}, "connector_pipeline_timer": 0.2490613642775947}, "num_env_steps_trained_lifetime": 41050416, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2604928, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.078771808025, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 86000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 60.65348331129498, "done": false, "training_iteration": 43, "trial_id": "8cacd_00000", "date": "2025-05-12_02-43-18", "timestamp": 1746981798, "time_this_iter_s": 32.91803240776062, "time_total_s": 1466.400221824646, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1466.400221824646, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 77.67234042553193, "ram_util_percent": 49.60425531914892}}
{"timers": {"training_iteration": 36.938710034139305, "restore_env_runners": 3.234083404341698e-05, "training_step": 36.93825176174866, "env_runner_sampling_timer": 27.80845243670679, "learner_update_timer": 9.122130765313324, "synch_weights": 0.0067033284800625745, "synch_env_connectors": 0.008519613262279216}, "env_runners": {"episode_return_mean": 0.6946816239316242, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011125853653750443, "get_actions": 0.0006453170240407421, "un_batch_to_individual_items": 6.190236205567304e-05, "listify_data_for_vector_env": 0.00012037844840870961, "tensor_to_numpy": 0.00020573940245946203, "remove_single_ts_time_rank_from_batch": 8.583345962142302e-06}}, "connector_pipeline_timer": 0.0014419977786701795}, "episode_return_max": 1.0022222222222232, "num_episodes_lifetime": 400, "episode_duration_sec_mean": 18.916351131952087, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014856930775249122, "add_time_dim_to_batch_and_zero_pad": 3.395717960655644e-05, "add_states_from_episodes_to_batch": 1.682550486213771e-05, "batch_individual_items": 8.675008017881265e-05, "add_observations_from_episodes_to_batch": 3.786909406657294e-05}}, "connector_pipeline_timer": 0.0005434243303866569}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 88000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 88000}, "sample": 27.591818915393, "num_env_steps_sampled_lifetime": 88000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4537777777777777, "agent_episode_returns_mean": {"default_agent": 0.6946816239316242}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6946816239316242}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.47042449570965, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000513538375973707, "weights_seq_no": 43.0, "env_to_module_sum_episodes_length_in": 95.47042449570965, "env_step_timer": 0.09887754651107018, "time_between_sampling": 9.74321224972745, "num_env_steps_sampled_lifetime_throughput": 41.17493074403922}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.004687500186264515, "mean_kl_loss": 0.00469172652810812, "weights_seq_no": 44.0, "vf_loss": 0.015290250070393085, "gradients_default_optimizer_global_norm": 0.600769579410553, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2665472, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015290250070393085, "vf_explained_var": 0.07588481903076172, "entropy": 0.5467977523803711, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.008089672774076462, "policy_loss": -0.023423904553055763}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0793721931228002, "add_time_dim_to_batch_and_zero_pad": 3.179986569433546e-05, "add_states_from_episodes_to_batch": 1.0890455748780568e-05, "general_advantage_estimation": 0.11877509189025205, "batch_individual_items": 0.04093160770505714, "add_observations_from_episodes_to_batch": 0.00033296153648426223, "add_one_ts_to_episodes_and_truncate": 0.0075450160414942515, "numpy_to_tensor": 0.0011935293563420052}}, "connector_pipeline_timer": 0.24879542821951942}, "num_env_steps_trained_lifetime": 42003984, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2665472, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0818875453683, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 88000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 41.17493074403922, "done": false, "training_iteration": 44, "trial_id": "8cacd_00000", "date": "2025-05-12_02-44-21", "timestamp": 1746981861, "time_this_iter_s": 62.4053430557251, "time_total_s": 1528.805564880371, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1528.805564880371, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 69.44117647058823, "ram_util_percent": 49.595588235294116}}
{"timers": {"training_iteration": 37.0605747673779, "restore_env_runners": 3.242342570218513e-05, "training_step": 37.06011430371117, "env_runner_sampling_timer": 27.91600668444972, "learner_update_timer": 9.136377281130198, "synch_weights": 0.006761622195267148, "synch_env_connectors": 0.00856054312967018}, "env_runners": {"episode_return_mean": 0.8639487179487196, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001123013204396036, "get_actions": 0.0006626695959104567, "un_batch_to_individual_items": 6.399011201804035e-05, "listify_data_for_vector_env": 0.00012309691878211457, "tensor_to_numpy": 0.0002116297050701045, "remove_single_ts_time_rank_from_batch": 8.652713963975305e-06}}, "connector_pipeline_timer": 0.0014798704634307175}, "episode_return_max": 1.1770000000000023, "num_episodes_lifetime": 416, "episode_duration_sec_mean": 26.523402497307607, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001519778267125462, "add_time_dim_to_batch_and_zero_pad": 3.557924736031508e-05, "add_states_from_episodes_to_batch": 1.716423543230396e-05, "batch_individual_items": 8.765269046468919e-05, "add_observations_from_episodes_to_batch": 3.8874687959320954e-05}}, "connector_pipeline_timer": 0.0005563432448811095}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 90000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 90000}, "sample": 27.58098495157333, "num_env_steps_sampled_lifetime": 90000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5384444444444451, "agent_episode_returns_mean": {"default_agent": 0.8639487179487196}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8639487179487196}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.17550989470028, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005268947893011685, "weights_seq_no": 44.0, "env_to_module_sum_episodes_length_in": 97.17550989470028, "env_step_timer": 0.1022339489482865, "time_between_sampling": 9.73823898061552, "num_env_steps_sampled_lifetime_throughput": 40.58799408404986}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.004687500186264515, "mean_kl_loss": 0.007461331784725189, "weights_seq_no": 45.0, "vf_loss": 0.02083365060389042, "gradients_default_optimizer_global_norm": 0.33200186491012573, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 2726272, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.02083365060389042, "vf_explained_var": 0.001335442066192627, "entropy": 0.4586997926235199, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08654850721359253, "policy_loss": 0.0656798779964447}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07938505114063232, "add_time_dim_to_batch_and_zero_pad": 3.17975042412139e-05, "add_states_from_episodes_to_batch": 1.0891087208964035e-05, "general_advantage_estimation": 0.1184442740421014, "batch_individual_items": 0.04098267407537021, "add_observations_from_episodes_to_batch": 0.00033352897164839573, "add_one_ts_to_episodes_and_truncate": 0.007542403902933186, "numpy_to_tensor": 0.0011934267707193079}}, "connector_pipeline_timer": 0.24852562045557802}, "num_env_steps_trained_lifetime": 42965384, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 2726272, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0857330907838, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 90000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 40.58799408404986, "done": false, "training_iteration": 45, "trial_id": "8cacd_00000", "date": "2025-05-12_02-45-10", "timestamp": 1746981910, "time_this_iter_s": 49.146143436431885, "time_total_s": 1577.951708316803, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1577.951708316803, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 78.51428571428573, "ram_util_percent": 49.57142857142858}}
{"timers": {"training_iteration": 37.14926743196412, "restore_env_runners": 3.248819144224847e-05, "training_step": 37.14880495093405, "env_runner_sampling_timer": 28.00408414327523, "learner_update_timer": 9.136920367918899, "synch_weights": 0.006829902963310148, "synch_env_connectors": 0.008594765698379714}, "env_runners": {"episode_return_mean": 0.7803098290598307, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011597857940969035, "get_actions": 0.0006870542559346864, "un_batch_to_individual_items": 6.651178650250032e-05, "listify_data_for_vector_env": 0.0001276583402916752, "tensor_to_numpy": 0.00021817622239425884, "remove_single_ts_time_rank_from_batch": 9.26701984338394e-06}}, "connector_pipeline_timer": 0.0015253815963187358}, "episode_return_max": 1.2235555555555588, "num_episodes_lifetime": 424, "episode_duration_sec_mean": 26.08129624464417, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015400200931002593, "add_time_dim_to_batch_and_zero_pad": 3.6751640209471903e-05, "add_states_from_episodes_to_batch": 1.7217939649547127e-05, "batch_individual_items": 8.818748485028823e-05, "add_observations_from_episodes_to_batch": 3.9561326046425776e-05}}, "connector_pipeline_timer": 0.0005680847303333768}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 92000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 92000}, "sample": 27.576710140430006, "num_env_steps_sampled_lifetime": 92000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.48555555555555546, "agent_episode_returns_mean": {"default_agent": 0.7803098290598307}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7803098290598307}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.40464053454478, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005409224310426797, "weights_seq_no": 45.0, "env_to_module_sum_episodes_length_in": 96.40464053454478, "env_step_timer": 0.1054484773700477, "time_between_sampling": 9.735432335468033, "num_env_steps_sampled_lifetime_throughput": 43.45176726532906}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.0023437500931322575, "mean_kl_loss": 0.004554098006337881, "weights_seq_no": 46.0, "vf_loss": 0.018365487456321716, "gradients_default_optimizer_global_norm": 0.7524673938751221, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2786816, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.018365487456321716, "vf_explained_var": 0.06614309549331665, "entropy": 0.40195658802986145, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.04353944957256317, "policy_loss": -0.061926279217004776}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07940060439869562, "add_time_dim_to_batch_and_zero_pad": 3.1796000030590044e-05, "add_states_from_episodes_to_batch": 1.0891806994517154e-05, "general_advantage_estimation": 0.11810916059162468, "batch_individual_items": 0.041034108297406446, "add_observations_from_episodes_to_batch": 0.00033409546195547644, "add_one_ts_to_episodes_and_truncate": 0.007539699465539304, "numpy_to_tensor": 0.0011934304938733512}}, "connector_pipeline_timer": 0.24825460350379364}, "num_env_steps_trained_lifetime": 43918952, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2786816, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0894935365366, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 92000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.45176726532906, "done": false, "training_iteration": 46, "trial_id": "8cacd_00000", "date": "2025-05-12_02-45-56", "timestamp": 1746981956, "time_this_iter_s": 45.946611166000366, "time_total_s": 1623.8983194828033, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1623.8983194828033, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 79.06461538461538, "ram_util_percent": 49.54923076923077}}
{"timers": {"training_iteration": 37.11266303432448, "restore_env_runners": 3.2419309530817626e-05, "training_step": 37.112200127104714, "env_runner_sampling_timer": 27.987289816762484, "learner_update_timer": 9.117117513999723, "synch_weights": 0.0068216259336748904, "synch_env_connectors": 0.008590857041403999}, "env_runners": {"episode_return_mean": 0.7179989316239327, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011523839271552168, "get_actions": 0.0006855443283973792, "un_batch_to_individual_items": 6.620480639596395e-05, "listify_data_for_vector_env": 0.00012774081222306086, "tensor_to_numpy": 0.00021789155913349203, "remove_single_ts_time_rank_from_batch": 9.377583727407853e-06}}, "connector_pipeline_timer": 0.0015225212616270993}, "episode_return_max": 1.2235555555555588, "num_episodes_lifetime": 432, "episode_duration_sec_mean": 23.73015477325045, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015333703128828167, "add_time_dim_to_batch_and_zero_pad": 3.645229951826336e-05, "add_states_from_episodes_to_batch": 1.7354379565174068e-05, "batch_individual_items": 8.777413092158392e-05, "add_observations_from_episodes_to_batch": 3.9628792174667274e-05}}, "connector_pipeline_timer": 0.0005660092763005128}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 94000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 94000}, "sample": 27.57142724376842, "num_env_steps_sampled_lifetime": 94000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.48555555555555546, "agent_episode_returns_mean": {"default_agent": 0.7179989316239327}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7179989316239327}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.42398855920602, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005397117852987515, "weights_seq_no": 46.0, "env_to_module_sum_episodes_length_in": 94.42398855920602, "env_step_timer": 0.1053227299393675, "time_between_sampling": 9.733964332854114, "num_env_steps_sampled_lifetime_throughput": 59.57078149634025}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.003515625139698386, "mean_kl_loss": 0.05972446873784065, "weights_seq_no": 47.0, "vf_loss": 0.007375873159617186, "gradients_default_optimizer_global_norm": 0.22353589534759521, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2847360, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007375873159617186, "vf_explained_var": -0.03191065788269043, "entropy": 0.6220418810844421, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.11640464514493942, "policy_loss": -0.1239205002784729}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07941525858658366, "add_time_dim_to_batch_and_zero_pad": 3.1793836153615245e-05, "add_states_from_episodes_to_batch": 1.0892453275659589e-05, "general_advantage_estimation": 0.11776982643275329, "batch_individual_items": 0.04108443287759444, "add_observations_from_episodes_to_batch": 0.0003346494695594195, "add_one_ts_to_episodes_and_truncate": 0.0075369401965029725, "numpy_to_tensor": 0.0011934109599871707}}, "connector_pipeline_timer": 0.24797726080919946}, "num_env_steps_trained_lifetime": 44872520, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2847360, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0931702000653, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 94000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.57078149634025, "done": false, "training_iteration": 47, "trial_id": "8cacd_00000", "date": "2025-05-12_02-46-29", "timestamp": 1746981989, "time_this_iter_s": 33.50593638420105, "time_total_s": 1657.4042558670044, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1657.4042558670044, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 79.4875, "ram_util_percent": 49.57916666666667}}
{"timers": {"training_iteration": 37.08785821087122, "restore_env_runners": 3.238111643046727e-05, "training_step": 37.087387248723665, "env_runner_sampling_timer": 27.979683185044866, "learner_update_timer": 9.099875904309723, "synch_weights": 0.006837120664340288, "synch_env_connectors": 0.00860004448099896}, "env_runners": {"episode_return_mean": 0.736782051282052, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011590265594304739, "get_actions": 0.0006849300928952413, "un_batch_to_individual_items": 6.599144674008932e-05, "listify_data_for_vector_env": 0.00012788190581767598, "tensor_to_numpy": 0.0002183237113119798, "remove_single_ts_time_rank_from_batch": 9.191968763099606e-06}}, "connector_pipeline_timer": 0.0015235192128753958}, "episode_return_max": 1.084333333333336, "num_episodes_lifetime": 440, "episode_duration_sec_mean": 21.019616735759534, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015364783804862084, "add_time_dim_to_batch_and_zero_pad": 3.646767451859081e-05, "add_states_from_episodes_to_batch": 1.721957822933836e-05, "batch_individual_items": 8.81845229566108e-05, "add_observations_from_episodes_to_batch": 3.958029051677554e-05}}, "connector_pipeline_timer": 0.000566234132336872}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 96000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 96000}, "sample": 27.56581104270361, "num_env_steps_sampled_lifetime": 96000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4188888888888892, "agent_episode_returns_mean": {"default_agent": 0.736782051282052}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.736782051282052}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.80364322384696, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005386161378308834, "weights_seq_no": 47.0, "env_to_module_sum_episodes_length_in": 92.80364322384696, "env_step_timer": 0.10514225208390061, "time_between_sampling": 9.731103982032986, "num_env_steps_sampled_lifetime_throughput": 57.63020749640522}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.003515625139698386, "mean_kl_loss": 0.01050069835036993, "weights_seq_no": 48.0, "vf_loss": 0.009425707161426544, "gradients_default_optimizer_global_norm": 0.6332354545593262, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2907904, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009425707161426544, "vf_explained_var": 0.04440426826477051, "entropy": 0.6283966302871704, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.20386795699596405, "policy_loss": -0.21333059668540955}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0794290929702742, "add_time_dim_to_batch_and_zero_pad": 3.1792765954190065e-05, "add_states_from_episodes_to_batch": 1.0893057450547533e-05, "general_advantage_estimation": 0.11742640368100014, "batch_individual_items": 0.04113361910534903, "add_observations_from_episodes_to_batch": 0.00033519110746501164, "add_one_ts_to_episodes_and_truncate": 0.007533996692900748, "numpy_to_tensor": 0.001193370173729296}}, "connector_pipeline_timer": 0.24769364067814673}, "num_env_steps_trained_lifetime": 45826088, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2907904, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.0967643809697, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 96000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.63020749640522, "done": false, "training_iteration": 48, "trial_id": "8cacd_00000", "date": "2025-05-12_02-47-04", "timestamp": 1746982024, "time_this_iter_s": 34.64760398864746, "time_total_s": 1692.0518598556519, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1692.0518598556519, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 80.01020408163265, "ram_util_percent": 49.557142857142864}}
{"timers": {"training_iteration": 37.06601766652249, "restore_env_runners": 3.226630525688104e-05, "training_step": 37.06554675899642, "env_runner_sampling_timer": 27.976125374944427, "learner_update_timer": 9.08160566527663, "synch_weights": 0.0068253054576964305, "synch_env_connectors": 0.008590740026180974}, "env_runners": {"episode_return_mean": 0.7712275641025644, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011523577322849086, "get_actions": 0.0006820939448708496, "un_batch_to_individual_items": 6.545363341755183e-05, "listify_data_for_vector_env": 0.00012739808539280156, "tensor_to_numpy": 0.00021838022652995127, "remove_single_ts_time_rank_from_batch": 9.053925622393247e-06}}, "connector_pipeline_timer": 0.0015173029512411348}, "episode_return_max": 1.0696666666666674, "num_episodes_lifetime": 448, "episode_duration_sec_mean": 20.530079756018967, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015263733564213925, "add_time_dim_to_batch_and_zero_pad": 3.611430155677167e-05, "add_states_from_episodes_to_batch": 1.70321582195712e-05, "batch_individual_items": 8.813847203129555e-05, "add_observations_from_episodes_to_batch": 3.937458350638993e-05}}, "connector_pipeline_timer": 0.000563480140326078}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 98000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 98000}, "sample": 27.559766770340616, "num_env_steps_sampled_lifetime": 98000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4188888888888892, "agent_episode_returns_mean": {"default_agent": 0.7712275641025644}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7712275641025644}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.53040423113829, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000536242457104694, "weights_seq_no": 48.0, "env_to_module_sum_episodes_length_in": 92.53040423113829, "env_step_timer": 0.10440629804046533, "time_between_sampling": 9.727275777343714, "num_env_steps_sampled_lifetime_throughput": 57.17933483347592}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.003515625139698386, "mean_kl_loss": 0.005309827160090208, "weights_seq_no": 49.0, "vf_loss": 0.0066215237602591515, "gradients_default_optimizer_global_norm": 0.6444858908653259, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2968448, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0066215237602591515, "vf_explained_var": -0.03625130653381348, "entropy": 0.5483567118644714, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06147702410817146, "policy_loss": 0.05483683943748474}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07944497408033238, "add_time_dim_to_batch_and_zero_pad": 3.1792847775032796e-05, "add_states_from_episodes_to_batch": 1.0894370296568064e-05, "general_advantage_estimation": 0.1170789575216388, "batch_individual_items": 0.04118384053526088, "add_observations_from_episodes_to_batch": 0.0003357255276655742, "add_one_ts_to_episodes_and_truncate": 0.007530897525351072, "numpy_to_tensor": 0.0011934368221005686}}, "connector_pipeline_timer": 0.24740902644353407}, "num_env_steps_trained_lifetime": 46779656, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 2968448, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.100277361236, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 98000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.17933483347592, "done": false, "training_iteration": 49, "trial_id": "8cacd_00000", "date": "2025-05-12_02-47-39", "timestamp": 1746982059, "time_this_iter_s": 34.91946625709534, "time_total_s": 1726.9713261127472, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1726.9713261127472, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 78.48599999999999, "ram_util_percent": 49.59}}
{"timers": {"training_iteration": 37.03927000488725, "restore_env_runners": 3.21676422001087e-05, "training_step": 37.038798566436455, "env_runner_sampling_timer": 27.966641934954986, "learner_update_timer": 9.064361360893864, "synch_weights": 0.006805130403119271, "synch_env_connectors": 0.008582199625931765}, "env_runners": {"episode_return_mean": 0.760860042735043, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011551628284239848, "get_actions": 0.0006813000242599575, "un_batch_to_individual_items": 6.543390289226435e-05, "listify_data_for_vector_env": 0.00012679920370759265, "tensor_to_numpy": 0.00021717044137602978, "remove_single_ts_time_rank_from_batch": 8.921288367557804e-06}}, "connector_pipeline_timer": 0.0015131407945966151}, "episode_return_max": 1.0696666666666674, "num_episodes_lifetime": 456, "episode_duration_sec_mean": 20.541403387970725, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001527790452865858, "add_time_dim_to_batch_and_zero_pad": 3.573636316085852e-05, "add_states_from_episodes_to_batch": 1.69579740094198e-05, "batch_individual_items": 8.940125507442173e-05, "add_observations_from_episodes_to_batch": 3.992595695980135e-05}}, "connector_pipeline_timer": 0.0005643786527980137}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 100000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 100000}, "sample": 27.55316017050515, "num_env_steps_sampled_lifetime": 100000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4365555555555559, "agent_episode_returns_mean": {"default_agent": 0.760860042735043}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.760860042735043}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.15315396766522, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005323390148429881, "weights_seq_no": 49.0, "env_to_module_sum_episodes_length_in": 94.15315396766522, "env_step_timer": 0.10360664085224226, "time_between_sampling": 9.72290539516714, "num_env_steps_sampled_lifetime_throughput": 58.024006886496146}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.003515625139698386, "mean_kl_loss": 0.008197841234505177, "weights_seq_no": 50.0, "vf_loss": 0.011168481782078743, "gradients_default_optimizer_global_norm": 0.4564996361732483, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3028992, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011168481782078743, "vf_explained_var": 0.030300438404083252, "entropy": 0.5134356021881104, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03843998163938522, "policy_loss": -0.04963727295398712}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07946017451889245, "add_time_dim_to_batch_and_zero_pad": 3.179245868276204e-05, "add_states_from_episodes_to_batch": 1.0895637580067086e-05, "general_advantage_estimation": 0.1167276648750966, "batch_individual_items": 0.041232998754664, "add_observations_from_episodes_to_batch": 0.00033624777035152673, "add_one_ts_to_episodes_and_truncate": 0.0075276871414830665, "numpy_to_tensor": 0.0011935027404870106}}, "connector_pipeline_timer": 0.247118686629546}, "num_env_steps_trained_lifetime": 47733224, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3028992, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.103710405459, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 100000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.024006886496146, "done": false, "training_iteration": 50, "trial_id": "8cacd_00000", "date": "2025-05-12_02-48-14", "timestamp": 1746982094, "time_this_iter_s": 34.40665888786316, "time_total_s": 1761.3779850006104, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1761.3779850006104, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 79.23061224489797, "ram_util_percent": 49.57755102040816}}
{"timers": {"training_iteration": 37.033189215568385, "restore_env_runners": 3.2061965785747725e-05, "training_step": 37.032717889502095, "env_runner_sampling_timer": 27.972458745075446, "learner_update_timer": 9.052480270544919, "synch_weights": 0.0067875230990957795, "synch_env_connectors": 0.0085667876296618}, "env_runners": {"episode_return_mean": 0.7200683760683769, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011593451311766844, "get_actions": 0.0006787565016168743, "un_batch_to_individual_items": 6.488702451446582e-05, "listify_data_for_vector_env": 0.00012638730269896327, "tensor_to_numpy": 0.00021573715738006262, "remove_single_ts_time_rank_from_batch": 8.900355706672253e-06}}, "connector_pipeline_timer": 0.0015075452495807574}, "episode_return_max": 1.057555555555557, "num_episodes_lifetime": 472, "episode_duration_sec_mean": 20.267524907240404, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015187164963535472, "add_time_dim_to_batch_and_zero_pad": 3.5495031464665195e-05, "add_states_from_episodes_to_batch": 1.6858399992435218e-05, "batch_individual_items": 8.935762776990388e-05, "add_observations_from_episodes_to_batch": 3.946969678805918e-05}}, "connector_pipeline_timer": 0.0005611230282474456}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 102000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 102000}, "sample": 27.54741702427162, "num_env_steps_sampled_lifetime": 102000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5593333333333335, "agent_episode_returns_mean": {"default_agent": 0.7200683760683769}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.7200683760683769}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.86038707147999, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005301740686121788, "weights_seq_no": 50.0, "env_to_module_sum_episodes_length_in": 96.86038707147999, "env_step_timer": 0.1042497251468636, "time_between_sampling": 9.717914051743644, "num_env_steps_sampled_lifetime_throughput": 54.608092599708364}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.003515625139698386, "mean_kl_loss": 0.010234714485704899, "weights_seq_no": 51.0, "vf_loss": 0.008798693306744099, "gradients_default_optimizer_global_norm": 0.4261906147003174, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 3089792, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008798693306744099, "vf_explained_var": 0.006345033645629883, "entropy": 0.4707895815372467, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.10221678763628006, "policy_loss": -0.11105146259069443}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07947457303127331, "add_time_dim_to_batch_and_zero_pad": 3.1791778087479173e-05, "add_states_from_episodes_to_batch": 1.0896800080917353e-05, "general_advantage_estimation": 0.11637284839573309, "batch_individual_items": 0.04128123804562556, "add_observations_from_episodes_to_batch": 0.00033677240563113447, "add_one_ts_to_episodes_and_truncate": 0.007524426565539755, "numpy_to_tensor": 0.0011935584168235693}}, "connector_pipeline_timer": 0.24682303196919325}, "num_env_steps_trained_lifetime": 48694624, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 3089792, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1078647610611, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 102000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.608092599708364, "done": false, "training_iteration": 51, "trial_id": "8cacd_00000", "date": "2025-05-12_02-48-50", "timestamp": 1746982130, "time_this_iter_s": 36.4468412399292, "time_total_s": 1797.8248262405396, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1797.8248262405396, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 79.66538461538462, "ram_util_percent": 49.599999999999994}}
{"timers": {"training_iteration": 37.067523254872704, "restore_env_runners": 3.199934612792098e-05, "training_step": 37.06705122006708, "env_runner_sampling_timer": 28.00759177091468, "learner_update_timer": 9.05168131000948, "synch_weights": 0.006785973868101302, "synch_env_connectors": 0.008560761753365785}, "env_runners": {"episode_return_mean": 0.7485170940170954, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011661605074296828, "get_actions": 0.0006842253901155323, "un_batch_to_individual_items": 6.509209132265412e-05, "listify_data_for_vector_env": 0.0001276916948122747, "tensor_to_numpy": 0.00021771175718369887, "remove_single_ts_time_rank_from_batch": 8.7344580615986e-06}}, "connector_pipeline_timer": 0.0015203246121557044}, "episode_return_max": 1.0460000000000025, "num_episodes_lifetime": 480, "episode_duration_sec_mean": 21.958505077403533, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001542354464899689, "add_time_dim_to_batch_and_zero_pad": 3.5951776174732785e-05, "add_states_from_episodes_to_batch": 1.6785933368763988e-05, "batch_individual_items": 8.987005950252277e-05, "add_observations_from_episodes_to_batch": 3.958414553960785e-05}}, "connector_pipeline_timer": 0.0005656703668642227}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 104000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 104000}, "sample": 27.54411960524218, "num_env_steps_sampled_lifetime": 104000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5627777777777784, "agent_episode_returns_mean": {"default_agent": 0.7485170940170954}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7485170940170954}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.02983633040628, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000531920117308362, "weights_seq_no": 51.0, "env_to_module_sum_episodes_length_in": 97.02983633040628, "env_step_timer": 0.10594420342044804, "time_between_sampling": 9.712471229024512, "num_env_steps_sampled_lifetime_throughput": 49.331508547609545}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.003515625139698386, "mean_kl_loss": 0.010353991761803627, "weights_seq_no": 52.0, "vf_loss": 0.015113148838281631, "gradients_default_optimizer_global_norm": 0.31864628195762634, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3150336, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015113148838281631, "vf_explained_var": 0.043056607246398926, "entropy": 0.4627877175807953, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.003117636078968644, "policy_loss": -0.01203190814703703}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07948923645595457, "add_time_dim_to_batch_and_zero_pad": 3.1790761858318625e-05, "add_states_from_episodes_to_batch": 1.0897849768149245e-05, "general_advantage_estimation": 0.11601446298946924, "batch_individual_items": 0.04132884485089231, "add_observations_from_episodes_to_batch": 0.0003372888334281573, "add_one_ts_to_episodes_and_truncate": 0.0075210355624011765, "numpy_to_tensor": 0.0011936018793592509}}, "connector_pipeline_timer": 0.24652328415338456}, "num_env_steps_trained_lifetime": 49648192, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3150336, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.111925658511, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 104000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.331508547609545, "done": false, "training_iteration": 52, "trial_id": "8cacd_00000", "date": "2025-05-12_02-49-31", "timestamp": 1746982171, "time_this_iter_s": 40.48511743545532, "time_total_s": 1838.3099436759949, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1838.3099436759949, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 78.39122807017544, "ram_util_percent": 49.526315789473685}}
{"timers": {"training_iteration": 37.06189225910397, "restore_env_runners": 3.192435267682345e-05, "training_step": 37.06141970464641, "env_runner_sampling_timer": 28.01316306675553, "learner_update_timer": 9.04048172413937, "synch_weights": 0.006782660129414441, "synch_env_connectors": 0.008573791135823995}, "env_runners": {"episode_return_mean": 0.8556901709401724, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011651230210874022, "get_actions": 0.0006803530345544411, "un_batch_to_individual_items": 6.465495777611963e-05, "listify_data_for_vector_env": 0.00012684409904396046, "tensor_to_numpy": 0.0002163059850843639, "remove_single_ts_time_rank_from_batch": 8.722753537270964e-06}}, "connector_pipeline_timer": 0.0015131023513897195}, "episode_return_max": 1.1202222222222247, "num_episodes_lifetime": 488, "episode_duration_sec_mean": 22.361752713595934, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015511197113540783, "add_time_dim_to_batch_and_zero_pad": 3.5774976400497564e-05, "add_states_from_episodes_to_batch": 1.6905196678360814e-05, "batch_individual_items": 8.925273205344223e-05, "add_observations_from_episodes_to_batch": 3.9180218750155435e-05}}, "connector_pipeline_timer": 0.0005645151498858569}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 106000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 106000}, "sample": 27.540839297818273, "num_env_steps_sampled_lifetime": 106000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.563222222222223, "agent_episode_returns_mean": {"default_agent": 0.8556901709401724}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8556901709401724}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.2651245379085, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005304976783684464, "weights_seq_no": 52.0, "env_to_module_sum_episodes_length_in": 95.2651245379085, "env_step_timer": 0.10562860680016072, "time_between_sampling": 9.708092480165362, "num_env_steps_sampled_lifetime_throughput": 54.6619726354356}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.003515625139698386, "mean_kl_loss": 0.006940921768546104, "weights_seq_no": 53.0, "vf_loss": 0.010808832943439484, "gradients_default_optimizer_global_norm": 0.3350014090538025, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3210880, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010808832943439484, "vf_explained_var": 0.05712360143661499, "entropy": 0.5005820989608765, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.15637902915477753, "policy_loss": 0.14554578065872192}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07950350404483925, "add_time_dim_to_batch_and_zero_pad": 3.1792136775992425e-05, "add_states_from_episodes_to_batch": 1.0898988781670851e-05, "general_advantage_estimation": 0.11565253697649104, "batch_individual_items": 0.041375843466249146, "add_observations_from_episodes_to_batch": 0.0003378012654288336, "add_one_ts_to_episodes_and_truncate": 0.007517561556668722, "numpy_to_tensor": 0.0011936290168026039}}, "connector_pipeline_timer": 0.24621888087069516}, "num_env_steps_trained_lifetime": 50601760, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3210880, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1158945515356, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 106000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.6619726354356, "done": false, "training_iteration": 53, "trial_id": "8cacd_00000", "date": "2025-05-12_02-50-07", "timestamp": 1746982207, "time_this_iter_s": 36.52132749557495, "time_total_s": 1874.8312711715698, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1874.8312711715698, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 77.775, "ram_util_percent": 49.53076923076923}}
{"timers": {"training_iteration": 37.03869807762292, "restore_env_runners": 3.196210913994524e-05, "training_step": 37.03822294270995, "env_runner_sampling_timer": 27.994927548467977, "learner_update_timer": 9.035538456627984, "synch_weights": 0.006763577528116373, "synch_env_connectors": 0.00856995222446282}, "env_runners": {"episode_return_mean": 0.867647435897437, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011556068512238638, "get_actions": 0.0006778271445581587, "un_batch_to_individual_items": 6.4857845648801e-05, "listify_data_for_vector_env": 0.00012628822929707884, "tensor_to_numpy": 0.0002150657359733677, "remove_single_ts_time_rank_from_batch": 8.599214248241295e-06}}, "connector_pipeline_timer": 0.0015052012513979156}, "episode_return_max": 1.1202222222222247, "num_episodes_lifetime": 496, "episode_duration_sec_mean": 20.47277868069215, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015455496331970197, "add_time_dim_to_batch_and_zero_pad": 3.608631756632181e-05, "add_states_from_episodes_to_batch": 1.685920280609684e-05, "batch_individual_items": 8.868987391535823e-05, "add_observations_from_episodes_to_batch": 3.89657854808564e-05}}, "connector_pipeline_timer": 0.0005624415263976679}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 108000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 108000}, "sample": 27.53639582034868, "num_env_steps_sampled_lifetime": 108000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6296666666666673, "agent_episode_returns_mean": {"default_agent": 0.867647435897437}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.867647435897437}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.36840509100271, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005285087907373852, "weights_seq_no": 53.0, "env_to_module_sum_episodes_length_in": 93.36840509100271, "env_step_timer": 0.10493291732023122, "time_between_sampling": 9.703867237161141, "num_env_steps_sampled_lifetime_throughput": 57.39232055307147}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.001757812569849193, "mean_kl_loss": 0.004993614740669727, "weights_seq_no": 54.0, "vf_loss": 0.009571962058544159, "gradients_default_optimizer_global_norm": 0.2423265278339386, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3271424, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009571962058544159, "vf_explained_var": 0.07620340585708618, "entropy": 0.4788739085197449, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.04817170649766922, "policy_loss": 0.03858219459652901}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07951701968830058, "add_time_dim_to_batch_and_zero_pad": 3.1793405119084985e-05, "add_states_from_episodes_to_batch": 1.090005523004263e-05, "general_advantage_estimation": 0.11528818550737355, "batch_individual_items": 0.041422220854813604, "add_observations_from_episodes_to_batch": 0.00033830261990619556, "add_one_ts_to_episodes_and_truncate": 0.007513961187494617, "numpy_to_tensor": 0.0011936339113091826}}, "connector_pipeline_timer": 0.24591050880514417}, "num_env_steps_trained_lifetime": 51555328, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3271424, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1197728741338, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 108000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.39232055307147, "done": false, "training_iteration": 54, "trial_id": "8cacd_00000", "date": "2025-05-12_02-50-42", "timestamp": 1746982242, "time_this_iter_s": 34.76040005683899, "time_total_s": 1909.5916712284088, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1909.5916712284088, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 76.702, "ram_util_percent": 49.571999999999996}}
{"timers": {"training_iteration": 37.01401037960668, "restore_env_runners": 3.1953488051967e-05, "training_step": 37.01353434104286, "env_runner_sampling_timer": 27.975290775543307, "learner_update_timer": 9.030500373261697, "synch_weights": 0.006749398752847923, "synch_env_connectors": 0.008563770702220475}, "env_runners": {"episode_return_mean": 0.709942307692308, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011580916969844699, "get_actions": 0.0006759730274510211, "un_batch_to_individual_items": 6.448583900859581e-05, "listify_data_for_vector_env": 0.00012655089459762153, "tensor_to_numpy": 0.00021569542133936928, "remove_single_ts_time_rank_from_batch": 8.652550888883018e-06}}, "connector_pipeline_timer": 0.001504716721138146}, "episode_return_max": 1.103666666666668, "num_episodes_lifetime": 504, "episode_duration_sec_mean": 19.801492691096026, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015348956522268951, "add_time_dim_to_batch_and_zero_pad": 3.5851689778417726e-05, "add_states_from_episodes_to_batch": 1.7113036007945147e-05, "batch_individual_items": 8.870860747316013e-05, "add_observations_from_episodes_to_batch": 3.9288648546127433e-05}}, "connector_pipeline_timer": 0.0005613416751440643}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 110000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 110000}, "sample": 27.53087238636961, "num_env_steps_sampled_lifetime": 110000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4931111111111114, "agent_episode_returns_mean": {"default_agent": 0.709942307692308}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.709942307692308}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.53005874017066, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005265703869639229, "weights_seq_no": 54.0, "env_to_module_sum_episodes_length_in": 92.53005874017066, "env_step_timer": 0.10428361214384076, "time_between_sampling": 9.699574000794902, "num_env_steps_sampled_lifetime_throughput": 57.73435355244561}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.001757812569849193, "mean_kl_loss": 0.006553290411829948, "weights_seq_no": 55.0, "vf_loss": 0.006707848981022835, "gradients_default_optimizer_global_norm": 0.2176320105791092, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3331968, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.006707848981022835, "vf_explained_var": 0.1439017653465271, "entropy": 0.46470022201538086, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06869824975728989, "policy_loss": 0.06197888404130936}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07952991855838822, "add_time_dim_to_batch_and_zero_pad": 3.179422888155382e-05, "add_states_from_episodes_to_batch": 1.090106045056047e-05, "general_advantage_estimation": 0.11492053364394075, "batch_individual_items": 0.04146778436116012, "add_observations_from_episodes_to_batch": 0.00033879799716739575, "add_one_ts_to_episodes_and_truncate": 0.007510219069548377, "numpy_to_tensor": 0.0011936197050239823}}, "connector_pipeline_timer": 0.2455972296826172}, "num_env_steps_trained_lifetime": 52508896, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3331968, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.123562040825, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 110000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.73435355244561, "done": false, "training_iteration": 55, "trial_id": "8cacd_00000", "date": "2025-05-12_02-51-17", "timestamp": 1746982277, "time_this_iter_s": 34.58568811416626, "time_total_s": 1944.177359342575, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1944.177359342575, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 78.02040816326532, "ram_util_percent": 49.597959183673474}}
{"timers": {"training_iteration": 36.99965377199062, "restore_env_runners": 3.1870953157092857e-05, "training_step": 36.99917746481244, "env_runner_sampling_timer": 27.96001564127787, "learner_update_timer": 9.03141883521908, "synch_weights": 0.00674935176532071, "synch_env_connectors": 0.008557719995198445}, "env_runners": {"episode_return_mean": 0.6777628205128207, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011512556651583063, "get_actions": 0.0006721439297237555, "un_batch_to_individual_items": 6.415712132801886e-05, "listify_data_for_vector_env": 0.0001272992300862013, "tensor_to_numpy": 0.00021459403622792927, "remove_single_ts_time_rank_from_batch": 8.685736386919321e-06}}, "connector_pipeline_timer": 0.0014987167707304766}, "episode_return_max": 1.0755555555555572, "num_episodes_lifetime": 512, "episode_duration_sec_mean": 20.2185340564324, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015304207165156184, "add_time_dim_to_batch_and_zero_pad": 3.559311043325341e-05, "add_states_from_episodes_to_batch": 1.6973874783336096e-05, "batch_individual_items": 8.890014784661247e-05, "add_observations_from_episodes_to_batch": 3.882811287866745e-05}}, "connector_pipeline_timer": 0.0005591378413920936}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 112000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 112000}, "sample": 27.524563658469447, "num_env_steps_sampled_lifetime": 112000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4931111111111114, "agent_episode_returns_mean": {"default_agent": 0.6777628205128207}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6777628205128207}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.43378730858203, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005246299257242184, "weights_seq_no": 55.0, "env_to_module_sum_episodes_length_in": 93.43378730858203, "env_step_timer": 0.10345305600660254, "time_between_sampling": 9.695109816442868, "num_env_steps_sampled_lifetime_throughput": 56.10480568345786}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.001757812569849193, "mean_kl_loss": 0.0076253050938248634, "weights_seq_no": 56.0, "vf_loss": 0.014331134036183357, "gradients_default_optimizer_global_norm": 0.22988420724868774, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3392512, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014331134036183357, "vf_explained_var": 0.13660341501235962, "entropy": 0.4570823907852173, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.015325851738452911, "policy_loss": 0.0009813010692596436}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795423167091054, "add_time_dim_to_batch_and_zero_pad": 3.179497682837173e-05, "add_states_from_episodes_to_batch": 1.0901965561013935e-05, "general_advantage_estimation": 0.11454961688922587, "batch_individual_items": 0.041512862135294336, "add_observations_from_episodes_to_batch": 0.00033928557662147023, "add_one_ts_to_episodes_and_truncate": 0.007506336687842258, "numpy_to_tensor": 0.0011935950094734825}}, "connector_pipeline_timer": 0.24527953139166034}, "num_env_steps_trained_lifetime": 53462464, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3392512, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1272634468949, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 112000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.10480568345786, "done": false, "training_iteration": 56, "trial_id": "8cacd_00000", "date": "2025-05-12_02-51-53", "timestamp": 1746982313, "time_this_iter_s": 35.59254479408264, "time_total_s": 1979.7699041366577, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1979.7699041366577, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 75.9843137254902, "ram_util_percent": 49.572549019607834}}
{"timers": {"training_iteration": 36.97600959204071, "restore_env_runners": 3.176224362385486e-05, "training_step": 36.97553360993431, "env_runner_sampling_timer": 27.944044646835092, "learner_update_timer": 9.023751999666885, "synch_weights": 0.0067431822476659254, "synch_env_connectors": 0.008541273795246659}, "env_runners": {"episode_return_mean": 0.8234850427350435, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001144807394872815, "get_actions": 0.0006713823426120304, "un_batch_to_individual_items": 6.46772939709489e-05, "listify_data_for_vector_env": 0.000126822343647361, "tensor_to_numpy": 0.00021467482242474236, "remove_single_ts_time_rank_from_batch": 8.518199350342534e-06}}, "connector_pipeline_timer": 0.001496202509676597}, "episode_return_max": 1.1171111111111123, "num_episodes_lifetime": 520, "episode_duration_sec_mean": 20.13070661966332, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015308531192577868, "add_time_dim_to_batch_and_zero_pad": 3.5795844916859905e-05, "add_states_from_episodes_to_batch": 1.6889120138288116e-05, "batch_individual_items": 8.872162585027114e-05, "add_observations_from_episodes_to_batch": 3.853712051373385e-05}}, "connector_pipeline_timer": 0.0005597924502646119}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 114000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 114000}, "sample": 27.51764868716275, "num_env_steps_sampled_lifetime": 114000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5405555555555559, "agent_episode_returns_mean": {"default_agent": 0.8234850427350435}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8234850427350435}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.43075871501132, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005233774740261761, "weights_seq_no": 56.0, "env_to_module_sum_episodes_length_in": 96.43075871501132, "env_step_timer": 0.10257003183370687, "time_between_sampling": 9.691075285826498, "num_env_steps_sampled_lifetime_throughput": 57.62759697988419}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.001757812569849193, "mean_kl_loss": 0.010951988399028778, "weights_seq_no": 57.0, "vf_loss": 0.012253185734152794, "gradients_default_optimizer_global_norm": 0.14106492698192596, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3453056, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012253185734152794, "vf_explained_var": 0.04513770341873169, "entropy": 0.4196588099002838, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.008526040241122246, "policy_loss": -0.003746388480067253}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795542234449524, "add_time_dim_to_batch_and_zero_pad": 3.1795260393234315e-05, "add_states_from_episodes_to_batch": 1.0903032463061138e-05, "general_advantage_estimation": 0.11417559908624089, "batch_individual_items": 0.04155704427540982, "add_observations_from_episodes_to_batch": 0.0003397746446867053, "add_one_ts_to_episodes_and_truncate": 0.007502369621863347, "numpy_to_tensor": 0.0011936365058634571}}, "connector_pipeline_timer": 0.24495732492345432}, "num_env_steps_trained_lifetime": 54416032, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3453056, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1308784686391, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 114000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.62759697988419, "done": false, "training_iteration": 57, "trial_id": "8cacd_00000", "date": "2025-05-12_02-52-27", "timestamp": 1746982347, "time_this_iter_s": 34.64938545227051, "time_total_s": 2014.4192895889282, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2014.4192895889282, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 78.87959183673469, "ram_util_percent": 49.56530612244899}}
{"timers": {"training_iteration": 36.977315446030296, "restore_env_runners": 3.1694621199490676e-05, "training_step": 36.976839492744965, "env_runner_sampling_timer": 27.95286984044673, "learner_update_timer": 9.016184277500221, "synch_weights": 0.00679208042519001, "synch_env_connectors": 0.00852540205728767}, "env_runners": {"episode_return_mean": 0.7289145299145314, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011371647202336054, "get_actions": 0.0006680454079793853, "un_batch_to_individual_items": 6.494610528205125e-05, "listify_data_for_vector_env": 0.0001261043438197666, "tensor_to_numpy": 0.0002142892670734309, "remove_single_ts_time_rank_from_batch": 8.367683703967332e-06}}, "connector_pipeline_timer": 0.0014894373463373019}, "episode_return_max": 1.0130000000000021, "num_episodes_lifetime": 536, "episode_duration_sec_mean": 20.43974600711576, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015295287327031683, "add_time_dim_to_batch_and_zero_pad": 3.575467507073224e-05, "add_states_from_episodes_to_batch": 1.699873229013209e-05, "batch_individual_items": 8.839006174498579e-05, "add_observations_from_episodes_to_batch": 3.828558979565135e-05}}, "connector_pipeline_timer": 0.0005582466884903296}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 116000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 116000}, "sample": 27.511861629922823, "num_env_steps_sampled_lifetime": 116000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5885555555555562, "agent_episode_returns_mean": {"default_agent": 0.7289145299145314}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.7289145299145314}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.4865446922611, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005240150454021537, "weights_seq_no": 57.0, "env_to_module_sum_episodes_length_in": 97.4865446922611, "env_step_timer": 0.10307665961639342, "time_between_sampling": 9.686603804819446, "num_env_steps_sampled_lifetime_throughput": 53.79308650204506}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.001757812569849193, "mean_kl_loss": 0.010525492951273918, "weights_seq_no": 58.0, "vf_loss": 0.010688230395317078, "gradients_default_optimizer_global_norm": 0.321043461561203, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 3513856, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010688230395317078, "vf_explained_var": 0.013753235340118408, "entropy": 0.4455309212207794, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.13739530742168427, "policy_loss": -0.1481020301580429}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0795655688644116, "add_time_dim_to_batch_and_zero_pad": 3.179498878913404e-05, "add_states_from_episodes_to_batch": 1.0904047830579103e-05, "general_advantage_estimation": 0.11379852346762666, "batch_individual_items": 0.041600275716509545, "add_observations_from_episodes_to_batch": 0.0003402729328329206, "add_one_ts_to_episodes_and_truncate": 0.007498390693535136, "numpy_to_tensor": 0.0011936578628247224}}, "connector_pipeline_timer": 0.2446305152614731}, "num_env_steps_trained_lifetime": 55377432, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 3513856, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1352084636042, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 116000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.79308650204506, "done": false, "training_iteration": 58, "trial_id": "8cacd_00000", "date": "2025-05-12_02-53-04", "timestamp": 1746982384, "time_this_iter_s": 37.12480044364929, "time_total_s": 2051.5440900325775, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2051.5440900325775, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 78.99056603773586, "ram_util_percent": 49.596226415094335}}
{"timers": {"training_iteration": 36.94764921682998, "restore_env_runners": 3.162467499471655e-05, "training_step": 36.947172043077515, "env_runner_sampling_timer": 27.943268407422277, "learner_update_timer": 8.996130122605228, "synch_weights": 0.006780684620938075, "synch_env_connectors": 0.008541659036726464}, "env_runners": {"episode_return_mean": 0.7563750000000016, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011290629841163864, "get_actions": 0.0006669197090694514, "un_batch_to_individual_items": 6.49590199275432e-05, "listify_data_for_vector_env": 0.00012572953069549538, "tensor_to_numpy": 0.00021326868632520825, "remove_single_ts_time_rank_from_batch": 8.240092187572575e-06}}, "connector_pipeline_timer": 0.0014848810787806421}, "episode_return_max": 1.1035555555555578, "num_episodes_lifetime": 544, "episode_duration_sec_mean": 20.591011067144475, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015245646395703252, "add_time_dim_to_batch_and_zero_pad": 3.546400607999295e-05, "add_states_from_episodes_to_batch": 1.6876315820870238e-05, "batch_individual_items": 8.806849059227776e-05, "add_observations_from_episodes_to_batch": 3.785335875803075e-05}}, "connector_pipeline_timer": 0.0005555157562737519}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 118000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 118000}, "sample": 27.50570762433589, "num_env_steps_sampled_lifetime": 118000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5441111111111112, "agent_episode_returns_mean": {"default_agent": 0.7563750000000016}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7563750000000016}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.1449445641814, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005215551525284595, "weights_seq_no": 58.0, "env_to_module_sum_episodes_length_in": 96.1449445641814, "env_step_timer": 0.10315834184745365, "time_between_sampling": 9.6819810562793, "num_env_steps_sampled_lifetime_throughput": 58.65605030087156}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.001757812569849193, "mean_kl_loss": 0.007664063014090061, "weights_seq_no": 59.0, "vf_loss": 0.013409426435828209, "gradients_default_optimizer_global_norm": 0.3570255637168884, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3574400, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013409426435828209, "vf_explained_var": 0.06377899646759033, "entropy": 0.4620057940483093, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07694068551063538, "policy_loss": -0.09036359190940857}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07957620446303719, "add_time_dim_to_batch_and_zero_pad": 3.179415309112329e-05, "add_states_from_episodes_to_batch": 1.0904972587445533e-05, "general_advantage_estimation": 0.11341874570147623, "batch_individual_items": 0.04164243148435972, "add_observations_from_episodes_to_batch": 0.00034076360775170915, "add_one_ts_to_episodes_and_truncate": 0.00749428969681141, "numpy_to_tensor": 0.001193667478996193}}, "connector_pipeline_timer": 0.24429906579013927}, "num_env_steps_trained_lifetime": 56331000, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3574400, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1394387708228, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 118000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.65605030087156, "done": false, "training_iteration": 59, "trial_id": "8cacd_00000", "date": "2025-05-12_02-53-39", "timestamp": 1746982419, "time_this_iter_s": 34.02576923370361, "time_total_s": 2085.569859266281, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2085.569859266281, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 81.22500000000001, "ram_util_percent": 49.52708333333334}}
{"timers": {"training_iteration": 36.93101283977167, "restore_env_runners": 3.153442825579485e-05, "training_step": 36.93053532175674, "env_runner_sampling_timer": 27.92766365270805, "learner_update_timer": 8.995115690129166, "synch_weights": 0.006763101774734677, "synch_env_connectors": 0.00852768344635925}, "env_runners": {"episode_return_mean": 0.7814305555555567, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011237558031179903, "get_actions": 0.0006650489453502357, "un_batch_to_individual_items": 6.475616285887239e-05, "listify_data_for_vector_env": 0.00012553447092386792, "tensor_to_numpy": 0.0002119109293121351, "remove_single_ts_time_rank_from_batch": 8.131856193221731e-06}}, "connector_pipeline_timer": 0.0014802442503502658}, "episode_return_max": 1.1035555555555578, "num_episodes_lifetime": 552, "episode_duration_sec_mean": 20.289189326827227, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015183803047330056, "add_time_dim_to_batch_and_zero_pad": 3.518143052927239e-05, "add_states_from_episodes_to_batch": 1.6864783196135424e-05, "batch_individual_items": 8.75986096916354e-05, "add_observations_from_episodes_to_batch": 3.766179026444929e-05}}, "connector_pipeline_timer": 0.0005526593886178271}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 120000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 120000}, "sample": 27.498942315060972, "num_env_steps_sampled_lifetime": 120000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5441111111111112, "agent_episode_returns_mean": {"default_agent": 0.7814305555555567}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7814305555555567}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.11319221270581, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005216440369471971, "weights_seq_no": 59.0, "env_to_module_sum_episodes_length_in": 94.11319221270581, "env_step_timer": 0.10294012804384066, "time_between_sampling": 9.67622524064221, "num_env_steps_sampled_lifetime_throughput": 56.56086841345287}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.001757812569849193, "mean_kl_loss": 0.005270082503557205, "weights_seq_no": 60.0, "vf_loss": 0.008837467059493065, "gradients_default_optimizer_global_norm": 0.29344192147254944, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3634944, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008837467059493065, "vf_explained_var": 0.0014818310737609863, "entropy": 0.4247327744960785, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.03197294473648071, "policy_loss": 0.023126205429434776}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07958621211270381, "add_time_dim_to_batch_and_zero_pad": 3.17929646081265e-05, "add_states_from_episodes_to_batch": 1.0905818444230951e-05, "general_advantage_estimation": 0.11303641370830206, "batch_individual_items": 0.041683850669281236, "add_observations_from_episodes_to_batch": 0.0003412451118788978, "add_one_ts_to_episodes_and_truncate": 0.0074900850809528135, "numpy_to_tensor": 0.0011936684270579482}}, "connector_pipeline_timer": 0.24396356829660593}, "num_env_steps_trained_lifetime": 57284568, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3634944, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1435709510508, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 120000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.56086841345287, "done": false, "training_iteration": 60, "trial_id": "8cacd_00000", "date": "2025-05-12_02-54-14", "timestamp": 1746982454, "time_this_iter_s": 35.29944467544556, "time_total_s": 2120.8693039417267, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2120.8693039417267, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 77.626, "ram_util_percent": 49.56199999999999}}
{"timers": {"training_iteration": 36.936477223483955, "restore_env_runners": 3.142308398045256e-05, "training_step": 36.935999546649164, "env_runner_sampling_timer": 27.909758569750956, "learner_update_timer": 9.01837565076787, "synch_weights": 0.006871578757001541, "synch_env_connectors": 0.0085203736118931}, "env_runners": {"episode_return_mean": 0.7356784188034193, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011215575063284927, "get_actions": 0.000665414383397659, "un_batch_to_individual_items": 6.510770040085878e-05, "listify_data_for_vector_env": 0.00012529716491320518, "tensor_to_numpy": 0.0002116683857505577, "remove_single_ts_time_rank_from_batch": 8.946523526837427e-06}}, "connector_pipeline_timer": 0.001480841389313983}, "episode_return_max": 1.0866666666666684, "num_episodes_lifetime": 560, "episode_duration_sec_mean": 20.06261039067319, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015112998049290164, "add_time_dim_to_batch_and_zero_pad": 3.480409346376136e-05, "add_states_from_episodes_to_batch": 1.6790174337215474e-05, "batch_individual_items": 8.726632257779316e-05, "add_observations_from_episodes_to_batch": 3.7444999622928076e-05}}, "connector_pipeline_timer": 0.0005499340385761118}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 122000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 122000}, "sample": 27.491333717360543, "num_env_steps_sampled_lifetime": 122000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.552777777777778, "agent_episode_returns_mean": {"default_agent": 0.7356784188034193}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7356784188034193}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.78980748319006, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005203823455600864, "weights_seq_no": 60.0, "env_to_module_sum_episodes_length_in": 92.78980748319006, "env_step_timer": 0.10244385210336446, "time_between_sampling": 9.670782959543684, "num_env_steps_sampled_lifetime_throughput": 53.107100468613304}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.0008789062849245965, "mean_kl_loss": 0.004275077022612095, "weights_seq_no": 61.0, "vf_loss": 0.006654953584074974, "gradients_default_optimizer_global_norm": 0.6562390327453613, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3695488, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.006654953584074974, "vf_explained_var": 0.06460219621658325, "entropy": 0.48303642868995667, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.1066938117146492, "policy_loss": -0.11335629969835281}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07959554208883081, "add_time_dim_to_batch_and_zero_pad": 3.179156047949357e-05, "add_states_from_episodes_to_batch": 1.0906596886537436e-05, "general_advantage_estimation": 0.11265127346042123, "batch_individual_items": 0.04173959245735591, "add_observations_from_episodes_to_batch": 0.0003417142195628897, "add_one_ts_to_episodes_and_truncate": 0.00748574335844158, "numpy_to_tensor": 0.0011936453694105164}}, "connector_pipeline_timer": 0.2436387232962643}, "num_env_steps_trained_lifetime": 58238136, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3695488, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1476065437973, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 122000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.107100468613304, "done": false, "training_iteration": 61, "trial_id": "8cacd_00000", "date": "2025-05-12_02-54-52", "timestamp": 1746982492, "time_this_iter_s": 37.509395122528076, "time_total_s": 2158.3786990642548, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2158.3786990642548, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 72.53888888888888, "ram_util_percent": 49.6111111111111}}
{"timers": {"training_iteration": 36.96096310306911, "restore_env_runners": 3.138685312925959e-05, "training_step": 36.960484682002686, "env_runner_sampling_timer": 27.929390175813438, "learner_update_timer": 9.023217374320204, "synch_weights": 0.006882329969427455, "synch_env_connectors": 0.008628302875767565}, "env_runners": {"episode_return_mean": 0.7337681623931627, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011317623694956796, "get_actions": 0.0006662637841893783, "un_batch_to_individual_items": 6.519842337502461e-05, "listify_data_for_vector_env": 0.0001255200849712182, "tensor_to_numpy": 0.00021185846076468757, "remove_single_ts_time_rank_from_batch": 8.96983570828711e-06}}, "connector_pipeline_timer": 0.0014834563925840182}, "episode_return_max": 1.036888888888889, "num_episodes_lifetime": 568, "episode_duration_sec_mean": 22.25976095626942, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015136314808337413, "add_time_dim_to_batch_and_zero_pad": 3.4528178772490544e-05, "add_states_from_episodes_to_batch": 1.6804103767787057e-05, "batch_individual_items": 8.754151137656426e-05, "add_observations_from_episodes_to_batch": 3.7340300944667486e-05}}, "connector_pipeline_timer": 0.0005500870648056672}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 124000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 124000}, "sample": 27.485854328870058, "num_env_steps_sampled_lifetime": 124000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5412222222222228, "agent_episode_returns_mean": {"default_agent": 0.7337681623931627}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7337681623931627}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.01405067882929, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005198635723840706, "weights_seq_no": 61.0, "env_to_module_sum_episodes_length_in": 93.01405067882929, "env_step_timer": 0.10206781737512417, "time_between_sampling": 9.667580069450183, "num_env_steps_sampled_lifetime_throughput": 50.611881603353325}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.0008789062849245965, "mean_kl_loss": 0.007369267288595438, "weights_seq_no": 62.0, "vf_loss": 0.011399488896131516, "gradients_default_optimizer_global_norm": 0.40296363830566406, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3756032, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011399488896131516, "vf_explained_var": 0.0874021053314209, "entropy": 0.4023246765136719, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.01459473092108965, "policy_loss": -0.02600068598985672}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07960460604402393, "add_time_dim_to_batch_and_zero_pad": 3.1792255136930805e-05, "add_states_from_episodes_to_batch": 1.0907309178068886e-05, "general_advantage_estimation": 0.11226353455612725, "batch_individual_items": 0.04179419107450214, "add_observations_from_episodes_to_batch": 0.0003421726605819628, "add_one_ts_to_episodes_and_truncate": 0.007481302941872458, "numpy_to_tensor": 0.0011936120460732896}}, "connector_pipeline_timer": 0.24330974754879983}, "num_env_steps_trained_lifetime": 59191704, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3756032, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1515470675936, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 124000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.611881603353325, "done": false, "training_iteration": 62, "trial_id": "8cacd_00000", "date": "2025-05-12_02-55-31", "timestamp": 1746982531, "time_this_iter_s": 39.411916971206665, "time_total_s": 2197.7906160354614, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2197.7906160354614, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 78.16607142857143, "ram_util_percent": 49.60892857142858}}
{"timers": {"training_iteration": 36.96518221303842, "restore_env_runners": 3.139098460011998e-05, "training_step": 36.96470281718266, "env_runner_sampling_timer": 27.936999168805286, "learner_update_timer": 9.019843610827008, "synch_weights": 0.006864883669732955, "synch_env_connectors": 0.008666301847025116}, "env_runners": {"episode_return_mean": 0.7758707264957269, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011253004582488109, "get_actions": 0.0006659312002779391, "un_batch_to_individual_items": 6.495874193380959e-05, "listify_data_for_vector_env": 0.0001251286790241954, "tensor_to_numpy": 0.00021091373946794574, "remove_single_ts_time_rank_from_batch": 8.858655562052897e-06}}, "connector_pipeline_timer": 0.0014806514504418426}, "episode_return_max": 1.0828888888888897, "num_episodes_lifetime": 576, "episode_duration_sec_mean": 23.01639772237555, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001521507578156656, "add_time_dim_to_batch_and_zero_pad": 3.451707442849986e-05, "add_states_from_episodes_to_batch": 1.6724680174130094e-05, "batch_individual_items": 8.718731144103021e-05, "add_observations_from_episodes_to_batch": 3.704106443949701e-05}}, "connector_pipeline_timer": 0.0005491850541908267}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 126000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 126000}, "sample": 27.48120573176493, "num_env_steps_sampled_lifetime": 126000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5187777777777778, "agent_episode_returns_mean": {"default_agent": 0.7758707264957269}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7758707264957269}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.23763323936825, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005182220547370147, "weights_seq_no": 62.0, "env_to_module_sum_episodes_length_in": 95.23763323936825, "env_step_timer": 0.1013256545535036, "time_between_sampling": 9.665001519436851, "num_env_steps_sampled_lifetime_throughput": 53.31909187640791}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.0008789062849245965, "mean_kl_loss": 0.005255597643554211, "weights_seq_no": 63.0, "vf_loss": 0.015197010710835457, "gradients_default_optimizer_global_norm": 0.19399645924568176, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3816576, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015197010710835457, "vf_explained_var": 0.09496438503265381, "entropy": 0.32792362570762634, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.009543413296341896, "policy_loss": -0.0056582167744636536}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07961385557580442, "add_time_dim_to_batch_and_zero_pad": 3.1796406745239823e-05, "add_states_from_episodes_to_batch": 1.0908016564089647e-05, "general_advantage_estimation": 0.1118734624425732, "batch_individual_items": 0.0418475659700598, "add_observations_from_episodes_to_batch": 0.0003426190813587145, "add_one_ts_to_episodes_and_truncate": 0.007476725269298849, "numpy_to_tensor": 0.0011935739546657276}}, "connector_pipeline_timer": 0.242977243203855}, "num_env_steps_trained_lifetime": 60145272, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3816576, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1553940202596, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 126000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.31909187640791, "done": false, "training_iteration": 63, "trial_id": "8cacd_00000", "date": "2025-05-12_02-56-09", "timestamp": 1746982569, "time_this_iter_s": 37.39785099029541, "time_total_s": 2235.188467025757, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2235.188467025757, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 78.38301886792453, "ram_util_percent": 49.6132075471698}}
{"timers": {"training_iteration": 36.95962985971803, "restore_env_runners": 3.129807474526167e-05, "training_step": 36.95915082582083, "env_runner_sampling_timer": 27.942592713027242, "learner_update_timer": 9.008703870618723, "synch_weights": 0.006859025833035914, "synch_env_connectors": 0.00865207082857026}, "env_runners": {"episode_return_mean": 0.8007211538461553, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001118954192013849, "get_actions": 0.0006643758085603276, "un_batch_to_individual_items": 6.48517757350553e-05, "listify_data_for_vector_env": 0.0001248266014384888, "tensor_to_numpy": 0.00021154108918890926, "remove_single_ts_time_rank_from_batch": 8.727940969442884e-06}}, "connector_pipeline_timer": 0.0014772362036541}, "episode_return_max": 1.1550000000000018, "num_episodes_lifetime": 592, "episode_duration_sec_mean": 19.853418459740205, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001514881604076699, "add_time_dim_to_batch_and_zero_pad": 3.46261613574923e-05, "add_states_from_episodes_to_batch": 1.694283076968102e-05, "batch_individual_items": 8.659855260240921e-05, "add_observations_from_episodes_to_batch": 3.697974430226508e-05}}, "connector_pipeline_timer": 0.0005476179103031674}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 128000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 128000}, "sample": 27.47727109868676, "num_env_steps_sampled_lifetime": 128000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5368888888888889, "agent_episode_returns_mean": {"default_agent": 0.8007211538461553}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8007211538461553}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.09416296218174, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005166644582178246, "weights_seq_no": 63.0, "env_to_module_sum_episodes_length_in": 97.09416296218174, "env_step_timer": 0.10212987836864154, "time_between_sampling": 9.662522573848065, "num_env_steps_sampled_lifetime_throughput": 54.823855696649524}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.0008789062849245965, "mean_kl_loss": 0.007407079450786114, "weights_seq_no": 64.0, "vf_loss": 0.014418241567909718, "gradients_default_optimizer_global_norm": 0.3179055154323578, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 3877376, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014418241567909718, "vf_explained_var": 0.08230984210968018, "entropy": 0.36966127157211304, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.023810746148228645, "policy_loss": 0.00938598345965147}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07962318739634479, "add_time_dim_to_batch_and_zero_pad": 3.180423609596286e-05, "add_states_from_episodes_to_batch": 1.090881907133273e-05, "general_advantage_estimation": 0.11148087688783463, "batch_individual_items": 0.041900068098598815, "add_observations_from_episodes_to_batch": 0.00034307976645373597, "add_one_ts_to_episodes_and_truncate": 0.0074721493298824495, "numpy_to_tensor": 0.0011935451038816234}}, "connector_pipeline_timer": 0.2426414557810541}, "num_env_steps_trained_lifetime": 61106672, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 3877376, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1599488791655, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 128000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.823855696649524, "done": false, "training_iteration": 64, "trial_id": "8cacd_00000", "date": "2025-05-12_02-56-45", "timestamp": 1746982605, "time_this_iter_s": 36.42473578453064, "time_total_s": 2271.6132028102875, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2271.6132028102875, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 79.48076923076923, "ram_util_percent": 49.62499999999999}}
{"timers": {"training_iteration": 36.94671774791085, "restore_env_runners": 3.1281093996152225e-05, "training_step": 36.94623798735262, "env_runner_sampling_timer": 27.933000690346976, "learner_update_timer": 9.005396992252539, "synch_weights": 0.00684491557470443, "synch_env_connectors": 0.008636352120293839}, "env_runners": {"episode_return_mean": 0.7905555555555571, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001122898869578845, "get_actions": 0.0006639917629425053, "un_batch_to_individual_items": 6.470274771906217e-05, "listify_data_for_vector_env": 0.00012426566941345187, "tensor_to_numpy": 0.0002116113780750352, "remove_single_ts_time_rank_from_batch": 8.589391585899686e-06}}, "connector_pipeline_timer": 0.0014760619755903757}, "episode_return_max": 1.1067777777777807, "num_episodes_lifetime": 600, "episode_duration_sec_mean": 20.2172383845288, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001520201142952908, "add_time_dim_to_batch_and_zero_pad": 3.4537999790211515e-05, "add_states_from_episodes_to_batch": 1.79113113768006e-05, "batch_individual_items": 8.686567263098234e-05, "add_observations_from_episodes_to_batch": 3.732168331911023e-05}}, "connector_pipeline_timer": 0.0005507736204277899}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 130000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 130000}, "sample": 27.472736370005332, "num_env_steps_sampled_lifetime": 130000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5368888888888889, "agent_episode_returns_mean": {"default_agent": 0.7905555555555571}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7905555555555571}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.46156626091144, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005150013696064296, "weights_seq_no": 64.0, "env_to_module_sum_episodes_length_in": 96.46156626091144, "env_step_timer": 0.10249864787479038, "time_between_sampling": 9.659435681729077, "num_env_steps_sampled_lifetime_throughput": 55.958895180230925}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.0004394531424622983, "mean_kl_loss": 0.0025770743377506733, "weights_seq_no": 65.0, "vf_loss": 0.014518403448164463, "gradients_default_optimizer_global_norm": 0.4068174362182617, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3937920, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014518403448164463, "vf_explained_var": 0.04774981737136841, "entropy": 0.34478560090065, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.010483372956514359, "policy_loss": -0.004037294536828995}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07963177150451664, "add_time_dim_to_batch_and_zero_pad": 3.1814779219044165e-05, "add_states_from_episodes_to_batch": 1.0909694726664699e-05, "general_advantage_estimation": 0.11108584054794654, "batch_individual_items": 0.04195176966767014, "add_observations_from_episodes_to_batch": 0.00034352775593862755, "add_one_ts_to_episodes_and_truncate": 0.007467435446727422, "numpy_to_tensor": 0.001193507952717701}}, "connector_pipeline_timer": 0.24230150531168876}, "num_env_steps_trained_lifetime": 62060240, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3937920, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1643971014914, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 130000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 55.958895180230925, "done": false, "training_iteration": 65, "trial_id": "8cacd_00000", "date": "2025-05-12_02-57-21", "timestamp": 1746982641, "time_this_iter_s": 35.68609571456909, "time_total_s": 2307.2992985248566, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2307.2992985248566, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 76.75882352941176, "ram_util_percent": 49.61764705882352}}
{"timers": {"training_iteration": 36.912360114271735, "restore_env_runners": 3.12112830511434e-05, "training_step": 36.911879109319095, "env_runner_sampling_timer": 27.914335107673505, "learner_update_timer": 8.989709198940014, "synch_weights": 0.0068391494189538535, "synch_env_connectors": 0.008636789599088548}, "env_runners": {"episode_return_mean": 0.8406356837606851, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.000111505350215728, "get_actions": 0.0006643937737725445, "un_batch_to_individual_items": 6.410966208305072e-05, "listify_data_for_vector_env": 0.00012392881864832161, "tensor_to_numpy": 0.0002126109711383717, "remove_single_ts_time_rank_from_batch": 8.451129855707858e-06}}, "connector_pipeline_timer": 0.0014754606397168102}, "episode_return_max": 1.1882222222222247, "num_episodes_lifetime": 608, "episode_duration_sec_mean": 20.196354515220683, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015132626201063256, "add_time_dim_to_batch_and_zero_pad": 3.4338396083374245e-05, "add_states_from_episodes_to_batch": 1.7919095960906402e-05, "batch_individual_items": 8.707046128848986e-05, "add_observations_from_episodes_to_batch": 3.720125093435129e-05}}, "connector_pipeline_timer": 0.0005489997977407221}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 132000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 132000}, "sample": 27.46714656955173, "num_env_steps_sampled_lifetime": 132000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5638888888888897, "agent_episode_returns_mean": {"default_agent": 0.8406356837606851}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8406356837606851}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.50631433673976, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005147022169329283, "weights_seq_no": 65.0, "env_to_module_sum_episodes_length_in": 94.50631433673976, "env_step_timer": 0.10229719530976894, "time_between_sampling": 9.65647805069082, "num_env_steps_sampled_lifetime_throughput": 59.553544674246005}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.00021972657123114914, "mean_kl_loss": 0.002854833612218499, "weights_seq_no": 66.0, "vf_loss": 0.009819762781262398, "gradients_default_optimizer_global_norm": 0.27669504284858704, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3998464, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009819762781262398, "vf_explained_var": 0.17212122678756714, "entropy": 0.3234632909297943, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03421664983034134, "policy_loss": -0.04403766244649887}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07963977708188555, "add_time_dim_to_batch_and_zero_pad": 3.182832105614384e-05, "add_states_from_episodes_to_batch": 1.0910571986885733e-05, "general_advantage_estimation": 0.11068848180716741, "batch_individual_items": 0.042002380948650296, "add_observations_from_episodes_to_batch": 0.0003439638976570443, "add_one_ts_to_episodes_and_truncate": 0.007462632336302603, "numpy_to_tensor": 0.0011934574700666945}}, "connector_pipeline_timer": 0.24195744859633253}, "num_env_steps_trained_lifetime": 63013808, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 3998464, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1687403644828, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 132000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.553544674246005, "done": false, "training_iteration": 66, "trial_id": "8cacd_00000", "date": "2025-05-12_02-57-54", "timestamp": 1746982674, "time_this_iter_s": 33.5260214805603, "time_total_s": 2340.825320005417, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2340.825320005417, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 80.43829787234043, "ram_util_percent": 49.6191489361702}}
{"timers": {"training_iteration": 36.88171201092903, "restore_env_runners": 3.1198170223628726e-05, "training_step": 36.881230229025896, "env_runner_sampling_timer": 27.89699719641677, "learner_update_timer": 8.976413253930625, "synch_weights": 0.0068243409247723905, "synch_env_connectors": 0.008624790703092139}, "env_runners": {"episode_return_mean": 0.7360619658119666, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011114928970412098, "get_actions": 0.0006640333053250139, "un_batch_to_individual_items": 6.379870866944482e-05, "listify_data_for_vector_env": 0.00012379921286679977, "tensor_to_numpy": 0.00021282895800805605, "remove_single_ts_time_rank_from_batch": 8.319790464357413e-06}}, "connector_pipeline_timer": 0.0014733829286378783}, "episode_return_max": 1.1882222222222247, "num_episodes_lifetime": 616, "episode_duration_sec_mean": 20.26005678815346, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015217163990563636, "add_time_dim_to_batch_and_zero_pad": 3.429859596447975e-05, "add_states_from_episodes_to_batch": 1.7788457508030368e-05, "batch_individual_items": 8.679777457471543e-05, "add_observations_from_episodes_to_batch": 3.680543611268068e-05}}, "connector_pipeline_timer": 0.0005489463552552349}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 134000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 134000}, "sample": 27.46074661612758, "num_env_steps_sampled_lifetime": 134000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.524888888888889, "agent_episode_returns_mean": {"default_agent": 0.7360619658119666}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7360619658119666}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.83511750097661, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005129794700488696, "weights_seq_no": 66.0, "env_to_module_sum_episodes_length_in": 92.83511750097661, "env_step_timer": 0.10183992629196761, "time_between_sampling": 9.652480155754176, "num_env_steps_sampled_lifetime_throughput": 58.96783848745375}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.00021972657123114914, "mean_kl_loss": 0.007440577726811171, "weights_seq_no": 67.0, "vf_loss": 0.005430843215435743, "gradients_default_optimizer_global_norm": 0.34973183274269104, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4059008, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.005430843215435743, "vf_explained_var": 0.044736623764038086, "entropy": 0.34442105889320374, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.11439131945371628, "policy_loss": -0.11982379108667374}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07964749013055651, "add_time_dim_to_batch_and_zero_pad": 3.1841090578613785e-05, "add_states_from_episodes_to_batch": 1.0912630732404571e-05, "general_advantage_estimation": 0.11028881912714901, "batch_individual_items": 0.042051873947043926, "add_observations_from_episodes_to_batch": 0.00034438818376548145, "add_one_ts_to_episodes_and_truncate": 0.007457719514541538, "numpy_to_tensor": 0.0011933930262735205}}, "connector_pipeline_timer": 0.24160953537475238}, "num_env_steps_trained_lifetime": 63967376, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4059008, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1729803225041, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 134000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.96783848745375, "done": false, "training_iteration": 67, "trial_id": "8cacd_00000", "date": "2025-05-12_02-58-28", "timestamp": 1746982708, "time_this_iter_s": 33.86242604255676, "time_total_s": 2374.6877460479736, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2374.6877460479736, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 79.6875, "ram_util_percent": 49.668749999999996}}
{"timers": {"training_iteration": 36.84976189154973, "restore_env_runners": 3.116618852523298e-05, "training_step": 36.84927907046564, "env_runner_sampling_timer": 27.880898366192614, "learner_update_timer": 8.960525252381311, "synch_weights": 0.0068579835155359575, "synch_env_connectors": 0.008603253796056658}, "env_runners": {"episode_return_mean": 0.6379551282051282, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011084762673104791, "get_actions": 0.0006624132514608872, "un_batch_to_individual_items": 6.350396520119998e-05, "listify_data_for_vector_env": 0.00012344811546592031, "tensor_to_numpy": 0.00021300040011343013, "remove_single_ts_time_rank_from_batch": 8.466161827281681e-06}}, "connector_pipeline_timer": 0.0014706072003086408}, "episode_return_max": 1.0102222222222228, "num_episodes_lifetime": 624, "episode_duration_sec_mean": 20.06247920445148, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001511108489633147, "add_time_dim_to_batch_and_zero_pad": 3.4105841255287755e-05, "add_states_from_episodes_to_batch": 1.7644201070449186e-05, "batch_individual_items": 8.607863160433844e-05, "add_observations_from_episodes_to_batch": 3.649009589661535e-05}}, "connector_pipeline_timer": 0.0005453629067531285}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 136000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 136000}, "sample": 27.453491291371666, "num_env_steps_sampled_lifetime": 136000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5013333333333336, "agent_episode_returns_mean": {"default_agent": 0.6379551282051282}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6379551282051282}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.46660973079317, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005112295313942036, "weights_seq_no": 67.0, "env_to_module_sum_episodes_length_in": 92.46660973079317, "env_step_timer": 0.10121619541472283, "time_between_sampling": 9.647645824584378, "num_env_steps_sampled_lifetime_throughput": 59.250555882784504}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 0.00010986328561557457, "mean_kl_loss": 0.0025466731749475002, "weights_seq_no": 68.0, "vf_loss": 0.007153132930397987, "gradients_default_optimizer_global_norm": 0.2736246883869171, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4119552, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007153132930397987, "vf_explained_var": 0.024989843368530273, "entropy": 0.32238712906837463, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.043560102581977844, "policy_loss": 0.03640640527009964}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07965463253054597, "add_time_dim_to_batch_and_zero_pad": 3.185338187851215e-05, "add_states_from_episodes_to_batch": 1.0914597245729863e-05, "general_advantage_estimation": 0.10988692597255019, "batch_individual_items": 0.042100130487374966, "add_observations_from_episodes_to_batch": 0.00034480334776202623, "add_one_ts_to_episodes_and_truncate": 0.007452725205982092, "numpy_to_tensor": 0.0011933376756091383}}, "connector_pipeline_timer": 0.2412574918227442}, "num_env_steps_trained_lifetime": 64920944, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4119552, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1771186073286, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 136000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.250555882784504, "done": false, "training_iteration": 68, "trial_id": "8cacd_00000", "date": "2025-05-12_02-59-02", "timestamp": 1746982742, "time_this_iter_s": 33.70849823951721, "time_total_s": 2408.396244287491, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2408.396244287491, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 79.20625, "ram_util_percent": 49.675000000000004}}
{"timers": {"training_iteration": 36.82194917928422, "restore_env_runners": 3.113852663789937e-05, "training_step": 36.82146502141097, "env_runner_sampling_timer": 27.869969556050695, "learner_update_timer": 8.943655562987505, "synch_weights": 0.0068416026803821625, "synch_env_connectors": 0.008638951258105938}, "env_runners": {"episode_return_mean": 0.6939957264957267, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011053817795580137, "get_actions": 0.0006595575073962867, "un_batch_to_individual_items": 6.405401828123938e-05, "listify_data_for_vector_env": 0.00012315838616394642, "tensor_to_numpy": 0.00021270755423507786, "remove_single_ts_time_rank_from_batch": 8.809489790416673e-06}}, "connector_pipeline_timer": 0.001466696264917966}, "episode_return_max": 1.0102222222222228, "num_episodes_lifetime": 632, "episode_duration_sec_mean": 20.11211412544213, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015055354315313333, "add_time_dim_to_batch_and_zero_pad": 3.423102853958124e-05, "add_states_from_episodes_to_batch": 1.7504788067279806e-05, "batch_individual_items": 8.617968631480938e-05, "add_observations_from_episodes_to_batch": 3.614148665474244e-05}}, "connector_pipeline_timer": 0.0005451250894687325}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 138000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 138000}, "sample": 27.44583331331351, "num_env_steps_sampled_lifetime": 138000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5013333333333336, "agent_episode_returns_mean": {"default_agent": 0.6939957264957267}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.6939957264957267}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.9707057554018, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005107941112100289, "weights_seq_no": 68.0, "env_to_module_sum_episodes_length_in": 93.9707057554018, "env_step_timer": 0.10061632455091789, "time_between_sampling": 9.64205686183315, "num_env_steps_sampled_lifetime_throughput": 58.569103906590264}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.4931642807787284e-05, "mean_kl_loss": 0.0029346479568630457, "weights_seq_no": 69.0, "vf_loss": 0.011801254004240036, "gradients_default_optimizer_global_norm": 0.30431702733039856, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4180096, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011801254004240036, "vf_explained_var": 0.11119437217712402, "entropy": 0.3007250428199768, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06243288889527321, "policy_loss": 0.050631310790777206}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07966167919352249, "add_time_dim_to_batch_and_zero_pad": 3.186500324345231e-05, "add_states_from_episodes_to_batch": 1.0916453165660538e-05, "general_advantage_estimation": 0.10948296225913054, "batch_individual_items": 0.0421474296795048, "add_observations_from_episodes_to_batch": 0.0003452123196602679, "add_one_ts_to_episodes_and_truncate": 0.007447661921642217, "numpy_to_tensor": 0.0011933588726555453}}, "connector_pipeline_timer": 0.24090232192823863}, "num_env_steps_trained_lifetime": 65874512, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4180096, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1811568284243, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 138000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.569103906590264, "done": false, "training_iteration": 69, "trial_id": "8cacd_00000", "date": "2025-05-12_02-59-36", "timestamp": 1746982776, "time_this_iter_s": 34.08720517158508, "time_total_s": 2442.483449459076, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2442.483449459076, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 79.25714285714287, "ram_util_percent": 49.62244897959183}}
{"timers": {"training_iteration": 36.82628469864137, "restore_env_runners": 3.104814136266327e-05, "training_step": 36.82580115034687, "env_runner_sampling_timer": 27.880942696320176, "learner_update_timer": 8.937004532677626, "synch_weights": 0.006855921653574661, "synch_env_connectors": 0.008647714745526907}, "env_runners": {"episode_return_mean": 0.8649989316239333, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011112705720155729, "get_actions": 0.0006581314212681302, "un_batch_to_individual_items": 6.381205422209367e-05, "listify_data_for_vector_env": 0.00012248253360019028, "tensor_to_numpy": 0.0002117903922649047, "remove_single_ts_time_rank_from_batch": 8.688361141680777e-06}}, "connector_pipeline_timer": 0.0014630540334938636}, "episode_return_max": 1.0665555555555575, "num_episodes_lifetime": 648, "episode_duration_sec_mean": 20.232684650240536, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001512055390348551, "add_time_dim_to_batch_and_zero_pad": 3.4453049238050225e-05, "add_states_from_episodes_to_batch": 1.740289918516777e-05, "batch_individual_items": 8.655094568596338e-05, "add_observations_from_episodes_to_batch": 3.618240891826036e-05}}, "connector_pipeline_timer": 0.0005483089444379621}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 140000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 140000}, "sample": 27.43952573480201, "num_env_steps_sampled_lifetime": 140000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5855555555555558, "agent_episode_returns_mean": {"default_agent": 0.8649989316239333}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8649989316239333}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.8663498019178, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005103145153373412, "weights_seq_no": 69.0, "env_to_module_sum_episodes_length_in": 96.8663498019178, "env_step_timer": 0.10169638386754261, "time_between_sampling": 9.635705181864461, "num_env_steps_sampled_lifetime_throughput": 53.567362834894915}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.4931642807787284e-05, "mean_kl_loss": 0.005898467730730772, "weights_seq_no": 70.0, "vf_loss": 0.016781341284513474, "gradients_default_optimizer_global_norm": 0.2820344567298889, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 4240896, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.016781341284513474, "vf_explained_var": 0.06800168752670288, "entropy": 0.26510167121887207, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.05779264494776726, "policy_loss": -0.0745742991566658}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07966824482998651, "add_time_dim_to_batch_and_zero_pad": 3.187947684299116e-05, "add_states_from_episodes_to_batch": 1.0918300507447008e-05, "general_advantage_estimation": 0.10907702748738199, "batch_individual_items": 0.042193779894743405, "add_observations_from_episodes_to_batch": 0.00034563042178576624, "add_one_ts_to_episodes_and_truncate": 0.00744265700046854, "numpy_to_tensor": 0.0011933866119934737}}, "connector_pipeline_timer": 0.24054382614244094}, "num_env_steps_trained_lifetime": 66835912, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 4240896, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1858965732374, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 140000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.567362834894915, "done": false, "training_iteration": 70, "trial_id": "8cacd_00000", "date": "2025-05-12_03-00-14", "timestamp": 1746982814, "time_this_iter_s": 37.270793437957764, "time_total_s": 2479.7542428970337, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2479.7542428970337, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 79.20188679245281, "ram_util_percent": 49.65283018867923}}
{"timers": {"training_iteration": 36.813789246084966, "restore_env_runners": 3.095365993848685e-05, "training_step": 36.81330588727341, "env_runner_sampling_timer": 27.866208522056976, "learner_update_timer": 8.939253559080852, "synch_weights": 0.006844995437035627, "synch_env_connectors": 0.008646373608073953}, "env_runners": {"episode_return_mean": 0.8347628205128227, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011051863138450467, "get_actions": 0.0006565863258444351, "un_batch_to_individual_items": 6.386098594184222e-05, "listify_data_for_vector_env": 0.00012191370453216828, "tensor_to_numpy": 0.0002113207707187968, "remove_single_ts_time_rank_from_batch": 8.53646120472477e-06}}, "connector_pipeline_timer": 0.0014577577729405736}, "episode_return_max": 1.202777777777781, "num_episodes_lifetime": 656, "episode_duration_sec_mean": 20.166714500711752, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015120711739608457, "add_time_dim_to_batch_and_zero_pad": 3.475646952655693e-05, "add_states_from_episodes_to_batch": 1.7535434245218306e-05, "batch_individual_items": 8.664413969809205e-05, "add_observations_from_episodes_to_batch": 3.6184011918489265e-05}}, "connector_pipeline_timer": 0.0005485033280522213}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 142000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 142000}, "sample": 27.432484130120983, "num_env_steps_sampled_lifetime": 142000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.46177777777777734, "agent_episode_returns_mean": {"default_agent": 0.8347628205128227}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8347628205128227}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.21842151529484, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005095345662652178, "weights_seq_no": 70.0, "env_to_module_sum_episodes_length_in": 97.21842151529484, "env_step_timer": 0.10211195396912583, "time_between_sampling": 9.629480780940504, "num_env_steps_sampled_lifetime_throughput": 55.94656242360451}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.4931642807787284e-05, "mean_kl_loss": 0.008161736652255058, "weights_seq_no": 71.0, "vf_loss": 0.01884033903479576, "gradients_default_optimizer_global_norm": 0.51891028881073, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4301440, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01884033903479576, "vf_explained_var": 0.17196649312973022, "entropy": 0.2574552893638611, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.11812641471624374, "policy_loss": -0.13696719706058502}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07967782318550184, "add_time_dim_to_batch_and_zero_pad": 3.1895674470156285e-05, "add_states_from_episodes_to_batch": 1.0920819257144852e-05, "general_advantage_estimation": 0.10866913527484261, "batch_individual_items": 0.04223983672260938, "add_observations_from_episodes_to_batch": 0.00034603666063688534, "add_one_ts_to_episodes_and_truncate": 0.007437541601526135, "numpy_to_tensor": 0.0011934570906573553}}, "connector_pipeline_timer": 0.2401860218397663}, "num_env_steps_trained_lifetime": 67789480, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4301440, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1905234074713, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 142000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 55.94656242360451, "done": false, "training_iteration": 71, "trial_id": "8cacd_00000", "date": "2025-05-12_03-00-49", "timestamp": 1746982849, "time_this_iter_s": 35.592291593551636, "time_total_s": 2515.3465344905853, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2515.3465344905853, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 75.84313725490196, "ram_util_percent": 49.658823529411755}}
{"timers": {"training_iteration": 36.80909370555412, "restore_env_runners": 3.085612333447401e-05, "training_step": 36.808610481330675, "env_runner_sampling_timer": 27.854747269126406, "learner_update_timer": 8.945815180130042, "synch_weights": 0.007049094482666434, "synch_env_connectors": 0.008637827871999534}, "env_runners": {"episode_return_mean": 0.8212767094017109, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010999493355346571, "get_actions": 0.0006575061423705966, "un_batch_to_individual_items": 6.458997868766258e-05, "listify_data_for_vector_env": 0.00012241785142248462, "tensor_to_numpy": 0.00021100782573650357, "remove_single_ts_time_rank_from_batch": 8.42593180854367e-06}}, "connector_pipeline_timer": 0.0014594872752656518}, "episode_return_max": 1.202777777777781, "num_episodes_lifetime": 664, "episode_duration_sec_mean": 20.13493879470196, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015089061986508245, "add_time_dim_to_batch_and_zero_pad": 3.458941593450748e-05, "add_states_from_episodes_to_batch": 1.7495723363730502e-05, "batch_individual_items": 8.725274234299375e-05, "add_observations_from_episodes_to_batch": 3.614416426355927e-05}}, "connector_pipeline_timer": 0.0005489061116992134}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 144000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 144000}, "sample": 27.425044165105874, "num_env_steps_sampled_lifetime": 144000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.46177777777777734, "agent_episode_returns_mean": {"default_agent": 0.8212767094017109}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8212767094017109}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.50416324279696, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005096957772117745, "weights_seq_no": 71.0, "env_to_module_sum_episodes_length_in": 95.50416324279696, "env_step_timer": 0.10230459230957709, "time_between_sampling": 9.623974572244295, "num_env_steps_sampled_lifetime_throughput": 54.92455843825313}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.7465821403893642e-05, "mean_kl_loss": 0.004768692422658205, "weights_seq_no": 72.0, "vf_loss": 0.012650497257709503, "gradients_default_optimizer_global_norm": 0.25038233399391174, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4361984, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012650497257709503, "vf_explained_var": 0.08341556787490845, "entropy": 0.24894945323467255, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.10635557025671005, "policy_loss": 0.09370481222867966}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07968675247932382, "add_time_dim_to_batch_and_zero_pad": 3.1914800197018435e-05, "add_states_from_episodes_to_batch": 1.0923255801865803e-05, "general_advantage_estimation": 0.10825955302380513, "batch_individual_items": 0.042284946295828615, "add_observations_from_episodes_to_batch": 0.00034643694166890517, "add_one_ts_to_episodes_and_truncate": 0.007432368104862538, "numpy_to_tensor": 0.0011935381010868557}}, "connector_pipeline_timer": 0.23982488320033093}, "num_env_steps_trained_lifetime": 68743048, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4361984, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1950391153632, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 144000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.92455843825313, "done": false, "training_iteration": 72, "trial_id": "8cacd_00000", "date": "2025-05-12_03-01-26", "timestamp": 1746982886, "time_this_iter_s": 36.37549543380737, "time_total_s": 2551.7220299243927, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2551.7220299243927, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 76.77058823529413, "ram_util_percent": 49.73333333333333}}
{"timers": {"training_iteration": 36.78247669512859, "restore_env_runners": 3.088356209482398e-05, "training_step": 36.78199235614736, "env_runner_sampling_timer": 27.836665290145138, "learner_update_timer": 8.937244316248737, "synch_weights": 0.007084104537837955, "synch_env_connectors": 0.00870603159327511}, "env_runners": {"episode_return_mean": 0.8465651709401721, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010982627941867128, "get_actions": 0.0006551185290998248, "un_batch_to_individual_items": 6.433412885672883e-05, "listify_data_for_vector_env": 0.000123386289315833, "tensor_to_numpy": 0.00021088070420223837, "remove_single_ts_time_rank_from_batch": 8.290267649412384e-06}}, "connector_pipeline_timer": 0.0014574318921633143}, "episode_return_max": 1.167333333333335, "num_episodes_lifetime": 672, "episode_duration_sec_mean": 20.122611371846425, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015006958993205632, "add_time_dim_to_batch_and_zero_pad": 3.437998065360389e-05, "add_states_from_episodes_to_batch": 1.7478400039909054e-05, "batch_individual_items": 8.751156553870566e-05, "add_observations_from_episodes_to_batch": 3.6416797216899325e-05}}, "connector_pipeline_timer": 0.000548082853599159}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 146000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 146000}, "sample": 27.416757467856158, "num_env_steps_sampled_lifetime": 146000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5252222222222221, "agent_episode_returns_mean": {"default_agent": 0.8465651709401721}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8465651709401721}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.56740168958927, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005091906326990631, "weights_seq_no": 72.0, "env_to_module_sum_episodes_length_in": 93.56740168958927, "env_step_timer": 0.10195014977430335, "time_between_sampling": 9.619488811367706, "num_env_steps_sampled_lifetime_throughput": 58.37850293595314}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.3732910701946821e-05, "mean_kl_loss": 0.0022141854278743267, "weights_seq_no": 73.0, "vf_loss": 0.010813446715474129, "gradients_default_optimizer_global_norm": 0.1648225635290146, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4422528, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010813446715474129, "vf_explained_var": 0.0822942852973938, "entropy": 0.27933913469314575, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0578775629401207, "policy_loss": 0.04706406593322754}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07969507951495078, "add_time_dim_to_batch_and_zero_pad": 3.1933123841888195e-05, "add_states_from_episodes_to_batch": 1.0925551533923256e-05, "general_advantage_estimation": 0.10784817967416095, "batch_individual_items": 0.04234528395391123, "add_observations_from_episodes_to_batch": 0.0003468293734142378, "add_one_ts_to_episodes_and_truncate": 0.007427265303972135, "numpy_to_tensor": 0.0011936001455986704}}, "connector_pipeline_timer": 0.23947661633140024}, "num_env_steps_trained_lifetime": 69696616, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4422528, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.1994454567566, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 146000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.37850293595314, "done": false, "training_iteration": 73, "trial_id": "8cacd_00000", "date": "2025-05-12_03-02-00", "timestamp": 1746982920, "time_this_iter_s": 34.16298508644104, "time_total_s": 2585.8850150108337, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2585.8850150108337, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 77.63877551020408, "ram_util_percent": 49.66122448979592}}
{"timers": {"training_iteration": 36.753081588057306, "restore_env_runners": 3.086672647814073e-05, "training_step": 36.75259645846588, "env_runner_sampling_timer": 27.820194325903692, "learner_update_timer": 8.92432420330625, "synch_weights": 0.007079652492462831, "synch_env_connectors": 0.008691640277343402}, "env_runners": {"episode_return_mean": 0.7969636752136756, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001098811586857816, "get_actions": 0.0006548289392684626, "un_batch_to_individual_items": 6.413772811098996e-05, "listify_data_for_vector_env": 0.00012270277096343115, "tensor_to_numpy": 0.0002135929289908271, "remove_single_ts_time_rank_from_batch": 8.211024634425511e-06}}, "connector_pipeline_timer": 0.001459804889377842}, "episode_return_max": 1.167333333333335, "num_episodes_lifetime": 680, "episode_duration_sec_mean": 20.20871854197141, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015023905769056674, "add_time_dim_to_batch_and_zero_pad": 3.4351464281420984e-05, "add_states_from_episodes_to_batch": 1.738891341229997e-05, "batch_individual_items": 8.711630234096875e-05, "add_observations_from_episodes_to_batch": 3.63100493693713e-05}}, "connector_pipeline_timer": 0.0005471077757389365}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 148000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 148000}, "sample": 27.407946200906988, "num_env_steps_sampled_lifetime": 148000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4663333333333338, "agent_episode_returns_mean": {"default_agent": 0.7969636752136756}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7969636752136756}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.635518615937, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005087811183603455, "weights_seq_no": 73.0, "env_to_module_sum_episodes_length_in": 92.635518615937, "env_step_timer": 0.1014284044125994, "time_between_sampling": 9.614708688209186, "num_env_steps_sampled_lifetime_throughput": 58.951937154977884}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.8664553509734105e-06, "mean_kl_loss": 0.004977822303771973, "weights_seq_no": 74.0, "vf_loss": 0.0064233699813485146, "gradients_default_optimizer_global_norm": 0.28233346343040466, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4483072, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0064233699813485146, "vf_explained_var": 0.12998485565185547, "entropy": 0.2858644127845764, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1576330065727234, "policy_loss": 0.15120956301689148}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07970778746471718, "add_time_dim_to_batch_and_zero_pad": 3.195673953374462e-05, "add_states_from_episodes_to_batch": 1.0928089025717238e-05, "general_advantage_estimation": 0.10743509302620728, "batch_individual_items": 0.042404900164202605, "add_observations_from_episodes_to_batch": 0.0003472253628304431, "add_one_ts_to_episodes_and_truncate": 0.007422143382289078, "numpy_to_tensor": 0.0011936499854101996}}, "connector_pipeline_timer": 0.23913027837162806}, "num_env_steps_trained_lifetime": 70650184, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4483072, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2037441674106, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 148000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.951937154977884, "done": false, "training_iteration": 74, "trial_id": "8cacd_00000", "date": "2025-05-12_03-02-34", "timestamp": 1746982954, "time_this_iter_s": 33.85707974433899, "time_total_s": 2619.7420947551727, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2619.7420947551727, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 79.525, "ram_util_percent": 49.71875}}
{"timers": {"training_iteration": 36.78711349734672, "restore_env_runners": 3.078805921846297e-05, "training_step": 36.786628405051225, "env_runner_sampling_timer": 27.829656615614656, "learner_update_timer": 8.948914852473182, "synch_weights": 0.007057658967528787, "synch_env_connectors": 0.00867148887456227}, "env_runners": {"episode_return_mean": 0.7380886752136752, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00010964775693797067, "get_actions": 0.0006588945766620796, "un_batch_to_individual_items": 6.39961291354999e-05, "listify_data_for_vector_env": 0.0001237742027177403, "tensor_to_numpy": 0.00021369652780955519, "remove_single_ts_time_rank_from_batch": 8.093671358896692e-06}}, "connector_pipeline_timer": 0.0014667459081293844}, "episode_return_max": 1.1657777777777785, "num_episodes_lifetime": 688, "episode_duration_sec_mean": 20.24088743871135, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015117458449455496, "add_time_dim_to_batch_and_zero_pad": 3.414979003868174e-05, "add_states_from_episodes_to_batch": 1.8201079992728445e-05, "batch_individual_items": 8.876134041431937e-05, "add_observations_from_episodes_to_batch": 3.7014782309091797e-05}}, "connector_pipeline_timer": 0.0005538617347866364}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 150000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 150000}, "sample": 27.399533060528263, "num_env_steps_sampled_lifetime": 150000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4663333333333338, "agent_episode_returns_mean": {"default_agent": 0.7380886752136752}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7380886752136752}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.41679227413134, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005082433373560593, "weights_seq_no": 74.0, "env_to_module_sum_episodes_length_in": 93.41679227413134, "env_step_timer": 0.10147951983799441, "time_between_sampling": 9.60916865243628, "num_env_steps_sampled_lifetime_throughput": 49.72338604749908}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.8664553509734105e-06, "mean_kl_loss": 0.0054809171706438065, "weights_seq_no": 75.0, "vf_loss": 0.014791034162044525, "gradients_default_optimizer_global_norm": 0.33188071846961975, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4543616, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014791034162044525, "vf_explained_var": 0.16368699073791504, "entropy": 0.2561919689178467, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.037825461477041245, "policy_loss": 0.023034395650029182}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07972368476753673, "add_time_dim_to_batch_and_zero_pad": 3.198473959937645e-05, "add_states_from_episodes_to_batch": 1.0930793212492492e-05, "general_advantage_estimation": 0.10702054988324519, "batch_individual_items": 0.042465463541892685, "add_observations_from_episodes_to_batch": 0.00034763564952096425, "add_one_ts_to_episodes_and_truncate": 0.007417227192509347, "numpy_to_tensor": 0.0011937299184109392}}, "connector_pipeline_timer": 0.23878690592941818}, "num_env_steps_trained_lifetime": 71603752, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4543616, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.207936959306, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 150000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.72338604749908, "done": false, "training_iteration": 75, "trial_id": "8cacd_00000", "date": "2025-05-12_03-03-14", "timestamp": 1746982994, "time_this_iter_s": 40.175700187683105, "time_total_s": 2659.917794942856, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2659.917794942856, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 72.16491228070174, "ram_util_percent": 49.74561403508771}}
{"timers": {"training_iteration": 36.98351120209326, "restore_env_runners": 3.1237178642443306e-05, "training_step": 36.983023014720715, "env_runner_sampling_timer": 27.979760418448514, "learner_update_timer": 8.995168477678448, "synch_weights": 0.007095041377850707, "synch_env_connectors": 0.008671033985805772}, "env_runners": {"episode_return_mean": 0.7994658119658123, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00011382322132836012, "get_actions": 0.0006802077006675408, "un_batch_to_individual_items": 6.561901935801745e-05, "listify_data_for_vector_env": 0.00012993554452297282, "tensor_to_numpy": 0.000222376122813329, "remove_single_ts_time_rank_from_batch": 8.739086394587001e-06}}, "connector_pipeline_timer": 0.0015173824849118926}, "episode_return_max": 1.3484444444444463, "num_episodes_lifetime": 696, "episode_duration_sec_mean": 21.757351568336738, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015704826677964172, "add_time_dim_to_batch_and_zero_pad": 3.433647374371181e-05, "add_states_from_episodes_to_batch": 1.8600306043505576e-05, "batch_individual_items": 9.157634104017008e-05, "add_observations_from_episodes_to_batch": 3.761056875662387e-05}}, "connector_pipeline_timer": 0.0005709183649321104}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 152000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 152000}, "sample": 27.400725874192844, "num_env_steps_sampled_lifetime": 152000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.47888888888888903, "agent_episode_returns_mean": {"default_agent": 0.7994658119658123}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7994658119658123}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.27801879055455, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005258084890799891, "weights_seq_no": 75.0, "env_to_module_sum_episodes_length_in": 96.27801879055455, "env_step_timer": 0.10383064856999775, "time_between_sampling": 9.606963636377143, "num_env_steps_sampled_lifetime_throughput": 35.390363923668765}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.8664553509734105e-06, "mean_kl_loss": 0.005248364992439747, "weights_seq_no": 76.0, "vf_loss": 0.017634565010666847, "gradients_default_optimizer_global_norm": 0.22900442779064178, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4604160, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017634565010666847, "vf_explained_var": 0.014587461948394775, "entropy": 0.23404596745967865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.04853672906756401, "policy_loss": -0.06617133319377899}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07974260999555334, "add_time_dim_to_batch_and_zero_pad": 3.201223398975112e-05, "add_states_from_episodes_to_batch": 1.0933520506625577e-05, "general_advantage_estimation": 0.10660484924383963, "batch_individual_items": 0.0425265487420125, "add_observations_from_episodes_to_batch": 0.0003480435179413545, "add_one_ts_to_episodes_and_truncate": 0.007412684392186888, "numpy_to_tensor": 0.0011940329577529696}}, "connector_pipeline_timer": 0.2384465528282153}, "num_env_steps_trained_lifetime": 72557320, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4604160, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2120255209466, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 152000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 35.390363923668765, "done": false, "training_iteration": 76, "trial_id": "8cacd_00000", "date": "2025-05-12_03-04-11", "timestamp": 1746983051, "time_this_iter_s": 56.45050883293152, "time_total_s": 2716.3683037757874, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2716.3683037757874, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 73.26875, "ram_util_percent": 49.71374999999999}}
{"timers": {"training_iteration": 37.15242387850234, "restore_env_runners": 3.1182806856049605e-05, "training_step": 37.1519349140035, "env_runner_sampling_timer": 28.150325832844022, "learner_update_timer": 8.99352443575166, "synch_weights": 0.007084017964074262, "synch_env_connectors": 0.008688433645958846}, "env_runners": {"episode_return_mean": 0.9102061965811991, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001187053446414179, "get_actions": 0.0007016569109527644, "un_batch_to_individual_items": 6.774807479367631e-05, "listify_data_for_vector_env": 0.00013365852869918698, "tensor_to_numpy": 0.0002296368959505521, "remove_single_ts_time_rank_from_batch": 8.880196376436222e-06}}, "connector_pipeline_timer": 0.0015652474476138113}, "episode_return_max": 1.2293333333333365, "num_episodes_lifetime": 712, "episode_duration_sec_mean": 31.921254728480754, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016195489292788846, "add_time_dim_to_batch_and_zero_pad": 3.5903041332381824e-05, "add_states_from_episodes_to_batch": 1.8803605185140797e-05, "batch_individual_items": 9.562958032421414e-05, "add_observations_from_episodes_to_batch": 3.820639271461928e-05}}, "connector_pipeline_timer": 0.0005893790145168994}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 154000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 154000}, "sample": 27.41447622100946, "num_env_steps_sampled_lifetime": 154000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5428888888888893, "agent_episode_returns_mean": {"default_agent": 0.9102061965811991}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9102061965811991}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.4487612951943, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000546120430072815, "weights_seq_no": 76.0, "env_to_module_sum_episodes_length_in": 97.4487612951943, "env_step_timer": 0.10811329945814921, "time_between_sampling": 9.611159827349434, "num_env_steps_sampled_lifetime_throughput": 37.04691446959374}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.8664553509734105e-06, "mean_kl_loss": 0.0066151730716228485, "weights_seq_no": 77.0, "vf_loss": 0.022250646725296974, "gradients_default_optimizer_global_norm": 0.23448219895362854, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 4664960, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.022250646725296974, "vf_explained_var": 0.060805439949035645, "entropy": 0.28187915682792664, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.05697959288954735, "policy_loss": 0.03472891077399254}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07976155711063293, "add_time_dim_to_batch_and_zero_pad": 3.203950001842223e-05, "add_states_from_episodes_to_batch": 1.0936180175592951e-05, "general_advantage_estimation": 0.1061874208222339, "batch_individual_items": 0.04258645593177577, "add_observations_from_episodes_to_batch": 0.0003484569654284329, "add_one_ts_to_episodes_and_truncate": 0.0074081326051517755, "numpy_to_tensor": 0.0011943296833162266}}, "connector_pipeline_timer": 0.2381032947585435}, "num_env_steps_trained_lifetime": 73518720, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 4664960, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2168115176585, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 154000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 37.04691446959374, "done": false, "training_iteration": 77, "trial_id": "8cacd_00000", "date": "2025-05-12_03-05-05", "timestamp": 1746983105, "time_this_iter_s": 53.89331579208374, "time_total_s": 2770.261619567871, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2770.261619567871, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 82.96233766233767, "ram_util_percent": 49.740259740259724}}
{"timers": {"training_iteration": 37.212517376107314, "restore_env_runners": 3.113597878625161e-05, "training_step": 37.21202638725345, "env_runner_sampling_timer": 28.20612569374558, "learner_update_timer": 8.997824110554152, "synch_weights": 0.007071961784426986, "synch_env_connectors": 0.008700573309509362}, "env_runners": {"episode_return_mean": 0.9010235042735066, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012106399674281177, "get_actions": 0.000716789985477978, "un_batch_to_individual_items": 6.855297105736333e-05, "listify_data_for_vector_env": 0.00013662943815854618, "tensor_to_numpy": 0.00023346499316757646, "remove_single_ts_time_rank_from_batch": 8.799418742104125e-06}}, "connector_pipeline_timer": 0.0015942218709727245}, "episode_return_max": 1.1317777777777813, "num_episodes_lifetime": 720, "episode_duration_sec_mean": 27.575361912874925, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016517313150877692, "add_time_dim_to_batch_and_zero_pad": 3.6302787100044707e-05, "add_states_from_episodes_to_batch": 1.8989966830754566e-05, "batch_individual_items": 9.767575485855197e-05, "add_observations_from_episodes_to_batch": 3.955388482944244e-05}}, "connector_pipeline_timer": 0.0006009027674739975}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 156000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 156000}, "sample": 27.431106744018486, "num_env_steps_sampled_lifetime": 156000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5221111111111112, "agent_episode_returns_mean": {"default_agent": 0.9010235042735066}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9010235042735066}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.20493840239358, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000554403597545205, "weights_seq_no": 77.0, "env_to_module_sum_episodes_length_in": 96.20493840239358, "env_step_timer": 0.11033003747528577, "time_between_sampling": 9.615421086208345, "num_env_steps_sampled_lifetime_throughput": 46.252734526591865}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.4332276754867053e-06, "mean_kl_loss": 0.0019233634229749441, "weights_seq_no": 78.0, "vf_loss": 0.017931651324033737, "gradients_default_optimizer_global_norm": 0.5724396705627441, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4725504, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017931651324033737, "vf_explained_var": 0.030725061893463135, "entropy": 0.23723812401294708, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08455270528793335, "policy_loss": 0.06662104278802872}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07978105431241131, "add_time_dim_to_batch_and_zero_pad": 3.206674950296487e-05, "add_states_from_episodes_to_batch": 1.093883329907969e-05, "general_advantage_estimation": 0.10576973173413581, "batch_individual_items": 0.04264720115276962, "add_observations_from_episodes_to_batch": 0.0003488710496141119, "add_one_ts_to_episodes_and_truncate": 0.007403481005418182, "numpy_to_tensor": 0.0011946975710723903}}, "connector_pipeline_timer": 0.23776115271488218}, "num_env_steps_trained_lifetime": 74472288, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4725504, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2214805918838, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 156000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.252734526591865, "done": false, "training_iteration": 78, "trial_id": "8cacd_00000", "date": "2025-05-12_03-05-48", "timestamp": 1746983148, "time_this_iter_s": 43.179526805877686, "time_total_s": 2813.441146373749, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2813.441146373749, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 78.9737704918033, "ram_util_percent": 49.73442622950819}}
{"timers": {"training_iteration": 37.26976401032625, "restore_env_runners": 3.105761900814633e-05, "training_step": 37.26927065436092, "env_runner_sampling_timer": 28.24887209729811, "learner_update_timer": 9.012276542938617, "synch_weights": 0.007115570166582375, "synch_env_connectors": 0.008698440576410418}, "env_runners": {"episode_return_mean": 0.8522820512820526, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001221619689456515, "get_actions": 0.0007228485953005256, "un_batch_to_individual_items": 7.029283234945058e-05, "listify_data_for_vector_env": 0.00013779966532570764, "tensor_to_numpy": 0.000238995979817391, "remove_single_ts_time_rank_from_batch": 8.773245132809612e-06}}, "connector_pipeline_timer": 0.0016129932848009793}, "episode_return_max": 1.3592222222222246, "num_episodes_lifetime": 728, "episode_duration_sec_mean": 25.16517003734601, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016802956502342102, "add_time_dim_to_batch_and_zero_pad": 3.674181563091758e-05, "add_states_from_episodes_to_batch": 1.9344717398991686e-05, "batch_individual_items": 9.928010417296649e-05, "add_observations_from_episodes_to_batch": 4.112428888398381e-05}}, "connector_pipeline_timer": 0.0006117735970568545}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 158000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 158000}, "sample": 27.449787010348157, "num_env_steps_sampled_lifetime": 158000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5221111111111112, "agent_episode_returns_mean": {"default_agent": 0.8522820512820526}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8522820512820526}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.17284172793288, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005601187976496999, "weights_seq_no": 78.0, "env_to_module_sum_episodes_length_in": 94.17284172793288, "env_step_timer": 0.11151345629909408, "time_between_sampling": 9.620045123296668, "num_env_steps_sampled_lifetime_throughput": 46.49104794291489}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.7166138377433526e-06, "mean_kl_loss": 0.0016194783383980393, "weights_seq_no": 79.0, "vf_loss": 0.012191022746264935, "gradients_default_optimizer_global_norm": 0.2982659935951233, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4786048, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012191022746264935, "vf_explained_var": 0.08341825008392334, "entropy": 0.2816639542579651, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.060888297855854034, "policy_loss": 0.048697277903556824}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07980069770464315, "add_time_dim_to_batch_and_zero_pad": 3.209330004775595e-05, "add_states_from_episodes_to_batch": 1.09413897420708e-05, "general_advantage_estimation": 0.1053505458357174, "batch_individual_items": 0.042707095443850464, "add_observations_from_episodes_to_batch": 0.00034927857641950925, "add_one_ts_to_episodes_and_truncate": 0.007398792684418865, "numpy_to_tensor": 0.0011950730881050942}}, "connector_pipeline_timer": 0.23741677265291822}, "num_env_steps_trained_lifetime": 75425856, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4786048, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.226034603473, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 158000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.49104794291489, "done": false, "training_iteration": 79, "trial_id": "8cacd_00000", "date": "2025-05-12_03-06-31", "timestamp": 1746983191, "time_this_iter_s": 42.954306840896606, "time_total_s": 2856.3954532146454, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2856.3954532146454, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 77.98360655737703, "ram_util_percent": 49.739344262295056}}
{"timers": {"training_iteration": 37.303232389802986, "restore_env_runners": 3.097104281386134e-05, "training_step": 37.302739000397324, "env_runner_sampling_timer": 28.275414577935127, "learner_update_timer": 9.019198714479227, "synch_weights": 0.007119449464907299, "synch_env_connectors": 0.008709696170652939}, "env_runners": {"episode_return_mean": 0.8752158119658128, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012274038899158068, "get_actions": 0.0007276130752319926, "un_batch_to_individual_items": 7.015336523426341e-05, "listify_data_for_vector_env": 0.00013853303268024242, "tensor_to_numpy": 0.00023994788749265604, "remove_single_ts_time_rank_from_batch": 8.73286585642457e-06}}, "connector_pipeline_timer": 0.001623768647410734}, "episode_return_max": 1.3592222222222246, "num_episodes_lifetime": 736, "episode_duration_sec_mean": 24.906980395625308, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016906031433233274, "add_time_dim_to_batch_and_zero_pad": 3.6823735590223325e-05, "add_states_from_episodes_to_batch": 1.9723757954510723e-05, "batch_individual_items": 9.924900223890605e-05, "add_observations_from_episodes_to_batch": 4.1380580630743274e-05}}, "connector_pipeline_timer": 0.0006139998061950978}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 160000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 160000}, "sample": 27.469084451523038, "num_env_steps_sampled_lifetime": 160000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5425555555555559, "agent_episode_returns_mean": {"default_agent": 0.8752158119658128}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8752158119658128}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.78381471300443, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005627490012624356, "weights_seq_no": 79.0, "env_to_module_sum_episodes_length_in": 92.78381471300443, "env_step_timer": 0.11165688850504281, "time_between_sampling": 9.625385277525847, "num_env_steps_sampled_lifetime_throughput": 49.15007387244264}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 8.583069188716763e-07, "mean_kl_loss": 0.004022620618343353, "weights_seq_no": 80.0, "vf_loss": 0.009180198423564434, "gradients_default_optimizer_global_norm": 0.23073901236057281, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4846592, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009180198423564434, "vf_explained_var": 0.028277099132537842, "entropy": 0.23339907824993134, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.002893757075071335, "policy_loss": -0.006286448333412409}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07981995640359923, "add_time_dim_to_batch_and_zero_pad": 3.2118922906815464e-05, "add_states_from_episodes_to_batch": 1.0943841172969597e-05, "general_advantage_estimation": 0.10493004833209392, "batch_individual_items": 0.04276587060899441, "add_observations_from_episodes_to_batch": 0.00034967706558388783, "add_one_ts_to_episodes_and_truncate": 0.007394095391739005, "numpy_to_tensor": 0.0011955067350400206}}, "connector_pipeline_timer": 0.237069609976922}, "num_env_steps_trained_lifetime": 76379424, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4846592, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.230475386771, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 160000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.15007387244264, "done": false, "training_iteration": 80, "trial_id": "8cacd_00000", "date": "2025-05-12_03-07-12", "timestamp": 1746983232, "time_this_iter_s": 40.63461637496948, "time_total_s": 2897.030069589615, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2897.030069589615, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 78.94210526315788, "ram_util_percent": 49.72807017543859}}
{"timers": {"training_iteration": 37.34604557677494, "restore_env_runners": 3.0880332379826525e-05, "training_step": 37.34555233226334, "env_runner_sampling_timer": 28.30540787209577, "learner_update_timer": 9.032000200264447, "synch_weights": 0.00713699397026076, "synch_env_connectors": 0.00871350820895597}, "env_runners": {"episode_return_mean": 0.7858087606837608, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012306260869240131, "get_actions": 0.0007308906780185768, "un_batch_to_individual_items": 7.051705254179965e-05, "listify_data_for_vector_env": 0.00013887706208598856, "tensor_to_numpy": 0.00024045037585528948, "remove_single_ts_time_rank_from_batch": 8.842308461021407e-06}}, "connector_pipeline_timer": 0.0016303177628612742}, "episode_return_max": 1.0964444444444457, "num_episodes_lifetime": 744, "episode_duration_sec_mean": 24.166969479875554, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016891373757594233, "add_time_dim_to_batch_and_zero_pad": 3.675104010191126e-05, "add_states_from_episodes_to_batch": 1.9719952763769432e-05, "batch_individual_items": 0.00010055119081155527, "add_observations_from_episodes_to_batch": 4.192156619320317e-05}}, "connector_pipeline_timer": 0.0006176135814902388}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 162000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 162000}, "sample": 27.48903880302739, "num_env_steps_sampled_lifetime": 162000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.35411111111111127, "agent_episode_returns_mean": {"default_agent": 0.7858087606837608}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7858087606837608}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.90513010586344, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005638205095838645, "weights_seq_no": 80.0, "env_to_module_sum_episodes_length_in": 92.90513010586344, "env_step_timer": 0.11150526332623137, "time_between_sampling": 9.630918772939681, "num_env_steps_sampled_lifetime_throughput": 47.86811558272194}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 8.583069188716763e-07, "mean_kl_loss": 0.006192321889102459, "weights_seq_no": 81.0, "vf_loss": 0.011193258687853813, "gradients_default_optimizer_global_norm": 0.28795677423477173, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4907136, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011193258687853813, "vf_explained_var": 0.10728275775909424, "entropy": 0.2478640228509903, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.02782268449664116, "policy_loss": 0.016629429534077644}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07983899286880582, "add_time_dim_to_batch_and_zero_pad": 3.2143693978532836e-05, "add_states_from_episodes_to_batch": 1.0946209436162122e-05, "general_advantage_estimation": 0.10450816986395925, "batch_individual_items": 0.04282361538129093, "add_observations_from_episodes_to_batch": 0.0003500647771074423, "add_one_ts_to_episodes_and_truncate": 0.007389292135644436, "numpy_to_tensor": 0.0011959191017276117}}, "connector_pipeline_timer": 0.23671967321718035}, "num_env_steps_trained_lifetime": 77332992, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4907136, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2348047509429, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 162000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.86811558272194, "done": false, "training_iteration": 81, "trial_id": "8cacd_00000", "date": "2025-05-12_03-07-53", "timestamp": 1746983273, "time_this_iter_s": 41.60226511955261, "time_total_s": 2938.6323347091675, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2938.6323347091675, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 76.18333333333334, "ram_util_percent": 49.778333333333336}}
{"timers": {"training_iteration": 37.387526884637204, "restore_env_runners": 3.0802529050556504e-05, "training_step": 37.38703349757071, "env_runner_sampling_timer": 28.339650564094818, "learner_update_timer": 9.039261982171793, "synch_weights": 0.007113349030562145, "synch_env_connectors": 0.008718330126870597}, "env_runners": {"episode_return_mean": 0.7908344017094021, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012330943509186918, "get_actions": 0.0007325446436088531, "un_batch_to_individual_items": 7.015729822731705e-05, "listify_data_for_vector_env": 0.00014007835161221091, "tensor_to_numpy": 0.0002399599399991443, "remove_single_ts_time_rank_from_batch": 8.751851475176867e-06}}, "connector_pipeline_timer": 0.001633567840423437}, "episode_return_max": 1.1577777777777793, "num_episodes_lifetime": 752, "episode_duration_sec_mean": 23.700256033346477, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016935144083021436, "add_time_dim_to_batch_and_zero_pad": 3.6931319746169973e-05, "add_states_from_episodes_to_batch": 1.9601489682932716e-05, "batch_individual_items": 0.00010073371310064056, "add_observations_from_episodes_to_batch": 4.235492301110247e-05}}, "connector_pipeline_timer": 0.0006189737134845612}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 164000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 164000}, "sample": 27.509723892316085, "num_env_steps_sampled_lifetime": 164000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.35411111111111127, "agent_episode_returns_mean": {"default_agent": 0.7908344017094021}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7908344017094021}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.0069057886725, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005656581933020562, "weights_seq_no": 81.0, "env_to_module_sum_episodes_length_in": 95.0069057886725, "env_step_timer": 0.11104311358144263, "time_between_sampling": 9.637175088409851, "num_env_steps_sampled_lifetime_throughput": 48.10580649350676}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.2915345943583816e-07, "mean_kl_loss": 0.0031010457314550877, "weights_seq_no": 82.0, "vf_loss": 0.017374303191900253, "gradients_default_optimizer_global_norm": 0.34178438782691956, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4967680, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017374303191900253, "vf_explained_var": 0.04241889715194702, "entropy": 0.19924986362457275, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0372164361178875, "policy_loss": -0.05459073558449745}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0798596374590679, "add_time_dim_to_batch_and_zero_pad": 3.21691477366653e-05, "add_states_from_episodes_to_batch": 1.094944594999912e-05, "general_advantage_estimation": 0.10408501810035412, "batch_individual_items": 0.04288381987108071, "add_observations_from_episodes_to_batch": 0.000350443616693967, "add_one_ts_to_episodes_and_truncate": 0.007384388275132532, "numpy_to_tensor": 0.001196311460407985}}, "connector_pipeline_timer": 0.23637240366163587}, "num_env_steps_trained_lifetime": 78286560, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 4967680, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2390244802928, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 164000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.10580649350676, "done": false, "training_iteration": 82, "trial_id": "8cacd_00000", "date": "2025-05-12_03-08-35", "timestamp": 1746983315, "time_this_iter_s": 41.513285398483276, "time_total_s": 2980.1456201076508, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2980.1456201076508, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 77.52033898305085, "ram_util_percent": 49.80338983050849}}
{"timers": {"training_iteration": 37.457047655260844, "restore_env_runners": 3.075250376008167e-05, "training_step": 37.45655422106501, "env_runner_sampling_timer": 28.397577177053865, "learner_update_timer": 9.050812290220078, "synch_weights": 0.007156156540256137, "synch_env_connectors": 0.008714329825607993}, "env_runners": {"episode_return_mean": 0.9362574786324805, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012315739906219812, "get_actions": 0.0007343678420655773, "un_batch_to_individual_items": 7.066828380191614e-05, "listify_data_for_vector_env": 0.00014008983278198444, "tensor_to_numpy": 0.00023894609865678993, "remove_single_ts_time_rank_from_batch": 8.61544017302798e-06}}, "connector_pipeline_timer": 0.0016352817583323415}, "episode_return_max": 1.2110000000000034, "num_episodes_lifetime": 768, "episode_duration_sec_mean": 23.84427922806769, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016887839963844426, "add_time_dim_to_batch_and_zero_pad": 3.68160735618905e-05, "add_states_from_episodes_to_batch": 1.9617263670413047e-05, "batch_individual_items": 0.00010099789257732502, "add_observations_from_episodes_to_batch": 4.251420848351955e-05}}, "connector_pipeline_timer": 0.000620849335184903}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 166000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 166000}, "sample": 27.53303475036012, "num_env_steps_sampled_lifetime": 166000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5898888888888891, "agent_episode_returns_mean": {"default_agent": 0.9362574786324805}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9362574786324805}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.02117502892946, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005673640554608789, "weights_seq_no": 82.0, "env_to_module_sum_episodes_length_in": 97.02117502892946, "env_step_timer": 0.1126058493674218, "time_between_sampling": 9.643901737505365, "num_env_steps_sampled_lifetime_throughput": 44.98579141513713}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.1457672971791908e-07, "mean_kl_loss": 0.0038360548205673695, "weights_seq_no": 83.0, "vf_loss": 0.0243717972189188, "gradients_default_optimizer_global_norm": 0.30925771594047546, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 5028480, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0243717972189188, "vf_explained_var": 0.10667151212692261, "entropy": 0.19796594977378845, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.019567614421248436, "policy_loss": -0.0048041874542832375}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0798805361882378, "add_time_dim_to_batch_and_zero_pad": 3.21933980501445e-05, "add_states_from_episodes_to_batch": 1.095265311248899e-05, "general_advantage_estimation": 0.10366070861503474, "batch_individual_items": 0.0429431694195366, "add_observations_from_episodes_to_batch": 0.0003508391830111929, "add_one_ts_to_episodes_and_truncate": 0.007379464642617319, "numpy_to_tensor": 0.0011966844900045063}}, "connector_pipeline_timer": 0.23602334512988069}, "num_env_steps_trained_lifetime": 79247960, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 5028480, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2439363345804, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 166000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.98579141513713, "done": false, "training_iteration": 83, "trial_id": "8cacd_00000", "date": "2025-05-12_03-09-19", "timestamp": 1746983359, "time_this_iter_s": 44.35638475418091, "time_total_s": 3024.5020048618317, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3024.5020048618317, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 78.43333333333335, "ram_util_percent": 49.79047619047617}}
{"timers": {"training_iteration": 37.48664663935825, "restore_env_runners": 3.066497872419914e-05, "training_step": 37.48615351250437, "env_runner_sampling_timer": 28.42537719002333, "learner_update_timer": 9.052634084227861, "synch_weights": 0.007133565974850103, "synch_env_connectors": 0.008722608527346784}, "env_runners": {"episode_return_mean": 0.8967692307692331, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012345820621297574, "get_actions": 0.0007330621986437856, "un_batch_to_individual_items": 7.21104488375571e-05, "listify_data_for_vector_env": 0.00014034528773932515, "tensor_to_numpy": 0.0002398167968023635, "remove_single_ts_time_rank_from_batch": 8.563593000216542e-06}}, "connector_pipeline_timer": 0.0016376269578630609}, "episode_return_max": 1.2110000000000034, "num_episodes_lifetime": 776, "episode_duration_sec_mean": 23.712542847240805, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001689106385561414, "add_time_dim_to_batch_and_zero_pad": 3.7309047193394014e-05, "add_states_from_episodes_to_batch": 1.9663177007644874e-05, "batch_individual_items": 0.00010189772453754167, "add_observations_from_episodes_to_batch": 4.255544555189912e-05}}, "connector_pipeline_timer": 0.0006233570502964896}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 168000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 168000}, "sample": 27.55661128126612, "num_env_steps_sampled_lifetime": 168000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5586666666666671, "agent_episode_returns_mean": {"default_agent": 0.8967692307692331}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8967692307692331}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.53420185186458, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000569061140206373, "weights_seq_no": 83.0, "env_to_module_sum_episodes_length_in": 96.53420185186458, "env_step_timer": 0.11346518806036757, "time_between_sampling": 9.65125248058247, "num_env_steps_sampled_lifetime_throughput": 49.37273146285305}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.1457672971791908e-07, "mean_kl_loss": 0.006146018858999014, "weights_seq_no": 84.0, "vf_loss": 0.01782631315290928, "gradients_default_optimizer_global_norm": 0.32507097721099854, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5089024, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01782631315290928, "vf_explained_var": 0.1506931185722351, "entropy": 0.20896455645561218, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.04237774387001991, "policy_loss": -0.060204047709703445}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07990150829907841, "add_time_dim_to_batch_and_zero_pad": 3.221649644271612e-05, "add_states_from_episodes_to_batch": 1.09557011871088e-05, "general_advantage_estimation": 0.10323540956751165, "batch_individual_items": 0.04301600948503616, "add_observations_from_episodes_to_batch": 0.00035122362364048486, "add_one_ts_to_episodes_and_truncate": 0.007374652703924958, "numpy_to_tensor": 0.001197060657862979}}, "connector_pipeline_timer": 0.2356869592482944}, "num_env_steps_trained_lifetime": 80201528, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5089024, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2487260493344, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 168000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.37273146285305, "done": false, "training_iteration": 84, "trial_id": "8cacd_00000", "date": "2025-05-12_03-10-00", "timestamp": 1746983400, "time_this_iter_s": 40.43395280838013, "time_total_s": 3064.935957670212, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3064.935957670212, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 78.32931034482758, "ram_util_percent": 49.76206896551725}}
{"timers": {"training_iteration": 37.52348257970467, "restore_env_runners": 3.0602328939524344e-05, "training_step": 37.52298951011933, "env_runner_sampling_timer": 28.454125752913097, "learner_update_timer": 9.060699061335596, "synch_weights": 0.007145286315104728, "synch_env_connectors": 0.008717764442073823}, "env_runners": {"episode_return_mean": 0.8900438034188056, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001237102175788497, "get_actions": 0.0007351417811934159, "un_batch_to_individual_items": 7.278605037999086e-05, "listify_data_for_vector_env": 0.0001400509161056248, "tensor_to_numpy": 0.0002412924345709658, "remove_single_ts_time_rank_from_batch": 8.787263441056278e-06}}, "connector_pipeline_timer": 0.0016420271798361966}, "episode_return_max": 1.2135555555555588, "num_episodes_lifetime": 784, "episode_duration_sec_mean": 23.565916853452073, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016953882596590036, "add_time_dim_to_batch_and_zero_pad": 3.716039432079132e-05, "add_states_from_episodes_to_batch": 1.9831302593274256e-05, "batch_individual_items": 0.000102190780119405, "add_observations_from_episodes_to_batch": 4.276345911483143e-05}}, "connector_pipeline_timer": 0.000624046292634804}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 170000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 170000}, "sample": 27.580521752257614, "num_env_steps_sampled_lifetime": 170000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5557777777777778, "agent_episode_returns_mean": {"default_agent": 0.8900438034188056}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8900438034188056}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.608640332734, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005703013762553507, "weights_seq_no": 84.0, "env_to_module_sum_episodes_length_in": 94.608640332734, "env_step_timer": 0.11380961431401661, "time_between_sampling": 9.658243225498472, "num_env_steps_sampled_lifetime_throughput": 48.4886064117948}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.0728836485895954e-07, "mean_kl_loss": 0.0049248021095991135, "weights_seq_no": 85.0, "vf_loss": 0.014910664409399033, "gradients_default_optimizer_global_norm": 0.184080570936203, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5149568, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014910664409399033, "vf_explained_var": 0.02665233612060547, "entropy": 0.21649666130542755, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.12765349447727203, "policy_loss": 0.1127428337931633}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07992214408408342, "add_time_dim_to_batch_and_zero_pad": 3.2238723527563944e-05, "add_states_from_episodes_to_batch": 1.0958823034832048e-05, "general_advantage_estimation": 0.10280897443007742, "batch_individual_items": 0.043087466452283806, "add_observations_from_episodes_to_batch": 0.0003516150415388154, "add_one_ts_to_episodes_and_truncate": 0.00736979910754214, "numpy_to_tensor": 0.0011974269739152786}}, "connector_pipeline_timer": 0.23534768073982681}, "num_env_steps_trained_lifetime": 81155096, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5149568, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2533955761598, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 170000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.4886064117948, "done": false, "training_iteration": 85, "trial_id": "8cacd_00000", "date": "2025-05-12_03-10-41", "timestamp": 1746983441, "time_this_iter_s": 41.18762469291687, "time_total_s": 3106.1235823631287, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3106.1235823631287, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 78.57068965517242, "ram_util_percent": 49.81551724137931}}
{"timers": {"training_iteration": 37.548973308787616, "restore_env_runners": 3.074330565229745e-05, "training_step": 37.54847907389813, "env_runner_sampling_timer": 28.474902555093955, "learner_update_timer": 9.065416774892238, "synch_weights": 0.007135777451961905, "synch_env_connectors": 0.008722378797655982}, "env_runners": {"episode_return_mean": 0.9379123931623946, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012343915191548882, "get_actions": 0.000736388951833469, "un_batch_to_individual_items": 7.301979652224816e-05, "listify_data_for_vector_env": 0.00013979376800012843, "tensor_to_numpy": 0.00024124051930991366, "remove_single_ts_time_rank_from_batch": 8.70298960138466e-06}}, "connector_pipeline_timer": 0.00164320473870483}, "episode_return_max": 1.2673333333333348, "num_episodes_lifetime": 792, "episode_duration_sec_mean": 23.49609678040378, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016974523347015516, "add_time_dim_to_batch_and_zero_pad": 3.717002726270578e-05, "add_states_from_episodes_to_batch": 2.016257180683783e-05, "batch_individual_items": 0.00010261580103934386, "add_observations_from_episodes_to_batch": 4.264922648121316e-05}}, "connector_pipeline_timer": 0.0006253367537681502}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 172000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 172000}, "sample": 27.604067300545026, "num_env_steps_sampled_lifetime": 172000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.43911111111111134, "agent_episode_returns_mean": {"default_agent": 0.9379123931623946}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9379123931623946}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.88862254498575, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005695108833617856, "weights_seq_no": 85.0, "env_to_module_sum_episodes_length_in": 92.88862254498575, "env_step_timer": 0.11363489802976967, "time_between_sampling": 9.665374777764832, "num_env_steps_sampled_lifetime_throughput": 49.80815531284964}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.364418242947977e-08, "mean_kl_loss": 0.002259258646517992, "weights_seq_no": 86.0, "vf_loss": 0.012712321244180202, "gradients_default_optimizer_global_norm": 0.34755581617355347, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5210112, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012712321244180202, "vf_explained_var": 0.07833337783813477, "entropy": 0.20715895295143127, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.022741049528121948, "policy_loss": -0.03545336425304413}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07994255156245841, "add_time_dim_to_batch_and_zero_pad": 3.226020442093129e-05, "add_states_from_episodes_to_batch": 1.096180687542725e-05, "general_advantage_estimation": 0.10238246780443501, "batch_individual_items": 0.04315735812923789, "add_observations_from_episodes_to_batch": 0.0003519948287168317, "add_one_ts_to_episodes_and_truncate": 0.0073648482578164845, "numpy_to_tensor": 0.0011978291775807486}}, "connector_pipeline_timer": 0.23500647039550382}, "num_env_steps_trained_lifetime": 82108664, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5210112, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.257946839844, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 172000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.80815531284964, "done": false, "training_iteration": 86, "trial_id": "8cacd_00000", "date": "2025-05-12_03-11-21", "timestamp": 1746983481, "time_this_iter_s": 40.09022068977356, "time_total_s": 3146.213803052902, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3146.213803052902, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 77.9298245614035, "ram_util_percent": 49.82631578947369}}
{"timers": {"training_iteration": 37.583045588629744, "restore_env_runners": 3.078387258989364e-05, "training_step": 37.58254968508916, "env_runner_sampling_timer": 28.499015285213, "learner_update_timer": 9.075387828403313, "synch_weights": 0.00712262367743949, "synch_env_connectors": 0.008720261999670314}, "env_runners": {"episode_return_mean": 0.7526634615384619, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012318712134186017, "get_actions": 0.0007392017103485983, "un_batch_to_individual_items": 7.300687022293695e-05, "listify_data_for_vector_env": 0.0001404726640613559, "tensor_to_numpy": 0.00024043641281077833, "remove_single_ts_time_rank_from_batch": 8.684402465654562e-06}}, "connector_pipeline_timer": 0.0016466349127878875}, "episode_return_max": 1.2673333333333348, "num_episodes_lifetime": 800, "episode_duration_sec_mean": 23.43368350843235, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016900199005003827, "add_time_dim_to_batch_and_zero_pad": 3.7109684961621974e-05, "add_states_from_episodes_to_batch": 2.0030065553813303e-05, "batch_individual_items": 0.00010289296975857073, "add_observations_from_episodes_to_batch": 4.24100601525953e-05}}, "connector_pipeline_timer": 0.0006238894949673899}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 174000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 174000}, "sample": 27.627539558224974, "num_env_steps_sampled_lifetime": 174000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.43911111111111134, "agent_episode_returns_mean": {"default_agent": 0.7526634615384619}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7526634615384619}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.42542975819296, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005685207978837073, "weights_seq_no": 86.0, "env_to_module_sum_episodes_length_in": 92.42542975819296, "env_step_timer": 0.11322159571603532, "time_between_sampling": 9.67243005211595, "num_env_steps_sampled_lifetime_throughput": 48.740896301170125}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.6822091214739885e-08, "mean_kl_loss": 0.002954866038635373, "weights_seq_no": 87.0, "vf_loss": 0.013101289980113506, "gradients_default_optimizer_global_norm": 0.30117496848106384, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5270656, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013101289980113506, "vf_explained_var": 0.06563466787338257, "entropy": 0.1978100836277008, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.012529000639915466, "policy_loss": -0.0005722939968109131}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07996257917675748, "add_time_dim_to_batch_and_zero_pad": 3.2280911823998504e-05, "add_states_from_episodes_to_batch": 1.0964675157004482e-05, "general_advantage_estimation": 0.10195500629376247, "batch_individual_items": 0.0432258338759077, "add_observations_from_episodes_to_batch": 0.00035236463864698965, "add_one_ts_to_episodes_and_truncate": 0.0073598311151745425, "numpy_to_tensor": 0.0011982073144754877}}, "connector_pipeline_timer": 0.23466240450969328}, "num_env_steps_trained_lifetime": 83062232, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5270656, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2623817386966, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 174000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.740896301170125, "done": false, "training_iteration": 87, "trial_id": "8cacd_00000", "date": "2025-05-12_03-12-02", "timestamp": 1746983522, "time_this_iter_s": 40.97502899169922, "time_total_s": 3187.1888320446014, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3187.1888320446014, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 77.53275862068966, "ram_util_percent": 49.82413793103449}}
{"timers": {"training_iteration": 37.62583122187344, "restore_env_runners": 3.0811033850074924e-05, "training_step": 37.62533391236827, "env_runner_sampling_timer": 28.53010738125087, "learner_update_timer": 9.087097676359283, "synch_weights": 0.007106630440649677, "synch_env_connectors": 0.008709905379666268}, "env_runners": {"episode_return_mean": 0.8155106837606844, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001233405519032062, "get_actions": 0.0007414115866601133, "un_batch_to_individual_items": 7.29825937366621e-05, "listify_data_for_vector_env": 0.00014072715898576124, "tensor_to_numpy": 0.000241330068435641, "remove_single_ts_time_rank_from_batch": 8.57521883553964e-06}}, "connector_pipeline_timer": 0.0016515093755607377}, "episode_return_max": 1.1077777777777795, "num_episodes_lifetime": 808, "episode_duration_sec_mean": 23.187862195471045, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016951417686542444, "add_time_dim_to_batch_and_zero_pad": 3.708151134321637e-05, "add_states_from_episodes_to_batch": 2.0056783543716803e-05, "batch_individual_items": 0.00010250019955761941, "add_observations_from_episodes_to_batch": 4.2304980665705786e-05}}, "connector_pipeline_timer": 0.0006236260905779569}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 176000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 176000}, "sample": 27.651336633334516, "num_env_steps_sampled_lifetime": 176000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4582222222222227, "agent_episode_returns_mean": {"default_agent": 0.8155106837606844}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8155106837606844}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.81056662882152, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005710846456918994, "weights_seq_no": 87.0, "env_to_module_sum_episodes_length_in": 93.81056662882152, "env_step_timer": 0.11297598224784462, "time_between_sampling": 9.67981660136307, "num_env_steps_sampled_lifetime_throughput": 47.68583843554952}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.3411045607369942e-08, "mean_kl_loss": 0.0031529671978205442, "weights_seq_no": 88.0, "vf_loss": 0.01126976776868105, "gradients_default_optimizer_global_norm": 0.282988578081131, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5331200, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01126976776868105, "vf_explained_var": 0.045438408851623535, "entropy": 0.17000679671764374, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1401202529668808, "policy_loss": 0.12885050475597382}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07998359780351426, "add_time_dim_to_batch_and_zero_pad": 3.2301109058384984e-05, "add_states_from_episodes_to_batch": 1.0967479892376973e-05, "general_advantage_estimation": 0.10152685517652285, "batch_individual_items": 0.04329332503183117, "add_observations_from_episodes_to_batch": 0.00035272532289568943, "add_one_ts_to_episodes_and_truncate": 0.007354724310559706, "numpy_to_tensor": 0.0011985774357146262}}, "connector_pipeline_timer": 0.23431754371445934}, "num_env_steps_trained_lifetime": 84015800, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5331200, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2667021448883, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 176000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.68583843554952, "done": false, "training_iteration": 88, "trial_id": "8cacd_00000", "date": "2025-05-12_03-12-44", "timestamp": 1746983564, "time_this_iter_s": 41.883930683135986, "time_total_s": 3229.0727627277374, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3229.0727627277374, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 76.64833333333333, "ram_util_percent": 49.845}}
{"timers": {"training_iteration": 37.71215756326471, "restore_env_runners": 3.0780923518375624e-05, "training_step": 37.71165603985458, "env_runner_sampling_timer": 28.605539933198365, "learner_update_timer": 9.097981334435689, "synch_weights": 0.0071120711362374885, "synch_env_connectors": 0.008725630325874662}, "env_runners": {"episode_return_mean": 0.9467393162393184, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012403227955848101, "get_actions": 0.0007438046227234754, "un_batch_to_individual_items": 7.276816067901705e-05, "listify_data_for_vector_env": 0.00014142459109800794, "tensor_to_numpy": 0.000244850715630041, "remove_single_ts_time_rank_from_batch": 8.481094873281735e-06}}, "connector_pipeline_timer": 0.001660398923559994}, "episode_return_max": 1.3554444444444487, "num_episodes_lifetime": 824, "episode_duration_sec_mean": 24.47259716465377, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017256220227182672, "add_time_dim_to_batch_and_zero_pad": 3.728332968877405e-05, "add_states_from_episodes_to_batch": 2.0025530570479003e-05, "batch_individual_items": 0.00010322166301667813, "add_observations_from_episodes_to_batch": 4.221107206894062e-05}}, "connector_pipeline_timer": 0.0006292454015307356}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 178000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 178000}, "sample": 27.678288734996926, "num_env_steps_sampled_lifetime": 178000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5200000000000005, "agent_episode_returns_mean": {"default_agent": 0.9467393162393184}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9467393162393184}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.90022545175088, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005735923096258079, "weights_seq_no": 88.0, "env_to_module_sum_episodes_length_in": 96.90022545175088, "env_step_timer": 0.11489523713080109, "time_between_sampling": 9.687802108992239, "num_env_steps_sampled_lifetime_throughput": 43.14732002451233}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.3411045607369942e-08, "mean_kl_loss": 0.0060055991634726524, "weights_seq_no": 89.0, "vf_loss": 0.02349027805030346, "gradients_default_optimizer_global_norm": 0.26752591133117676, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 5392000, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.02349027805030346, "vf_explained_var": 0.07857710123062134, "entropy": 0.1738957315683365, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.05166950821876526, "policy_loss": 0.028179235756397247}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08000486302981834, "add_time_dim_to_batch_and_zero_pad": 3.232034425685935e-05, "add_states_from_episodes_to_batch": 1.0970142065577196e-05, "general_advantage_estimation": 0.10109773099099857, "batch_individual_items": 0.043359498781148566, "add_observations_from_episodes_to_batch": 0.00035309139699548427, "add_one_ts_to_episodes_and_truncate": 0.007349819228925812, "numpy_to_tensor": 0.0011989398237977136}}, "connector_pipeline_timer": 0.23397083400457913}, "num_env_steps_trained_lifetime": 84977200, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 5392000, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2717099047823, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 178000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.14732002451233, "done": false, "training_iteration": 89, "trial_id": "8cacd_00000", "date": "2025-05-12_03-13-31", "timestamp": 1746983611, "time_this_iter_s": 46.27766704559326, "time_total_s": 3275.3504297733307, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3275.3504297733307, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 77.42272727272729, "ram_util_percent": 49.92575757575757}}
{"timers": {"training_iteration": 37.749924358972045, "restore_env_runners": 3.078911428830576e-05, "training_step": 37.74942224279602, "env_runner_sampling_timer": 28.632264151326382, "learner_update_timer": 9.108973818971334, "synch_weights": 0.007162578424872258, "synch_env_connectors": 0.008737473022615029}, "env_runners": {"episode_return_mean": 0.9857329059829086, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012405128041084146, "get_actions": 0.0007459578982645752, "un_batch_to_individual_items": 7.256989434136636e-05, "listify_data_for_vector_env": 0.00014328422139389077, "tensor_to_numpy": 0.0002445148656302773, "remove_single_ts_time_rank_from_batch": 8.668196973176314e-06}}, "connector_pipeline_timer": 0.0016663234097993081}, "episode_return_max": 1.3554444444444487, "num_episodes_lifetime": 832, "episode_duration_sec_mean": 24.246886546163225, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017329924941094878, "add_time_dim_to_batch_and_zero_pad": 3.7301973620285306e-05, "add_states_from_episodes_to_batch": 2.022337991636768e-05, "batch_individual_items": 0.00010312111939103516, "add_observations_from_episodes_to_batch": 4.188445646001987e-05}}, "connector_pipeline_timer": 0.0006315691220209042}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 180000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 180000}, "sample": 27.70535442392745, "num_env_steps_sampled_lifetime": 180000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4896666666666663, "agent_episode_returns_mean": {"default_agent": 0.9857329059829086}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9857329059829086}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.4420415897247, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005759063812605303, "weights_seq_no": 89.0, "env_to_module_sum_episodes_length_in": 97.4420415897247, "env_step_timer": 0.11599723949478573, "time_between_sampling": 9.696831534034938, "num_env_steps_sampled_lifetime_throughput": 48.11909016066497}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.705522803684971e-09, "mean_kl_loss": 0.003713929560035467, "weights_seq_no": 90.0, "vf_loss": 0.022404629737138748, "gradients_default_optimizer_global_norm": 0.3326927423477173, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5452544, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.022404629737138748, "vf_explained_var": 0.08540874719619751, "entropy": 0.17959406971931458, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.04074191674590111, "policy_loss": 0.018337277695536613}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08002646766181613, "add_time_dim_to_batch_and_zero_pad": 3.2338894640577184e-05, "add_states_from_episodes_to_batch": 1.097279424727355e-05, "general_advantage_estimation": 0.100668493403667, "batch_individual_items": 0.04342453439297645, "add_observations_from_episodes_to_batch": 0.0003534765970811152, "add_one_ts_to_episodes_and_truncate": 0.007344883556493629, "numpy_to_tensor": 0.0011993454563755754}}, "connector_pipeline_timer": 0.23362325648452506}, "num_env_steps_trained_lifetime": 85930768, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5452544, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.276590839264, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 180000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.11909016066497, "done": false, "training_iteration": 90, "trial_id": "8cacd_00000", "date": "2025-05-12_03-14-12", "timestamp": 1746983652, "time_this_iter_s": 41.507121324539185, "time_total_s": 3316.85755109787, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3316.85755109787, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 77.92203389830509, "ram_util_percent": 49.918644067796606}}
{"timers": {"training_iteration": 37.78098918646233, "restore_env_runners": 3.073922314545344e-05, "training_step": 37.780486701448055, "env_runner_sampling_timer": 28.668369390803115, "learner_update_timer": 9.103949151871635, "synch_weights": 0.007145905640622467, "synch_env_connectors": 0.008744150292392892}, "env_runners": {"episode_return_mean": 0.8907457264957286, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001233864152459195, "get_actions": 0.0007475754462699948, "un_batch_to_individual_items": 7.243875347356264e-05, "listify_data_for_vector_env": 0.00014298892803029495, "tensor_to_numpy": 0.0002457636842591017, "remove_single_ts_time_rank_from_batch": 8.664522506496554e-06}}, "connector_pipeline_timer": 0.0016693298511062363}, "episode_return_max": 1.3121111111111141, "num_episodes_lifetime": 840, "episode_duration_sec_mean": 24.018864618461677, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017320433565695765, "add_time_dim_to_batch_and_zero_pad": 3.723064381648884e-05, "add_states_from_episodes_to_batch": 2.0020033598471053e-05, "batch_individual_items": 0.00010275478811723539, "add_observations_from_episodes_to_batch": 4.189463043506833e-05}}, "connector_pipeline_timer": 0.0006329778746219377}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 182000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 182000}, "sample": 27.73248145229658, "num_env_steps_sampled_lifetime": 182000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4896666666666663, "agent_episode_returns_mean": {"default_agent": 0.8907457264957286}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8907457264957286}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.78194018147093, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005786131301927416, "weights_seq_no": 90.0, "env_to_module_sum_episodes_length_in": 95.78194018147093, "env_step_timer": 0.11631248588928157, "time_between_sampling": 9.705976290146134, "num_env_steps_sampled_lifetime_throughput": 48.69898256503856}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.3527614018424856e-09, "mean_kl_loss": 0.002488601952791214, "weights_seq_no": 91.0, "vf_loss": 0.01268833503127098, "gradients_default_optimizer_global_norm": 0.3191940486431122, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5513088, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01268833503127098, "vf_explained_var": 0.10564535856246948, "entropy": 0.1896076500415802, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0772404745221138, "policy_loss": -0.08992880582809448}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08004741328487107, "add_time_dim_to_batch_and_zero_pad": 3.235683198222494e-05, "add_states_from_episodes_to_batch": 1.0975346371121085e-05, "general_advantage_estimation": 0.10023911434498294, "batch_individual_items": 0.043488276062689686, "add_observations_from_episodes_to_batch": 0.00035385070402518977, "add_one_ts_to_episodes_and_truncate": 0.007339863305587262, "numpy_to_tensor": 0.0011997626723195718}}, "connector_pipeline_timer": 0.2332734980614715}, "num_env_steps_trained_lifetime": 86884336, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5513088, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2813469840653, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 182000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.69898256503856, "done": false, "training_iteration": 91, "trial_id": "8cacd_00000", "date": "2025-05-12_03-14-53", "timestamp": 1746983693, "time_this_iter_s": 40.87584948539734, "time_total_s": 3357.733400583267, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3357.733400583267, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 78.66724137931034, "ram_util_percent": 49.943103448275856}}
{"timers": {"training_iteration": 37.81253998146771, "restore_env_runners": 3.070483090091778e-05, "training_step": 37.812037173303565, "env_runner_sampling_timer": 28.701958877295084, "learner_update_timer": 9.101915803822916, "synch_weights": 0.00713901158420955, "synch_env_connectors": 0.008759896779476391}, "env_runners": {"episode_return_mean": 0.7923397435897447, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012384855643032832, "get_actions": 0.000752694225230128, "un_batch_to_individual_items": 7.202649048729799e-05, "listify_data_for_vector_env": 0.00014565278721954286, "tensor_to_numpy": 0.0002460654109784548, "remove_single_ts_time_rank_from_batch": 8.54016026274095e-06}}, "connector_pipeline_timer": 0.0016782584724715254}, "episode_return_max": 1.3121111111111141, "num_episodes_lifetime": 848, "episode_duration_sec_mean": 23.845301431365126, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001729638144373411, "add_time_dim_to_batch_and_zero_pad": 3.7057725688643334e-05, "add_states_from_episodes_to_batch": 1.9921305525103448e-05, "batch_individual_items": 0.00010170073821726173, "add_observations_from_episodes_to_batch": 4.168135462458386e-05}}, "connector_pipeline_timer": 0.000632972480452369}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 184000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 184000}, "sample": 27.76024939746385, "num_env_steps_sampled_lifetime": 184000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4900000000000001, "agent_episode_returns_mean": {"default_agent": 0.7923397435897447}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7923397435897447}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.80632166240274, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005809645333364596, "weights_seq_no": 91.0, "env_to_module_sum_episodes_length_in": 93.80632166240274, "env_step_timer": 0.11668115500606617, "time_between_sampling": 9.714659200324007, "num_env_steps_sampled_lifetime_throughput": 48.75101474634078}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.6763807009212428e-09, "mean_kl_loss": 0.0018936198903247714, "weights_seq_no": 92.0, "vf_loss": 0.009080309420824051, "gradients_default_optimizer_global_norm": 0.41524738073349, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5573632, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009080309420824051, "vf_explained_var": 0.09406107664108276, "entropy": 0.1551983803510666, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.02525508403778076, "policy_loss": -0.03433539345860481}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08006827014859873, "add_time_dim_to_batch_and_zero_pad": 3.237945668750476e-05, "add_states_from_episodes_to_batch": 1.0977850173075532e-05, "general_advantage_estimation": 0.09980970138813235, "batch_individual_items": 0.043550695545569486, "add_observations_from_episodes_to_batch": 0.00035421469117072514, "add_one_ts_to_episodes_and_truncate": 0.007334805141343436, "numpy_to_tensor": 0.001200254359399113}}, "connector_pipeline_timer": 0.23292234790113048}, "num_env_steps_trained_lifetime": 87837904, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5573632, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2859803468868, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 184000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.75101474634078, "done": false, "training_iteration": 92, "trial_id": "8cacd_00000", "date": "2025-05-12_03-15-34", "timestamp": 1746983734, "time_this_iter_s": 40.95861101150513, "time_total_s": 3398.6920115947723, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3398.6920115947723, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 80.53275862068966, "ram_util_percent": 50.096551724137925}}
{"timers": {"training_iteration": 37.84741911291302, "restore_env_runners": 3.069078260378809e-05, "training_step": 37.84691502283054, "env_runner_sampling_timer": 28.726102843142133, "learner_update_timer": 9.112627906424695, "synch_weights": 0.007152692468361514, "synch_env_connectors": 0.008794414811673331}, "env_runners": {"episode_return_mean": 0.8371025641025646, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012433699046738133, "get_actions": 0.0007536566608673338, "un_batch_to_individual_items": 7.18430575433445e-05, "listify_data_for_vector_env": 0.00014626535292184016, "tensor_to_numpy": 0.000246082285054804, "remove_single_ts_time_rank_from_batch": 8.501172719195803e-06}}, "connector_pipeline_timer": 0.0016816633810686637}, "episode_return_max": 1.2043333333333344, "num_episodes_lifetime": 856, "episode_duration_sec_mean": 24.148792691932247, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017312321665245456, "add_time_dim_to_batch_and_zero_pad": 3.7309444020073115e-05, "add_states_from_episodes_to_batch": 2.0025955725619652e-05, "batch_individual_items": 0.00010256076369390108, "add_observations_from_episodes_to_batch": 4.1816613155644063e-05}}, "connector_pipeline_timer": 0.0006350459437833091}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 186000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 186000}, "sample": 27.787787648754076, "num_env_steps_sampled_lifetime": 186000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.4900000000000001, "agent_episode_returns_mean": {"default_agent": 0.8371025641025646}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8371025641025646}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.78049866229672, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005841092269820921, "weights_seq_no": 92.0, "env_to_module_sum_episodes_length_in": 92.78049866229672, "env_step_timer": 0.11641312149313744, "time_between_sampling": 9.72236782737701, "num_env_steps_sampled_lifetime_throughput": 48.320669929163415}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.6763807009212428e-09, "mean_kl_loss": 0.00877402164041996, "weights_seq_no": 93.0, "vf_loss": 0.008689865469932556, "gradients_default_optimizer_global_norm": 0.473899781703949, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5634176, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008689865469932556, "vf_explained_var": 0.1728878617286682, "entropy": 0.27503594756126404, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1747574359178543, "policy_loss": 0.16606758534908295}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0800898236737234, "add_time_dim_to_batch_and_zero_pad": 3.240128321547687e-05, "add_states_from_episodes_to_batch": 1.0980266364239688e-05, "general_advantage_estimation": 0.09938023955898428, "batch_individual_items": 0.0436120942511854, "add_observations_from_episodes_to_batch": 0.00035458582350296594, "add_one_ts_to_episodes_and_truncate": 0.007329718764053864, "numpy_to_tensor": 0.0012007363864699428}}, "connector_pipeline_timer": 0.23257084332419012}, "num_env_steps_trained_lifetime": 88791472, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5634176, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2904929077536, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 186000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.320669929163415, "done": false, "training_iteration": 93, "trial_id": "8cacd_00000", "date": "2025-05-12_03-16-16", "timestamp": 1746983776, "time_this_iter_s": 41.324501037597656, "time_total_s": 3440.01651263237, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3440.01651263237, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 77.28474576271186, "ram_util_percent": 50.24576271186441}}
{"timers": {"training_iteration": 37.88279226838391, "restore_env_runners": 3.093487477147053e-05, "training_step": 37.88228659020223, "env_runner_sampling_timer": 28.754292676630712, "learner_update_timer": 9.119807196040457, "synch_weights": 0.0071543205436688465, "synch_env_connectors": 0.00883072066354644}, "env_runners": {"episode_return_mean": 0.8142991452991458, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012534938373384792, "get_actions": 0.000753869839325664, "un_batch_to_individual_items": 7.194403716902152e-05, "listify_data_for_vector_env": 0.00014638567437022927, "tensor_to_numpy": 0.0002457914712533116, "remove_single_ts_time_rank_from_batch": 8.755791677041162e-06}}, "connector_pipeline_timer": 0.001685944291113481}, "episode_return_max": 1.2043333333333344, "num_episodes_lifetime": 864, "episode_duration_sec_mean": 24.135745194711717, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017280066056843453, "add_time_dim_to_batch_and_zero_pad": 3.7420456251214005e-05, "add_states_from_episodes_to_batch": 1.9851036274057658e-05, "batch_individual_items": 0.00010244926137524795, "add_observations_from_episodes_to_batch": 4.167114560555449e-05}}, "connector_pipeline_timer": 0.0006348504843603844}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 188000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 188000}, "sample": 27.815280375883482, "num_env_steps_sampled_lifetime": 188000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5600000000000002, "agent_episode_returns_mean": {"default_agent": 0.8142991452991458}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8142991452991458}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.43796344050888, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000587015367243755, "weights_seq_no": 93.0, "env_to_module_sum_episodes_length_in": 93.43796344050888, "env_step_timer": 0.11602663398768234, "time_between_sampling": 9.730273740999225, "num_env_steps_sampled_lifetime_throughput": 48.197921341162484}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 8.381903504606214e-10, "mean_kl_loss": 0.003167532617226243, "weights_seq_no": 94.0, "vf_loss": 0.016836393624544144, "gradients_default_optimizer_global_norm": 0.26721951365470886, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5694720, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.016836393624544144, "vf_explained_var": -0.015149116516113281, "entropy": 0.18621701002120972, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.018511231988668442, "policy_loss": 0.0016748374328017235}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08011142176123073, "add_time_dim_to_batch_and_zero_pad": 3.242255526714925e-05, "add_states_from_episodes_to_batch": 1.0982636446389947e-05, "general_advantage_estimation": 0.09895022815628034, "batch_individual_items": 0.04367234509313456, "add_observations_from_episodes_to_batch": 0.00035494530171938083, "add_one_ts_to_episodes_and_truncate": 0.0073245645037959915, "numpy_to_tensor": 0.0012011918775634413}}, "connector_pipeline_timer": 0.23221757745389837}, "num_env_steps_trained_lifetime": 89745040, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5694720, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.2948866193683, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 188000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.197921341162484, "done": false, "training_iteration": 94, "trial_id": "8cacd_00000", "date": "2025-05-12_03-16-57", "timestamp": 1746983817, "time_this_iter_s": 41.404266595840454, "time_total_s": 3481.4207792282104, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3481.4207792282104, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 77.88305084745764, "ram_util_percent": 50.52203389830508}}
{"timers": {"training_iteration": 37.91469340761007, "restore_env_runners": 3.088652601025025e-05, "training_step": 37.91418705021021, "env_runner_sampling_timer": 28.785280302864408, "learner_update_timer": 9.120729281990046, "synch_weights": 0.007143352338220761, "synch_env_connectors": 0.008855679456900356}, "env_runners": {"episode_return_mean": 0.8474145299145305, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012532038589945922, "get_actions": 0.0007569748512907488, "un_batch_to_individual_items": 7.202937612496746e-05, "listify_data_for_vector_env": 0.0001467139803982484, "tensor_to_numpy": 0.00024699675525427517, "remove_single_ts_time_rank_from_batch": 8.657173416738176e-06}}, "connector_pipeline_timer": 0.0016915431746800502}, "episode_return_max": 1.3573333333333353, "num_episodes_lifetime": 872, "episode_duration_sec_mean": 23.95592643319205, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017302051169967611, "add_time_dim_to_batch_and_zero_pad": 3.747519715439043e-05, "add_states_from_episodes_to_batch": 1.999972968918128e-05, "batch_individual_items": 0.00010193003889292365, "add_observations_from_episodes_to_batch": 4.201300474288811e-05}}, "connector_pipeline_timer": 0.0006365943701760611}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 190000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 190000}, "sample": 27.842914914522503, "num_env_steps_sampled_lifetime": 190000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.588333333333333, "agent_episode_returns_mean": {"default_agent": 0.8474145299145305}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8474145299145305}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.1615574597736, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005915813374282398, "weights_seq_no": 94.0, "env_to_module_sum_episodes_length_in": 96.1615574597736, "env_step_timer": 0.11557826836226877, "time_between_sampling": 9.738223111401515, "num_env_steps_sampled_lifetime_throughput": 48.576303720707095}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.190951752303107e-10, "mean_kl_loss": 0.001243729842826724, "weights_seq_no": 95.0, "vf_loss": 0.015563515946269035, "gradients_default_optimizer_global_norm": 0.20654234290122986, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5755264, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015563515946269035, "vf_explained_var": 0.03430908918380737, "entropy": 0.14419105648994446, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.033675290644168854, "policy_loss": -0.04923881217837334}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08013305159472046, "add_time_dim_to_batch_and_zero_pad": 3.2443591749390897e-05, "add_states_from_episodes_to_batch": 1.0984951100375122e-05, "general_advantage_estimation": 0.09851960847767467, "batch_individual_items": 0.04373172082881952, "add_observations_from_episodes_to_batch": 0.000355307091789131, "add_one_ts_to_episodes_and_truncate": 0.007319376226866832, "numpy_to_tensor": 0.0012016689951964365}}, "connector_pipeline_timer": 0.23186285329678008}, "num_env_steps_trained_lifetime": 90698608, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5755264, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.29916340746, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 190000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.576303720707095, "done": false, "training_iteration": 95, "trial_id": "8cacd_00000", "date": "2025-05-12_03-17-38", "timestamp": 1746983858, "time_this_iter_s": 41.09030532836914, "time_total_s": 3522.5110845565796, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3522.5110845565796, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 79.52413793103449, "ram_util_percent": 50.670689655172424}}
{"timers": {"training_iteration": 37.98798070916398, "restore_env_runners": 3.0827660743832215e-05, "training_step": 37.9874738543381, "env_runner_sampling_timer": 28.854147170555773, "learner_update_timer": 9.125137129080152, "synch_weights": 0.007151382814829829, "synch_env_connectors": 0.008851315672320018}, "env_runners": {"episode_return_mean": 0.9279380341880364, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001258908958075872, "get_actions": 0.0007605890397020237, "un_batch_to_individual_items": 7.24808175437542e-05, "listify_data_for_vector_env": 0.00014739395350543786, "tensor_to_numpy": 0.0002475279341685103, "remove_single_ts_time_rank_from_batch": 9.741139309442305e-06}}, "connector_pipeline_timer": 0.0016993191117291783}, "episode_return_max": 1.2512222222222258, "num_episodes_lifetime": 888, "episode_duration_sec_mean": 24.326134221740055, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017282059618243834, "add_time_dim_to_batch_and_zero_pad": 3.778695268705502e-05, "add_states_from_episodes_to_batch": 1.9924679924131436e-05, "batch_individual_items": 0.00010179591766611623, "add_observations_from_episodes_to_batch": 4.18844710226638e-05}}, "connector_pipeline_timer": 0.0006398667163983474}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 192000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 192000}, "sample": 27.87369850195043, "num_env_steps_sampled_lifetime": 192000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5742222222222224, "agent_episode_returns_mean": {"default_agent": 0.9279380341880364}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9279380341880364}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.45026093717678, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005913038460623766, "weights_seq_no": 95.0, "env_to_module_sum_episodes_length_in": 97.45026093717678, "env_step_timer": 0.11734292619597918, "time_between_sampling": 9.74575003817817, "num_env_steps_sampled_lifetime_throughput": 44.1238634324518}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.190951752303107e-10, "mean_kl_loss": 0.009316850453615189, "weights_seq_no": 96.0, "vf_loss": 0.021805349737405777, "gradients_default_optimizer_global_norm": 0.25573402643203735, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 5816064, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.021805349737405777, "vf_explained_var": 0.08337163925170898, "entropy": 0.19726204872131348, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.02056945487856865, "policy_loss": -0.04237480089068413}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08015422555936431, "add_time_dim_to_batch_and_zero_pad": 3.2463815246334434e-05, "add_states_from_episodes_to_batch": 1.098712119779259e-05, "general_advantage_estimation": 0.09808832600982552, "batch_individual_items": 0.043810352545181605, "add_observations_from_episodes_to_batch": 0.0003556730215273198, "add_one_ts_to_episodes_and_truncate": 0.007314198679025846, "numpy_to_tensor": 0.0012021756212890217}}, "connector_pipeline_timer": 0.23152630046495887}, "num_env_steps_trained_lifetime": 91660008, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 5816064, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3041251711277, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 192000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.1238634324518, "done": false, "training_iteration": 96, "trial_id": "8cacd_00000", "date": "2025-05-12_03-18-24", "timestamp": 1746983904, "time_this_iter_s": 45.261963844299316, "time_total_s": 3567.773048400879, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3567.773048400879, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 79.8076923076923, "ram_util_percent": 50.90153846153846}}
{"timers": {"training_iteration": 38.01141291991234, "restore_env_runners": 3.076238414953649e-05, "training_step": 38.010905484634726, "env_runner_sampling_timer": 28.878309794250203, "learner_update_timer": 9.12442197822934, "synch_weights": 0.0071353529866856015, "synch_env_connectors": 0.008858569515599341}, "env_runners": {"episode_return_mean": 1.0366410256410283, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012659194872715346, "get_actions": 0.0007595049462979487, "un_batch_to_individual_items": 7.257088637620169e-05, "listify_data_for_vector_env": 0.00014750925589256193, "tensor_to_numpy": 0.0002470583082964669, "remove_single_ts_time_rank_from_batch": 9.995043528703313e-06}}, "connector_pipeline_timer": 0.0016980662383632686}, "episode_return_max": 1.3663333333333363, "num_episodes_lifetime": 896, "episode_duration_sec_mean": 24.191855250317424, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017187343124060834, "add_time_dim_to_batch_and_zero_pad": 3.77136797155018e-05, "add_states_from_episodes_to_batch": 2.0047569502684472e-05, "batch_individual_items": 0.00010198595298007977, "add_observations_from_episodes_to_batch": 4.168815626264296e-05}}, "connector_pipeline_timer": 0.0006396158765568856}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 194000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 194000}, "sample": 27.903839907709614, "num_env_steps_sampled_lifetime": 194000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6775555555555575, "agent_episode_returns_mean": {"default_agent": 1.0366410256410283}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0366410256410283}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.30824095803321, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005903157260732886, "weights_seq_no": 96.0, "env_to_module_sum_episodes_length_in": 96.30824095803321, "env_step_timer": 0.11780804894259615, "time_between_sampling": 9.753066022903054, "num_env_steps_sampled_lifetime_throughput": 49.4841369232235}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.0954758761515535e-10, "mean_kl_loss": 0.0027066711336374283, "weights_seq_no": 97.0, "vf_loss": 0.026923682540655136, "gradients_default_optimizer_global_norm": 0.8360772132873535, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5876608, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.026923682540655136, "vf_explained_var": 0.09035563468933105, "entropy": 0.19138827919960022, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.013265609741210938, "policy_loss": -0.0136580690741539}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08017548479945576, "add_time_dim_to_batch_and_zero_pad": 3.248333991425334e-05, "add_states_from_episodes_to_batch": 1.0990459398096956e-05, "general_advantage_estimation": 0.09765750806048559, "batch_individual_items": 0.04388797911513349, "add_observations_from_episodes_to_batch": 0.0003560268519616076, "add_one_ts_to_episodes_and_truncate": 0.007308919274519018, "numpy_to_tensor": 0.001202711167960259}}, "connector_pipeline_timer": 0.23118921413434426}, "num_env_steps_trained_lifetime": 92613576, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5876608, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3089577831813, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 194000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.4841369232235, "done": false, "training_iteration": 97, "trial_id": "8cacd_00000", "date": "2025-05-12_03-19-04", "timestamp": 1746983944, "time_this_iter_s": 40.34802031517029, "time_total_s": 3608.121068716049, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3608.121068716049, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 79.30175438596493, "ram_util_percent": 51.03859649122808}}
{"timers": {"training_iteration": 38.04010231716321, "restore_env_runners": 3.0835760316969945e-05, "training_step": 38.03959285423837, "env_runner_sampling_timer": 28.899842922737704, "learner_update_timer": 9.131538223467041, "synch_weights": 0.007173255456814839, "synch_env_connectors": 0.008841036820453927}, "env_runners": {"episode_return_mean": 0.9015576923076942, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001280191218435217, "get_actions": 0.0007570912026407924, "un_batch_to_individual_items": 7.269890412929587e-05, "listify_data_for_vector_env": 0.00014785426273895803, "tensor_to_numpy": 0.0002475617016093043, "remove_single_ts_time_rank_from_batch": 9.889457596776158e-06}}, "connector_pipeline_timer": 0.0016985648015065194}, "episode_return_max": 1.3663333333333363, "num_episodes_lifetime": 904, "episode_duration_sec_mean": 23.841102927894397, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017192621530164897, "add_time_dim_to_batch_and_zero_pad": 3.753479775986578e-05, "add_states_from_episodes_to_batch": 2.057032533287751e-05, "batch_individual_items": 0.00010203352152368404, "add_observations_from_episodes_to_batch": 4.1863038760462303e-05}}, "connector_pipeline_timer": 0.0006395534545028795}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 196000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 196000}, "sample": 27.93331564635412, "num_env_steps_sampled_lifetime": 196000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.45955555555555583, "agent_episode_returns_mean": {"default_agent": 0.9015576923076942}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9015576923076942}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.27729796375624, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000591627625677693, "weights_seq_no": 97.0, "env_to_module_sum_episodes_length_in": 94.27729796375624, "env_step_timer": 0.11769191502532104, "time_between_sampling": 9.759883979712894, "num_env_steps_sampled_lifetime_throughput": 48.82342747943436}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.0477379380757768e-10, "mean_kl_loss": 0.0026613662485033274, "weights_seq_no": 98.0, "vf_loss": 0.007387370802462101, "gradients_default_optimizer_global_norm": 0.36539363861083984, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5937152, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007387370802462101, "vf_explained_var": 0.1286645531654358, "entropy": 0.1962490826845169, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06955822557210922, "policy_loss": -0.07694561034440994}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08019743259218941, "add_time_dim_to_batch_and_zero_pad": 3.2502817707340426e-05, "add_states_from_episodes_to_batch": 1.0996282122237817e-05, "general_advantage_estimation": 0.09722685768753152, "batch_individual_items": 0.043964456338431775, "add_observations_from_episodes_to_batch": 0.0003563747684851586, "add_one_ts_to_episodes_and_truncate": 0.007303634408234494, "numpy_to_tensor": 0.0012032559961360056}}, "connector_pipeline_timer": 0.23085183295029543}, "num_env_steps_trained_lifetime": 93567144, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5937152, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3136633304769, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 196000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.82342747943436, "done": false, "training_iteration": 98, "trial_id": "8cacd_00000", "date": "2025-05-12_03-19-45", "timestamp": 1746983985, "time_this_iter_s": 40.896493911743164, "time_total_s": 3649.0175626277924, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3649.0175626277924, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 78.11724137931033, "ram_util_percent": 51.13275862068965}}
{"timers": {"training_iteration": 38.07725753675158, "restore_env_runners": 3.076940271932834e-05, "training_step": 38.076747954455975, "env_runner_sampling_timer": 28.92808792448032, "learner_update_timer": 9.140429528022377, "synch_weights": 0.007189496902244903, "synch_env_connectors": 0.008842910452247452}, "env_runners": {"episode_return_mean": 0.7930544871794876, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012772030295100822, "get_actions": 0.0007583715312616167, "un_batch_to_individual_items": 7.282679758356096e-05, "listify_data_for_vector_env": 0.00014808251340437282, "tensor_to_numpy": 0.0002476990809905328, "remove_single_ts_time_rank_from_batch": 9.733856267105455e-06}}, "connector_pipeline_timer": 0.0017002583372857697}, "episode_return_max": 1.0583333333333353, "num_episodes_lifetime": 912, "episode_duration_sec_mean": 23.738978120750236, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017132023650706117, "add_time_dim_to_batch_and_zero_pad": 3.742383092864787e-05, "add_states_from_episodes_to_batch": 2.0772263016586985e-05, "batch_individual_items": 0.00010181135800890948, "add_observations_from_episodes_to_batch": 4.214556542752432e-05}}, "connector_pipeline_timer": 0.0006401212187936155}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 198000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 198000}, "sample": 27.9627574426745, "num_env_steps_sampled_lifetime": 198000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.45955555555555583, "agent_episode_returns_mean": {"default_agent": 0.7930544871794876}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7930544871794876}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.82230476390549, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005926285781838153, "weights_seq_no": 98.0, "env_to_module_sum_episodes_length_in": 92.82230476390549, "env_step_timer": 0.11754882531314165, "time_between_sampling": 9.766717699739322, "num_env_steps_sampled_lifetime_throughput": 47.80635293717277}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.238689690378884e-11, "mean_kl_loss": 0.0028063266072422266, "weights_seq_no": 99.0, "vf_loss": 0.008991396985948086, "gradients_default_optimizer_global_norm": 0.3104645907878876, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5997696, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008991396985948086, "vf_explained_var": 0.0616421103477478, "entropy": 0.20234069228172302, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.02747824788093567, "policy_loss": -0.036469634622335434}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08021925879058839, "add_time_dim_to_batch_and_zero_pad": 3.252119761045197e-05, "add_states_from_episodes_to_batch": 1.100190934608308e-05, "general_advantage_estimation": 0.09679570504123056, "batch_individual_items": 0.0440394021193525, "add_observations_from_episodes_to_batch": 0.00035671466399302116, "add_one_ts_to_episodes_and_truncate": 0.007298349887348172, "numpy_to_tensor": 0.001203822916631557}}, "connector_pipeline_timer": 0.23051230982851412}, "num_env_steps_trained_lifetime": 94520712, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 5997696, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3182438710483, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 198000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.80635293717277, "done": false, "training_iteration": 99, "trial_id": "8cacd_00000", "date": "2025-05-12_03-20-27", "timestamp": 1746984027, "time_this_iter_s": 41.77348017692566, "time_total_s": 3690.791042804718, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3690.791042804718, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 78.65762711864407, "ram_util_percent": 51.176271186440665}}
{"timers": {"training_iteration": 38.10104631437407, "restore_env_runners": 3.075470868582465e-05, "training_step": 38.10053572890142, "env_runner_sampling_timer": 28.941343074835512, "learner_update_timer": 9.150981092132152, "synch_weights": 0.007171816933222566, "synch_env_connectors": 0.008854306347722486}, "env_runners": {"episode_return_mean": 0.7783557692307698, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012782605223227178, "get_actions": 0.0007555508445168634, "un_batch_to_individual_items": 7.256580223952022e-05, "listify_data_for_vector_env": 0.00014910124129074233, "tensor_to_numpy": 0.0002463296161793133, "remove_single_ts_time_rank_from_batch": 9.581551875807847e-06}}, "connector_pipeline_timer": 0.001695539829025845}, "episode_return_max": 1.296333333333335, "num_episodes_lifetime": 920, "episode_duration_sec_mean": 24.079907337730955, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017198582598528168, "add_time_dim_to_batch_and_zero_pad": 3.708610095836874e-05, "add_states_from_episodes_to_batch": 2.0579051672686194e-05, "batch_individual_items": 0.00010184758994479084, "add_observations_from_episodes_to_batch": 4.1749097693596685e-05}}, "connector_pipeline_timer": 0.0006388687287220923}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 200000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 200000}, "sample": 27.990832038734606, "num_env_steps_sampled_lifetime": 200000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5040000000000006, "agent_episode_returns_mean": {"default_agent": 0.7783557692307698}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7783557692307698}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.8392546425742, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005906679233377211, "weights_seq_no": 99.0, "env_to_module_sum_episodes_length_in": 92.8392546425742, "env_step_timer": 0.1167120593029061, "time_between_sampling": 9.773637630225975, "num_env_steps_sampled_lifetime_throughput": 49.34054024411483}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.238689690378884e-11, "mean_kl_loss": 0.006475747097283602, "weights_seq_no": 100.0, "vf_loss": 0.009858095087110996, "gradients_default_optimizer_global_norm": 0.11405500024557114, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6058240, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009858095087110996, "vf_explained_var": 0.16084080934524536, "entropy": 0.22057469189167023, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.004814299289137125, "policy_loss": -0.014672385528683662}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08024178108166032, "add_time_dim_to_batch_and_zero_pad": 3.253899963359555e-05, "add_states_from_episodes_to_batch": 1.100741439717166e-05, "general_advantage_estimation": 0.09636443930208698, "batch_individual_items": 0.04411337744902084, "add_observations_from_episodes_to_batch": 0.0003570726341138809, "add_one_ts_to_episodes_and_truncate": 0.007293125793438764, "numpy_to_tensor": 0.0012043725631176734}}, "connector_pipeline_timer": 0.23017246767577343}, "num_env_steps_trained_lifetime": 95474280, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6058240, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3227014344752, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 200000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.34054024411483, "done": false, "training_iteration": 100, "trial_id": "8cacd_00000", "date": "2025-05-12_03-21-07", "timestamp": 1746984067, "time_this_iter_s": 40.474833726882935, "time_total_s": 3731.265876531601, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3731.265876531601, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 76.23620689655174, "ram_util_percent": 51.287931034482774}}
{"timers": {"training_iteration": 38.12798699433033, "restore_env_runners": 3.0755161615923924e-05, "training_step": 38.127476214712395, "env_runner_sampling_timer": 28.968075823847155, "learner_update_timer": 9.151212298550822, "synch_weights": 0.007148831763893608, "synch_env_connectors": 0.008854059274253452}, "env_runners": {"episode_return_mean": 0.7896164529914536, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001274229484790045, "get_actions": 0.0007559256317766828, "un_batch_to_individual_items": 7.250213271210921e-05, "listify_data_for_vector_env": 0.00014953960925075048, "tensor_to_numpy": 0.0002471368346079679, "remove_single_ts_time_rank_from_batch": 9.826508783215623e-06}}, "connector_pipeline_timer": 0.0016962343372705908}, "episode_return_max": 1.296333333333335, "num_episodes_lifetime": 928, "episode_duration_sec_mean": 23.40649922738453, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017293904626437963, "add_time_dim_to_batch_and_zero_pad": 3.7082609146275625e-05, "add_states_from_episodes_to_batch": 2.0445741552652835e-05, "batch_individual_items": 0.00010130841027659511, "add_observations_from_episodes_to_batch": 4.207270544615473e-05}}, "connector_pipeline_timer": 0.000638775103734479}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 202000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 202000}, "sample": 28.018580726356237, "num_env_steps_sampled_lifetime": 202000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5040000000000006, "agent_episode_returns_mean": {"default_agent": 0.7896164529914536}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7896164529914536}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.81715319836174, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005911884668106566, "weights_seq_no": 100.0, "env_to_module_sum_episodes_length_in": 94.81715319836174, "env_step_timer": 0.11602594783030902, "time_between_sampling": 9.78102731236909, "num_env_steps_sampled_lifetime_throughput": 48.80142527318908}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.619344845189442e-11, "mean_kl_loss": 0.002739629242569208, "weights_seq_no": 101.0, "vf_loss": 0.013964804820716381, "gradients_default_optimizer_global_norm": 0.38672706484794617, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6118784, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013964804820716381, "vf_explained_var": 0.15251392126083374, "entropy": 0.20338785648345947, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.1268947422504425, "policy_loss": -0.14085955917835236}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08026376239113175, "add_time_dim_to_batch_and_zero_pad": 3.255607349661708e-05, "add_states_from_episodes_to_batch": 1.1012709156278599e-05, "general_advantage_estimation": 0.09593342030722221, "batch_individual_items": 0.04418575320188379, "add_observations_from_episodes_to_batch": 0.0003574293233658022, "add_one_ts_to_episodes_and_truncate": 0.007287801816418766, "numpy_to_tensor": 0.0012048886043825428}}, "connector_pipeline_timer": 0.22983059544520484}, "num_env_steps_trained_lifetime": 96427848, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6118784, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3270380222464, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 202000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.80142527318908, "done": false, "training_iteration": 101, "trial_id": "8cacd_00000", "date": "2025-05-12_03-21-48", "timestamp": 1746984108, "time_this_iter_s": 40.811076402664185, "time_total_s": 3772.076952934265, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3772.076952934265, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 78.66896551724139, "ram_util_percent": 51.3448275862069}}
{"timers": {"training_iteration": 38.18546176134702, "restore_env_runners": 3.0738609996415185e-05, "training_step": 38.18495069452527, "env_runner_sampling_timer": 29.01886253813868, "learner_update_timer": 9.157913971995306, "synch_weights": 0.00713420844624241, "synch_env_connectors": 0.008832690681510035}, "env_runners": {"episode_return_mean": 0.8332980769230786, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012716852289136583, "get_actions": 0.000756062074141009, "un_batch_to_individual_items": 7.304999900456401e-05, "listify_data_for_vector_env": 0.0001497926364744832, "tensor_to_numpy": 0.00024809757749346415, "remove_single_ts_time_rank_from_batch": 9.952352779386741e-06}}, "connector_pipeline_timer": 0.0016968565774763984}, "episode_return_max": 1.2983333333333364, "num_episodes_lifetime": 944, "episode_duration_sec_mean": 24.000165494855658, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017446067313892351, "add_time_dim_to_batch_and_zero_pad": 3.696042379184528e-05, "add_states_from_episodes_to_batch": 2.0616242339622874e-05, "batch_individual_items": 0.0001019854137920242, "add_observations_from_episodes_to_batch": 4.188507920764697e-05}}, "connector_pipeline_timer": 0.0006406845008929566}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 204000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 204000}, "sample": 28.047824646819837, "num_env_steps_sampled_lifetime": 204000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5155555555555561, "agent_episode_returns_mean": {"default_agent": 0.8332980769230786}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8332980769230786}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.99258895549703, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005887391996778991, "weights_seq_no": 101.0, "env_to_module_sum_episodes_length_in": 96.99258895549703, "env_step_timer": 0.11700315069356693, "time_between_sampling": 9.788072132997018, "num_env_steps_sampled_lifetime_throughput": 45.50109131710097}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.619344845189442e-11, "mean_kl_loss": 0.008052724413573742, "weights_seq_no": 102.0, "vf_loss": 0.014717896468937397, "gradients_default_optimizer_global_norm": 0.30512452125549316, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 6179584, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014717896468937397, "vf_explained_var": -0.03804779052734375, "entropy": 0.26876309514045715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.11821054667234421, "policy_loss": -0.13292844593524933}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08028556713620559, "add_time_dim_to_batch_and_zero_pad": 3.257229198236016e-05, "add_states_from_episodes_to_batch": 1.1017807278814563e-05, "general_advantage_estimation": 0.09550203369832451, "batch_individual_items": 0.044256640361944766, "add_observations_from_episodes_to_batch": 0.0003577882315693214, "add_one_ts_to_episodes_and_truncate": 0.007282481606359857, "numpy_to_tensor": 0.0012053759275658955}}, "connector_pipeline_timer": 0.2294866608423801}, "num_env_steps_trained_lifetime": 97389248, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 6179584, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3320556081187, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 204000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.50109131710097, "done": false, "training_iteration": 102, "trial_id": "8cacd_00000", "date": "2025-05-12_03-22-32", "timestamp": 1746984152, "time_this_iter_s": 43.89342474937439, "time_total_s": 3815.9703776836395, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3815.9703776836395, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 78.81612903225806, "ram_util_percent": 51.49193548387097}}
{"timers": {"training_iteration": 38.20343518070354, "restore_env_runners": 3.065122389816932e-05, "training_step": 38.20292440455002, "env_runner_sampling_timer": 29.0368831380373, "learner_update_timer": 9.15786304696536, "synch_weights": 0.007139067361772565, "synch_env_connectors": 0.00883616578468747}, "env_runners": {"episode_return_mean": 0.7737809829059846, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012686777513738396, "get_actions": 0.0007558246499965139, "un_batch_to_individual_items": 7.296240029347209e-05, "listify_data_for_vector_env": 0.00015072447917866685, "tensor_to_numpy": 0.00024717045168121886, "remove_single_ts_time_rank_from_batch": 9.789090111168678e-06}}, "connector_pipeline_timer": 0.0016955048882866322}, "episode_return_max": 1.203333333333337, "num_episodes_lifetime": 952, "episode_duration_sec_mean": 23.610147382047916, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001739419928906228, "add_time_dim_to_batch_and_zero_pad": 3.809266135393016e-05, "add_states_from_episodes_to_batch": 2.0429132368912086e-05, "batch_individual_items": 0.00010153256532579821, "add_observations_from_episodes_to_batch": 4.2373018436553996e-05}}, "connector_pipeline_timer": 0.0006399728440997524}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 206000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 206000}, "sample": 28.076154623030103, "num_env_steps_sampled_lifetime": 206000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5678888888888898, "agent_episode_returns_mean": {"default_agent": 0.7737809829059846}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7737809829059846}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.6560067306747, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005864430858533307, "weights_seq_no": 102.0, "env_to_module_sum_episodes_length_in": 96.6560067306747, "env_step_timer": 0.11745896321004466, "time_between_sampling": 9.795363410099002, "num_env_steps_sampled_lifetime_throughput": 49.922111274876244}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.619344845189442e-11, "mean_kl_loss": 0.0055180685594677925, "weights_seq_no": 103.0, "vf_loss": 0.017752569168806076, "gradients_default_optimizer_global_norm": 0.5415830612182617, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6240128, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017752569168806076, "vf_explained_var": -0.03144240379333496, "entropy": 0.24758577346801758, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.129945769906044, "policy_loss": -0.1476983278989792}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08030752418993899, "add_time_dim_to_batch_and_zero_pad": 3.258802049092063e-05, "add_states_from_episodes_to_batch": 1.1023472168001311e-05, "general_advantage_estimation": 0.095070390629574, "batch_individual_items": 0.04432595536328433, "add_observations_from_episodes_to_batch": 0.0003581353086763358, "add_one_ts_to_episodes_and_truncate": 0.007277070280320508, "numpy_to_tensor": 0.0012058426054250629}}, "connector_pipeline_timer": 0.22914092244166748}, "num_env_steps_trained_lifetime": 98342816, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6240128, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3369401384712, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 206000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.922111274876244, "done": false, "training_iteration": 103, "trial_id": "8cacd_00000", "date": "2025-05-12_03-23-12", "timestamp": 1746984192, "time_this_iter_s": 39.99867057800293, "time_total_s": 3855.9690482616425, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3855.9690482616425, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 78.7140350877193, "ram_util_percent": 51.52456140350878}}
{"timers": {"training_iteration": 38.22597529503651, "restore_env_runners": 3.0683711657535925e-05, "training_step": 38.22546355864452, "env_runner_sampling_timer": 29.060122138366925, "learner_update_timer": 9.157172536925716, "synch_weights": 0.007129796688157162, "synch_env_connectors": 0.008824952126840901}, "env_runners": {"episode_return_mean": 0.8640673076923095, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012820697016923207, "get_actions": 0.0007554781889058262, "un_batch_to_individual_items": 7.303103184004027e-05, "listify_data_for_vector_env": 0.00015117038825119834, "tensor_to_numpy": 0.00024734900461305663, "remove_single_ts_time_rank_from_batch": 9.768915652138975e-06}}, "connector_pipeline_timer": 0.0016972378087047452}, "episode_return_max": 1.2467777777777804, "num_episodes_lifetime": 960, "episode_duration_sec_mean": 23.49199342965363, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017436217955715442, "add_time_dim_to_batch_and_zero_pad": 3.836566282619888e-05, "add_states_from_episodes_to_batch": 2.02188765856888e-05, "batch_individual_items": 0.00010181292584505143, "add_observations_from_episodes_to_batch": 4.225366890847461e-05}}, "connector_pipeline_timer": 0.0006405457044328061}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 208000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 208000}, "sample": 28.10417456342248, "num_env_steps_sampled_lifetime": 208000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5694444444444453, "agent_episode_returns_mean": {"default_agent": 0.8640673076923095}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8640673076923095}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.76198302123541, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005885452643858975, "weights_seq_no": 103.0, "env_to_module_sum_episodes_length_in": 94.76198302123541, "env_step_timer": 0.1176545318757991, "time_between_sampling": 9.802130393240443, "num_env_steps_sampled_lifetime_throughput": 49.328022582461294}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.309672422594721e-11, "mean_kl_loss": 0.0020393209997564554, "weights_seq_no": 104.0, "vf_loss": 0.018090829253196716, "gradients_default_optimizer_global_norm": 0.4238151013851166, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6300672, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.018090829253196716, "vf_explained_var": 0.03242248296737671, "entropy": 0.2239810675382614, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.056870944797992706, "policy_loss": -0.07496178895235062}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.080329183195784, "add_time_dim_to_batch_and_zero_pad": 3.260282720009929e-05, "add_states_from_episodes_to_batch": 1.1028961978773863e-05, "general_advantage_estimation": 0.09463843788882861, "batch_individual_items": 0.044393807470460865, "add_observations_from_episodes_to_batch": 0.000358474485417981, "add_one_ts_to_episodes_and_truncate": 0.007271596532641267, "numpy_to_tensor": 0.0012062897021342656}}, "connector_pipeline_timer": 0.22879302326268486}, "num_env_steps_trained_lifetime": 99296384, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6300672, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.341693772656, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 208000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.328022582461294, "done": false, "training_iteration": 104, "trial_id": "8cacd_00000", "date": "2025-05-12_03-23-53", "timestamp": 1746984233, "time_this_iter_s": 40.47508120536804, "time_total_s": 3896.4441294670105, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3896.4441294670105, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 79.20172413793101, "ram_util_percent": 51.51724137931034}}
{"timers": {"training_iteration": 38.24142669908614, "restore_env_runners": 3.0644874526186764e-05, "training_step": 38.240915183058064, "env_runner_sampling_timer": 29.07935764290327, "learner_update_timer": 9.153388870626465, "synch_weights": 0.00712691573126407, "synch_env_connectors": 0.008841811605568939}, "env_runners": {"episode_return_mean": 0.9848226495726504, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.000128861633117944, "get_actions": 0.0007568363690665272, "un_batch_to_individual_items": 7.374341722773679e-05, "listify_data_for_vector_env": 0.00015117935845149604, "tensor_to_numpy": 0.00024860767803497227, "remove_single_ts_time_rank_from_batch": 9.587818863798417e-06}}, "connector_pipeline_timer": 0.0016998944956513478}, "episode_return_max": 1.2467777777777804, "num_episodes_lifetime": 968, "episode_duration_sec_mean": 23.633270122163314, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017341678416904794, "add_time_dim_to_batch_and_zero_pad": 3.853882664908245e-05, "add_states_from_episodes_to_batch": 2.005709957649391e-05, "batch_individual_items": 0.00010168098443398358, "add_observations_from_episodes_to_batch": 4.188695253858751e-05}}, "connector_pipeline_timer": 0.000639181246527278}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 210000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 210000}, "sample": 28.13150554243995, "num_env_steps_sampled_lifetime": 210000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5782222222222222, "agent_episode_returns_mean": {"default_agent": 0.9848226495726504}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9848226495726504}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.99287293048995, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005895529533328122, "weights_seq_no": 104.0, "env_to_module_sum_episodes_length_in": 92.99287293048995, "env_step_timer": 0.11741938708761553, "time_between_sampling": 9.808225857991431, "num_env_steps_sampled_lifetime_throughput": 50.18414079327414}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.309672422594721e-11, "mean_kl_loss": 0.007746931165456772, "weights_seq_no": 105.0, "vf_loss": 0.013714579865336418, "gradients_default_optimizer_global_norm": 0.4504900872707367, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6361216, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013714579865336418, "vf_explained_var": 0.0675973892211914, "entropy": 0.23595313727855682, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0078500434756279, "policy_loss": -0.02156461402773857}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.080350626193693, "add_time_dim_to_batch_and_zero_pad": 3.261689897305407e-05, "add_states_from_episodes_to_batch": 1.103425964624119e-05, "general_advantage_estimation": 0.0942069635545352, "batch_individual_items": 0.04446005506235748, "add_observations_from_episodes_to_batch": 0.00035880279509397175, "add_one_ts_to_episodes_and_truncate": 0.007266099373287544, "numpy_to_tensor": 0.001206707072748739}}, "connector_pipeline_timer": 0.22844371245323786}, "num_env_steps_trained_lifetime": 100249952, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6361216, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3463186401432, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 210000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.18414079327414, "done": false, "training_iteration": 105, "trial_id": "8cacd_00000", "date": "2025-05-12_03-24-33", "timestamp": 1746984273, "time_this_iter_s": 39.78844451904297, "time_total_s": 3936.2325739860535, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3936.2325739860535, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 80.40714285714286, "ram_util_percent": 51.521428571428565}}
{"timers": {"training_iteration": 38.260156702555264, "restore_env_runners": 3.056942577545315e-05, "training_step": 38.25964497168749, "env_runner_sampling_timer": 29.09450438511424, "learner_update_timer": 9.156994917740189, "synch_weights": 0.007101425573944192, "synch_env_connectors": 0.008845707499511767}, "env_runners": {"episode_return_mean": 0.9648611111111117, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012862533621376155, "get_actions": 0.0007560402354722971, "un_batch_to_individual_items": 7.416084271288539e-05, "listify_data_for_vector_env": 0.0001505944276964633, "tensor_to_numpy": 0.00024793292639574513, "remove_single_ts_time_rank_from_batch": 9.513321396322364e-06}}, "connector_pipeline_timer": 0.0016992272695963908}, "episode_return_max": 1.2704444444444458, "num_episodes_lifetime": 976, "episode_duration_sec_mean": 23.58773406020203, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001723829195503022, "add_time_dim_to_batch_and_zero_pad": 3.839829808315886e-05, "add_states_from_episodes_to_batch": 1.9817734736476904e-05, "batch_individual_items": 0.00010138795862630301, "add_observations_from_episodes_to_batch": 4.185934366435494e-05}}, "connector_pipeline_timer": 0.0006358045272491314}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 212000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 212000}, "sample": 28.15779589892481, "num_env_steps_sampled_lifetime": 212000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5283333333333335, "agent_episode_returns_mean": {"default_agent": 0.9648611111111117}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9648611111111117}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.43342237214523, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005873177674337969, "weights_seq_no": 105.0, "env_to_module_sum_episodes_length_in": 92.43342237214523, "env_step_timer": 0.11671812145088988, "time_between_sampling": 9.813572354839183, "num_env_steps_sampled_lifetime_throughput": 49.73349763198798}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.548362112973605e-12, "mean_kl_loss": 0.004037010949105024, "weights_seq_no": 106.0, "vf_loss": 0.013180874288082123, "gradients_default_optimizer_global_norm": 0.41597291827201843, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6421760, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013180874288082123, "vf_explained_var": 0.09503507614135742, "entropy": 0.2412066012620926, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.04929367080330849, "policy_loss": 0.03611280396580696}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08037183199322423, "add_time_dim_to_batch_and_zero_pad": 3.263051902789357e-05, "add_states_from_episodes_to_batch": 1.1039488464110667e-05, "general_advantage_estimation": 0.09377535207313877, "batch_individual_items": 0.044524733281569015, "add_observations_from_episodes_to_batch": 0.00035912354112787535, "add_one_ts_to_episodes_and_truncate": 0.007260608887467582, "numpy_to_tensor": 0.0012071264269807333}}, "connector_pipeline_timer": 0.22809246225745353}, "num_env_steps_trained_lifetime": 101203520, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6421760, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3508168409035, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 212000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.73349763198798, "done": false, "training_iteration": 106, "trial_id": "8cacd_00000", "date": "2025-05-12_03-25-13", "timestamp": 1746984313, "time_this_iter_s": 40.13274526596069, "time_total_s": 3976.365319252014, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3976.365319252014, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 76.89999999999999, "ram_util_percent": 51.54655172413793}}
{"timers": {"training_iteration": 38.278587630799706, "restore_env_runners": 3.06067315101251e-05, "training_step": 38.2780750442406, "env_runner_sampling_timer": 29.114997007223085, "learner_update_timer": 9.154929090872779, "synch_weights": 0.007102543318209535, "synch_env_connectors": 0.008843372424528177}, "env_runners": {"episode_return_mean": 0.8838814102564108, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012847097521410844, "get_actions": 0.0007562480697573168, "un_batch_to_individual_items": 7.376860265502448e-05, "listify_data_for_vector_env": 0.00014985607713272528, "tensor_to_numpy": 0.00024665325884481407, "remove_single_ts_time_rank_from_batch": 9.33276525484644e-06}}, "connector_pipeline_timer": 0.0016951578595142114}, "episode_return_max": 1.3482222222222235, "num_episodes_lifetime": 984, "episode_duration_sec_mean": 23.588810959038362, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017227971161353086, "add_time_dim_to_batch_and_zero_pad": 3.936861247550471e-05, "add_states_from_episodes_to_batch": 1.9879238449328188e-05, "batch_individual_items": 0.00010120383224344191, "add_observations_from_episodes_to_batch": 4.155699477438243e-05}}, "connector_pipeline_timer": 0.0006359189032428398}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 214000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 214000}, "sample": 28.183466139147125, "num_env_steps_sampled_lifetime": 214000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.46144444444444466, "agent_episode_returns_mean": {"default_agent": 0.8838814102564108}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8838814102564108}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.6972831304814, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005860087217471925, "weights_seq_no": 106.0, "env_to_module_sum_episodes_length_in": 93.6972831304814, "env_step_timer": 0.11596019104808865, "time_between_sampling": 9.818872913868393, "num_env_steps_sampled_lifetime_throughput": 49.769900773709544}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.2741810564868024e-12, "mean_kl_loss": 0.0043434989638626575, "weights_seq_no": 107.0, "vf_loss": 0.0115587767213583, "gradients_default_optimizer_global_norm": 0.2848125398159027, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6482304, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0115587767213583, "vf_explained_var": 0.09092682600021362, "entropy": 0.1315230131149292, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.09425320476293564, "policy_loss": 0.08269442617893219}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08039327319404557, "add_time_dim_to_batch_and_zero_pad": 3.2643184991739286e-05, "add_states_from_episodes_to_batch": 1.1044589279696331e-05, "general_advantage_estimation": 0.09334384608501484, "batch_individual_items": 0.04458816944089006, "add_observations_from_episodes_to_batch": 0.0003594464719615884, "add_one_ts_to_episodes_and_truncate": 0.007255264781426795, "numpy_to_tensor": 0.0012075735534208272}}, "connector_pipeline_timer": 0.22774049020423964}, "num_env_steps_trained_lifetime": 102157088, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6482304, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3551904457845, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 214000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.769900773709544, "done": false, "training_iteration": 107, "trial_id": "8cacd_00000", "date": "2025-05-12_03-25-53", "timestamp": 1746984353, "time_this_iter_s": 40.12043738365173, "time_total_s": 4016.485756635666, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4016.485756635666, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 78.98421052631578, "ram_util_percent": 51.526315789473685}}
{"timers": {"training_iteration": 38.298632944821726, "restore_env_runners": 3.055966420266908e-05, "training_step": 38.29812002512819, "env_runner_sampling_timer": 29.13569479104085, "learner_update_timer": 9.154271902404064, "synch_weights": 0.007105650885025695, "synch_env_connectors": 0.00884132470028557}, "env_runners": {"episode_return_mean": 0.8593173076923093, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012845402488251997, "get_actions": 0.0007528117736566378, "un_batch_to_individual_items": 7.357888276042177e-05, "listify_data_for_vector_env": 0.00014920619283308162, "tensor_to_numpy": 0.0002450465487843132, "remove_single_ts_time_rank_from_batch": 9.18221000148969e-06}}, "connector_pipeline_timer": 0.0016897198393944883}, "episode_return_max": 1.1683333333333352, "num_episodes_lifetime": 1000, "episode_duration_sec_mean": 23.279728467529033, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017135346708982343, "add_time_dim_to_batch_and_zero_pad": 4.021574548882362e-05, "add_states_from_episodes_to_batch": 1.9922867837855296e-05, "batch_individual_items": 0.00010099580189882556, "add_observations_from_episodes_to_batch": 4.143864616325822e-05}}, "connector_pipeline_timer": 0.0006344580652163402}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 216000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 216000}, "sample": 28.208434734700848, "num_env_steps_sampled_lifetime": 216000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5352222222222224, "agent_episode_returns_mean": {"default_agent": 0.8593173076923093}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8593173076923093}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.09114544515135, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005851495345661265, "weights_seq_no": 107.0, "env_to_module_sum_episodes_length_in": 97.09114544515135, "env_step_timer": 0.11506646120392484, "time_between_sampling": 9.823771293368836, "num_env_steps_sampled_lifetime_throughput": 49.54117854503415}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.6370905282434012e-12, "mean_kl_loss": 0.00407560495659709, "weights_seq_no": 108.0, "vf_loss": 0.016154101118445396, "gradients_default_optimizer_global_norm": 0.6487500667572021, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6542848, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.016154101118445396, "vf_explained_var": 0.09995317459106445, "entropy": 0.22078044712543488, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.13608592748641968, "policy_loss": 0.11993180960416794}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08041485842765116, "add_time_dim_to_batch_and_zero_pad": 3.2655054584380234e-05, "add_states_from_episodes_to_batch": 1.1049544130191681e-05, "general_advantage_estimation": 0.0929123554914461, "batch_individual_items": 0.04466557913349651, "add_observations_from_episodes_to_batch": 0.0003597635518244722, "add_one_ts_to_episodes_and_truncate": 0.007249833096617962, "numpy_to_tensor": 0.0012079902646894753}}, "connector_pipeline_timer": 0.22740251887566415}, "num_env_steps_trained_lifetime": 103110656, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6542848, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3594414968838, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 216000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.54117854503415, "done": false, "training_iteration": 108, "trial_id": "8cacd_00000", "date": "2025-05-12_03-26-34", "timestamp": 1746984394, "time_this_iter_s": 40.30169320106506, "time_total_s": 4056.787449836731, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4056.787449836731, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 78.63508771929826, "ram_util_percent": 51.60526315789475}}
{"timers": {"training_iteration": 38.357219004073514, "restore_env_runners": 3.0569067558141784e-05, "training_step": 38.35670619257692, "env_runner_sampling_timer": 29.186270825310448, "learner_update_timer": 9.162295677900008, "synch_weights": 0.007092972376169702, "synch_env_connectors": 0.008855428453278429}, "env_runners": {"episode_return_mean": 0.874493589743592, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012854652169961664, "get_actions": 0.0007508417679454027, "un_batch_to_individual_items": 7.293010299116634e-05, "listify_data_for_vector_env": 0.00014897602290675258, "tensor_to_numpy": 0.00024683146329154427, "remove_single_ts_time_rank_from_batch": 9.061514500918308e-06}}, "connector_pipeline_timer": 0.0016893751028157179}, "episode_return_max": 1.2214444444444479, "num_episodes_lifetime": 1008, "episode_duration_sec_mean": 23.69064356658667, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017196585314298188, "add_time_dim_to_batch_and_zero_pad": 3.9907973138534994e-05, "add_states_from_episodes_to_batch": 1.9877218795321067e-05, "batch_individual_items": 0.00010188107104575448, "add_observations_from_episodes_to_batch": 4.138609276358724e-05}}, "connector_pipeline_timer": 0.0006351853109284153}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 218000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 218000}, "sample": 28.23536924500086, "num_env_steps_sampled_lifetime": 218000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5352222222222224, "agent_episode_returns_mean": {"default_agent": 0.874493589743592}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.874493589743592}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.82008394043343, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005838143197263424, "weights_seq_no": 108.0, "env_to_module_sum_episodes_length_in": 97.82008394043343, "env_step_timer": 0.11603356717831236, "time_between_sampling": 9.828557169885714, "num_env_steps_sampled_lifetime_throughput": 45.19873962413236}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 8.185452641217006e-13, "mean_kl_loss": 0.003365346696227789, "weights_seq_no": 109.0, "vf_loss": 0.018283221870660782, "gradients_default_optimizer_global_norm": 0.3581262230873108, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6603392, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.018283221870660782, "vf_explained_var": 0.09772920608520508, "entropy": 0.1974007785320282, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06630741059780121, "policy_loss": -0.08459063619375229}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08043582509926527, "add_time_dim_to_batch_and_zero_pad": 3.266699246674999e-05, "add_states_from_episodes_to_batch": 1.1054915424715506e-05, "general_advantage_estimation": 0.0924808948251404, "batch_individual_items": 0.04474135770520682, "add_observations_from_episodes_to_batch": 0.00036007476544282614, "add_one_ts_to_episodes_and_truncate": 0.007244446568927147, "numpy_to_tensor": 0.0012084095243775172}}, "connector_pipeline_timer": 0.22706237095443976}, "num_env_steps_trained_lifetime": 104064224, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6603392, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3635720079167, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 218000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.19873962413236, "done": false, "training_iteration": 109, "trial_id": "8cacd_00000", "date": "2025-05-12_03-27-18", "timestamp": 1746984438, "time_this_iter_s": 44.17609620094299, "time_total_s": 4100.963546037674, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4100.963546037674, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 78.97777777777777, "ram_util_percent": 51.57619047619047}}
{"timers": {"training_iteration": 38.366047039072775, "restore_env_runners": 3.0488376885971335e-05, "training_step": 38.36553324869115, "env_runner_sampling_timer": 29.19699440428733, "learner_update_timer": 9.160421888931014, "synch_weights": 0.007071237652418518, "synch_env_connectors": 0.008867989168761498}, "env_runners": {"episode_return_mean": 0.8734220085470107, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012814442179614902, "get_actions": 0.0007503054746069456, "un_batch_to_individual_items": 7.199860431645205e-05, "listify_data_for_vector_env": 0.0001483320027006929, "tensor_to_numpy": 0.0002468049846863955, "remove_single_ts_time_rank_from_batch": 8.954312527417753e-06}}, "connector_pipeline_timer": 0.0016859634865020179}, "episode_return_max": 1.2214444444444479, "num_episodes_lifetime": 1016, "episode_duration_sec_mean": 23.469727162096206, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017447013797359888, "add_time_dim_to_batch_and_zero_pad": 3.9509550753160286e-05, "add_states_from_episodes_to_batch": 1.9985563436229672e-05, "batch_individual_items": 0.00010154035290860504, "add_observations_from_episodes_to_batch": 4.141346443900881e-05}}, "connector_pipeline_timer": 0.0006374241172024045}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 220000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 220000}, "sample": 28.261056002243286, "num_env_steps_sampled_lifetime": 220000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5616666666666671, "agent_episode_returns_mean": {"default_agent": 0.8734220085470107}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8734220085470107}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.20878366771622, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005828755582844886, "weights_seq_no": 109.0, "env_to_module_sum_episodes_length_in": 96.20878366771622, "env_step_timer": 0.11615140956254456, "time_between_sampling": 9.833594132267162, "num_env_steps_sampled_lifetime_throughput": 50.864186594285734}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.092726320608503e-13, "mean_kl_loss": 0.0019455512519925833, "weights_seq_no": 110.0, "vf_loss": 0.013735306449234486, "gradients_default_optimizer_global_norm": 0.4938702881336212, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6663936, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013735306449234486, "vf_explained_var": 0.14558660984039307, "entropy": 0.22528302669525146, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.1175343245267868, "policy_loss": -0.131269633769989}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0804570286317043, "add_time_dim_to_batch_and_zero_pad": 3.267928608612013e-05, "add_states_from_episodes_to_batch": 1.1060704338796431e-05, "general_advantage_estimation": 0.09204949622661171, "batch_individual_items": 0.04481557204756962, "add_observations_from_episodes_to_batch": 0.00036037570843356243, "add_one_ts_to_episodes_and_truncate": 0.007238983308480445, "numpy_to_tensor": 0.0012088053898452363}}, "connector_pipeline_timer": 0.22672084620985242}, "num_env_steps_trained_lifetime": 105017792, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6663936, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3675839645791, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 220000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.864186594285734, "done": false, "training_iteration": 110, "trial_id": "8cacd_00000", "date": "2025-05-12_03-27-57", "timestamp": 1746984477, "time_this_iter_s": 39.25780272483826, "time_total_s": 4140.221348762512, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4140.221348762512, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 79.9090909090909, "ram_util_percent": 51.57454545454546}}
{"timers": {"training_iteration": 38.393111250652034, "restore_env_runners": 3.0391493118405465e-05, "training_step": 38.39259775217423, "env_runner_sampling_timer": 29.225054394774453, "learner_update_timer": 9.1593954214817, "synch_weights": 0.007104530275888109, "synch_env_connectors": 0.008853922287075367}, "env_runners": {"episode_return_mean": 0.8032564102564114, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001284763479837797, "get_actions": 0.0007518976933192307, "un_batch_to_individual_items": 7.202581953890534e-05, "listify_data_for_vector_env": 0.00014797108948805496, "tensor_to_numpy": 0.00024617404522075595, "remove_single_ts_time_rank_from_batch": 8.804725497972844e-06}}, "connector_pipeline_timer": 0.0016860280061466292}, "episode_return_max": 1.1631111111111132, "num_episodes_lifetime": 1024, "episode_duration_sec_mean": 23.768946270586728, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017456249470759028, "add_time_dim_to_batch_and_zero_pad": 3.981031742713474e-05, "add_states_from_episodes_to_batch": 1.9878017628005245e-05, "batch_individual_items": 0.00010092096454263104, "add_observations_from_episodes_to_batch": 4.181713067627814e-05}}, "connector_pipeline_timer": 0.0006367179269703333}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 222000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 222000}, "sample": 28.286863529868782, "num_env_steps_sampled_lifetime": 222000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5650000000000005, "agent_episode_returns_mean": {"default_agent": 0.8032564102564114}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8032564102564114}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.18707917036167, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005873160311135344, "weights_seq_no": 110.0, "env_to_module_sum_episodes_length_in": 94.18707917036167, "env_step_timer": 0.11630733470232334, "time_between_sampling": 9.838167244433297, "num_env_steps_sampled_lifetime_throughput": 48.466556432160466}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.092726320608503e-13, "mean_kl_loss": 0.007920828647911549, "weights_seq_no": 111.0, "vf_loss": 0.011595692485570908, "gradients_default_optimizer_global_norm": 0.7588801980018616, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6724480, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011595692485570908, "vf_explained_var": 0.13886600732803345, "entropy": 0.24213002622127533, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.12306435406208038, "policy_loss": -0.1346600502729416}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08047824092098463, "add_time_dim_to_batch_and_zero_pad": 3.2700187133921086e-05, "add_states_from_episodes_to_batch": 1.1066491983066103e-05, "general_advantage_estimation": 0.09161829895057097, "batch_individual_items": 0.04488856726721467, "add_observations_from_episodes_to_batch": 0.0003606749750879572, "add_one_ts_to_episodes_and_truncate": 0.00723352124858585, "numpy_to_tensor": 0.0012092196670511089}}, "connector_pipeline_timer": 0.22637833753296133}, "num_env_steps_trained_lifetime": 105971360, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6724480, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3714793249076, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 222000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.466556432160466, "done": false, "training_iteration": 111, "trial_id": "8cacd_00000", "date": "2025-05-12_03-28-38", "timestamp": 1746984518, "time_this_iter_s": 41.08887267112732, "time_total_s": 4181.3102214336395, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4181.3102214336395, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 78.81525423728816, "ram_util_percent": 51.545762711864406}}
{"timers": {"training_iteration": 38.418616040385494, "restore_env_runners": 3.039157819191085e-05, "training_step": 38.4181020568925, "env_runner_sampling_timer": 29.2393232362767, "learner_update_timer": 9.17064276105689, "synch_weights": 0.007093703973117365, "synch_env_connectors": 0.008845611064210786}, "env_runners": {"episode_return_mean": 0.915876068376069, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.000127976046756054, "get_actions": 0.0007525682816330926, "un_batch_to_individual_items": 7.215334576201965e-05, "listify_data_for_vector_env": 0.00014776017451036927, "tensor_to_numpy": 0.00024742821088111493, "remove_single_ts_time_rank_from_batch": 8.755993574724326e-06}}, "connector_pipeline_timer": 0.0016872240604138427}, "episode_return_max": 1.450888888888891, "num_episodes_lifetime": 1032, "episode_duration_sec_mean": 23.6417088829811, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001739608733328767, "add_time_dim_to_batch_and_zero_pad": 3.962851768194187e-05, "add_states_from_episodes_to_batch": 1.9912110056240747e-05, "batch_individual_items": 0.00010054011985744493, "add_observations_from_episodes_to_batch": 4.1675063704048164e-05}}, "connector_pipeline_timer": 0.0006355692817445986}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 224000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 224000}, "sample": 28.311891823705196, "num_env_steps_sampled_lifetime": 224000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.584888888888889, "agent_episode_returns_mean": {"default_agent": 0.915876068376069}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.915876068376069}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.05911147229082, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005863761093059385, "weights_seq_no": 111.0, "env_to_module_sum_episodes_length_in": 93.05911147229082, "env_step_timer": 0.11597985381928781, "time_between_sampling": 9.84236949391912, "num_env_steps_sampled_lifetime_throughput": 48.74068209343998}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.0463631603042515e-13, "mean_kl_loss": 0.003768217284232378, "weights_seq_no": 112.0, "vf_loss": 0.013470669277012348, "gradients_default_optimizer_global_norm": 0.3090137541294098, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6785024, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013470669277012348, "vf_explained_var": 0.11741167306900024, "entropy": 0.20523372292518616, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03227487951517105, "policy_loss": -0.04574555531144142}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08049954445161618, "add_time_dim_to_batch_and_zero_pad": 3.2720082232191575e-05, "add_states_from_episodes_to_batch": 1.107205780399124e-05, "general_advantage_estimation": 0.09118744834042826, "batch_individual_items": 0.044960122735261995, "add_observations_from_episodes_to_batch": 0.0003609713888383662, "add_one_ts_to_episodes_and_truncate": 0.007227986931558203, "numpy_to_tensor": 0.0012096086981739172}}, "connector_pipeline_timer": 0.22603472105498706}, "num_env_steps_trained_lifetime": 106924928, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6785024, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.375260019633, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 224000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.74068209343998, "done": false, "training_iteration": 112, "trial_id": "8cacd_00000", "date": "2025-05-12_03-29-19", "timestamp": 1746984559, "time_this_iter_s": 40.961591720581055, "time_total_s": 4222.271813154221, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4222.271813154221, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 77.63448275862069, "ram_util_percent": 51.599999999999994}}
{"timers": {"training_iteration": 38.44843100128163, "restore_env_runners": 3.0306662404095538e-05, "training_step": 38.44791739862358, "env_runner_sampling_timer": 29.265782208973928, "learner_update_timer": 9.174017722686324, "synch_weights": 0.007075097933392426, "synch_env_connectors": 0.008854730953576072}, "env_runners": {"episode_return_mean": 1.0886014957264967, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012783830723753304, "get_actions": 0.0007554109396367337, "un_batch_to_individual_items": 7.149936240177363e-05, "listify_data_for_vector_env": 0.0001481555939891526, "tensor_to_numpy": 0.0002485635433816437, "remove_single_ts_time_rank_from_batch": 8.960258785803351e-06}}, "connector_pipeline_timer": 0.0016923503778553724}, "episode_return_max": 1.450888888888891, "num_episodes_lifetime": 1040, "episode_duration_sec_mean": 23.2439379684904, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001730441216282295, "add_time_dim_to_batch_and_zero_pad": 4.052175143983941e-05, "add_states_from_episodes_to_batch": 2.012909149336691e-05, "batch_individual_items": 0.00010075192000026599, "add_observations_from_episodes_to_batch": 4.309114801713264e-05}}, "connector_pipeline_timer": 0.0006389496834829623}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 226000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 226000}, "sample": 28.33659726359413, "num_env_steps_sampled_lifetime": 226000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6117777777777778, "agent_episode_returns_mean": {"default_agent": 1.0886014957264967}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0886014957264967}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.58418957234045, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005866535615259525, "weights_seq_no": 112.0, "env_to_module_sum_episodes_length_in": 93.58418957234045, "env_step_timer": 0.11573859308408557, "time_between_sampling": 9.846992538091666, "num_env_steps_sampled_lifetime_throughput": 48.213101063162654}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.0231815801521257e-13, "mean_kl_loss": 0.004712092690169811, "weights_seq_no": 113.0, "vf_loss": 0.014288915321230888, "gradients_default_optimizer_global_norm": 0.29298916459083557, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6845568, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014288915321230888, "vf_explained_var": 0.035143375396728516, "entropy": 0.28355473279953003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.026231229305267334, "policy_loss": 0.011942312121391296}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08052075209714299, "add_time_dim_to_batch_and_zero_pad": 3.273894940969474e-05, "add_states_from_episodes_to_batch": 1.107741565935045e-05, "general_advantage_estimation": 0.09075667393259346, "batch_individual_items": 0.045030151167021554, "add_observations_from_episodes_to_batch": 0.00036125661681621113, "add_one_ts_to_episodes_and_truncate": 0.007222364148746358, "numpy_to_tensor": 0.0012099929067075196}}, "connector_pipeline_timer": 0.2256894450022191}, "num_env_steps_trained_lifetime": 107878496, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6845568, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3789279525313, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 226000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.213101063162654, "done": false, "training_iteration": 113, "trial_id": "8cacd_00000", "date": "2025-05-12_03-30-01", "timestamp": 1746984601, "time_this_iter_s": 41.41851830482483, "time_total_s": 4263.690331459045, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4263.690331459045, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 77.63050847457627, "ram_util_percent": 51.606779661016944}}
{"timers": {"training_iteration": 38.48011619438881, "restore_env_runners": 3.0222595774158377e-05, "training_step": 38.47960334975735, "env_runner_sampling_timer": 29.2891606906842, "learner_update_timer": 9.18230307176946, "synch_weights": 0.007095376964066172, "synch_env_connectors": 0.00885084464404109}, "env_runners": {"episode_return_mean": 1.0331965811965824, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012747339753013255, "get_actions": 0.0007573453195008597, "un_batch_to_individual_items": 7.099880369785e-05, "listify_data_for_vector_env": 0.00014872262050557992, "tensor_to_numpy": 0.0002507153724828793, "remove_single_ts_time_rank_from_batch": 8.853506552957203e-06}}, "connector_pipeline_timer": 0.001695653475571827}, "episode_return_max": 1.2561111111111125, "num_episodes_lifetime": 1048, "episode_duration_sec_mean": 24.145043408076653, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001731617031204727, "add_time_dim_to_batch_and_zero_pad": 4.033430404104094e-05, "add_states_from_episodes_to_batch": 1.992205175409182e-05, "batch_individual_items": 0.00010029083746254513, "add_observations_from_episodes_to_batch": 4.332067104678595e-05}}, "connector_pipeline_timer": 0.0006384086332581365}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 228000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 228000}, "sample": 28.36112995934548, "num_env_steps_sampled_lifetime": 228000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6952222222222223, "agent_episode_returns_mean": {"default_agent": 1.0331965811965824}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0331965811965824}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.16158119918842, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005860648448678832, "weights_seq_no": 113.0, "env_to_module_sum_episodes_length_in": 96.16158119918842, "env_step_timer": 0.11507971654322231, "time_between_sampling": 9.85198547152063, "num_env_steps_sampled_lifetime_throughput": 47.898783457482345}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.0231815801521257e-13, "mean_kl_loss": 0.005987988319247961, "weights_seq_no": 114.0, "vf_loss": 0.017648307606577873, "gradients_default_optimizer_global_norm": 0.4693525433540344, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6906112, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017648307606577873, "vf_explained_var": 0.14459192752838135, "entropy": 0.21896064281463623, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.167885884642601, "policy_loss": -0.18553417921066284}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08054134695561416, "add_time_dim_to_batch_and_zero_pad": 3.275689723547571e-05, "add_states_from_episodes_to_batch": 1.1082569151691061e-05, "general_advantage_estimation": 0.09032610317808132, "batch_individual_items": 0.045098551357972354, "add_observations_from_episodes_to_batch": 0.0003615341430955178, "add_one_ts_to_episodes_and_truncate": 0.007216836622897633, "numpy_to_tensor": 0.0012103592202006542}}, "connector_pipeline_timer": 0.2253421979288011}, "num_env_steps_trained_lifetime": 108832064, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 6906112, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3824850007695, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 228000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.898783457482345, "done": false, "training_iteration": 114, "trial_id": "8cacd_00000", "date": "2025-05-12_03-30-43", "timestamp": 1746984643, "time_this_iter_s": 41.634984731674194, "time_total_s": 4305.32531619072, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4305.32531619072, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 77.00833333333331, "ram_util_percent": 51.61666666666667}}
{"timers": {"training_iteration": 38.53516206363492, "restore_env_runners": 3.018336979995031e-05, "training_step": 38.53464863044977, "env_runner_sampling_timer": 29.33927461658736, "learner_update_timer": 9.187235601431773, "synch_weights": 0.007093413194425268, "synch_env_connectors": 0.008857285207599933}, "env_runners": {"episode_return_mean": 1.0505950854700878, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012859063024277834, "get_actions": 0.0007563359948674055, "un_batch_to_individual_items": 7.079147378913204e-05, "listify_data_for_vector_env": 0.00014767316871213673, "tensor_to_numpy": 0.0002494373148823354, "remove_single_ts_time_rank_from_batch": 9.039028500925532e-06}}, "connector_pipeline_timer": 0.0016924808277097062}, "episode_return_max": 1.429444444444448, "num_episodes_lifetime": 1064, "episode_duration_sec_mean": 23.55260911005773, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017457843649429686, "add_time_dim_to_batch_and_zero_pad": 3.993832387802596e-05, "add_states_from_episodes_to_batch": 1.971566572131407e-05, "batch_individual_items": 0.00010022746026884439, "add_observations_from_episodes_to_batch": 4.3213454092953365e-05}}, "connector_pipeline_timer": 0.0006393066454258633}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 230000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 230000}, "sample": 28.38729553132758, "num_env_steps_sampled_lifetime": 230000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6307777777777783, "agent_episode_returns_mean": {"default_agent": 1.0505950854700878}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 1.0505950854700878}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.56517781012535, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005865964322554926, "weights_seq_no": 114.0, "env_to_module_sum_episodes_length_in": 97.56517781012535, "env_step_timer": 0.11603597806393559, "time_between_sampling": 9.85729371119071, "num_env_steps_sampled_lifetime_throughput": 45.38723863056722}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.1159079007606287e-14, "mean_kl_loss": 0.004796460270881653, "weights_seq_no": 115.0, "vf_loss": 0.023877356201410294, "gradients_default_optimizer_global_norm": 0.34586846828460693, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 6966912, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.023877356201410294, "vf_explained_var": 0.16406941413879395, "entropy": 0.1894824206829071, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.038071829825639725, "policy_loss": -0.06194917857646942}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08056194808160609, "add_time_dim_to_batch_and_zero_pad": 3.2773782209906154e-05, "add_states_from_episodes_to_batch": 1.1087511832593662e-05, "general_advantage_estimation": 0.08989580374126611, "batch_individual_items": 0.04516524964998744, "add_observations_from_episodes_to_batch": 0.00036182085318756704, "add_one_ts_to_episodes_and_truncate": 0.007211375261150927, "numpy_to_tensor": 0.0012106981481331575}}, "connector_pipeline_timer": 0.22499356729225137}, "num_env_steps_trained_lifetime": 109793464, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 6966912, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3867330152477, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 230000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.38723863056722, "done": false, "training_iteration": 115, "trial_id": "8cacd_00000", "date": "2025-05-12_03-31-27", "timestamp": 1746984687, "time_this_iter_s": 44.00562930107117, "time_total_s": 4349.330945491791, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4349.330945491791, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 78.95806451612903, "ram_util_percent": 51.630645161290325}}
{"timers": {"training_iteration": 38.59705671781856, "restore_env_runners": 3.0137536104942448e-05, "training_step": 38.59654285996526, "env_runner_sampling_timer": 29.395298711411485, "learner_update_timer": 9.193114001247459, "synch_weights": 0.00708558206249234, "synch_env_connectors": 0.008894670355531748}, "env_runners": {"episode_return_mean": 0.9288269230769254, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013045169360480859, "get_actions": 0.0007667548239927212, "un_batch_to_individual_items": 7.242125205407381e-05, "listify_data_for_vector_env": 0.00015085938766687474, "tensor_to_numpy": 0.0002572502731152653, "remove_single_ts_time_rank_from_batch": 9.269203155904351e-06}}, "connector_pipeline_timer": 0.0017210771503710647}, "episode_return_max": 1.429444444444448, "num_episodes_lifetime": 1072, "episode_duration_sec_mean": 24.28464236071143, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017796166010318395, "add_time_dim_to_batch_and_zero_pad": 4.006752117238949e-05, "add_states_from_episodes_to_batch": 1.9606638905876204e-05, "batch_individual_items": 0.0001019760982172946, "add_observations_from_episodes_to_batch": 4.332240245098425e-05}}, "connector_pipeline_timer": 0.0006482671476682821}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 232000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 232000}, "sample": 28.415216643332016, "num_env_steps_sampled_lifetime": 232000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5753333333333334, "agent_episode_returns_mean": {"default_agent": 0.9288269230769254}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9288269230769254}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.52343752036086, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005907747904589868, "weights_seq_no": 115.0, "env_to_module_sum_episodes_length_in": 96.52343752036086, "env_step_timer": 0.11797371656673884, "time_between_sampling": 9.862909775133616, "num_env_steps_sampled_lifetime_throughput": 44.630885722674414}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.5579539503803143e-14, "mean_kl_loss": 0.0026747267693281174, "weights_seq_no": 116.0, "vf_loss": 0.014328577555716038, "gradients_default_optimizer_global_norm": 0.34228450059890747, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7027456, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014328577555716038, "vf_explained_var": -0.018587231636047363, "entropy": 0.2264513075351715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.14764440059661865, "policy_loss": 0.1333158314228058}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08058236429038264, "add_time_dim_to_batch_and_zero_pad": 3.279547379502815e-05, "add_states_from_episodes_to_batch": 1.1092347402971633e-05, "general_advantage_estimation": 0.08946654694286939, "batch_individual_items": 0.04523056867102644, "add_observations_from_episodes_to_batch": 0.0003621040656634745, "add_one_ts_to_episodes_and_truncate": 0.007205906172976807, "numpy_to_tensor": 0.0012110507715849483}}, "connector_pipeline_timer": 0.22464442497863973}, "num_env_steps_trained_lifetime": 110747032, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7027456, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3908578209364, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 232000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.630885722674414, "done": false, "training_iteration": 116, "trial_id": "8cacd_00000", "date": "2025-05-12_03-32-12", "timestamp": 1746984732, "time_this_iter_s": 44.7447190284729, "time_total_s": 4394.075664520264, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4394.075664520264, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 78.0453125, "ram_util_percent": 51.621875}}
{"timers": {"training_iteration": 38.60494530788038, "restore_env_runners": 3.0046160742225957e-05, "training_step": 38.60443176560561, "env_runner_sampling_timer": 29.40949064569737, "learner_update_timer": 9.18683426807499, "synch_weights": 0.0070628302418651095, "synch_env_connectors": 0.00890049765198476}, "env_runners": {"episode_return_mean": 0.9365758547008567, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001308293388728251, "get_actions": 0.0007702916540864957, "un_batch_to_individual_items": 7.275739175308869e-05, "listify_data_for_vector_env": 0.00015217593298905317, "tensor_to_numpy": 0.0002587749815631669, "remove_single_ts_time_rank_from_batch": 9.209705314857537e-06}}, "connector_pipeline_timer": 0.0017282407380012745}, "episode_return_max": 1.2175555555555582, "num_episodes_lifetime": 1080, "episode_duration_sec_mean": 24.933210615375067, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017833889154490984, "add_time_dim_to_batch_and_zero_pad": 3.986535828576727e-05, "add_states_from_episodes_to_batch": 1.993013913327391e-05, "batch_individual_items": 0.00010160584947880818, "add_observations_from_episodes_to_batch": 4.340337329823176e-05}}, "connector_pipeline_timer": 0.000647566483933973}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 234000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 234000}, "sample": 28.44201544845957, "num_env_steps_sampled_lifetime": 234000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5753333333333334, "agent_episode_returns_mean": {"default_agent": 0.9365758547008567}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9365758547008567}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.48997330704012, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000592203947528689, "weights_seq_no": 116.0, "env_to_module_sum_episodes_length_in": 94.48997330704012, "env_step_timer": 0.11795211258585704, "time_between_sampling": 9.869091078252415, "num_env_steps_sampled_lifetime_throughput": 50.66917381413749}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.2789769751901572e-14, "mean_kl_loss": 0.002070089802145958, "weights_seq_no": 117.0, "vf_loss": 0.014238128438591957, "gradients_default_optimizer_global_norm": 0.756379246711731, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7088000, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014238128438591957, "vf_explained_var": 0.14395368099212646, "entropy": 0.2329322248697281, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.048611752688884735, "policy_loss": -0.06284987926483154}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08060267770017567, "add_time_dim_to_batch_and_zero_pad": 3.281648417019746e-05, "add_states_from_episodes_to_batch": 1.1097017510674306e-05, "general_advantage_estimation": 0.08903761322006644, "batch_individual_items": 0.04529447413657967, "add_observations_from_episodes_to_batch": 0.00036238414180462587, "add_one_ts_to_episodes_and_truncate": 0.007200402579039932, "numpy_to_tensor": 0.0012113767827529485}}, "connector_pipeline_timer": 0.22429402957447117}, "num_env_steps_trained_lifetime": 111700600, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7088000, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3948614572098, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 234000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.66917381413749, "done": false, "training_iteration": 117, "trial_id": "8cacd_00000", "date": "2025-05-12_03-32-51", "timestamp": 1746984771, "time_this_iter_s": 39.40278339385986, "time_total_s": 4433.4784479141235, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4433.4784479141235, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 79.6107142857143, "ram_util_percent": 51.63392857142858}}
{"timers": {"training_iteration": 38.63199765935156, "restore_env_runners": 3.0038699128493287e-05, "training_step": 38.63148256049955, "env_runner_sampling_timer": 29.43767363454041, "learner_update_timer": 9.185716852644251, "synch_weights": 0.007048241939464133, "synch_env_connectors": 0.008890151675456516}, "env_runners": {"episode_return_mean": 0.8914284188034198, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001317362943519716, "get_actions": 0.0007683919446654142, "un_batch_to_individual_items": 7.274349205549083e-05, "listify_data_for_vector_env": 0.0001514872975227909, "tensor_to_numpy": 0.0002576850344811083, "remove_single_ts_time_rank_from_batch": 9.689997588199452e-06}}, "connector_pipeline_timer": 0.0017276533009993864}, "episode_return_max": 1.2175555555555582, "num_episodes_lifetime": 1088, "episode_duration_sec_mean": 24.302693672394508, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017874157506996797, "add_time_dim_to_batch_and_zero_pad": 3.983318449332554e-05, "add_states_from_episodes_to_batch": 1.9941378265244676e-05, "batch_individual_items": 0.00010268638857937244, "add_observations_from_episodes_to_batch": 4.327918272488314e-05}}, "connector_pipeline_timer": 0.0006487855207598768}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 236000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 236000}, "sample": 28.468805072653527, "num_env_steps_sampled_lifetime": 236000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.577666666666667, "agent_episode_returns_mean": {"default_agent": 0.8914284188034198}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8914284188034198}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.96387440004465, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005959942972345128, "weights_seq_no": 117.0, "env_to_module_sum_episodes_length_in": 92.96387440004465, "env_step_timer": 0.11784158797282805, "time_between_sampling": 9.874356380304269, "num_env_steps_sampled_lifetime_throughput": 48.322056975997484}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.394884875950786e-15, "mean_kl_loss": 0.0021422228310257196, "weights_seq_no": 118.0, "vf_loss": 0.01237083412706852, "gradients_default_optimizer_global_norm": 0.2698516547679901, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7148544, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01237083412706852, "vf_explained_var": 0.023810267448425293, "entropy": 0.22894015908241272, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.014514001086354256, "policy_loss": 0.002143159508705139}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0806226271653439, "add_time_dim_to_batch_and_zero_pad": 3.284152479040866e-05, "add_states_from_episodes_to_batch": 1.1101644981584291e-05, "general_advantage_estimation": 0.08860895360702536, "batch_individual_items": 0.04535733773595485, "add_observations_from_episodes_to_batch": 0.0003626590260163795, "add_one_ts_to_episodes_and_truncate": 0.007194868976364461, "numpy_to_tensor": 0.0012116933886205797}}, "connector_pipeline_timer": 0.22394246292588818}, "num_env_steps_trained_lifetime": 112654168, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7148544, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.3987459349758, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 236000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.322056975997484, "done": false, "training_iteration": 118, "trial_id": "8cacd_00000", "date": "2025-05-12_03-33-32", "timestamp": 1746984812, "time_this_iter_s": 41.32728934288025, "time_total_s": 4474.805737257004, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4474.805737257004, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 80.14655172413794, "ram_util_percent": 51.622413793103455}}
{"timers": {"training_iteration": 38.64068596921804, "restore_env_runners": 3.0012312149931615e-05, "training_step": 38.640170353354556, "env_runner_sampling_timer": 29.451093720225, "learner_update_timer": 9.1809856955478, "synch_weights": 0.007046958520059967, "synch_env_connectors": 0.008881175158692859}, "env_runners": {"episode_return_mean": 0.9032243589743594, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013159915779753801, "get_actions": 0.0007669280904028421, "un_batch_to_individual_items": 7.284982773184805e-05, "listify_data_for_vector_env": 0.00015164434225310196, "tensor_to_numpy": 0.00025603189082528993, "remove_single_ts_time_rank_from_batch": 9.61134836501577e-06}}, "connector_pipeline_timer": 0.0017257149631319877}, "episode_return_max": 1.3385555555555575, "num_episodes_lifetime": 1096, "episode_duration_sec_mean": 24.068135137913277, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017840590655570602, "add_time_dim_to_batch_and_zero_pad": 4.0181585434675984e-05, "add_states_from_episodes_to_batch": 1.978582780698434e-05, "batch_individual_items": 0.00010182528891391147, "add_observations_from_episodes_to_batch": 4.284867793080169e-05}}, "connector_pipeline_timer": 0.0006470429584828991}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 238000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 238000}, "sample": 28.494695337510596, "num_env_steps_sampled_lifetime": 238000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.621888888888889, "agent_episode_returns_mean": {"default_agent": 0.9032243589743594}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9032243589743594}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.87054867860904, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005957144783487816, "weights_seq_no": 118.0, "env_to_module_sum_episodes_length_in": 92.87054867860904, "env_step_timer": 0.11735911949145182, "time_between_sampling": 9.87923917969053, "num_env_steps_sampled_lifetime_throughput": 50.520190810455}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.197442437975393e-15, "mean_kl_loss": 0.0042266747914254665, "weights_seq_no": 119.0, "vf_loss": 0.009758819825947285, "gradients_default_optimizer_global_norm": 0.2621123492717743, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7209088, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009758819825947285, "vf_explained_var": 0.12909704446792603, "entropy": 0.25790664553642273, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.08756524324417114, "policy_loss": -0.09732406586408615}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08064322527353876, "add_time_dim_to_batch_and_zero_pad": 3.2865762949934334e-05, "add_states_from_episodes_to_batch": 1.110608020137589e-05, "general_advantage_estimation": 0.08818121753492301, "batch_individual_items": 0.04541878584592879, "add_observations_from_episodes_to_batch": 0.0003629294141297009, "add_one_ts_to_episodes_and_truncate": 0.00718931182548461, "numpy_to_tensor": 0.0012120583146927224}}, "connector_pipeline_timer": 0.22359109473741948}, "num_env_steps_trained_lifetime": 113607736, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7209088, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4025132370407, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 238000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.520190810455, "done": false, "training_iteration": 119, "trial_id": "8cacd_00000", "date": "2025-05-12_03-34-12", "timestamp": 1746984852, "time_this_iter_s": 39.51778531074524, "time_total_s": 4514.323522567749, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4514.323522567749, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 80.10535714285713, "ram_util_percent": 51.621428571428574}}
{"timers": {"training_iteration": 38.66719331599584, "restore_env_runners": 2.99281890360724e-05, "training_step": 38.666673465291005, "env_runner_sampling_timer": 29.46536764219276, "learner_update_timer": 9.193222432892338, "synch_weights": 0.007029576934881766, "synch_env_connectors": 0.008879717407130719}, "env_runners": {"episode_return_mean": 0.8446655982905988, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013085233509597802, "get_actions": 0.0007633160144680655, "un_batch_to_individual_items": 7.393579633148668e-05, "listify_data_for_vector_env": 0.0001503561248026382, "tensor_to_numpy": 0.00025520840511667744, "remove_single_ts_time_rank_from_batch": 9.474096954453915e-06}}, "connector_pipeline_timer": 0.0017199830601915486}, "episode_return_max": 1.3385555555555575, "num_episodes_lifetime": 1104, "episode_duration_sec_mean": 24.039480377471047, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017771345281109846, "add_time_dim_to_batch_and_zero_pad": 3.997470296519477e-05, "add_states_from_episodes_to_batch": 1.9806411282657216e-05, "batch_individual_items": 0.00010156888450563837, "add_observations_from_episodes_to_batch": 4.297206082466609e-05}}, "connector_pipeline_timer": 0.0006452170114117585}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 240000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 240000}, "sample": 28.519763233469423, "num_env_steps_sampled_lifetime": 240000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5861111111111108, "agent_episode_returns_mean": {"default_agent": 0.8446655982905988}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8446655982905988}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.71835386281273, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005927389809392329, "weights_seq_no": 119.0, "env_to_module_sum_episodes_length_in": 94.71835386281273, "env_step_timer": 0.11659659774546528, "time_between_sampling": 9.883233438610159, "num_env_steps_sampled_lifetime_throughput": 48.342528494656676}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.197442437975393e-15, "mean_kl_loss": 0.00745534198358655, "weights_seq_no": 120.0, "vf_loss": 0.013564293272793293, "gradients_default_optimizer_global_norm": 0.2732676565647125, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7269632, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013564293272793293, "vf_explained_var": 0.09171301126480103, "entropy": 0.2329624593257904, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06429581344127655, "policy_loss": 0.05073151737451553}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08066419533685301, "add_time_dim_to_batch_and_zero_pad": 3.2889022193570816e-05, "add_states_from_episodes_to_batch": 1.1110296552095948e-05, "general_advantage_estimation": 0.08775398606890203, "batch_individual_items": 0.04550505330002973, "add_observations_from_episodes_to_batch": 0.0003631904585780397, "add_one_ts_to_episodes_and_truncate": 0.00718367676072479, "numpy_to_tensor": 0.0012123990229045642}}, "connector_pipeline_timer": 0.22326530217652749}, "num_env_steps_trained_lifetime": 114561304, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7269632, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4061653184708, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 240000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.342528494656676, "done": false, "training_iteration": 120, "trial_id": "8cacd_00000", "date": "2025-05-12_03-34-53", "timestamp": 1746984893, "time_this_iter_s": 41.30827522277832, "time_total_s": 4555.631797790527, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4555.631797790527, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 76.81525423728814, "ram_util_percent": 51.62203389830509}}
{"timers": {"training_iteration": 38.710933475425854, "restore_env_runners": 2.9832907171117223e-05, "training_step": 38.71041391322808, "env_runner_sampling_timer": 29.50409756112082, "learner_update_timer": 9.198229329803407, "synch_weights": 0.007032330165517115, "synch_env_connectors": 0.00887129923305122}, "env_runners": {"episode_return_mean": 0.8136923076923094, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013103867638393225, "get_actions": 0.0007636784600640321, "un_batch_to_individual_items": 7.387277363857912e-05, "listify_data_for_vector_env": 0.00014895835604157568, "tensor_to_numpy": 0.0002535642122254136, "remove_single_ts_time_rank_from_batch": 9.275873473036556e-06}}, "connector_pipeline_timer": 0.0017156627610183692}, "episode_return_max": 1.2053333333333356, "num_episodes_lifetime": 1120, "episode_duration_sec_mean": 23.61132255121185, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017747663837896482, "add_time_dim_to_batch_and_zero_pad": 3.974658073339489e-05, "add_states_from_episodes_to_batch": 1.9841091662021613e-05, "batch_individual_items": 0.00010077414996143119, "add_observations_from_episodes_to_batch": 4.2801294786247305e-05}}, "connector_pipeline_timer": 0.0006421650086927716}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 242000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 242000}, "sample": 28.54572873878916, "num_env_steps_sampled_lifetime": 242000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6131111111111124, "agent_episode_returns_mean": {"default_agent": 0.8136923076923094}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8136923076923094}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.05466286991968, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005925490607884362, "weights_seq_no": 120.0, "env_to_module_sum_episodes_length_in": 97.05466286991968, "env_step_timer": 0.11742491588002098, "time_between_sampling": 9.88787250868295, "num_env_steps_sampled_lifetime_throughput": 46.24825371738884}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.197442437975393e-15, "mean_kl_loss": 0.005679087247699499, "weights_seq_no": 121.0, "vf_loss": 0.010071277618408203, "gradients_default_optimizer_global_norm": 0.8033846616744995, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 7330432, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010071277618408203, "vf_explained_var": -0.004956483840942383, "entropy": 0.25503793358802795, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.013065600767731667, "policy_loss": 0.002994330832734704}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08068492761637368, "add_time_dim_to_batch_and_zero_pad": 3.291143967600609e-05, "add_states_from_episodes_to_batch": 1.1114337967908495e-05, "general_advantage_estimation": 0.08732728120044773, "batch_individual_items": 0.04558963893646414, "add_observations_from_episodes_to_batch": 0.0003634627991961234, "add_one_ts_to_episodes_and_truncate": 0.007178106996077437, "numpy_to_tensor": 0.0012127400311206305}}, "connector_pipeline_timer": 0.22293819408737942}, "num_env_steps_trained_lifetime": 115522704, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 7330432, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4105041069486, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 242000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.24825371738884, "done": false, "training_iteration": 121, "trial_id": "8cacd_00000", "date": "2025-05-12_03-35-37", "timestamp": 1746984937, "time_this_iter_s": 43.058653354644775, "time_total_s": 4598.690451145172, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4598.690451145172, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 79.05409836065576, "ram_util_percent": 51.6639344262295}}
{"timers": {"training_iteration": 38.7204722440616, "restore_env_runners": 2.978057811720223e-05, "training_step": 38.719952162485825, "env_runner_sampling_timer": 29.521574207509587, "learner_update_timer": 9.190280409895347, "synch_weights": 0.00701927486388061, "synch_env_connectors": 0.00887962624072127}, "env_runners": {"episode_return_mean": 0.7851826923076941, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013043269243707788, "get_actions": 0.000764454482209888, "un_batch_to_individual_items": 7.40059946625233e-05, "listify_data_for_vector_env": 0.000149203474121056, "tensor_to_numpy": 0.0002530179121057007, "remove_single_ts_time_rank_from_batch": 9.169916511200873e-06}}, "connector_pipeline_timer": 0.0017152386676125891}, "episode_return_max": 1.0658888888888922, "num_episodes_lifetime": 1128, "episode_duration_sec_mean": 23.77620339641355, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017739628055393574, "add_time_dim_to_batch_and_zero_pad": 3.951843487016298e-05, "add_states_from_episodes_to_batch": 1.9969719672105233e-05, "batch_individual_items": 0.00010060681465598577, "add_observations_from_episodes_to_batch": 4.259636127891782e-05}}, "connector_pipeline_timer": 0.000641972795283114}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 244000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 244000}, "sample": 28.571121454428212, "num_env_steps_sampled_lifetime": 244000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5371111111111113, "agent_episode_returns_mean": {"default_agent": 0.7851826923076941}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.7851826923076941}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.86987127269667, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005922450505675721, "weights_seq_no": 121.0, "env_to_module_sum_episodes_length_in": 96.86987127269667, "env_step_timer": 0.11817569338226588, "time_between_sampling": 9.892685906977245, "num_env_steps_sampled_lifetime_throughput": 50.32285731305429}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.5987212189876965e-15, "mean_kl_loss": 0.004702692851424217, "weights_seq_no": 122.0, "vf_loss": 0.017781630158424377, "gradients_default_optimizer_global_norm": 0.6301811337471008, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7390976, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017781630158424377, "vf_explained_var": -0.004415154457092285, "entropy": 0.23843011260032654, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.10821037739515305, "policy_loss": -0.12599200010299683}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08070616452087011, "add_time_dim_to_batch_and_zero_pad": 3.293319990637907e-05, "add_states_from_episodes_to_batch": 1.1118357525563592e-05, "general_advantage_estimation": 0.08690168498075572, "batch_individual_items": 0.045672601954840145, "add_observations_from_episodes_to_batch": 0.00036373095395583136, "add_one_ts_to_episodes_and_truncate": 0.007172556399047126, "numpy_to_tensor": 0.0012130541192700549}}, "connector_pipeline_timer": 0.22261106293989671}, "num_env_steps_trained_lifetime": 116476272, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7390976, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.414715503125, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 244000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.32285731305429, "done": false, "training_iteration": 122, "trial_id": "8cacd_00000", "date": "2025-05-12_03-36-16", "timestamp": 1746984976, "time_this_iter_s": 39.68198108673096, "time_total_s": 4638.372432231903, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4638.372432231903, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 79.74561403508773, "ram_util_percent": 51.652631578947364}}
{"timers": {"training_iteration": 38.72609061566098, "restore_env_runners": 2.9747772316602816e-05, "training_step": 38.72556998490094, "env_runner_sampling_timer": 29.527225280394482, "learner_update_timer": 9.1902690898764, "synch_weights": 0.006998557115256158, "synch_env_connectors": 0.008875967978308969}, "env_runners": {"episode_return_mean": 0.9129166666666689, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012934456334346006, "get_actions": 0.0007629662003857199, "un_batch_to_individual_items": 7.417797038181352e-05, "listify_data_for_vector_env": 0.00014985484195458498, "tensor_to_numpy": 0.00025207525612131013, "remove_single_ts_time_rank_from_batch": 9.040797322852862e-06}}, "connector_pipeline_timer": 0.0017111395821357317}, "episode_return_max": 1.2608888888888923, "num_episodes_lifetime": 1136, "episode_duration_sec_mean": 23.287065937029464, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000176719757575793, "add_time_dim_to_batch_and_zero_pad": 3.946007111710188e-05, "add_states_from_episodes_to_batch": 1.97989756033773e-05, "batch_individual_items": 0.00010035938129486824, "add_observations_from_episodes_to_batch": 4.2304689199313586e-05}}, "connector_pipeline_timer": 0.000642190214651568}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 246000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 246000}, "sample": 28.59499002429417, "num_env_steps_sampled_lifetime": 246000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5371111111111113, "agent_episode_returns_mean": {"default_agent": 0.9129166666666689}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9129166666666689}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.00606473331294, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005883846094722944, "weights_seq_no": 122.0, "env_to_module_sum_episodes_length_in": 95.00606473331294, "env_step_timer": 0.11797321034360234, "time_between_sampling": 9.896425354003016, "num_env_steps_sampled_lifetime_throughput": 50.80159247919583}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 7.993606094938482e-16, "mean_kl_loss": 0.0038074366748332977, "weights_seq_no": 123.0, "vf_loss": 0.022164419293403625, "gradients_default_optimizer_global_norm": 0.8199681043624878, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7451520, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.022164419293403625, "vf_explained_var": 0.04607611894607544, "entropy": 0.2528228461742401, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.18404722213745117, "policy_loss": -0.206211656332016}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08072697029451507, "add_time_dim_to_batch_and_zero_pad": 3.2953573788168815e-05, "add_states_from_episodes_to_batch": 1.1122175258167389e-05, "general_advantage_estimation": 0.08647649047733738, "batch_individual_items": 0.04575377739895498, "add_observations_from_episodes_to_batch": 0.00036399675934036256, "add_one_ts_to_episodes_and_truncate": 0.007166922183257977, "numpy_to_tensor": 0.0012133412516532381}}, "connector_pipeline_timer": 0.222281995715955}, "num_env_steps_trained_lifetime": 117429840, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7451520, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.418801620967, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 246000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.80159247919583, "done": false, "training_iteration": 123, "trial_id": "8cacd_00000", "date": "2025-05-12_03-36-56", "timestamp": 1746985016, "time_this_iter_s": 39.2989182472229, "time_total_s": 4677.671350479126, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4677.671350479126, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 79.48363636363636, "ram_util_percent": 51.62545454545454}}
{"timers": {"training_iteration": 38.80723438274437, "restore_env_runners": 2.9734294609545408e-05, "training_step": 38.80671275929192, "env_runner_sampling_timer": 29.59545584378055, "learner_update_timer": 9.203196818027614, "synch_weights": 0.006981819544071021, "synch_env_connectors": 0.00887343429851077}, "env_runners": {"episode_return_mean": 0.883221153846155, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001309113297737512, "get_actions": 0.0007688995166872105, "un_batch_to_individual_items": 7.429690490801366e-05, "listify_data_for_vector_env": 0.0001506638355319994, "tensor_to_numpy": 0.00025281645941854655, "remove_single_ts_time_rank_from_batch": 9.109793233254035e-06}}, "connector_pipeline_timer": 0.0017222410049960557}, "episode_return_max": 1.2608888888888923, "num_episodes_lifetime": 1144, "episode_duration_sec_mean": 24.71138073913506, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001792758954598657, "add_time_dim_to_batch_and_zero_pad": 3.913321625806776e-05, "add_states_from_episodes_to_batch": 1.9969945389330098e-05, "batch_individual_items": 0.00010118831491395267, "add_observations_from_episodes_to_batch": 4.2543035233974676e-05}}, "connector_pipeline_timer": 0.0006486959897884559}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 248000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 248000}, "sample": 28.621540723888263, "num_env_steps_sampled_lifetime": 248000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6286666666666675, "agent_episode_returns_mean": {"default_agent": 0.883221153846155}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.883221153846155}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.18461887024247, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000594076859451478, "weights_seq_no": 123.0, "env_to_module_sum_episodes_length_in": 93.18461887024247, "env_step_timer": 0.11860971967878778, "time_between_sampling": 9.899855188933183, "num_env_steps_sampled_lifetime_throughput": 42.630783302766055}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.996803047469241e-16, "mean_kl_loss": 0.0025301987770944834, "weights_seq_no": 124.0, "vf_loss": 0.010059772990643978, "gradients_default_optimizer_global_norm": 0.31150633096694946, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7512064, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010059772990643978, "vf_explained_var": 0.059302330017089844, "entropy": 0.19180981814861298, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.04586080461740494, "policy_loss": -0.05592058598995209}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08074775500623514, "add_time_dim_to_batch_and_zero_pad": 3.297289687250165e-05, "add_states_from_episodes_to_batch": 1.1125854800722016e-05, "general_advantage_estimation": 0.0860518011554892, "batch_individual_items": 0.04583344638399213, "add_observations_from_episodes_to_batch": 0.00036425302552177755, "add_one_ts_to_episodes_and_truncate": 0.007161230946144899, "numpy_to_tensor": 0.0012136279159766091}}, "connector_pipeline_timer": 0.22195183490019801}, "num_env_steps_trained_lifetime": 118383408, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7512064, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.422764544902, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 248000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 42.630783302766055, "done": false, "training_iteration": 124, "trial_id": "8cacd_00000", "date": "2025-05-12_03-37-43", "timestamp": 1746985063, "time_this_iter_s": 46.860329389572144, "time_total_s": 4724.531679868698, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4724.531679868698, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 77.16417910447761, "ram_util_percent": 51.637313432835825}}
{"timers": {"training_iteration": 38.86044717957692, "restore_env_runners": 2.9680951666017143e-05, "training_step": 38.859925703349, "env_runner_sampling_timer": 29.64940651065274, "learner_update_timer": 9.20247632511735, "synch_weights": 0.006963876408610686, "synch_env_connectors": 0.008878065955526631}, "env_runners": {"episode_return_mean": 0.9706175213675217, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001312190700700951, "get_actions": 0.0007726147430672975, "un_batch_to_individual_items": 7.518296471063971e-05, "listify_data_for_vector_env": 0.00015187322057866028, "tensor_to_numpy": 0.00025492854733761205, "remove_single_ts_time_rank_from_batch": 8.977689600563394e-06}}, "connector_pipeline_timer": 0.0017318826227276296}, "episode_return_max": 1.2158888888888901, "num_episodes_lifetime": 1152, "episode_duration_sec_mean": 26.260980997635635, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001798710228366718, "add_time_dim_to_batch_and_zero_pad": 3.906181438840351e-05, "add_states_from_episodes_to_batch": 2.034110263808183e-05, "batch_individual_items": 0.00010150585538050537, "add_observations_from_episodes_to_batch": 4.30320465177919e-05}}, "connector_pipeline_timer": 0.0006510858756379042}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 250000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 250000}, "sample": 28.649846728466365, "num_env_steps_sampled_lifetime": 250000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6726666666666667, "agent_episode_returns_mean": {"default_agent": 0.9706175213675217}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9706175213675217}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.5245620427042, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005997492823109507, "weights_seq_no": 124.0, "env_to_module_sum_episodes_length_in": 92.5245620427042, "env_step_timer": 0.11869941026589664, "time_between_sampling": 9.904759232015143, "num_env_steps_sampled_lifetime_throughput": 45.23038656989572}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.9984015237346206e-16, "mean_kl_loss": 0.0015649235574528575, "weights_seq_no": 125.0, "vf_loss": 0.008931848220527172, "gradients_default_optimizer_global_norm": 0.5531857013702393, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7572608, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008931848220527172, "vf_explained_var": 0.15306150913238525, "entropy": 0.20218712091445923, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.05112198367714882, "policy_loss": -0.06005382537841797}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08076958451739129, "add_time_dim_to_batch_and_zero_pad": 3.29925481377441e-05, "add_states_from_episodes_to_batch": 1.1130228535026864e-05, "general_advantage_estimation": 0.08562786418113011, "batch_individual_items": 0.0459114840618889, "add_observations_from_episodes_to_batch": 0.0003645045967035838, "add_one_ts_to_episodes_and_truncate": 0.007155619031555981, "numpy_to_tensor": 0.0012139221228881518}}, "connector_pipeline_timer": 0.2216219360022846}, "num_env_steps_trained_lifetime": 119336976, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7572608, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4266063301961, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 250000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.23038656989572, "done": false, "training_iteration": 125, "trial_id": "8cacd_00000", "date": "2025-05-12_03-38-27", "timestamp": 1746985107, "time_this_iter_s": 44.144978761672974, "time_total_s": 4768.676658630371, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4768.676658630371, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 79.5111111111111, "ram_util_percent": 51.65555555555555}}
{"timers": {"training_iteration": 38.88477316767116, "restore_env_runners": 2.9626142136695176e-05, "training_step": 38.88425219520552, "env_runner_sampling_timer": 29.66719309039618, "learner_update_timer": 9.209029874906157, "synch_weights": 0.006951092644527122, "synch_env_connectors": 0.008875581385947169}, "env_runners": {"episode_return_mean": 0.9241282051282056, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013035060643924786, "get_actions": 0.0007720817639243984, "un_batch_to_individual_items": 7.54621477388334e-05, "listify_data_for_vector_env": 0.00015099491232778358, "tensor_to_numpy": 0.0002557338616631526, "remove_single_ts_time_rank_from_batch": 8.929734233799604e-06}}, "connector_pipeline_timer": 0.0017297128824515884}, "episode_return_max": 1.232111111111112, "num_episodes_lifetime": 1160, "episode_duration_sec_mean": 26.018053476972383, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017869271913694513, "add_time_dim_to_batch_and_zero_pad": 3.9236119433643166e-05, "add_states_from_episodes_to_batch": 2.0488471694034764e-05, "batch_individual_items": 0.00010252781782211259, "add_observations_from_episodes_to_batch": 4.2941213310416606e-05}}, "connector_pipeline_timer": 0.0006514236849064869}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 252000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 252000}, "sample": 28.677413013494057, "num_env_steps_sampled_lifetime": 252000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6012222222222224, "agent_episode_returns_mean": {"default_agent": 0.9241282051282056}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9241282051282056}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.66224629659585, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005987005512395084, "weights_seq_no": 125.0, "env_to_module_sum_episodes_length_in": 93.66224629659585, "env_step_timer": 0.1179933042210179, "time_between_sampling": 9.909579156194173, "num_env_steps_sampled_lifetime_throughput": 48.33744788807561}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 9.992007618673103e-17, "mean_kl_loss": 0.003440129803493619, "weights_seq_no": 126.0, "vf_loss": 0.010495455004274845, "gradients_default_optimizer_global_norm": 0.4682725965976715, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7633152, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010495455004274845, "vf_explained_var": 0.09318065643310547, "entropy": 0.18506594002246857, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.059434372931718826, "policy_loss": 0.048938922584056854}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08079166273282376, "add_time_dim_to_batch_and_zero_pad": 3.301196908814716e-05, "add_states_from_episodes_to_batch": 1.1135272209216528e-05, "general_advantage_estimation": 0.08520457383614258, "batch_individual_items": 0.045987960061689606, "add_observations_from_episodes_to_batch": 0.000364756381159266, "add_one_ts_to_episodes_and_truncate": 0.007149970342164202, "numpy_to_tensor": 0.0012141985528699637}}, "connector_pipeline_timer": 0.22129131864893972}, "num_env_steps_trained_lifetime": 120290544, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7633152, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.43032900333, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.33744788807561, "done": false, "training_iteration": 126, "trial_id": "8cacd_00000", "date": "2025-05-12_03-39-08", "timestamp": 1746985148, "time_this_iter_s": 41.313483476638794, "time_total_s": 4809.99014210701, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4809.99014210701, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 78.95344827586207, "ram_util_percent": 51.66896551724137}}
{"timers": {"training_iteration": 38.89811106986445, "restore_env_runners": 2.9939880703556306e-05, "training_step": 38.897588161123466, "env_runner_sampling_timer": 29.684684502342222, "learner_update_timer": 9.204864754177073, "synch_weights": 0.006961485718094753, "synch_env_connectors": 0.008880265572070061}, "env_runners": {"episode_return_mean": 0.8199091880341888, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001306820898348829, "get_actions": 0.0007698470236936799, "un_batch_to_individual_items": 7.519860806272338e-05, "listify_data_for_vector_env": 0.00015027469558211748, "tensor_to_numpy": 0.00025504412145608624, "remove_single_ts_time_rank_from_batch": 8.966674537619127e-06}}, "connector_pipeline_timer": 0.001726524513524787}, "episode_return_max": 1.232111111111112, "num_episodes_lifetime": 1168, "episode_duration_sec_mean": 24.438008979539063, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001777743825577324, "add_time_dim_to_batch_and_zero_pad": 3.949788788382284e-05, "add_states_from_episodes_to_batch": 2.0620571854148676e-05, "batch_individual_items": 0.00010197532389653631, "add_observations_from_episodes_to_batch": 4.3226197217214675e-05}}, "connector_pipeline_timer": 0.0006503783596687033}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 254000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 254000}, "sample": 28.70399817221889, "num_env_steps_sampled_lifetime": 254000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6012222222222224, "agent_episode_returns_mean": {"default_agent": 0.8199091880341888}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8199091880341888}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.91874906657739, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005970194631805805, "weights_seq_no": 126.0, "env_to_module_sum_episodes_length_in": 96.91874906657739, "env_step_timer": 0.1169755130591637, "time_between_sampling": 9.91445063783454, "num_env_steps_sampled_lifetime_throughput": 49.62564191222682}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.9960038093365514e-17, "mean_kl_loss": 0.0020956650841981173, "weights_seq_no": 127.0, "vf_loss": 0.01783575676381588, "gradients_default_optimizer_global_norm": 0.4498046338558197, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7693696, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01783575676381588, "vf_explained_var": 0.17205488681793213, "entropy": 0.2192295491695404, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.10243116319179535, "policy_loss": 0.08459538966417313}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08081360764559602, "add_time_dim_to_batch_and_zero_pad": 3.3030652364999464e-05, "add_states_from_episodes_to_batch": 1.1140171986849052e-05, "general_advantage_estimation": 0.08478218649173677, "batch_individual_items": 0.04606267536308797, "add_observations_from_episodes_to_batch": 0.0003650062994658981, "add_one_ts_to_episodes_and_truncate": 0.007144278714657389, "numpy_to_tensor": 0.0012144621320396864}}, "connector_pipeline_timer": 0.22095965585926136}, "num_env_steps_trained_lifetime": 121244112, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7693696, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.433934562368, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 254000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.62564191222682, "done": false, "training_iteration": 127, "trial_id": "8cacd_00000", "date": "2025-05-12_03-39-49", "timestamp": 1746985189, "time_this_iter_s": 40.236873388290405, "time_total_s": 4850.2270154953, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4850.2270154953, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 78.13103448275862, "ram_util_percent": 51.639655172413796}}
{"timers": {"training_iteration": 38.94553668177581, "restore_env_runners": 2.9843481914311796e-05, "training_step": 38.94501425012221, "env_runner_sampling_timer": 29.72729076124879, "learner_update_timer": 9.209695426315276, "synch_weights": 0.0069508538609309835, "synch_env_connectors": 0.008888450916354146}, "env_runners": {"episode_return_mean": 0.8837179487179512, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001299025462235469, "get_actions": 0.0007665722214082843, "un_batch_to_individual_items": 7.465632180906107e-05, "listify_data_for_vector_env": 0.00014956740914002454, "tensor_to_numpy": 0.0002541438322616692, "remove_single_ts_time_rank_from_batch": 8.857266258921981e-06}}, "connector_pipeline_timer": 0.0017186927918249964}, "episode_return_max": 1.4860000000000049, "num_episodes_lifetime": 1184, "episode_duration_sec_mean": 23.82672903729823, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017618134736001507, "add_time_dim_to_batch_and_zero_pad": 3.945982251113341e-05, "add_states_from_episodes_to_batch": 2.0435698100574754e-05, "batch_individual_items": 0.00010123878925157087, "add_observations_from_episodes_to_batch": 4.332783327732133e-05}}, "connector_pipeline_timer": 0.0006477595131406234}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 256000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 256000}, "sample": 28.73158357102651, "num_env_steps_sampled_lifetime": 256000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5610000000000008, "agent_episode_returns_mean": {"default_agent": 0.8837179487179512}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8837179487179512}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.74746009308343, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005942048792059137, "weights_seq_no": 127.0, "env_to_module_sum_episodes_length_in": 97.74746009308343, "env_step_timer": 0.11757540143063107, "time_between_sampling": 9.918836254985155, "num_env_steps_sampled_lifetime_throughput": 45.71659990215682}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.4980019046682757e-17, "mean_kl_loss": 0.0023506563156843185, "weights_seq_no": 128.0, "vf_loss": 0.017660804092884064, "gradients_default_optimizer_global_norm": 0.42858853936195374, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 7754496, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017660804092884064, "vf_explained_var": 0.04948967695236206, "entropy": 0.1902562528848648, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06760024279356003, "policy_loss": -0.08526105433702469}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08083488400393946, "add_time_dim_to_batch_and_zero_pad": 3.304859077916091e-05, "add_states_from_episodes_to_batch": 1.1144910241699669e-05, "general_advantage_estimation": 0.08436051401683564, "batch_individual_items": 0.04613558734245238, "add_observations_from_episodes_to_batch": 0.00036527467376841575, "add_one_ts_to_episodes_and_truncate": 0.007138685322666436, "numpy_to_tensor": 0.0012147091397706816}}, "connector_pipeline_timer": 0.22062633243361182}, "num_env_steps_trained_lifetime": 122205512, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 7754496, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.438224977325, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 256000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.71659990215682, "done": false, "training_iteration": 128, "trial_id": "8cacd_00000", "date": "2025-05-12_03-40-32", "timestamp": 1746985232, "time_this_iter_s": 43.65858817100525, "time_total_s": 4893.8856036663055, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4893.8856036663055, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 78.72580645161291, "ram_util_percent": 51.72741935483869}}
{"timers": {"training_iteration": 38.95718663116807, "restore_env_runners": 2.9759047087579798e-05, "training_step": 38.956664521831, "env_runner_sampling_timer": 29.73335917025629, "learner_update_timer": 9.215280522642134, "synch_weights": 0.006947933322330451, "synch_env_connectors": 0.008903645407165777}, "env_runners": {"episode_return_mean": 0.8045972222222242, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012938178599852446, "get_actions": 0.0007655004088690391, "un_batch_to_individual_items": 7.462607648322927e-05, "listify_data_for_vector_env": 0.00014914493886060523, "tensor_to_numpy": 0.0002542334435796491, "remove_single_ts_time_rank_from_batch": 8.79405766168751e-06}}, "connector_pipeline_timer": 0.0017167364316682753}, "episode_return_max": 1.1911111111111146, "num_episodes_lifetime": 1192, "episode_duration_sec_mean": 23.53351117361598, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000175391041978901, "add_time_dim_to_batch_and_zero_pad": 3.936223391137422e-05, "add_states_from_episodes_to_batch": 2.048603086615372e-05, "batch_individual_items": 0.0001005587772209533, "add_observations_from_episodes_to_batch": 4.2858173706560314e-05}}, "connector_pipeline_timer": 0.0006456222680891651}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 258000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 258000}, "sample": 28.757749708153828, "num_env_steps_sampled_lifetime": 258000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.5610000000000008, "agent_episode_returns_mean": {"default_agent": 0.8045972222222242}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8045972222222242}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.21647546985457, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005928737077368398, "weights_seq_no": 128.0, "env_to_module_sum_episodes_length_in": 96.21647546985457, "env_step_timer": 0.11768527003740792, "time_between_sampling": 9.923483347713022, "num_env_steps_sampled_lifetime_throughput": 49.76004856051148}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.2490009523341379e-17, "mean_kl_loss": 0.0034854430705308914, "weights_seq_no": 129.0, "vf_loss": 0.009017279371619225, "gradients_default_optimizer_global_norm": 0.2105623483657837, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7815040, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009017279371619225, "vf_explained_var": -0.003809690475463867, "entropy": 0.20909088850021362, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.05836790055036545, "policy_loss": -0.06738518923521042}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08085596645445163, "add_time_dim_to_batch_and_zero_pad": 3.306641735991303e-05, "add_states_from_episodes_to_batch": 1.114975971411938e-05, "general_advantage_estimation": 0.08393957722278346, "batch_individual_items": 0.04620693672469337, "add_observations_from_episodes_to_batch": 0.0003655370299550676, "add_one_ts_to_episodes_and_truncate": 0.007133032950643993, "numpy_to_tensor": 0.001214928771234019}}, "connector_pipeline_timer": 0.22029189537108942}, "num_env_steps_trained_lifetime": 123159080, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7815040, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4423861905266, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 258000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.76004856051148, "done": false, "training_iteration": 129, "trial_id": "8cacd_00000", "date": "2025-05-12_03-41-12", "timestamp": 1746985272, "time_this_iter_s": 40.13016152381897, "time_total_s": 4934.0157651901245, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4934.0157651901245, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 78.60877192982456, "ram_util_percent": 51.715789473684204}}
{"timers": {"training_iteration": 38.979557305406395, "restore_env_runners": 2.9742456609969142e-05, "training_step": 38.979032687162665, "env_runner_sampling_timer": 29.748478195123734, "learner_update_timer": 9.222500812395714, "synch_weights": 0.006978639989125003, "synch_env_connectors": 0.008910536963108296}, "env_runners": {"episode_return_mean": 0.8795138888888901, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001290277895819949, "get_actions": 0.0007646875976756237, "un_batch_to_individual_items": 7.522199217610139e-05, "listify_data_for_vector_env": 0.00014938709722293992, "tensor_to_numpy": 0.00025448048777275433, "remove_single_ts_time_rank_from_batch": 8.711083795526168e-06}}, "connector_pipeline_timer": 0.001715827744806513}, "episode_return_max": 1.2356666666666685, "num_episodes_lifetime": 1200, "episode_duration_sec_mean": 23.5466866321452, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017499688926684705, "add_time_dim_to_batch_and_zero_pad": 3.9347804791176275e-05, "add_states_from_episodes_to_batch": 2.0698997669683118e-05, "batch_individual_items": 0.00010015951193474941, "add_observations_from_episodes_to_batch": 4.2984069718099526e-05}}, "connector_pipeline_timer": 0.0006446138178225995}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 260000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 260000}, "sample": 28.782957029785695, "num_env_steps_sampled_lifetime": 260000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6494444444444445, "agent_episode_returns_mean": {"default_agent": 0.8795138888888901}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8795138888888901}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.18465983002719, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005899644455177781, "weights_seq_no": 129.0, "env_to_module_sum_episodes_length_in": 94.18465983002719, "env_step_timer": 0.11741826149866262, "time_between_sampling": 9.927955901954562, "num_env_steps_sampled_lifetime_throughput": 48.44641308906054}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.245004761670689e-18, "mean_kl_loss": 0.004117984790354967, "weights_seq_no": 130.0, "vf_loss": 0.010523810982704163, "gradients_default_optimizer_global_norm": 0.25050434470176697, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7875584, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010523810982704163, "vf_explained_var": 0.0635882019996643, "entropy": 0.2077023983001709, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.10825201123952866, "policy_loss": -0.11877583712339401}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08087640929725338, "add_time_dim_to_batch_and_zero_pad": 3.308302254999787e-05, "add_states_from_episodes_to_batch": 1.1154437705982047e-05, "general_advantage_estimation": 0.08351961724311086, "batch_individual_items": 0.04627681655035534, "add_observations_from_episodes_to_batch": 0.000365791071550732, "add_one_ts_to_episodes_and_truncate": 0.007127319537529696, "numpy_to_tensor": 0.001215142509154127}}, "connector_pipeline_timer": 0.21995624921597395}, "num_env_steps_trained_lifetime": 124112648, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7875584, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4464203569664, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 260000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.44641308906054, "done": false, "training_iteration": 130, "trial_id": "8cacd_00000", "date": "2025-05-12_03-41-54", "timestamp": 1746985314, "time_this_iter_s": 41.210339307785034, "time_total_s": 4975.22610449791, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4975.22610449791, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 78.21896551724137, "ram_util_percent": 51.7155172413793}}
{"timers": {"training_iteration": 39.007659594862325, "restore_env_runners": 2.9754032032061675e-05, "training_step": 39.007133632801064, "env_runner_sampling_timer": 29.7771054833025, "learner_update_timer": 9.221946733651771, "synch_weights": 0.007003260589230616, "synch_env_connectors": 0.00890774959347142}, "env_runners": {"episode_return_mean": 0.9468611111111116, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001286079482060127, "get_actions": 0.0007627195577111015, "un_batch_to_individual_items": 7.499688989105619e-05, "listify_data_for_vector_env": 0.00014832276363089522, "tensor_to_numpy": 0.0002533745598647498, "remove_single_ts_time_rank_from_batch": 8.63869314523211e-06}}, "connector_pipeline_timer": 0.0017110085533296128}, "episode_return_max": 1.2356666666666685, "num_episodes_lifetime": 1208, "episode_duration_sec_mean": 24.284995063029466, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017440445407967582, "add_time_dim_to_batch_and_zero_pad": 3.917393266777577e-05, "add_states_from_episodes_to_batch": 2.0582654306688996e-05, "batch_individual_items": 0.00010017677512191115, "add_observations_from_episodes_to_batch": 4.295061010883829e-05}}, "connector_pipeline_timer": 0.0006428874706206644}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 262000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 262000}, "sample": 28.807984076915176, "num_env_steps_sampled_lifetime": 262000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6494444444444445, "agent_episode_returns_mean": {"default_agent": 0.9468611111111116}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9468611111111116}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.98691178025373, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005904445756861422, "weights_seq_no": 130.0, "env_to_module_sum_episodes_length_in": 92.98691178025373, "env_step_timer": 0.1169463872517716, "time_between_sampling": 9.932822006992266, "num_env_steps_sampled_lifetime_throughput": 47.64138217691753}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.1225023808353447e-18, "mean_kl_loss": 0.00276963971555233, "weights_seq_no": 131.0, "vf_loss": 0.014317815192043781, "gradients_default_optimizer_global_norm": 0.47167477011680603, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7936128, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014317815192043781, "vf_explained_var": 0.0656440258026123, "entropy": 0.18242962658405304, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0185215063393116, "policy_loss": 0.004203682765364647}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08089657931655377, "add_time_dim_to_batch_and_zero_pad": 3.3099188994536935e-05, "add_states_from_episodes_to_batch": 1.115917716224771e-05, "general_advantage_estimation": 0.08310045948530914, "batch_individual_items": 0.046345122645931706, "add_observations_from_episodes_to_batch": 0.0003660363786117115, "add_one_ts_to_episodes_and_truncate": 0.007121569479382671, "numpy_to_tensor": 0.0012153926094385173}}, "connector_pipeline_timer": 0.21961955690452348}, "num_env_steps_trained_lifetime": 125066216, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7936128, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4503296014584, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 262000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.64138217691753, "done": false, "training_iteration": 131, "trial_id": "8cacd_00000", "date": "2025-05-12_03-42-36", "timestamp": 1746985356, "time_this_iter_s": 41.80689287185669, "time_total_s": 5017.032997369766, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5017.032997369766, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 77.72499999999998, "ram_util_percent": 51.719999999999985}}
{"timers": {"training_iteration": 39.026445441083695, "restore_env_runners": 2.9712491732922592e-05, "training_step": 39.025919743643065, "env_runner_sampling_timer": 29.78802589748949, "learner_update_timer": 9.229826980465237, "synch_weights": 0.006989921983351832, "synch_env_connectors": 0.008916362097539036}, "env_runners": {"episode_return_mean": 1.0277788461538466, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012865052676043053, "get_actions": 0.0007607935844344681, "un_batch_to_individual_items": 7.449444419894416e-05, "listify_data_for_vector_env": 0.00014692937824453881, "tensor_to_numpy": 0.00025352301886503564, "remove_single_ts_time_rank_from_batch": 8.63328072956508e-06}}, "connector_pipeline_timer": 0.001707149507499736}, "episode_return_max": 1.234555555555557, "num_episodes_lifetime": 1216, "episode_duration_sec_mean": 23.63647504937542, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017451063710926919, "add_time_dim_to_batch_and_zero_pad": 3.89699110947176e-05, "add_states_from_episodes_to_batch": 2.034981758118128e-05, "batch_individual_items": 9.95633209254248e-05, "add_observations_from_episodes_to_batch": 4.306196494478327e-05}}, "connector_pipeline_timer": 0.0006404627660468408}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 264000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 264000}, "sample": 28.831911074681773, "num_env_steps_sampled_lifetime": 264000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6833333333333335, "agent_episode_returns_mean": {"default_agent": 1.0277788461538466}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0277788461538466}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.4084942518177, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005894399699928095, "weights_seq_no": 131.0, "env_to_module_sum_episodes_length_in": 93.4084942518177, "env_step_timer": 0.11634792202108818, "time_between_sampling": 9.937737862941376, "num_env_steps_sampled_lifetime_throughput": 48.76855221676896}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.5612511904176723e-18, "mean_kl_loss": 0.0029321114998310804, "weights_seq_no": 132.0, "vf_loss": 0.007401569746434689, "gradients_default_optimizer_global_norm": 0.4563145041465759, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7996672, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007401569746434689, "vf_explained_var": 0.1243099570274353, "entropy": 0.2376708686351776, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06390440464019775, "policy_loss": -0.07130599021911621}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08091650670453836, "add_time_dim_to_batch_and_zero_pad": 3.31155538079899e-05, "add_states_from_episodes_to_batch": 1.116376638568527e-05, "general_advantage_estimation": 0.08268194652093915, "batch_individual_items": 0.04643029581794151, "add_observations_from_episodes_to_batch": 0.00036627436042431196, "add_one_ts_to_episodes_and_truncate": 0.007115792400444934, "numpy_to_tensor": 0.0012156162434663416}}, "connector_pipeline_timer": 0.21930007285438047}, "num_env_steps_trained_lifetime": 126019784, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 7996672, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.454116019025, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 264000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.76855221676896, "done": false, "training_iteration": 132, "trial_id": "8cacd_00000", "date": "2025-05-12_03-43-17", "timestamp": 1746985397, "time_this_iter_s": 40.905378580093384, "time_total_s": 5057.93837594986, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5057.93837594986, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 77.67931034482761, "ram_util_percent": 51.72241379310344}}
{"timers": {"training_iteration": 39.04038027103286, "restore_env_runners": 2.973136682070726e-05, "training_step": 39.039853349566656, "env_runner_sampling_timer": 29.802339417304584, "learner_update_timer": 9.229421140230583, "synch_weights": 0.007016621763507824, "synch_env_connectors": 0.008936614476541146}, "env_runners": {"episode_return_mean": 0.9595523504273513, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012875410112405257, "get_actions": 0.0007621997115110379, "un_batch_to_individual_items": 7.45738913803129e-05, "listify_data_for_vector_env": 0.00014752346631809, "tensor_to_numpy": 0.0002526300234323457, "remove_single_ts_time_rank_from_batch": 8.53921703912318e-06}}, "connector_pipeline_timer": 0.0017082018269338251}, "episode_return_max": 1.234555555555557, "num_episodes_lifetime": 1224, "episode_duration_sec_mean": 23.356655059173274, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017445458851260464, "add_time_dim_to_batch_and_zero_pad": 3.8690761261095296e-05, "add_states_from_episodes_to_batch": 2.034615330426209e-05, "batch_individual_items": 9.930798432508812e-05, "add_observations_from_episodes_to_batch": 4.296003409834163e-05}}, "connector_pipeline_timer": 0.000639997272002287}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 266000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 266000}, "sample": 28.8549440278382, "num_env_steps_sampled_lifetime": 266000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6305555555555558, "agent_episode_returns_mean": {"default_agent": 0.9595523504273513}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9595523504273513}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.86567559841632, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005898903134072802, "weights_seq_no": 132.0, "env_to_module_sum_episodes_length_in": 95.86567559841632, "env_step_timer": 0.11560028316332799, "time_between_sampling": 9.942889117367884, "num_env_steps_sampled_lifetime_throughput": 49.3695436017663}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 7.806255952088362e-19, "mean_kl_loss": 0.0047815293073654175, "weights_seq_no": 133.0, "vf_loss": 0.014576082117855549, "gradients_default_optimizer_global_norm": 0.3451025187969208, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8057216, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014576082117855549, "vf_explained_var": 0.05459284782409668, "entropy": 0.18794691562652588, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.030316971242427826, "policy_loss": 0.015740888193249702}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08093698802693167, "add_time_dim_to_batch_and_zero_pad": 3.313216140635096e-05, "add_states_from_episodes_to_batch": 1.1168797906768842e-05, "general_advantage_estimation": 0.08226514470990806, "batch_individual_items": 0.0465141105242465, "add_observations_from_episodes_to_batch": 0.00036650596896293033, "add_one_ts_to_episodes_and_truncate": 0.007109995156138168, "numpy_to_tensor": 0.001215846625552935}}, "connector_pipeline_timer": 0.21898148202964995}, "num_env_steps_trained_lifetime": 126973352, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8057216, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4577816752799, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 266000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.3695436017663, "done": false, "training_iteration": 133, "trial_id": "8cacd_00000", "date": "2025-05-12_03-43-57", "timestamp": 1746985437, "time_this_iter_s": 40.43772006034851, "time_total_s": 5098.376096010208, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5098.376096010208, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 77.86034482758623, "ram_util_percent": 51.73448275862068}}
{"timers": {"training_iteration": 39.11069296261252, "restore_env_runners": 2.97930531576192e-05, "training_step": 39.11016506436096, "env_runner_sampling_timer": 29.868112281631543, "learner_update_timer": 9.233938750618274, "synch_weights": 0.007038009545900573, "synch_env_connectors": 0.008950236331774466}, "env_runners": {"episode_return_mean": 0.8860961538461561, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012921991080256244, "get_actions": 0.0007614885721574807, "un_batch_to_individual_items": 7.546772896586524e-05, "listify_data_for_vector_env": 0.00014744424733954286, "tensor_to_numpy": 0.0002523030967460722, "remove_single_ts_time_rank_from_batch": 8.42794388566692e-06}}, "connector_pipeline_timer": 0.001708698371178188}, "episode_return_max": 1.2687777777777807, "num_episodes_lifetime": 1240, "episode_duration_sec_mean": 24.841582327576678, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017481111991676508, "add_time_dim_to_batch_and_zero_pad": 3.854411256048617e-05, "add_states_from_episodes_to_batch": 2.0682036393755854e-05, "batch_individual_items": 0.00010018237059134538, "add_observations_from_episodes_to_batch": 4.336033687762544e-05}}, "connector_pipeline_timer": 0.0006436499806412989}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 268000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 268000}, "sample": 28.88100538070827, "num_env_steps_sampled_lifetime": 268000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6503333333333338, "agent_episode_returns_mean": {"default_agent": 0.8860961538461561}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8860961538461561}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.41308540819372, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005919484911244048, "weights_seq_no": 133.0, "env_to_module_sum_episodes_length_in": 97.41308540819372, "env_step_timer": 0.11686461798095539, "time_between_sampling": 9.947761716905212, "num_env_steps_sampled_lifetime_throughput": 43.32382187056622}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.903127976044181e-19, "mean_kl_loss": 0.0029083851259201765, "weights_seq_no": 134.0, "vf_loss": 0.017117734998464584, "gradients_default_optimizer_global_norm": 0.31329160928726196, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 8118016, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017117734998464584, "vf_explained_var": 0.04959547519683838, "entropy": 0.2346484363079071, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.009563023224473, "policy_loss": -0.007554716896265745}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08095777123220668, "add_time_dim_to_batch_and_zero_pad": 3.314809529742358e-05, "add_states_from_episodes_to_batch": 1.1173742420665404e-05, "general_advantage_estimation": 0.08184918291044548, "batch_individual_items": 0.0465963171868435, "add_observations_from_episodes_to_batch": 0.00036674238789446864, "add_one_ts_to_episodes_and_truncate": 0.007104284187477405, "numpy_to_tensor": 0.0012160938783734164}}, "connector_pipeline_timer": 0.21866253843412858}, "num_env_steps_trained_lifetime": 127934752, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 8118016, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.462128606808, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 268000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.32382187056622, "done": false, "training_iteration": 134, "trial_id": "8cacd_00000", "date": "2025-05-12_03-44-43", "timestamp": 1746985483, "time_this_iter_s": 46.09103536605835, "time_total_s": 5144.4671313762665, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5144.4671313762665, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 80.12, "ram_util_percent": 51.763076923076916}}
{"timers": {"training_iteration": 39.13650839935637, "restore_env_runners": 2.9789122645536988e-05, "training_step": 39.13598054908737, "env_runner_sampling_timer": 29.8870552062652, "learner_update_timer": 9.240759380022082, "synch_weights": 0.007091536460461615, "synch_env_connectors": 0.008972994968451482}, "env_runners": {"episode_return_mean": 0.9003685897435922, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012865966264927997, "get_actions": 0.0007601421413062721, "un_batch_to_individual_items": 7.515476986197641e-05, "listify_data_for_vector_env": 0.00014886011205190238, "tensor_to_numpy": 0.0002512285295061376, "remove_single_ts_time_rank_from_batch": 8.4160401634672e-06}}, "connector_pipeline_timer": 0.0017064709282938607}, "episode_return_max": 1.237222222222226, "num_episodes_lifetime": 1248, "episode_duration_sec_mean": 24.514524207058702, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017616236786394368, "add_time_dim_to_batch_and_zero_pad": 3.9741679115355705e-05, "add_states_from_episodes_to_batch": 2.0549185447496392e-05, "batch_individual_items": 0.00010053870334265073, "add_observations_from_episodes_to_batch": 4.439833211697965e-05}}, "connector_pipeline_timer": 0.0006454972644249204}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 270000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 270000}, "sample": 28.906500963975887, "num_env_steps_sampled_lifetime": 270000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.622000000000001, "agent_episode_returns_mean": {"default_agent": 0.9003685897435922}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9003685897435922}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.49967423584056, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005941326014619971, "weights_seq_no": 134.0, "env_to_module_sum_episodes_length_in": 96.49967423584056, "env_step_timer": 0.11756497792422205, "time_between_sampling": 9.952891258499209, "num_env_steps_sampled_lifetime_throughput": 47.847705723485774}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.9515639880220904e-19, "mean_kl_loss": 0.00407953467220068, "weights_seq_no": 135.0, "vf_loss": 0.01559545285999775, "gradients_default_optimizer_global_norm": 0.16115792095661163, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8178560, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01559545285999775, "vf_explained_var": 0.07995909452438354, "entropy": 0.18266306817531586, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.02772117778658867, "policy_loss": -0.043316617608070374}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08097798031377351, "add_time_dim_to_batch_and_zero_pad": 3.3163257294483686e-05, "add_states_from_episodes_to_batch": 1.117848116454424e-05, "general_advantage_estimation": 0.08143407825250105, "batch_individual_items": 0.046676512594736166, "add_observations_from_episodes_to_batch": 0.00036696893785030595, "add_one_ts_to_episodes_and_truncate": 0.007098501768674043, "numpy_to_tensor": 0.00121641615137509}}, "connector_pipeline_timer": 0.21834186255101465}, "num_env_steps_trained_lifetime": 128888320, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8178560, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4663428215379, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 270000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.847705723485774, "done": false, "training_iteration": 135, "trial_id": "8cacd_00000", "date": "2025-05-12_03-45-25", "timestamp": 1746985525, "time_this_iter_s": 41.70967435836792, "time_total_s": 5186.176805734634, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5186.176805734634, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 78.20338983050847, "ram_util_percent": 51.801694915254224}}
{"timers": {"training_iteration": 39.15482110199283, "restore_env_runners": 2.9722231431799757e-05, "training_step": 39.15429304522648, "env_runner_sampling_timer": 29.898893158232518, "learner_update_timer": 9.247196955831855, "synch_weights": 0.007131689085858173, "synch_env_connectors": 0.00895998901875834}, "env_runners": {"episode_return_mean": 0.9408547008547029, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012783337707863713, "get_actions": 0.0007611677530864201, "un_batch_to_individual_items": 7.494897831823652e-05, "listify_data_for_vector_env": 0.00014896447898106712, "tensor_to_numpy": 0.0002505810891968934, "remove_single_ts_time_rank_from_batch": 8.406462363249515e-06}}, "connector_pipeline_timer": 0.0017067603797776168}, "episode_return_max": 1.2838888888888917, "num_episodes_lifetime": 1256, "episode_duration_sec_mean": 23.694352702307977, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017535448766727268, "add_time_dim_to_batch_and_zero_pad": 4.0110001228226695e-05, "add_states_from_episodes_to_batch": 2.0265289437542293e-05, "batch_individual_items": 9.995520596142305e-05, "add_observations_from_episodes_to_batch": 4.4033755221740393e-05}}, "connector_pipeline_timer": 0.0006439120395488896}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 272000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 272000}, "sample": 28.930839406352405, "num_env_steps_sampled_lifetime": 272000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.622000000000001, "agent_episode_returns_mean": {"default_agent": 0.9408547008547029}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9408547008547029}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.48724800731983, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005955753725519682, "weights_seq_no": 135.0, "env_to_module_sum_episodes_length_in": 94.48724800731983, "env_step_timer": 0.11754230341564008, "time_between_sampling": 9.958160413392243, "num_env_steps_sampled_lifetime_throughput": 48.72418087581685}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.9515639880220904e-19, "mean_kl_loss": 0.005021774675697088, "weights_seq_no": 136.0, "vf_loss": 0.012230999767780304, "gradients_default_optimizer_global_norm": 0.6643207669258118, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8239104, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012230999767780304, "vf_explained_var": 0.09331011772155762, "entropy": 0.22615689039230347, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.10534116625785828, "policy_loss": -0.11757215857505798}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08099802723648568, "add_time_dim_to_batch_and_zero_pad": 3.317771124203935e-05, "add_states_from_episodes_to_batch": 1.118311775938817e-05, "general_advantage_estimation": 0.0810206288094245, "batch_individual_items": 0.04675474759275226, "add_observations_from_episodes_to_batch": 0.00036719040256824137, "add_one_ts_to_episodes_and_truncate": 0.00709283108982795, "numpy_to_tensor": 0.001216808489428762}}, "connector_pipeline_timer": 0.2180208990815195}, "num_env_steps_trained_lifetime": 129841888, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8239104, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4704265391126, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 272000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.72418087581685, "done": false, "training_iteration": 136, "trial_id": "8cacd_00000", "date": "2025-05-12_03-46-06", "timestamp": 1746985566, "time_this_iter_s": 40.9833619594574, "time_total_s": 5227.160167694092, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5227.160167694092, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 77.70344827586207, "ram_util_percent": 51.732758620689644}}
{"timers": {"training_iteration": 39.199805582882895, "restore_env_runners": 2.9792009110757147e-05, "training_step": 39.19927707568423, "env_runner_sampling_timer": 29.942038580680215, "learner_update_timer": 9.249039972153511, "synch_weights": 0.007127656194996608, "synch_env_connectors": 0.008962063128566447}, "env_runners": {"episode_return_mean": 0.970696581196582, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001289548009303909, "get_actions": 0.0007636765615894811, "un_batch_to_individual_items": 7.480324862046198e-05, "listify_data_for_vector_env": 0.00015122048008653962, "tensor_to_numpy": 0.0002510764689167096, "remove_single_ts_time_rank_from_batch": 8.332706319752395e-06}}, "connector_pipeline_timer": 0.0017152328840086234}, "episode_return_max": 1.3017777777777797, "num_episodes_lifetime": 1264, "episode_duration_sec_mean": 23.664179409999598, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017739275034914196, "add_time_dim_to_batch_and_zero_pad": 4.2057219712447835e-05, "add_states_from_episodes_to_batch": 2.019982413882954e-05, "batch_individual_items": 0.0001023151818625985, "add_observations_from_episodes_to_batch": 4.43083593278142e-05}}, "connector_pipeline_timer": 0.0006527383065951232}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 274000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 274000}, "sample": 28.95629866877069, "num_env_steps_sampled_lifetime": 274000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6285555555555555, "agent_episode_returns_mean": {"default_agent": 0.970696581196582}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.970696581196582}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.90999062424105, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006005943263597581, "weights_seq_no": 136.0, "env_to_module_sum_episodes_length_in": 92.90999062424105, "env_step_timer": 0.11822457725680212, "time_between_sampling": 9.96360788095424, "num_env_steps_sampled_lifetime_throughput": 45.73465285529826}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.9515639880220904e-19, "mean_kl_loss": 0.0064548044465482235, "weights_seq_no": 137.0, "vf_loss": 0.010989701375365257, "gradients_default_optimizer_global_norm": 0.6179105639457703, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8299648, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010989701375365257, "vf_explained_var": 0.03821218013763428, "entropy": 0.20106609165668488, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.155312180519104, "policy_loss": -0.166301891207695}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08101762303271222, "add_time_dim_to_batch_and_zero_pad": 3.3191509785185536e-05, "add_states_from_episodes_to_batch": 1.1187643774227357e-05, "general_advantage_estimation": 0.0806079315273841, "batch_individual_items": 0.04683110088944872, "add_observations_from_episodes_to_batch": 0.0003674016010980029, "add_one_ts_to_episodes_and_truncate": 0.0070870822043822175, "numpy_to_tensor": 0.0012172140191059949}}, "connector_pipeline_timer": 0.21769828090505944}, "num_env_steps_trained_lifetime": 130795456, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8299648, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4743819480536, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 274000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.73465285529826, "done": false, "training_iteration": 137, "trial_id": "8cacd_00000", "date": "2025-05-12_03-46-50", "timestamp": 1746985610, "time_this_iter_s": 43.67344284057617, "time_total_s": 5270.833610534668, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5270.833610534668, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 79.03548387096772, "ram_util_percent": 51.7290322580645}}
{"timers": {"training_iteration": 39.219638800604045, "restore_env_runners": 3.115408899954232e-05, "training_step": 39.21910836847736, "env_runner_sampling_timer": 29.959679318133404, "learner_update_timer": 9.251221198721977, "synch_weights": 0.007137239633026662, "synch_env_connectors": 0.008958009497268132}, "env_runners": {"episode_return_mean": 0.8503643162393164, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012927053921029603, "get_actions": 0.0007635451188448695, "un_batch_to_individual_items": 7.472649233038898e-05, "listify_data_for_vector_env": 0.0001509695034571783, "tensor_to_numpy": 0.00025104445389235677, "remove_single_ts_time_rank_from_batch": 8.42321027200613e-06}}, "connector_pipeline_timer": 0.0017144573339072347}, "episode_return_max": 1.3017777777777797, "num_episodes_lifetime": 1272, "episode_duration_sec_mean": 25.074237281220086, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017710083280167316, "add_time_dim_to_batch_and_zero_pad": 4.265708623762961e-05, "add_states_from_episodes_to_batch": 1.998079346601339e-05, "batch_individual_items": 0.00010250351371082607, "add_observations_from_episodes_to_batch": 4.412256040289739e-05}}, "connector_pipeline_timer": 0.0006533922850376863}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 276000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 276000}, "sample": 28.98075811919227, "num_env_steps_sampled_lifetime": 276000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6122222222222223, "agent_episode_returns_mean": {"default_agent": 0.8503643162393164}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8503643162393164}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.72359840171904, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005999690403828433, "weights_seq_no": 137.0, "env_to_module_sum_episodes_length_in": 92.72359840171904, "env_step_timer": 0.11764233664656733, "time_between_sampling": 9.969103820977791, "num_env_steps_sampled_lifetime_throughput": 48.45960184875813}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.9515639880220904e-19, "mean_kl_loss": 0.006527016870677471, "weights_seq_no": 138.0, "vf_loss": 0.010734900832176208, "gradients_default_optimizer_global_norm": 0.29793480038642883, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8360192, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010734900832176208, "vf_explained_var": 0.04712122678756714, "entropy": 0.24050746858119965, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.11379797011613846, "policy_loss": -0.12453287094831467}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08103699860029055, "add_time_dim_to_batch_and_zero_pad": 3.320426458611647e-05, "add_states_from_episodes_to_batch": 1.1192060957002413e-05, "general_advantage_estimation": 0.08019623997810342, "batch_individual_items": 0.04690599771545193, "add_observations_from_episodes_to_batch": 0.000367603406617043, "add_one_ts_to_episodes_and_truncate": 0.007081264603536378, "numpy_to_tensor": 0.0012176393173408764}}, "connector_pipeline_timer": 0.2173749284222204}, "num_env_steps_trained_lifetime": 131749024, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8360192, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.478211206162, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 276000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.45960184875813, "done": false, "training_iteration": 138, "trial_id": "8cacd_00000", "date": "2025-05-12_03-47-31", "timestamp": 1746985651, "time_this_iter_s": 41.19859957695007, "time_total_s": 5312.032210111618, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5312.032210111618, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 77.04406779661018, "ram_util_percent": 51.72033898305083}}
{"timers": {"training_iteration": 39.23827227880801, "restore_env_runners": 3.107254811465055e-05, "training_step": 39.237742411002586, "env_runner_sampling_timer": 29.968560241552098, "learner_update_timer": 9.260982059344725, "synch_weights": 0.007129510236690441, "synch_env_connectors": 0.00895304440230976}, "env_runners": {"episode_return_mean": 0.8835427350427356, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012894914222615715, "get_actions": 0.0007617999545108812, "un_batch_to_individual_items": 7.462092128157273e-05, "listify_data_for_vector_env": 0.00014988076139980602, "tensor_to_numpy": 0.00025140407058889486, "remove_single_ts_time_rank_from_batch": 8.649481162055569e-06}}, "connector_pipeline_timer": 0.00171236981346593}, "episode_return_max": 1.3586666666666685, "num_episodes_lifetime": 1280, "episode_duration_sec_mean": 24.50643934185445, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001765493391397156, "add_time_dim_to_batch_and_zero_pad": 4.230243422217708e-05, "add_states_from_episodes_to_batch": 1.9882344844147548e-05, "batch_individual_items": 0.00010193832511062874, "add_observations_from_episodes_to_batch": 4.366254528485292e-05}}, "connector_pipeline_timer": 0.0006505368656504171}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 278000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 278000}, "sample": 29.00400912813754, "num_env_steps_sampled_lifetime": 278000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6122222222222223, "agent_episode_returns_mean": {"default_agent": 0.8835427350427356}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8835427350427356}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.45640746909082, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005960707137163986, "weights_seq_no": 138.0, "env_to_module_sum_episodes_length_in": 94.45640746909082, "env_step_timer": 0.11691968010569881, "time_between_sampling": 9.974725553150144, "num_env_steps_sampled_lifetime_throughput": 48.589884714452786}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 9.757819940110452e-20, "mean_kl_loss": 0.0017042644321918488, "weights_seq_no": 139.0, "vf_loss": 0.013437533751130104, "gradients_default_optimizer_global_norm": 0.186956986784935, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8420736, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013437533751130104, "vf_explained_var": 0.10120922327041626, "entropy": 0.1886442005634308, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0395464263856411, "policy_loss": 0.02610887587070465}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08105633287421403, "add_time_dim_to_batch_and_zero_pad": 3.321617513973755e-05, "add_states_from_episodes_to_batch": 1.1196481031863135e-05, "general_advantage_estimation": 0.0797854975766554, "batch_individual_items": 0.04697941074484617, "add_observations_from_episodes_to_batch": 0.0003677991158655459, "add_one_ts_to_episodes_and_truncate": 0.007075437556486884, "numpy_to_tensor": 0.0012180322082089414}}, "connector_pipeline_timer": 0.21705094960094767}, "num_env_steps_trained_lifetime": 132702592, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8420736, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4819164409134, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 278000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.589884714452786, "done": false, "training_iteration": 139, "trial_id": "8cacd_00000", "date": "2025-05-12_03-48-12", "timestamp": 1746985692, "time_this_iter_s": 41.10016632080078, "time_total_s": 5353.132376432419, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5353.132376432419, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 77.53103448275861, "ram_util_percent": 51.74482758620689}}
{"timers": {"training_iteration": 39.300684435149954, "restore_env_runners": 3.097182263183697e-05, "training_step": 39.30015501102254, "env_runner_sampling_timer": 30.029127789376563, "learner_update_timer": 9.262796983641262, "synch_weights": 0.007158197134352368, "synch_env_connectors": 0.008947537958275522}, "env_runners": {"episode_return_mean": 0.9349348290598312, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012906180921953364, "get_actions": 0.0007610976556421225, "un_batch_to_individual_items": 7.428307963687463e-05, "listify_data_for_vector_env": 0.000151014769333966, "tensor_to_numpy": 0.0002512028994324051, "remove_single_ts_time_rank_from_batch": 8.70303172999728e-06}}, "connector_pipeline_timer": 0.0017139360524400056}, "episode_return_max": 1.1634444444444467, "num_episodes_lifetime": 1296, "episode_duration_sec_mean": 24.268080969375834, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017640713979441685, "add_time_dim_to_batch_and_zero_pad": 4.1892088829159345e-05, "add_states_from_episodes_to_batch": 1.9718190174048018e-05, "batch_individual_items": 0.00010286687886046802, "add_observations_from_episodes_to_batch": 4.40299405047164e-05}}, "connector_pipeline_timer": 0.0006521402253512537}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 280000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 280000}, "sample": 29.029927209933287, "num_env_steps_sampled_lifetime": 280000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.720111111111112, "agent_episode_returns_mean": {"default_agent": 0.9349348290598312}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9349348290598312}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.97307088740523, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005946715932063564, "weights_seq_no": 139.0, "env_to_module_sum_episodes_length_in": 96.97307088740523, "env_step_timer": 0.11817890886377713, "time_between_sampling": 9.980663050784766, "num_env_steps_sampled_lifetime_throughput": 43.89360745842036}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 9.757819940110452e-20, "mean_kl_loss": 0.005214431788772345, "weights_seq_no": 140.0, "vf_loss": 0.01909060776233673, "gradients_default_optimizer_global_norm": 0.19352352619171143, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 8481536, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01909060776233673, "vf_explained_var": 0.08993673324584961, "entropy": 0.21288207173347473, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.05198310688138008, "policy_loss": -0.07107371836900711}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08107576901279923, "add_time_dim_to_batch_and_zero_pad": 3.322715705584484e-05, "add_states_from_episodes_to_batch": 1.1200773498987245e-05, "general_advantage_estimation": 0.07937584393923863, "batch_individual_items": 0.047051295233881046, "add_observations_from_episodes_to_batch": 0.00036799942058824477, "add_one_ts_to_episodes_and_truncate": 0.007069716583918176, "numpy_to_tensor": 0.0012184449173278612}}, "connector_pipeline_timer": 0.21672676127325807}, "num_env_steps_trained_lifetime": 133663992, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 8481536, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.486299749849, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 280000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.89360745842036, "done": false, "training_iteration": 140, "trial_id": "8cacd_00000", "date": "2025-05-12_03-48-58", "timestamp": 1746985738, "time_this_iter_s": 45.50096845626831, "time_total_s": 5398.633344888687, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5398.633344888687, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 79.91718750000001, "ram_util_percent": 51.75625}}
{"timers": {"training_iteration": 39.316338269328455, "restore_env_runners": 3.096110439032547e-05, "training_step": 39.31580836144229, "env_runner_sampling_timer": 30.041303218122803, "learner_update_timer": 9.26628766669485, "synch_weights": 0.007145321162990456, "synch_env_connectors": 0.008966133578687875}, "env_runners": {"episode_return_mean": 0.9123418803418832, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012930488372929006, "get_actions": 0.0007607143528233538, "un_batch_to_individual_items": 7.424451005729355e-05, "listify_data_for_vector_env": 0.0001498643775301768, "tensor_to_numpy": 0.0002507876404509799, "remove_single_ts_time_rank_from_batch": 8.662765876676875e-06}}, "connector_pipeline_timer": 0.0017105993001246727}, "episode_return_max": 1.3078888888888929, "num_episodes_lifetime": 1304, "episode_duration_sec_mean": 24.220835171316523, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017612570271581022, "add_time_dim_to_batch_and_zero_pad": 4.141307919010442e-05, "add_states_from_episodes_to_batch": 1.966938585121548e-05, "batch_individual_items": 0.00010251189171810846, "add_observations_from_episodes_to_batch": 4.408499814368265e-05}}, "connector_pipeline_timer": 0.0006501537631715907}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 282000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 282000}, "sample": 29.054749718663405, "num_env_steps_sampled_lifetime": 282000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6756666666666684, "agent_episode_returns_mean": {"default_agent": 0.9123418803418832}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9123418803418832}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.9597834271195, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005941409142878033, "weights_seq_no": 140.0, "env_to_module_sum_episodes_length_in": 96.9597834271195, "env_step_timer": 0.11869255719253044, "time_between_sampling": 9.986646980684405, "num_env_steps_sampled_lifetime_throughput": 48.60210781179487}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.878909970055226e-20, "mean_kl_loss": 0.0033932048827409744, "weights_seq_no": 141.0, "vf_loss": 0.01666964404284954, "gradients_default_optimizer_global_norm": 0.48832741379737854, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8542080, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01666964404284954, "vf_explained_var": 0.01200711727142334, "entropy": 0.18714839220046997, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.07171164453029633, "policy_loss": 0.055042002350091934}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08109526147532513, "add_time_dim_to_batch_and_zero_pad": 3.3237417716124806e-05, "add_states_from_episodes_to_batch": 1.1204900468581207e-05, "general_advantage_estimation": 0.07896725272481253, "batch_individual_items": 0.04712160453206094, "add_observations_from_episodes_to_batch": 0.00036820538930462096, "add_one_ts_to_episodes_and_truncate": 0.0070641538770452, "numpy_to_tensor": 0.0012188261990437202}}, "connector_pipeline_timer": 0.21640224771716204}, "num_env_steps_trained_lifetime": 134617560, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8542080, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4905472009618, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 282000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.60210781179487, "done": false, "training_iteration": 141, "trial_id": "8cacd_00000", "date": "2025-05-12_03-49-39", "timestamp": 1746985779, "time_this_iter_s": 40.88567852973938, "time_total_s": 5439.5190234184265, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5439.5190234184265, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 77.44745762711864, "ram_util_percent": 51.80677966101694}}
{"timers": {"training_iteration": 39.33018355411517, "restore_env_runners": 3.0899493343067594e-05, "training_step": 39.329654277307874, "env_runner_sampling_timer": 30.051383377571586, "learner_update_timer": 9.270019768877907, "synch_weights": 0.007181482951339529, "synch_env_connectors": 0.008978855242876812}, "env_runners": {"episode_return_mean": 0.8755277777777798, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001281339710344998, "get_actions": 0.0007619505919905997, "un_batch_to_individual_items": 7.418919960714324e-05, "listify_data_for_vector_env": 0.00015249669983199358, "tensor_to_numpy": 0.00025181160170370965, "remove_single_ts_time_rank_from_batch": 8.762230015350713e-06}}, "connector_pipeline_timer": 0.0017133463560290378}, "episode_return_max": 1.3078888888888929, "num_episodes_lifetime": 1312, "episode_duration_sec_mean": 23.58162677859589, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017509190169343717, "add_time_dim_to_batch_and_zero_pad": 4.1369193302779196e-05, "add_states_from_episodes_to_batch": 1.9935515789251724e-05, "batch_individual_items": 0.00010326928496281664, "add_observations_from_episodes_to_batch": 4.375112708482884e-05}}, "connector_pipeline_timer": 0.0006490583824175248}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 284000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 284000}, "sample": 29.078627025725307, "num_env_steps_sampled_lifetime": 284000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6756666666666684, "agent_episode_returns_mean": {"default_agent": 0.8755277777777798}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8755277777777798}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.1417105393784, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005933738628418604, "weights_seq_no": 141.0, "env_to_module_sum_episodes_length_in": 95.1417105393784, "env_step_timer": 0.11886114296988032, "time_between_sampling": 9.992467257795502, "num_env_steps_sampled_lifetime_throughput": 49.02897989126792}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.439454985027613e-20, "mean_kl_loss": 0.0020549988839775324, "weights_seq_no": 142.0, "vf_loss": 0.008871643804013729, "gradients_default_optimizer_global_norm": 0.2566683292388916, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8602624, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008871643804013729, "vf_explained_var": 0.04957062005996704, "entropy": 0.20425571501255035, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.02551056258380413, "policy_loss": -0.03438219800591469}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0811145269016992, "add_time_dim_to_batch_and_zero_pad": 3.324705044738394e-05, "add_states_from_episodes_to_batch": 1.1208964821382762e-05, "general_advantage_estimation": 0.0785597009102812, "batch_individual_items": 0.04719009456475386, "add_observations_from_episodes_to_batch": 0.0003684047687044457, "add_one_ts_to_episodes_and_truncate": 0.007058539912651237, "numpy_to_tensor": 0.001219199440633747}}, "connector_pipeline_timer": 0.2160766592760607}, "num_env_steps_trained_lifetime": 135571128, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8602624, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4946610730774, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 284000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.02897989126792, "done": false, "training_iteration": 142, "trial_id": "8cacd_00000", "date": "2025-05-12_03-50-20", "timestamp": 1746985820, "time_this_iter_s": 40.71855425834656, "time_total_s": 5480.237577676773, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5480.237577676773, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 78.4241379310345, "ram_util_percent": 51.79827586206898}}
{"timers": {"training_iteration": 39.34008703999401, "restore_env_runners": 3.089649841136545e-05, "training_step": 39.33955694995478, "env_runner_sampling_timer": 30.057737301195864, "learner_update_timer": 9.273588798199107, "synch_weights": 0.007161775121836571, "synch_env_connectors": 0.008990225690416945}, "env_runners": {"episode_return_mean": 0.9596858974358985, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012835337864453356, "get_actions": 0.0007627565136698161, "un_batch_to_individual_items": 7.373627423693778e-05, "listify_data_for_vector_env": 0.00015189089025476602, "tensor_to_numpy": 0.000250063505453174, "remove_single_ts_time_rank_from_batch": 8.637802087323579e-06}}, "connector_pipeline_timer": 0.0017110497395574204}, "episode_return_max": 1.3326666666666682, "num_episodes_lifetime": 1320, "episode_duration_sec_mean": 23.554897594846352, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017497850567446, "add_time_dim_to_batch_and_zero_pad": 4.0961639615358924e-05, "add_states_from_episodes_to_batch": 1.9836268303665107e-05, "batch_individual_items": 0.00010257940592517833, "add_observations_from_episodes_to_batch": 4.345447360265842e-05}}, "connector_pipeline_timer": 0.0006458012253085611}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 286000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 286000}, "sample": 29.10086722432275, "num_env_steps_sampled_lifetime": 286000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6852222222222234, "agent_episode_returns_mean": {"default_agent": 0.9596858974358985}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9596858974358985}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.28017180872344, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005915509141140249, "weights_seq_no": 142.0, "env_to_module_sum_episodes_length_in": 93.28017180872344, "env_step_timer": 0.1182505921839207, "time_between_sampling": 9.997929074179684, "num_env_steps_sampled_lifetime_throughput": 49.492512264726315}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.2197274925138065e-20, "mean_kl_loss": 0.0030585969798266888, "weights_seq_no": 143.0, "vf_loss": 0.012389203533530235, "gradients_default_optimizer_global_norm": 0.38742321729660034, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8663168, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012389203533530235, "vf_explained_var": 0.09408688545227051, "entropy": 0.1760161817073822, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.019031349569559097, "policy_loss": 0.006642155349254608}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08113377348329828, "add_time_dim_to_batch_and_zero_pad": 3.325751678226373e-05, "add_states_from_episodes_to_batch": 1.1212957396954657e-05, "general_advantage_estimation": 0.07815322206676802, "batch_individual_items": 0.047257522186239666, "add_observations_from_episodes_to_batch": 0.0003685963599773897, "add_one_ts_to_episodes_and_truncate": 0.007052870572157648, "numpy_to_tensor": 0.0012195569647721924}}, "connector_pipeline_timer": 0.21575099320880972}, "num_env_steps_trained_lifetime": 136524696, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8663168, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.4986436130305, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 286000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.492512264726315, "done": false, "training_iteration": 143, "trial_id": "8cacd_00000", "date": "2025-05-12_03-51-00", "timestamp": 1746985860, "time_this_iter_s": 40.339314222335815, "time_total_s": 5520.576891899109, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5520.576891899109, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 77.34736842105264, "ram_util_percent": 51.814035087719304}}
{"timers": {"training_iteration": 39.34620796748408, "restore_env_runners": 3.089853343067301e-05, "training_step": 39.34567740234525, "env_runner_sampling_timer": 30.067590554003914, "learner_update_timer": 9.269853607287121, "synch_weights": 0.007159207370601895, "synch_env_connectors": 0.009003403433484445}, "env_runners": {"episode_return_mean": 0.8789497863247872, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012831088043665728, "get_actions": 0.0007632565282532156, "un_batch_to_individual_items": 7.374624710638056e-05, "listify_data_for_vector_env": 0.00015044789682296328, "tensor_to_numpy": 0.0002496870297196246, "remove_single_ts_time_rank_from_batch": 8.607956614121409e-06}}, "connector_pipeline_timer": 0.0017093202526012878}, "episode_return_max": 1.3326666666666682, "num_episodes_lifetime": 1328, "episode_duration_sec_mean": 23.22823820699068, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017377295032852208, "add_time_dim_to_batch_and_zero_pad": 4.081799272832266e-05, "add_states_from_episodes_to_batch": 2.0356305932919077e-05, "batch_individual_items": 0.00010273903959186023, "add_observations_from_episodes_to_batch": 4.3770805158561266e-05}}, "connector_pipeline_timer": 0.0006443605562673783}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 288000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 288000}, "sample": 29.121916979314374, "num_env_steps_sampled_lifetime": 288000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6784444444444448, "agent_episode_returns_mean": {"default_agent": 0.8789497863247872}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8789497863247872}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.52941614305423, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005934424117598593, "weights_seq_no": 143.0, "env_to_module_sum_episodes_length_in": 92.52941614305423, "env_step_timer": 0.1174815193565903, "time_between_sampling": 10.003512577141578, "num_env_steps_sampled_lifetime_throughput": 49.9609014815608}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.0986374625690325e-21, "mean_kl_loss": 0.0033256965689361095, "weights_seq_no": 144.0, "vf_loss": 0.009015391580760479, "gradients_default_optimizer_global_norm": 0.3824777603149414, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8723712, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009015391580760479, "vf_explained_var": 0.08067983388900757, "entropy": 0.20042625069618225, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0029601482674479485, "policy_loss": -0.011975537985563278}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08115260329977522, "add_time_dim_to_batch_and_zero_pad": 3.3266969085672206e-05, "add_states_from_episodes_to_batch": 1.1216719224279279e-05, "general_advantage_estimation": 0.07774775092003404, "batch_individual_items": 0.047323250035439204, "add_observations_from_episodes_to_batch": 0.0003687816989481608, "add_one_ts_to_episodes_and_truncate": 0.007047287134382863, "numpy_to_tensor": 0.0012200116383837285}}, "connector_pipeline_timer": 0.21542439218557624}, "num_env_steps_trained_lifetime": 137478264, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8723712, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5024970360773, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 288000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.9609014815608, "done": false, "training_iteration": 144, "trial_id": "8cacd_00000", "date": "2025-05-12_03-51-40", "timestamp": 1746985900, "time_this_iter_s": 39.96959161758423, "time_total_s": 5560.546483516693, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5560.546483516693, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 78.46140350877194, "ram_util_percent": 51.81929824561404}}
{"timers": {"training_iteration": 39.35636095875923, "restore_env_runners": 3.081054810569906e-05, "training_step": 39.35583001627178, "env_runner_sampling_timer": 30.076196645833853, "learner_update_timer": 9.27141180979422, "synch_weights": 0.007147638296864954, "synch_env_connectors": 0.008998849399129325}, "env_runners": {"episode_return_mean": 0.8697254273504279, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012771348893538824, "get_actions": 0.0007631659060294512, "un_batch_to_individual_items": 7.374018589407361e-05, "listify_data_for_vector_env": 0.00014962040167351495, "tensor_to_numpy": 0.00024871037584046007, "remove_single_ts_time_rank_from_batch": 8.517291224453844e-06}}, "connector_pipeline_timer": 0.0017071139749980382}, "episode_return_max": 1.1924444444444453, "num_episodes_lifetime": 1336, "episode_duration_sec_mean": 23.354841279038492, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017400731249941228, "add_time_dim_to_batch_and_zero_pad": 4.051118928301537e-05, "add_states_from_episodes_to_batch": 2.016016661093706e-05, "batch_individual_items": 0.00010232698389414244, "add_observations_from_episodes_to_batch": 4.362093756386393e-05}}, "connector_pipeline_timer": 0.0006429069793604675}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 290000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 290000}, "sample": 29.142058091253705, "num_env_steps_sampled_lifetime": 290000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6784444444444448, "agent_episode_returns_mean": {"default_agent": 0.8697254273504279}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8697254273504279}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.54915540908796, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005939505902640161, "weights_seq_no": 144.0, "env_to_module_sum_episodes_length_in": 93.54915540908796, "env_step_timer": 0.11689739273553376, "time_between_sampling": 10.008591843690084, "num_env_steps_sampled_lifetime_throughput": 49.46178493088932}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.0493187312845163e-21, "mean_kl_loss": 0.004219491500407457, "weights_seq_no": 145.0, "vf_loss": 0.01130563672631979, "gradients_default_optimizer_global_norm": 0.37360459566116333, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8784256, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01130563672631979, "vf_explained_var": 0.09087127447128296, "entropy": 0.15214045345783234, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1695934236049652, "policy_loss": 0.15828776359558105}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08117129507257413, "add_time_dim_to_batch_and_zero_pad": 3.327565659153767e-05, "add_states_from_episodes_to_batch": 1.1220304519080942e-05, "general_advantage_estimation": 0.07734388867402824, "batch_individual_items": 0.04738767517543636, "add_observations_from_episodes_to_batch": 0.00036896052150340436, "add_one_ts_to_episodes_and_truncate": 0.007041670788306348, "numpy_to_tensor": 0.0012204756528263537}}, "connector_pipeline_timer": 0.21509793672348682}, "num_env_steps_trained_lifetime": 138431832, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8784256, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.506223526302, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 290000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.46178493088932, "done": false, "training_iteration": 145, "trial_id": "8cacd_00000", "date": "2025-05-12_03-52-21", "timestamp": 1746985941, "time_this_iter_s": 40.379143714904785, "time_total_s": 5600.925627231598, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5600.925627231598, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 78.94561403508773, "ram_util_percent": 51.81929824561404}}
{"timers": {"training_iteration": 39.368043188921625, "restore_env_runners": 3.075244263651643e-05, "training_step": 39.36749803285904, "env_runner_sampling_timer": 30.08411430562549, "learner_update_timer": 9.27516459019628, "synch_weights": 0.007141668913895647, "synch_env_connectors": 0.008998891905137758}, "env_runners": {"episode_return_mean": 0.82952670940171, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012673289729765011, "get_actions": 0.000761121287388138, "un_batch_to_individual_items": 7.315225830977286e-05, "listify_data_for_vector_env": 0.0001483977550310005, "tensor_to_numpy": 0.0002475070031353583, "remove_single_ts_time_rank_from_batch": 8.456816289937745e-06}}, "connector_pipeline_timer": 0.0017001386317057334}, "episode_return_max": 1.1924444444444453, "num_episodes_lifetime": 1344, "episode_duration_sec_mean": 23.54605038166339, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000173098949713908, "add_time_dim_to_batch_and_zero_pad": 4.0101944295605435e-05, "add_states_from_episodes_to_batch": 2.0104136038578635e-05, "batch_individual_items": 0.00010164368797450967, "add_observations_from_episodes_to_batch": 4.322158391310527e-05}}, "connector_pipeline_timer": 0.0006387031681416868}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 292000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 292000}, "sample": 29.16078106791723, "num_env_steps_sampled_lifetime": 292000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6336666666666668, "agent_episode_returns_mean": {"default_agent": 0.82952670940171}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.82952670940171}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.67530324362478, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005910807166903806, "weights_seq_no": 145.0, "env_to_module_sum_episodes_length_in": 96.67530324362478, "env_step_timer": 0.11583094357226796, "time_between_sampling": 10.013331487401562, "num_env_steps_sampled_lifetime_throughput": 49.258407801466824}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.5246593656422581e-21, "mean_kl_loss": 0.002918873680755496, "weights_seq_no": 146.0, "vf_loss": 0.00915247667580843, "gradients_default_optimizer_global_norm": 0.3406969904899597, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8844800, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.00915247667580843, "vf_explained_var": 0.08689969778060913, "entropy": 0.17010822892189026, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.04749641939997673, "policy_loss": 0.03834395110607147}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08118952793958722, "add_time_dim_to_batch_and_zero_pad": 3.3283653650673714e-05, "add_states_from_episodes_to_batch": 1.122374643605581e-05, "general_advantage_estimation": 0.07694162675785053, "batch_individual_items": 0.04745056388763002, "add_observations_from_episodes_to_batch": 0.0003691331494376777, "add_one_ts_to_episodes_and_truncate": 0.007035992310437871, "numpy_to_tensor": 0.0012209090358165284}}, "connector_pipeline_timer": 0.21477098444142084}, "num_env_steps_trained_lifetime": 139385400, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8844800, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5098252370183, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 292000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.258407801466824, "done": false, "training_iteration": 146, "trial_id": "8cacd_00000", "date": "2025-05-12_03-53-01", "timestamp": 1746985981, "time_this_iter_s": 40.5401496887207, "time_total_s": 5641.465776920319, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5641.465776920319, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 76.46551724137932, "ram_util_percent": 51.81896551724139}}
{"timers": {"training_iteration": 39.411084010072386, "restore_env_runners": 3.065991821017688e-05, "training_step": 39.41053968857045, "env_runner_sampling_timer": 30.126845974689235, "learner_update_timer": 9.275488534214325, "synch_weights": 0.0071270722247837644, "synch_env_connectors": 0.008994763986093224}, "env_runners": {"episode_return_mean": 0.8376367521367544, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012650291215886126, "get_actions": 0.0007633218031359349, "un_batch_to_individual_items": 7.278305420907882e-05, "listify_data_for_vector_env": 0.00014813484009425898, "tensor_to_numpy": 0.0002482898835833789, "remove_single_ts_time_rank_from_batch": 8.363765346013063e-06}}, "connector_pipeline_timer": 0.001703359879061653}, "episode_return_max": 1.2532222222222265, "num_episodes_lifetime": 1360, "episode_duration_sec_mean": 24.08826243612454, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001743068339031144, "add_time_dim_to_batch_and_zero_pad": 4.0920365648984115e-05, "add_states_from_episodes_to_batch": 2.0183423640293693e-05, "batch_individual_items": 0.00010155595534322654, "add_observations_from_episodes_to_batch": 4.373791473799026e-05}}, "connector_pipeline_timer": 0.0006418677676514848}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 294000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 294000}, "sample": 29.18148650809545, "num_env_steps_sampled_lifetime": 294000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6560000000000014, "agent_episode_returns_mean": {"default_agent": 0.8376367521367544}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8376367521367544}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.61472595869887, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005935121020157056, "weights_seq_no": 146.0, "env_to_module_sum_episodes_length_in": 97.61472595869887, "env_step_timer": 0.11682061376646986, "time_between_sampling": 10.01846403265057, "num_env_steps_sampled_lifetime_throughput": 45.70261446160798}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 7.623296828211291e-22, "mean_kl_loss": 0.00409119063988328, "weights_seq_no": 147.0, "vf_loss": 0.017770973965525627, "gradients_default_optimizer_global_norm": 0.34257543087005615, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 8905600, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017770973965525627, "vf_explained_var": 0.09095233678817749, "entropy": 0.190497487783432, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07758671045303345, "policy_loss": -0.09535768628120422}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0812074338897528, "add_time_dim_to_batch_and_zero_pad": 3.3290783203272766e-05, "add_states_from_episodes_to_batch": 1.1227027484078647e-05, "general_advantage_estimation": 0.07654063013112897, "batch_individual_items": 0.04751185867806201, "add_observations_from_episodes_to_batch": 0.0003693175887610199, "add_one_ts_to_episodes_and_truncate": 0.007030386215048131, "numpy_to_tensor": 0.001221306783581645}}, "connector_pipeline_timer": 0.21444341753132373}, "num_env_steps_trained_lifetime": 140346800, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 8905600, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5141042911678, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 294000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.70261446160798, "done": false, "training_iteration": 147, "trial_id": "8cacd_00000", "date": "2025-05-12_03-53-45", "timestamp": 1746986025, "time_this_iter_s": 43.69211387634277, "time_total_s": 5685.157890796661, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5685.157890796661, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 80.76451612903226, "ram_util_percent": 51.84032258064518}}
{"timers": {"training_iteration": 39.42922669266167, "restore_env_runners": 3.057431903740789e-05, "training_step": 39.428682310374754, "env_runner_sampling_timer": 30.136962173402353, "learner_update_timer": 9.283532289102205, "synch_weights": 0.00711069550252216, "synch_env_connectors": 0.009022046346228491}, "env_runners": {"episode_return_mean": 0.8920982905982927, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012712713343611203, "get_actions": 0.0007638948150401416, "un_batch_to_individual_items": 7.325325022327462e-05, "listify_data_for_vector_env": 0.0001477819970284234, "tensor_to_numpy": 0.0002498618580040487, "remove_single_ts_time_rank_from_batch": 8.34597849365554e-06}}, "connector_pipeline_timer": 0.0017057511041794074}, "episode_return_max": 1.2532222222222265, "num_episodes_lifetime": 1368, "episode_duration_sec_mean": 23.92768439838458, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001733668043601826, "add_time_dim_to_batch_and_zero_pad": 4.091108293127253e-05, "add_states_from_episodes_to_batch": 2.0278694600409093e-05, "batch_individual_items": 0.00010067017886471512, "add_observations_from_episodes_to_batch": 4.339347460489022e-05}}, "connector_pipeline_timer": 0.0006401555883393885}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 296000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 296000}, "sample": 29.2014005898988, "num_env_steps_sampled_lifetime": 296000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6560000000000014, "agent_episode_returns_mean": {"default_agent": 0.8920982905982927}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8920982905982927}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.17525125683689, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005942708867922785, "weights_seq_no": 147.0, "env_to_module_sum_episodes_length_in": 96.17525125683689, "env_step_timer": 0.11716087116884404, "time_between_sampling": 10.023090232317049, "num_env_steps_sampled_lifetime_throughput": 48.4087505521358}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.8116484141056453e-22, "mean_kl_loss": 0.0026762878987938166, "weights_seq_no": 148.0, "vf_loss": 0.01534013357013464, "gradients_default_optimizer_global_norm": 0.286373108625412, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8966144, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01534013357013464, "vf_explained_var": 0.11003768444061279, "entropy": 0.18170037865638733, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.055997900664806366, "policy_loss": 0.04065777733922005}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08122465778812114, "add_time_dim_to_batch_and_zero_pad": 3.330167179957407e-05, "add_states_from_episodes_to_batch": 1.1230250536370649e-05, "general_advantage_estimation": 0.07614075039426589, "batch_individual_items": 0.04757186006629651, "add_observations_from_episodes_to_batch": 0.0003695071259827792, "add_one_ts_to_episodes_and_truncate": 0.007024749832335149, "numpy_to_tensor": 0.001221748025487619}}, "connector_pipeline_timer": 0.21411502399098467}, "num_env_steps_trained_lifetime": 141300368, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 8966144, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5182467817106, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 296000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.4087505521358, "done": false, "training_iteration": 148, "trial_id": "8cacd_00000", "date": "2025-05-12_03-54-26", "timestamp": 1746986066, "time_this_iter_s": 41.24561166763306, "time_total_s": 5726.403502464294, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5726.403502464294, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 77.05593220338983, "ram_util_percent": 51.82033898305086}}
{"timers": {"training_iteration": 39.446460954845065, "restore_env_runners": 3.056857583945517e-05, "training_step": 39.445916000380976, "env_runner_sampling_timer": 30.14989488392834, "learner_update_timer": 9.28784486806115, "synch_weights": 0.007098473547495493, "synch_env_connectors": 0.009029051882764252}, "env_runners": {"episode_return_mean": 0.9021720085470099, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001271375682068399, "get_actions": 0.0007646047410405619, "un_batch_to_individual_items": 7.296521378825236e-05, "listify_data_for_vector_env": 0.00014701223364988264, "tensor_to_numpy": 0.0002515738893173201, "remove_single_ts_time_rank_from_batch": 8.308069399961004e-06}}, "connector_pipeline_timer": 0.0017088133008826298}, "episode_return_max": 1.243000000000002, "num_episodes_lifetime": 1376, "episode_duration_sec_mean": 23.562276177336678, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017267818880328803, "add_time_dim_to_batch_and_zero_pad": 4.111931142314937e-05, "add_states_from_episodes_to_batch": 2.018606063090127e-05, "batch_individual_items": 0.00010126004191959373, "add_observations_from_episodes_to_batch": 4.345376542607459e-05}}, "connector_pipeline_timer": 0.0006393978052162141}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 298000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 298000}, "sample": 29.220632225534516, "num_env_steps_sampled_lifetime": 298000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6551111111111111, "agent_episode_returns_mean": {"default_agent": 0.9021720085470099}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9021720085470099}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.14158822341957, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005951181932462945, "weights_seq_no": 148.0, "env_to_module_sum_episodes_length_in": 94.14158822341957, "env_step_timer": 0.11718341863099503, "time_between_sampling": 10.027952953066254, "num_env_steps_sampled_lifetime_throughput": 48.4830631198469}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.9058242070528227e-22, "mean_kl_loss": 0.0024382963310927153, "weights_seq_no": 149.0, "vf_loss": 0.014069980010390282, "gradients_default_optimizer_global_norm": 0.37482595443725586, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9026688, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014069980010390282, "vf_explained_var": 0.14091819524765015, "entropy": 0.1759440004825592, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.15485817193984985, "policy_loss": -0.1689281463623047}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0812412130751333, "add_time_dim_to_batch_and_zero_pad": 3.3313243545460327e-05, "add_states_from_episodes_to_batch": 1.1233506425063139e-05, "general_advantage_estimation": 0.07574201282912696, "batch_individual_items": 0.04763040906089845, "add_observations_from_episodes_to_batch": 0.00036968763070096877, "add_one_ts_to_episodes_and_truncate": 0.007019102478654889, "numpy_to_tensor": 0.001222169261877205}}, "connector_pipeline_timer": 0.2137856116296994}, "num_env_steps_trained_lifetime": 142253936, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9026688, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5222550120134, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 298000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.4830631198469, "done": false, "training_iteration": 149, "trial_id": "8cacd_00000", "date": "2025-05-12_03-55-08", "timestamp": 1746986108, "time_this_iter_s": 41.17168426513672, "time_total_s": 5767.575186729431, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5767.575186729431, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 78.38793103448276, "ram_util_percent": 51.8344827586207}}
{"timers": {"training_iteration": 39.462927416576605, "restore_env_runners": 3.047889008870072e-05, "training_step": 39.46237566465718, "env_runner_sampling_timer": 30.16419923214903, "learner_update_timer": 9.290009632600553, "synch_weights": 0.00709003381202122, "synch_env_connectors": 0.009021856363945662}, "env_runners": {"episode_return_mean": 0.885682692307693, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012638012700789353, "get_actions": 0.0007633975020325975, "un_batch_to_individual_items": 7.258568198759025e-05, "listify_data_for_vector_env": 0.0001470872627740152, "tensor_to_numpy": 0.0002507858767846998, "remove_single_ts_time_rank_from_batch": 8.241391085302742e-06}}, "connector_pipeline_timer": 0.0017056418360152478}, "episode_return_max": 1.243000000000002, "num_episodes_lifetime": 1384, "episode_duration_sec_mean": 23.749911765144518, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017252110915859378, "add_time_dim_to_batch_and_zero_pad": 4.074993555081623e-05, "add_states_from_episodes_to_batch": 1.9946293389964072e-05, "batch_individual_items": 0.00010102338808688015, "add_observations_from_episodes_to_batch": 4.3326519687626955e-05}}, "connector_pipeline_timer": 0.0006387431577733661}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 300000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 300000}, "sample": 29.239437142591854, "num_env_steps_sampled_lifetime": 300000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6551111111111111, "agent_episode_returns_mean": {"default_agent": 0.885682692307693}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.885682692307693}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.88010017269711, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005936568983433518, "weights_seq_no": 149.0, "env_to_module_sum_episodes_length_in": 92.88010017269711, "env_step_timer": 0.1169497753507829, "time_between_sampling": 10.032916310748066, "num_env_steps_sampled_lifetime_throughput": 48.557779293494875}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 9.529121035264113e-23, "mean_kl_loss": 0.003963471855968237, "weights_seq_no": 150.0, "vf_loss": 0.007489524781703949, "gradients_default_optimizer_global_norm": 0.19885900616645813, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9087232, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007489524781703949, "vf_explained_var": 0.2384120225906372, "entropy": 0.18425939977169037, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.1280706375837326, "policy_loss": -0.13556015491485596}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08125724417042643, "add_time_dim_to_batch_and_zero_pad": 3.332410368948613e-05, "add_states_from_episodes_to_batch": 1.1236604171131314e-05, "general_advantage_estimation": 0.0753443562502512, "batch_individual_items": 0.04768744667950164, "add_observations_from_episodes_to_batch": 0.00036986998461207443, "add_one_ts_to_episodes_and_truncate": 0.007013569377065186, "numpy_to_tensor": 0.0012225727287363032}}, "connector_pipeline_timer": 0.21345534079294082}, "num_env_steps_trained_lifetime": 143207504, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9087232, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.526131253032, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 300000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.557779293494875, "done": false, "training_iteration": 150, "trial_id": "8cacd_00000", "date": "2025-05-12_03-55-49", "timestamp": 1746986149, "time_this_iter_s": 41.1113920211792, "time_total_s": 5808.68657875061, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5808.68657875061, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 77.87627118644069, "ram_util_percent": 51.83389830508476}}
{"timers": {"training_iteration": 39.52813710969082, "restore_env_runners": 3.042510117092278e-05, "training_step": 39.52758587729061, "env_runner_sampling_timer": 30.22695576268757, "learner_update_timer": 9.292473745694553, "synch_weights": 0.007078825473896274, "synch_env_connectors": 0.009022792800315373}, "env_runners": {"episode_return_mean": 0.9032596153846153, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012757918654322738, "get_actions": 0.0007708922554311753, "un_batch_to_individual_items": 7.312112302868439e-05, "listify_data_for_vector_env": 0.00014805678660412966, "tensor_to_numpy": 0.00025211938380778723, "remove_single_ts_time_rank_from_batch": 8.498641562469492e-06}}, "connector_pipeline_timer": 0.001720651917346531}, "episode_return_max": 1.2164444444444455, "num_episodes_lifetime": 1392, "episode_duration_sec_mean": 24.6059757129619, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001748164482306801, "add_time_dim_to_batch_and_zero_pad": 4.115888316926187e-05, "add_states_from_episodes_to_batch": 1.970117502547815e-05, "batch_individual_items": 0.00010275499429883997, "add_observations_from_episodes_to_batch": 4.3332758624144004e-05}}, "connector_pipeline_timer": 0.0006456492417729194}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 302000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 302000}, "sample": 29.260962030073248, "num_env_steps_sampled_lifetime": 302000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7121111111111111, "agent_episode_returns_mean": {"default_agent": 0.9032596153846153}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9032596153846153}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.20270419859831, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006011387287709828, "weights_seq_no": 150.0, "env_to_module_sum_episodes_length_in": 93.20270419859831, "env_step_timer": 0.11736107720139732, "time_between_sampling": 10.037790230224882, "num_env_steps_sampled_lifetime_throughput": 43.303059018900335}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.7645605176320567e-23, "mean_kl_loss": 0.003212531330063939, "weights_seq_no": 151.0, "vf_loss": 0.014446379616856575, "gradients_default_optimizer_global_norm": 0.33266201615333557, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9147776, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014446379616856575, "vf_explained_var": 0.12176579236984253, "entropy": 0.16937357187271118, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.10464300215244293, "policy_loss": 0.0901966392993927}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08127292545250635, "add_time_dim_to_batch_and_zero_pad": 3.3334575306328004e-05, "add_states_from_episodes_to_batch": 1.1239596611855719e-05, "general_advantage_estimation": 0.07494785288167008, "batch_individual_items": 0.04775953623492677, "add_observations_from_episodes_to_batch": 0.0003700559126818593, "add_one_ts_to_episodes_and_truncate": 0.00700803873725966, "numpy_to_tensor": 0.0012229468293321452}}, "connector_pipeline_timer": 0.21314089974185466}, "num_env_steps_trained_lifetime": 144161072, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9147776, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.529877743729, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 302000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.303059018900335, "done": false, "training_iteration": 151, "trial_id": "8cacd_00000", "date": "2025-05-12_03-56-35", "timestamp": 1746986195, "time_this_iter_s": 45.999829053878784, "time_total_s": 5854.686407804489, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5854.686407804489, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 79.32000000000001, "ram_util_percent": 51.88615384615384}}
{"timers": {"training_iteration": 39.53317744830388, "restore_env_runners": 3.0410850148249557e-05, "training_step": 39.53262594822772, "env_runner_sampling_timer": 30.221535850350715, "learner_update_timer": 9.302951706657602, "synch_weights": 0.0070596612191643066, "synch_env_connectors": 0.00901134687233091}, "env_runners": {"episode_return_mean": 0.9857147435897444, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012757084720972447, "get_actions": 0.0007669901593350837, "un_batch_to_individual_items": 7.328193919261355e-05, "listify_data_for_vector_env": 0.00014701861925264513, "tensor_to_numpy": 0.00025171464906843566, "remove_single_ts_time_rank_from_batch": 8.450549151565716e-06}}, "connector_pipeline_timer": 0.0017144608366237058}, "episode_return_max": 1.3030000000000028, "num_episodes_lifetime": 1400, "episode_duration_sec_mean": 25.46190355250068, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017462058694016726, "add_time_dim_to_batch_and_zero_pad": 4.0753169379340605e-05, "add_states_from_episodes_to_batch": 1.9677361166271936e-05, "batch_individual_items": 0.000102532846597097, "add_observations_from_episodes_to_batch": 4.352701622069551e-05}}, "connector_pipeline_timer": 0.0006442087017140087}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 304000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 304000}, "sample": 29.280552181273855, "num_env_steps_sampled_lifetime": 304000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.751222222222222, "agent_episode_returns_mean": {"default_agent": 0.9857147435897444}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9857147435897444}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.54315455438017, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006003696754372411, "weights_seq_no": 151.0, "env_to_module_sum_episodes_length_in": 95.54315455438017, "env_step_timer": 0.11640170049606277, "time_between_sampling": 10.043140479555477, "num_env_steps_sampled_lifetime_throughput": 49.85961343757113}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.3822802588160283e-23, "mean_kl_loss": 0.003464298089966178, "weights_seq_no": 152.0, "vf_loss": 0.015919895842671394, "gradients_default_optimizer_global_norm": 0.26946404576301575, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9208320, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015919895842671394, "vf_explained_var": 0.08701956272125244, "entropy": 0.20692963898181915, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.08246630430221558, "policy_loss": -0.09838619828224182}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08128803957462744, "add_time_dim_to_batch_and_zero_pad": 3.334399508050669e-05, "add_states_from_episodes_to_batch": 1.1242455543340188e-05, "general_advantage_estimation": 0.07455300262483584, "batch_individual_items": 0.04782962406457537, "add_observations_from_episodes_to_batch": 0.0003702322751917063, "add_one_ts_to_episodes_and_truncate": 0.0070024331933124725, "numpy_to_tensor": 0.0012233262506431534}}, "connector_pipeline_timer": 0.21282546367781072}, "num_env_steps_trained_lifetime": 145114640, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9208320, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5334966914868, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 304000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.85961343757113, "done": false, "training_iteration": 152, "trial_id": "8cacd_00000", "date": "2025-05-12_03-57-15", "timestamp": 1746986235, "time_this_iter_s": 40.050294160842896, "time_total_s": 5894.736701965332, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5894.736701965332, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 76.7, "ram_util_percent": 51.850877192982466}}
{"timers": {"training_iteration": 39.56619910090084, "restore_env_runners": 3.0317741652714487e-05, "training_step": 39.56564854782544, "env_runner_sampling_timer": 30.256027993327223, "learner_update_timer": 9.301488037201025, "synch_weights": 0.007054169596962441, "synch_env_connectors": 0.009009169403625691}, "env_runners": {"episode_return_mean": 0.9619636752136779, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012672179716052205, "get_actions": 0.0007641705814732292, "un_batch_to_individual_items": 7.300046219313775e-05, "listify_data_for_vector_env": 0.00014737140414326053, "tensor_to_numpy": 0.00025018317019239226, "remove_single_ts_time_rank_from_batch": 8.356301383574746e-06}}, "connector_pipeline_timer": 0.0017080776238614435}, "episode_return_max": 1.3450000000000044, "num_episodes_lifetime": 1416, "episode_duration_sec_mean": 23.261428404817252, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017565431256353752, "add_time_dim_to_batch_and_zero_pad": 4.031205112982235e-05, "add_states_from_episodes_to_batch": 1.9791249504980164e-05, "batch_individual_items": 0.00010185035554927467, "add_observations_from_episodes_to_batch": 4.322388360927373e-05}}, "connector_pipeline_timer": 0.0006431895867987427}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 306000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 306000}, "sample": 29.301094829097877, "num_env_steps_sampled_lifetime": 306000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6496666666666674, "agent_episode_returns_mean": {"default_agent": 0.9619636752136779}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9619636752136779}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.24262117046396, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005996483068810753, "weights_seq_no": 152.0, "env_to_module_sum_episodes_length_in": 97.24262117046396, "env_step_timer": 0.11715912019236344, "time_between_sampling": 10.048730269744587, "num_env_steps_sampled_lifetime_throughput": 46.595551579706566}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.1911401294080142e-23, "mean_kl_loss": 0.0021015997044742107, "weights_seq_no": 153.0, "vf_loss": 0.019725078716874123, "gradients_default_optimizer_global_norm": 0.5123900175094604, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 9269120, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.019725078716874123, "vf_explained_var": 0.122913658618927, "entropy": 0.15783409774303436, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.13933686912059784, "policy_loss": -0.15906193852424622}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08130337300176081, "add_time_dim_to_batch_and_zero_pad": 3.3352833001866116e-05, "add_states_from_episodes_to_batch": 1.1245263336407012e-05, "general_advantage_estimation": 0.07415999710785003, "batch_individual_items": 0.04789818748400719, "add_observations_from_episodes_to_batch": 0.0003704299348601379, "add_one_ts_to_episodes_and_truncate": 0.006997055766370608, "numpy_to_tensor": 0.001223689468845149}}, "connector_pipeline_timer": 0.21251080214507354}, "num_env_steps_trained_lifetime": 146076040, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 9269120, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.537790272515, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 306000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.595551579706566, "done": false, "training_iteration": 153, "trial_id": "8cacd_00000", "date": "2025-05-12_03-57-58", "timestamp": 1746986278, "time_this_iter_s": 42.85186791419983, "time_total_s": 5937.588569879532, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5937.588569879532, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 79.41475409836065, "ram_util_percent": 51.92131147540984}}
{"timers": {"training_iteration": 39.57743313080182, "restore_env_runners": 3.029956422353067e-05, "training_step": 39.5768824542572, "env_runner_sampling_timer": 30.262414110193973, "learner_update_timer": 9.306354340939025, "synch_weights": 0.007036408901005872, "synch_env_connectors": 0.008999670709573653}, "env_runners": {"episode_return_mean": 0.9167371794871817, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012624692280201096, "get_actions": 0.0007627180811507516, "un_batch_to_individual_items": 7.24420822536234e-05, "listify_data_for_vector_env": 0.00014827909380049208, "tensor_to_numpy": 0.000250132793416723, "remove_single_ts_time_rank_from_batch": 8.225895412029721e-06}}, "connector_pipeline_timer": 0.0017047396666038134}, "episode_return_max": 1.3450000000000044, "num_episodes_lifetime": 1424, "episode_duration_sec_mean": 23.238345425682873, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017568735053625424, "add_time_dim_to_batch_and_zero_pad": 4.125311717769886e-05, "add_states_from_episodes_to_batch": 1.9761979399521796e-05, "batch_individual_items": 0.00010148394959760818, "add_observations_from_episodes_to_batch": 4.330020130430759e-05}}, "connector_pipeline_timer": 0.0006432860012350549}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 308000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 308000}, "sample": 29.32053715539583, "num_env_steps_sampled_lifetime": 308000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6267777777777787, "agent_episode_returns_mean": {"default_agent": 0.9167371794871817}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9167371794871817}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.46656710819201, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005973610999700874, "weights_seq_no": 153.0, "env_to_module_sum_episodes_length_in": 96.46656710819201, "env_step_timer": 0.11756416494729294, "time_between_sampling": 10.053960735859915, "num_env_steps_sampled_lifetime_throughput": 49.05872340941671}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.955700647040071e-24, "mean_kl_loss": 0.0018644699594005942, "weights_seq_no": 154.0, "vf_loss": 0.014603348448872566, "gradients_default_optimizer_global_norm": 0.1493806540966034, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9329664, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014603348448872566, "vf_explained_var": 0.1405315399169922, "entropy": 0.12059444934129715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.07148198783397675, "policy_loss": 0.056878652423620224}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08131848737639416, "add_time_dim_to_batch_and_zero_pad": 3.336378976523175e-05, "add_states_from_episodes_to_batch": 1.1248050728159827e-05, "general_advantage_estimation": 0.07376833329094167, "batch_individual_items": 0.047965251692643984, "add_observations_from_episodes_to_batch": 0.000370617128107533, "add_one_ts_to_episodes_and_truncate": 0.006991609574648304, "numpy_to_tensor": 0.0012241026500581461}}, "connector_pipeline_timer": 0.2121957362866233}, "num_env_steps_trained_lifetime": 147029608, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9329664, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5419446322535, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 308000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.05872340941671, "done": false, "training_iteration": 154, "trial_id": "8cacd_00000", "date": "2025-05-12_03-58-39", "timestamp": 1746986319, "time_this_iter_s": 40.70722985267639, "time_total_s": 5978.295799732208, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5978.295799732208, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 77.37413793103448, "ram_util_percent": 51.9155172413793}}
{"timers": {"training_iteration": 39.57539992444379, "restore_env_runners": 3.028756861432565e-05, "training_step": 39.57484859466465, "env_runner_sampling_timer": 30.25876837675203, "learner_update_timer": 9.307985468819652, "synch_weights": 0.007017544812004487, "synch_env_connectors": 0.008993051002487849}, "env_runners": {"episode_return_mean": 0.9359626068376092, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012536819165514967, "get_actions": 0.0007602467854604128, "un_batch_to_individual_items": 7.189531074536885e-05, "listify_data_for_vector_env": 0.0001476406679429664, "tensor_to_numpy": 0.00025095502690635537, "remove_single_ts_time_rank_from_batch": 8.267241111422371e-06}}, "connector_pipeline_timer": 0.0016999225939252245}, "episode_return_max": 1.2451111111111142, "num_episodes_lifetime": 1432, "episode_duration_sec_mean": 23.035659968461843, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017523355493384056, "add_time_dim_to_batch_and_zero_pad": 4.123764970124209e-05, "add_states_from_episodes_to_batch": 1.9959454746514834e-05, "batch_individual_items": 0.00010252326217738864, "add_observations_from_episodes_to_batch": 4.2908524091061697e-05}}, "connector_pipeline_timer": 0.0006420153940720036}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 310000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 310000}, "sample": 29.338295815721086, "num_env_steps_sampled_lifetime": 310000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6267777777777787, "agent_episode_returns_mean": {"default_agent": 0.9359626068376092}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9359626068376092}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.48113097648307, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005948469895120225, "weights_seq_no": 154.0, "env_to_module_sum_episodes_length_in": 94.48113097648307, "env_step_timer": 0.11729400874496258, "time_between_sampling": 10.059158687549306, "num_env_steps_sampled_lifetime_throughput": 50.68507981920343}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.955700647040071e-24, "mean_kl_loss": 0.010502642951905727, "weights_seq_no": 155.0, "vf_loss": 0.009740607813000679, "gradients_default_optimizer_global_norm": 1.1624515056610107, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9390208, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009740607813000679, "vf_explained_var": 0.03650856018066406, "entropy": 0.2108852118253708, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.023335611447691917, "policy_loss": 0.013595000840723515}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08133352486623441, "add_time_dim_to_batch_and_zero_pad": 3.337409211028404e-05, "add_states_from_episodes_to_batch": 1.1251257845921805e-05, "general_advantage_estimation": 0.07337785253066077, "batch_individual_items": 0.048031034288359836, "add_observations_from_episodes_to_batch": 0.0003707971444963036, "add_one_ts_to_episodes_and_truncate": 0.006986181741183678, "numpy_to_tensor": 0.0012244869086999433}}, "connector_pipeline_timer": 0.2118804791051277}, "num_env_steps_trained_lifetime": 147983176, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9390208, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.54596212577, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 310000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.68507981920343, "done": false, "training_iteration": 155, "trial_id": "8cacd_00000", "date": "2025-05-12_03-59-18", "timestamp": 1746986358, "time_this_iter_s": 39.39106488227844, "time_total_s": 6017.686864614487, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6017.686864614487, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 78.01964285714284, "ram_util_percent": 51.907142857142844}}
{"timers": {"training_iteration": 39.58047851949936, "restore_env_runners": 3.0300692933296288e-05, "training_step": 39.579927126018, "env_runner_sampling_timer": 30.264456300944495, "learner_update_timer": 9.307325710471448, "synch_weights": 0.007064723363878963, "synch_env_connectors": 0.008980447492462029}, "env_runners": {"episode_return_mean": 0.9216388888888896, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012532110474116189, "get_actions": 0.0007550275640288838, "un_batch_to_individual_items": 7.209868623477946e-05, "listify_data_for_vector_env": 0.0001466974306976542, "tensor_to_numpy": 0.0002495058726966871, "remove_single_ts_time_rank_from_batch": 8.224621521135288e-06}}, "connector_pipeline_timer": 0.0016914111890030572}, "episode_return_max": 1.2280000000000029, "num_episodes_lifetime": 1440, "episode_duration_sec_mean": 22.970081173076462, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017372528491248058, "add_time_dim_to_batch_and_zero_pad": 4.057244014121746e-05, "add_states_from_episodes_to_batch": 2.1090117294381025e-05, "batch_individual_items": 0.00010220432535215541, "add_observations_from_episodes_to_batch": 4.266314697197582e-05}}, "connector_pipeline_timer": 0.0006395503169014343}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 312000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 312000}, "sample": 29.354824339098382, "num_env_steps_sampled_lifetime": 312000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.696000000000001, "agent_episode_returns_mean": {"default_agent": 0.9216388888888896}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9216388888888896}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.85637108621613, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005915598221123266, "weights_seq_no": 155.0, "env_to_module_sum_episodes_length_in": 92.85637108621613, "env_step_timer": 0.11672564989683992, "time_between_sampling": 10.063967632206909, "num_env_steps_sampled_lifetime_throughput": 49.79408449328331}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.9778503235200354e-24, "mean_kl_loss": 0.0024805923458188772, "weights_seq_no": 156.0, "vf_loss": 0.010950158350169659, "gradients_default_optimizer_global_norm": 0.26425936818122864, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9450752, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.010950158350169659, "vf_explained_var": 0.0969892144203186, "entropy": 0.16816189885139465, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.042022645473480225, "policy_loss": -0.05297280102968216}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08134870241764047, "add_time_dim_to_batch_and_zero_pad": 3.338381202944219e-05, "add_states_from_episodes_to_batch": 1.125512601651822e-05, "general_advantage_estimation": 0.07298858879225661, "batch_individual_items": 0.04809515939699217, "add_observations_from_episodes_to_batch": 0.00037098937884441825, "add_one_ts_to_episodes_and_truncate": 0.006980708983431021, "numpy_to_tensor": 0.0012248448719037505}}, "connector_pipeline_timer": 0.21156486634373337}, "num_env_steps_trained_lifetime": 148936744, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9450752, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.549845074953, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 312000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.79408449328331, "done": false, "training_iteration": 156, "trial_id": "8cacd_00000", "date": "2025-05-12_03-59-59", "timestamp": 1746986399, "time_this_iter_s": 40.10252547264099, "time_total_s": 6057.789390087128, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6057.789390087128, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 77.66666666666667, "ram_util_percent": 51.912280701754376}}
{"timers": {"training_iteration": 39.59415215111434, "restore_env_runners": 3.0299686011613674e-05, "training_step": 39.59360129756783, "env_runner_sampling_timer": 30.271574077355062, "learner_update_timer": 9.313836168756731, "synch_weights": 0.007106792130243448, "synch_env_connectors": 0.009004073017556841}, "env_runners": {"episode_return_mean": 0.9496420940170947, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012543473762235296, "get_actions": 0.0007544419043466349, "un_batch_to_individual_items": 7.232766456271015e-05, "listify_data_for_vector_env": 0.0001463244119834904, "tensor_to_numpy": 0.0002476259143626521, "remove_single_ts_time_rank_from_batch": 8.359495799449746e-06}}, "connector_pipeline_timer": 0.0016885846762282918}, "episode_return_max": 1.2150000000000012, "num_episodes_lifetime": 1448, "episode_duration_sec_mean": 23.11132453543223, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017342573590092679, "add_time_dim_to_batch_and_zero_pad": 4.015294251317898e-05, "add_states_from_episodes_to_batch": 2.0974892568657666e-05, "batch_individual_items": 0.00010263285164129362, "add_observations_from_episodes_to_batch": 4.2886891046121045e-05}}, "connector_pipeline_timer": 0.00063816608225161}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 314000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 314000}, "sample": 29.3704591158588, "num_env_steps_sampled_lifetime": 314000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7085555555555556, "agent_episode_returns_mean": {"default_agent": 0.9496420940170947}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9496420940170947}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.57905858638796, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005930107754396744, "weights_seq_no": 156.0, "env_to_module_sum_episodes_length_in": 92.57905858638796, "env_step_timer": 0.11605699268860811, "time_between_sampling": 10.068650465476537, "num_env_steps_sampled_lifetime_throughput": 48.73645919136282}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.4889251617600177e-24, "mean_kl_loss": 0.0031005186028778553, "weights_seq_no": 157.0, "vf_loss": 0.012261169962584972, "gradients_default_optimizer_global_norm": 0.40761181712150574, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9511296, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012261169962584972, "vf_explained_var": 0.08254212141036987, "entropy": 0.20754802227020264, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03180588781833649, "policy_loss": -0.04406703636050224}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08136400612553167, "add_time_dim_to_batch_and_zero_pad": 3.339279014115031e-05, "add_states_from_episodes_to_batch": 1.1258841697909778e-05, "general_advantage_estimation": 0.07260048990336775, "batch_individual_items": 0.04815782962002322, "add_observations_from_episodes_to_batch": 0.000371175358791362, "add_one_ts_to_episodes_and_truncate": 0.006975240082659387, "numpy_to_tensor": 0.0012251878671524221}}, "connector_pipeline_timer": 0.21124906951965647}, "num_env_steps_trained_lifetime": 149890312, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9511296, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5535957689399, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 314000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.73645919136282, "done": false, "training_iteration": 157, "trial_id": "8cacd_00000", "date": "2025-05-12_04-00-40", "timestamp": 1746986440, "time_this_iter_s": 40.966164112091064, "time_total_s": 6098.755554199219, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6098.755554199219, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 77.38620689655171, "ram_util_percent": 51.893103448275866}}
{"timers": {"training_iteration": 39.60334592831321, "restore_env_runners": 3.021468913798684e-05, "training_step": 39.60279550430216, "env_runner_sampling_timer": 30.27723696933154, "learner_update_timer": 9.317384107029149, "synch_weights": 0.0070911082089476106, "synch_env_connectors": 0.009022446277400743}, "env_runners": {"episode_return_mean": 0.9806709401709409, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012495338332373817, "get_actions": 0.000752910073533153, "un_batch_to_individual_items": 7.187294294044788e-05, "listify_data_for_vector_env": 0.00014546745298993466, "tensor_to_numpy": 0.0002461585660749928, "remove_single_ts_time_rank_from_batch": 8.270626206735207e-06}}, "connector_pipeline_timer": 0.0016816128756254227}, "episode_return_max": 1.2790000000000017, "num_episodes_lifetime": 1456, "episode_duration_sec_mean": 23.135250068365515, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017211652069133054, "add_time_dim_to_batch_and_zero_pad": 3.9842430473888126e-05, "add_states_from_episodes_to_batch": 2.107354593712591e-05, "batch_individual_items": 0.00010184704324995372, "add_observations_from_episodes_to_batch": 4.28848914986454e-05}}, "connector_pipeline_timer": 0.0006356959691522753}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 316000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 316000}, "sample": 29.384944279436738, "num_env_steps_sampled_lifetime": 316000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6793333333333335, "agent_episode_returns_mean": {"default_agent": 0.9806709401709409}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9806709401709409}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.19804951583266, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005913444607096506, "weights_seq_no": 157.0, "env_to_module_sum_episodes_length_in": 94.19804951583266, "env_step_timer": 0.1151918370912879, "time_between_sampling": 10.07363370229401, "num_env_steps_sampled_lifetime_throughput": 49.263263740330906}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 7.4446258088000885e-25, "mean_kl_loss": 0.004063890781253576, "weights_seq_no": 158.0, "vf_loss": 0.012850351631641388, "gradients_default_optimizer_global_norm": 0.2755039632320404, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9571840, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012850351631641388, "vf_explained_var": 0.11215198040008545, "entropy": 0.21233303844928741, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.07631079107522964, "policy_loss": 0.06346044689416885}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0813789785288233, "add_time_dim_to_batch_and_zero_pad": 3.34010003096247e-05, "add_states_from_episodes_to_batch": 1.1262377552835085e-05, "general_advantage_estimation": 0.07221352294337727, "batch_individual_items": 0.048219403652553706, "add_observations_from_episodes_to_batch": 0.0003713545502015795, "add_one_ts_to_episodes_and_truncate": 0.0069697453590049085, "numpy_to_tensor": 0.0012255070580089338}}, "connector_pipeline_timer": 0.21093292063512667}, "num_env_steps_trained_lifetime": 150843880, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9571840, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5572164645396, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 316000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.263263740330906, "done": false, "training_iteration": 158, "trial_id": "8cacd_00000", "date": "2025-05-12_04-01-20", "timestamp": 1746986480, "time_this_iter_s": 40.53183889389038, "time_total_s": 6139.287393093109, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6139.287393093109, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 76.32241379310345, "ram_util_percent": 51.901724137931026}}
{"timers": {"training_iteration": 39.631195938230086, "restore_env_runners": 3.0192542268637408e-05, "training_step": 39.63064497145912, "env_runner_sampling_timer": 30.30440626020823, "learner_update_timer": 9.318062685598846, "synch_weights": 0.007092702116842871, "synch_env_connectors": 0.009022418814617175}, "env_runners": {"episode_return_mean": 0.936582264957267, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012459597602505843, "get_actions": 0.0007528661836560286, "un_batch_to_individual_items": 7.119941006432343e-05, "listify_data_for_vector_env": 0.00014472438282338906, "tensor_to_numpy": 0.00024454316054876006, "remove_single_ts_time_rank_from_batch": 8.170706668725986e-06}}, "connector_pipeline_timer": 0.0016765114348882262}, "episode_return_max": 1.3737777777777809, "num_episodes_lifetime": 1472, "episode_duration_sec_mean": 23.23361681506696, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017126474389706173, "add_time_dim_to_batch_and_zero_pad": 3.9720474457622495e-05, "add_states_from_episodes_to_batch": 2.12597312999836e-05, "batch_individual_items": 0.0001007292655882966, "add_observations_from_episodes_to_batch": 4.290023075832673e-05}}, "connector_pipeline_timer": 0.0006341146931379617}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 318000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 318000}, "sample": 29.400710992643162, "num_env_steps_sampled_lifetime": 318000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6953333333333337, "agent_episode_returns_mean": {"default_agent": 0.936582264957267}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.936582264957267}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.9018142003549, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000591686792987536, "weights_seq_no": 158.0, "env_to_module_sum_episodes_length_in": 96.9018142003549, "env_step_timer": 0.11638876524323814, "time_between_sampling": 10.078871727678685, "num_env_steps_sampled_lifetime_throughput": 47.09407314619203}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.7223129044000443e-25, "mean_kl_loss": 0.0020612922962754965, "weights_seq_no": 159.0, "vf_loss": 0.015567194670438766, "gradients_default_optimizer_global_norm": 0.16890019178390503, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 9632640, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.015567194670438766, "vf_explained_var": 0.043988585472106934, "entropy": 0.14234653115272522, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.08436522632837296, "policy_loss": -0.09993242472410202}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08139367361343675, "add_time_dim_to_batch_and_zero_pad": 3.340869699556356e-05, "add_states_from_episodes_to_batch": 1.1265816806500686e-05, "general_advantage_estimation": 0.0718278407435966, "batch_individual_items": 0.04827936859157177, "add_observations_from_episodes_to_batch": 0.00037154551024779593, "add_one_ts_to_episodes_and_truncate": 0.006964374855815044, "numpy_to_tensor": 0.0012258054162615876}}, "connector_pipeline_timer": 0.21061627790143522}, "num_env_steps_trained_lifetime": 151805280, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 9632640, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5615093866502, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 318000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.09407314619203, "done": false, "training_iteration": 159, "trial_id": "8cacd_00000", "date": "2025-05-12_04-02-03", "timestamp": 1746986523, "time_this_iter_s": 42.4065625667572, "time_total_s": 6181.693955659866, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6181.693955659866, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 80.53999999999999, "ram_util_percent": 51.87666666666668}}
{"timers": {"training_iteration": 39.63325610528779, "restore_env_runners": 3.021061684514311e-05, "training_step": 39.63270466018452, "env_runner_sampling_timer": 30.309692440966142, "learner_update_timer": 9.31485911882284, "synch_weights": 0.007071346095692191, "synch_env_connectors": 0.009020368626482353}, "env_runners": {"episode_return_mean": 0.9031826923076948, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012405759781065876, "get_actions": 0.0007507804392151042, "un_batch_to_individual_items": 7.24389074640973e-05, "listify_data_for_vector_env": 0.0001450804205556635, "tensor_to_numpy": 0.0002450940683555163, "remove_single_ts_time_rank_from_batch": 8.216328510059673e-06}}, "connector_pipeline_timer": 0.0016748443312194342}, "episode_return_max": 1.2677777777777817, "num_episodes_lifetime": 1480, "episode_duration_sec_mean": 23.42167138121137, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017082918655793842, "add_time_dim_to_batch_and_zero_pad": 3.968853477409066e-05, "add_states_from_episodes_to_batch": 2.113418700766944e-05, "batch_individual_items": 0.00010162454805204042, "add_observations_from_episodes_to_batch": 4.2642215736954806e-05}}, "connector_pipeline_timer": 0.0006321631696229988}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 320000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 320000}, "sample": 29.415554200206287, "num_env_steps_sampled_lifetime": 320000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7210000000000014, "agent_episode_returns_mean": {"default_agent": 0.9031826923076948}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9031826923076948}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.06806299378098, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005905650434465689, "weights_seq_no": 159.0, "env_to_module_sum_episodes_length_in": 97.06806299378098, "env_step_timer": 0.1169399128882683, "time_between_sampling": 10.08344674980272, "num_env_steps_sampled_lifetime_throughput": 50.09946442436097}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.8611564522000221e-25, "mean_kl_loss": 0.0019286657916381955, "weights_seq_no": 160.0, "vf_loss": 0.019442876800894737, "gradients_default_optimizer_global_norm": 0.40924206376075745, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9693184, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.019442876800894737, "vf_explained_var": 0.025056958198547363, "entropy": 0.1840677112340927, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.044471196830272675, "policy_loss": -0.06391408294439316}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08140827519850516, "add_time_dim_to_batch_and_zero_pad": 3.3415219647592206e-05, "add_states_from_episodes_to_batch": 1.1269051037236283e-05, "general_advantage_estimation": 0.07144425755551706, "batch_individual_items": 0.0483375316714442, "add_observations_from_episodes_to_batch": 0.00037172939563811423, "add_one_ts_to_episodes_and_truncate": 0.006958977048153226, "numpy_to_tensor": 0.0012261573066431723}}, "connector_pipeline_timer": 0.21029986166035403}, "num_env_steps_trained_lifetime": 152758848, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9693184, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5656607286721, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 320000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.09946442436097, "done": false, "training_iteration": 160, "trial_id": "8cacd_00000", "date": "2025-05-12_04-02-43", "timestamp": 1746986563, "time_this_iter_s": 39.855161905288696, "time_total_s": 6221.549117565155, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6221.549117565155, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 78.19649122807019, "ram_util_percent": 51.85614035087719}}
{"timers": {"training_iteration": 39.6393447584849, "restore_env_runners": 3.012051065387381e-05, "training_step": 39.638792569832674, "env_runner_sampling_timer": 30.31034365576648, "learner_update_timer": 9.32025229867461, "synch_weights": 0.007115806634755757, "synch_env_connectors": 0.009021276940226692}, "env_runners": {"episode_return_mean": 0.8764401709401729, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012465356264949643, "get_actions": 0.0007520728555133296, "un_batch_to_individual_items": 7.225784668806797e-05, "listify_data_for_vector_env": 0.00014539917010144207, "tensor_to_numpy": 0.0002442451312879099, "remove_single_ts_time_rank_from_batch": 8.190263900505238e-06}}, "connector_pipeline_timer": 0.001676633266806837}, "episode_return_max": 1.2677777777777817, "num_episodes_lifetime": 1488, "episode_duration_sec_mean": 23.090766765240566, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001703282076112504, "add_time_dim_to_batch_and_zero_pad": 3.941048755922811e-05, "add_states_from_episodes_to_batch": 2.1031339631018817e-05, "batch_individual_items": 0.00010162651546277605, "add_observations_from_episodes_to_batch": 4.2239037873873125e-05}}, "connector_pipeline_timer": 0.0006292414499217141}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 322000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 322000}, "sample": 29.42935665206412, "num_env_steps_sampled_lifetime": 322000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6291111111111116, "agent_episode_returns_mean": {"default_agent": 0.8764401709401729}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8764401709401729}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.30039798872318, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.00058881614497686, "weights_seq_no": 160.0, "env_to_module_sum_episodes_length_in": 95.30039798872318, "env_step_timer": 0.11697366350967041, "time_between_sampling": 10.087607034709485, "num_env_steps_sampled_lifetime_throughput": 49.46244667390751}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.8611564522000221e-25, "mean_kl_loss": 0.005877283401787281, "weights_seq_no": 161.0, "vf_loss": 0.014910686761140823, "gradients_default_optimizer_global_norm": 0.7175388336181641, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9753728, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014910686761140823, "vf_explained_var": 0.0687485933303833, "entropy": 0.22349011898040771, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.17666049301624298, "policy_loss": 0.16174980998039246}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08142266997411078, "add_time_dim_to_batch_and_zero_pad": 3.342235097666124e-05, "add_states_from_episodes_to_batch": 1.1272534001727453e-05, "general_advantage_estimation": 0.0710619574871247, "batch_individual_items": 0.04839435731255983, "add_observations_from_episodes_to_batch": 0.0003719077787697748, "add_one_ts_to_episodes_and_truncate": 0.006953554589058757, "numpy_to_tensor": 0.0012265047186752263}}, "connector_pipeline_timer": 0.20998316129550412}, "num_env_steps_trained_lifetime": 153712416, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9753728, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.569672892915, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 322000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.46244667390751, "done": false, "training_iteration": 161, "trial_id": "8cacd_00000", "date": "2025-05-12_04-03-23", "timestamp": 1746986603, "time_this_iter_s": 40.26116442680359, "time_total_s": 6261.810281991959, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6261.810281991959, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 77.82280701754385, "ram_util_percent": 51.9157894736842}}
{"timers": {"training_iteration": 39.65058476041005, "restore_env_runners": 3.0145305519454537e-05, "training_step": 39.65003272264437, "env_runner_sampling_timer": 30.31453167854883, "learner_update_timer": 9.327307363857852, "synch_weights": 0.007113544568383411, "synch_env_connectors": 0.009027191160817051}, "env_runners": {"episode_return_mean": 1.0154668803418816, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012503527324237633, "get_actions": 0.0007522244792153576, "un_batch_to_individual_items": 7.238389469388914e-05, "listify_data_for_vector_env": 0.00014565467467427977, "tensor_to_numpy": 0.0002441825708736789, "remove_single_ts_time_rank_from_batch": 8.309192530655404e-06}}, "connector_pipeline_timer": 0.0016777817225427695}, "episode_return_max": 1.4385555555555576, "num_episodes_lifetime": 1496, "episode_duration_sec_mean": 23.26592915268216, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017092131306010357, "add_time_dim_to_batch_and_zero_pad": 4.0187713540648015e-05, "add_states_from_episodes_to_batch": 2.1160816494201088e-05, "batch_individual_items": 0.0001012116363690102, "add_observations_from_episodes_to_batch": 4.2003453124329105e-05}}, "connector_pipeline_timer": 0.0006305685766467798}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 324000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 324000}, "sample": 29.442651663929805, "num_env_steps_sampled_lifetime": 324000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6291111111111116, "agent_episode_returns_mean": {"default_agent": 1.0154668803418816}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0154668803418816}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.40095348059612, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005876145982908732, "weights_seq_no": 161.0, "env_to_module_sum_episodes_length_in": 93.40095348059612, "env_step_timer": 0.11683316660652139, "time_between_sampling": 10.091808283626102, "num_env_steps_sampled_lifetime_throughput": 48.94946703726143}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 9.305782261000111e-26, "mean_kl_loss": 0.004913961980491877, "weights_seq_no": 162.0, "vf_loss": 0.014632240869104862, "gradients_default_optimizer_global_norm": 0.26876911520957947, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9814272, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014632240869104862, "vf_explained_var": 0.0484352707862854, "entropy": 0.20047448575496674, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.14745572209358215, "policy_loss": -0.16208796203136444}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08143679209668447, "add_time_dim_to_batch_and_zero_pad": 3.342903815704913e-05, "add_states_from_episodes_to_batch": 1.1275930401909812e-05, "general_advantage_estimation": 0.0706809079643444, "batch_individual_items": 0.04845016080768597, "add_observations_from_episodes_to_batch": 0.0003720838012993529, "add_one_ts_to_episodes_and_truncate": 0.006948074011441061, "numpy_to_tensor": 0.0012268443467363108}}, "connector_pipeline_timer": 0.20966635099178516}, "num_env_steps_trained_lifetime": 154665984, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9814272, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5735482478, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 324000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.94946703726143, "done": false, "training_iteration": 162, "trial_id": "8cacd_00000", "date": "2025-05-12_04-04-04", "timestamp": 1746986644, "time_this_iter_s": 40.782960653305054, "time_total_s": 6302.593242645264, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6302.593242645264, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 77.81206896551724, "ram_util_percent": 51.91724137931034}}
{"timers": {"training_iteration": 39.663385869115935, "restore_env_runners": 3.0096852462598047e-05, "training_step": 39.66283383972793, "env_runner_sampling_timer": 30.32587579065335, "learner_update_timer": 9.328752043639282, "synch_weights": 0.0071254681226891655, "synch_env_connectors": 0.009032484249183039}, "env_runners": {"episode_return_mean": 1.0029166666666678, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012511837562262845, "get_actions": 0.000752003852972399, "un_batch_to_individual_items": 7.207049179335348e-05, "listify_data_for_vector_env": 0.00014459487799522002, "tensor_to_numpy": 0.00024399550838440212, "remove_single_ts_time_rank_from_batch": 8.283504000475679e-06}}, "connector_pipeline_timer": 0.0016735048079286388}, "episode_return_max": 1.4385555555555576, "num_episodes_lifetime": 1504, "episode_duration_sec_mean": 23.58806641863388, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017140428752495415, "add_time_dim_to_batch_and_zero_pad": 3.988206288172605e-05, "add_states_from_episodes_to_batch": 2.1342499751732242e-05, "batch_individual_items": 0.00010100645437065804, "add_observations_from_episodes_to_batch": 4.171345643127587e-05}}, "connector_pipeline_timer": 0.0006313979405820841}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 326000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 326000}, "sample": 29.455250230604825, "num_env_steps_sampled_lifetime": 326000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7084444444444442, "agent_episode_returns_mean": {"default_agent": 1.0029166666666678}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0029166666666678}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.56009259398016, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000587273194817908, "weights_seq_no": 162.0, "env_to_module_sum_episodes_length_in": 92.56009259398016, "env_step_timer": 0.11619724104331025, "time_between_sampling": 10.095980896688134, "num_env_steps_sampled_lifetime_throughput": 48.76976353490266}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 9.305782261000111e-26, "mean_kl_loss": 0.005136753432452679, "weights_seq_no": 163.0, "vf_loss": 0.006497190333902836, "gradients_default_optimizer_global_norm": 0.9774648547172546, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9874816, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.006497190333902836, "vf_explained_var": 0.14762777090072632, "entropy": 0.19077415764331818, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.01771225407719612, "policy_loss": -0.024209443479776382}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08145057106980913, "add_time_dim_to_batch_and_zero_pad": 3.343475935856268e-05, "add_states_from_episodes_to_batch": 1.1279141620739234e-05, "general_advantage_estimation": 0.07030100840627115, "batch_individual_items": 0.048504359067178184, "add_observations_from_episodes_to_batch": 0.0003722499426005676, "add_one_ts_to_episodes_and_truncate": 0.006942620409916657, "numpy_to_tensor": 0.0012271681617640662}}, "connector_pipeline_timer": 0.209348741748011}, "num_env_steps_trained_lifetime": 155619552, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9874816, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5772891282982, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 326000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.76976353490266, "done": false, "training_iteration": 163, "trial_id": "8cacd_00000", "date": "2025-05-12_04-04-45", "timestamp": 1746986685, "time_this_iter_s": 40.946919202804565, "time_total_s": 6343.540161848068, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6343.540161848068, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 77.22241379310347, "ram_util_percent": 51.86379310344828}}
{"timers": {"training_iteration": 39.669199646904765, "restore_env_runners": 3.0019883933768542e-05, "training_step": 39.668648344810634, "env_runner_sampling_timer": 30.329766686456818, "learner_update_timer": 9.330636005972872, "synch_weights": 0.007166043441449368, "synch_env_connectors": 0.009026024406706275}, "env_runners": {"episode_return_mean": 0.866558760683761, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012426978514080576, "get_actions": 0.0007534956250313116, "un_batch_to_individual_items": 7.127670905770101e-05, "listify_data_for_vector_env": 0.00014349795519347146, "tensor_to_numpy": 0.00024310801300199446, "remove_single_ts_time_rank_from_batch": 8.336427131238532e-06}}, "connector_pipeline_timer": 0.0016697378379747667}, "episode_return_max": 1.3743333333333352, "num_episodes_lifetime": 1512, "episode_duration_sec_mean": 23.574157245787703, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017133519054413494, "add_time_dim_to_batch_and_zero_pad": 3.959559525137846e-05, "add_states_from_episodes_to_batch": 2.1477946150231365e-05, "batch_individual_items": 0.00010083171940268533, "add_observations_from_episodes_to_batch": 4.18666496444554e-05}}, "connector_pipeline_timer": 0.0006318177754811238}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 328000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 328000}, "sample": 29.467191817015784, "num_env_steps_sampled_lifetime": 328000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6902222222222224, "agent_episode_returns_mean": {"default_agent": 0.866558760683761}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.866558760683761}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.46150088783796, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005869195210323248, "weights_seq_no": 163.0, "env_to_module_sum_episodes_length_in": 93.46150088783796, "env_step_timer": 0.11554607706224991, "time_between_sampling": 10.100476138571118, "num_env_steps_sampled_lifetime_throughput": 49.596048186126566}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.6528911305000553e-26, "mean_kl_loss": 0.0027668362017720938, "weights_seq_no": 164.0, "vf_loss": 0.013256982900202274, "gradients_default_optimizer_global_norm": 0.5513404607772827, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9935360, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013256982900202274, "vf_explained_var": 0.10569459199905396, "entropy": 0.18284262716770172, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03374180570244789, "policy_loss": -0.04699878767132759}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08146599343456136, "add_time_dim_to_batch_and_zero_pad": 3.3439933232196764e-05, "add_states_from_episodes_to_batch": 1.1282231022295832e-05, "general_advantage_estimation": 0.06992265677856292, "batch_individual_items": 0.04855786133559966, "add_observations_from_episodes_to_batch": 0.00037241590269582756, "add_one_ts_to_episodes_and_truncate": 0.006937199273021333, "numpy_to_tensor": 0.0012275021860566262}}, "connector_pipeline_timer": 0.2090336732245131}, "num_env_steps_trained_lifetime": 156573120, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9935360, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5808978363616, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 328000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.596048186126566, "done": false, "training_iteration": 164, "trial_id": "8cacd_00000", "date": "2025-05-12_04-05-25", "timestamp": 1746986725, "time_this_iter_s": 40.26500058174133, "time_total_s": 6383.80516242981, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6383.80516242981, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 78.39824561403509, "ram_util_percent": 51.90350877192982}}
{"timers": {"training_iteration": 39.66563582490572, "restore_env_runners": 3.0071685082628204e-05, "training_step": 39.665083906832535, "env_runner_sampling_timer": 30.327424641232234, "learner_update_timer": 9.329379687743115, "synch_weights": 0.007200460007017053, "synch_env_connectors": 0.009031021162632793}, "env_runners": {"episode_return_mean": 0.8485619658119663, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001239893527367381, "get_actions": 0.0007514582694938365, "un_batch_to_individual_items": 7.121432883801534e-05, "listify_data_for_vector_env": 0.00014249294365058378, "tensor_to_numpy": 0.0002421910288398826, "remove_single_ts_time_rank_from_batch": 8.250280188152155e-06}}, "connector_pipeline_timer": 0.001663606833324457}, "episode_return_max": 1.3743333333333352, "num_episodes_lifetime": 1520, "episode_duration_sec_mean": 23.39189957855692, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017121661606246853, "add_time_dim_to_batch_and_zero_pad": 3.93322714753133e-05, "add_states_from_episodes_to_batch": 2.1265936249989277e-05, "batch_individual_items": 0.00010012118119339198, "add_observations_from_episodes_to_batch": 4.141074532914813e-05}}, "connector_pipeline_timer": 0.000629560827228915}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 330000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 330000}, "sample": 29.47796451845625, "num_env_steps_sampled_lifetime": 330000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6902222222222224, "agent_episode_returns_mean": {"default_agent": 0.8485619658119663}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8485619658119663}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.45633127323336, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005854171814848499, "weights_seq_no": 164.0, "env_to_module_sum_episodes_length_in": 96.45633127323336, "env_step_timer": 0.11451719082644637, "time_between_sampling": 10.104749350919919, "num_env_steps_sampled_lifetime_throughput": 50.76689544584108}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.3264455652500277e-26, "mean_kl_loss": 0.0019617171492427588, "weights_seq_no": 165.0, "vf_loss": 0.012397564947605133, "gradients_default_optimizer_global_norm": 1.053694486618042, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9995904, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012397564947605133, "vf_explained_var": 0.11351466178894043, "entropy": 0.19000957906246185, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.05618559941649437, "policy_loss": -0.0685831606388092}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0814815378048116, "add_time_dim_to_batch_and_zero_pad": 3.344466015234652e-05, "add_states_from_episodes_to_batch": 1.1285320721625521e-05, "general_advantage_estimation": 0.0695461590525682, "batch_individual_items": 0.04861009847264597, "add_observations_from_episodes_to_batch": 0.00037257647859489256, "add_one_ts_to_episodes_and_truncate": 0.0069318329768232115, "numpy_to_tensor": 0.0012278368430470132}}, "connector_pipeline_timer": 0.2087193704271101}, "num_env_steps_trained_lifetime": 157526688, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 9995904, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.584376641351, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 330000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.76689544584108, "done": false, "training_iteration": 165, "trial_id": "8cacd_00000", "date": "2025-05-12_04-06-05", "timestamp": 1746986765, "time_this_iter_s": 39.330429792404175, "time_total_s": 6423.135592222214, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6423.135592222214, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 78.02499999999999, "ram_util_percent": 51.919642857142854}}
{"timers": {"training_iteration": 39.70178591971666, "restore_env_runners": 3.011196824537921e-05, "training_step": 39.70123421882422, "env_runner_sampling_timer": 30.3675645207399, "learner_update_timer": 9.325389561005718, "synch_weights": 0.007200034406942719, "synch_env_connectors": 0.009035640951020312}, "env_runners": {"episode_return_mean": 0.9562350427350451, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012417312857992177, "get_actions": 0.00075220574653895, "un_batch_to_individual_items": 7.209168684850011e-05, "listify_data_for_vector_env": 0.0001419639268462947, "tensor_to_numpy": 0.0002424902403209797, "remove_single_ts_time_rank_from_batch": 8.175592150400386e-06}}, "connector_pipeline_timer": 0.001665709558950081}, "episode_return_max": 1.226000000000004, "num_episodes_lifetime": 1536, "episode_duration_sec_mean": 23.2204726849128, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017098373679313986, "add_time_dim_to_batch_and_zero_pad": 3.953782470223166e-05, "add_states_from_episodes_to_batch": 2.120531077949143e-05, "batch_individual_items": 9.979436116412525e-05, "add_observations_from_episodes_to_batch": 4.142316910901177e-05}}, "connector_pipeline_timer": 0.0006290646662092808}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 332000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 332000}, "sample": 29.491297065571676, "num_env_steps_sampled_lifetime": 332000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6818888888888899, "agent_episode_returns_mean": {"default_agent": 0.9562350427350451}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9562350427350451}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.51014163468342, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005854840737665793, "weights_seq_no": 165.0, "env_to_module_sum_episodes_length_in": 97.51014163468342, "env_step_timer": 0.11556772383938592, "time_between_sampling": 10.108645911281974, "num_env_steps_sampled_lifetime_throughput": 46.127613905674366}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.3264455652500277e-26, "mean_kl_loss": 0.012139499187469482, "weights_seq_no": 166.0, "vf_loss": 0.01966475136578083, "gradients_default_optimizer_global_norm": 0.7168817520141602, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 10056704, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01966475136578083, "vf_explained_var": 0.06499111652374268, "entropy": 0.20272955298423767, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.08645464479923248, "policy_loss": -0.10611940920352936}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0814974327284135, "add_time_dim_to_batch_and_zero_pad": 3.3448798541007294e-05, "add_states_from_episodes_to_batch": 1.1288590404111906e-05, "general_advantage_estimation": 0.06917144505541563, "batch_individual_items": 0.048661241360817835, "add_observations_from_episodes_to_batch": 0.00037275190138587403, "add_one_ts_to_episodes_and_truncate": 0.006926561486622076, "numpy_to_tensor": 0.001228181186679012}}, "connector_pipeline_timer": 0.20840622606843287}, "num_env_steps_trained_lifetime": 158488088, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 10056704, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5885277804568, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 332000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.127613905674366, "done": false, "training_iteration": 166, "trial_id": "8cacd_00000", "date": "2025-05-12_04-06-48", "timestamp": 1746986808, "time_this_iter_s": 43.298728704452515, "time_total_s": 6466.434320926666, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6466.434320926666, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 81.08225806451614, "ram_util_percent": 51.9483870967742}}
{"timers": {"training_iteration": 39.70344770368953, "restore_env_runners": 3.014084856550285e-05, "training_step": 39.702895913806, "env_runner_sampling_timer": 30.371852571122506, "learner_update_timer": 9.322771090975664, "synch_weights": 0.007193058062905573, "synch_env_connectors": 0.009038087541480553}, "env_runners": {"episode_return_mean": 0.9953525641025668, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001250724751100966, "get_actions": 0.0007529647666117678, "un_batch_to_individual_items": 7.240841025695501e-05, "listify_data_for_vector_env": 0.00014225558210599387, "tensor_to_numpy": 0.0002418351082744315, "remove_single_ts_time_rank_from_batch": 8.158707149095374e-06}}, "connector_pipeline_timer": 0.0016695987294553126}, "episode_return_max": 1.2958888888888926, "num_episodes_lifetime": 1544, "episode_duration_sec_mean": 23.47689681921058, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001709348733353025, "add_time_dim_to_batch_and_zero_pad": 3.949885302609697e-05, "add_states_from_episodes_to_batch": 2.1025220920039623e-05, "batch_individual_items": 9.94364053296658e-05, "add_observations_from_episodes_to_batch": 4.1146161522450785e-05}}, "connector_pipeline_timer": 0.0006293555043033633}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 334000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 334000}, "sample": 29.503760520034557, "num_env_steps_sampled_lifetime": 334000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6881111111111122, "agent_episode_returns_mean": {"default_agent": 0.9953525641025668}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9953525641025668}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.16671851760631, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005850062307157623, "weights_seq_no": 166.0, "env_to_module_sum_episodes_length_in": 96.16671851760631, "env_step_timer": 0.11582871251155906, "time_between_sampling": 10.111643736265767, "num_env_steps_sampled_lifetime_throughput": 50.04360434740036}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.3264455652500277e-26, "mean_kl_loss": 0.0065157450735569, "weights_seq_no": 167.0, "vf_loss": 0.018177999183535576, "gradients_default_optimizer_global_norm": 0.49503812193870544, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10117248, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.018177999183535576, "vf_explained_var": 0.062080442905426025, "entropy": 0.26159998774528503, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06797997653484344, "policy_loss": -0.08615796267986298}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08151291603966282, "add_time_dim_to_batch_and_zero_pad": 3.345628969584658e-05, "add_states_from_episodes_to_batch": 1.129178616067348e-05, "general_advantage_estimation": 0.06879875895230103, "batch_individual_items": 0.04871086472137903, "add_observations_from_episodes_to_batch": 0.00037292111807330744, "add_one_ts_to_episodes_and_truncate": 0.006921227352927226, "numpy_to_tensor": 0.001228570929753816}}, "connector_pipeline_timer": 0.20809316514978643}, "num_env_steps_trained_lifetime": 159441656, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10117248, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.5925374591166, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 334000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.04360434740036, "done": false, "training_iteration": 167, "trial_id": "8cacd_00000", "date": "2025-05-12_04-07-28", "timestamp": 1746986848, "time_this_iter_s": 39.885310649871826, "time_total_s": 6506.319631576538, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6506.319631576538, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 79.09821428571429, "ram_util_percent": 51.92499999999999}}
{"timers": {"training_iteration": 39.705990591942616, "restore_env_runners": 3.0091440070571384e-05, "training_step": 39.70543723895793, "env_runner_sampling_timer": 30.375148811601285, "learner_update_timer": 9.322022306165918, "synch_weights": 0.007185454482276565, "synch_env_connectors": 0.009045505666061323}, "env_runners": {"episode_return_mean": 0.9517574786324805, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001249669909761276, "get_actions": 0.0007508487843023841, "un_batch_to_individual_items": 7.340865584244226e-05, "listify_data_for_vector_env": 0.00014160735264144504, "tensor_to_numpy": 0.00024183566247219042, "remove_single_ts_time_rank_from_batch": 8.184535067281511e-06}}, "connector_pipeline_timer": 0.001667939677642641}, "episode_return_max": 1.2958888888888926, "num_episodes_lifetime": 1552, "episode_duration_sec_mean": 23.298025466076453, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017090845052213668, "add_time_dim_to_batch_and_zero_pad": 4.044597942721418e-05, "add_states_from_episodes_to_batch": 2.0779656907832518e-05, "batch_individual_items": 0.00010003131655055242, "add_observations_from_episodes_to_batch": 4.0860344772041285e-05}}, "connector_pipeline_timer": 0.0006297895898130707}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 336000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 336000}, "sample": 29.515685713149182, "num_env_steps_sampled_lifetime": 336000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6881111111111122, "agent_episode_returns_mean": {"default_agent": 0.9517574786324805}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9517574786324805}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.13328401270536, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005831544157168185, "weights_seq_no": 167.0, "env_to_module_sum_episodes_length_in": 94.13328401270536, "env_step_timer": 0.11576994271971848, "time_between_sampling": 10.11436998787452, "num_env_steps_sampled_lifetime_throughput": 49.94998953601183}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.1632227826250138e-26, "mean_kl_loss": 0.003044798271730542, "weights_seq_no": 168.0, "vf_loss": 0.012246359139680862, "gradients_default_optimizer_global_norm": 0.5492423176765442, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10177792, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012246359139680862, "vf_explained_var": 0.07187581062316895, "entropy": 0.2147928923368454, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.047676101326942444, "policy_loss": 0.035429734736680984}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08152785956141434, "add_time_dim_to_batch_and_zero_pad": 3.3470136147795386e-05, "add_states_from_episodes_to_batch": 1.129513914315664e-05, "general_advantage_estimation": 0.06842781825674336, "batch_individual_items": 0.04875906039059301, "add_observations_from_episodes_to_batch": 0.00037308744523668885, "add_one_ts_to_episodes_and_truncate": 0.006915857625757524, "numpy_to_tensor": 0.0012290649698483828}}, "connector_pipeline_timer": 0.20777996318690609}, "num_env_steps_trained_lifetime": 160395224, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10177792, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.596408091425, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 336000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.94998953601183, "done": false, "training_iteration": 168, "trial_id": "8cacd_00000", "date": "2025-05-12_04-08-08", "timestamp": 1746986888, "time_this_iter_s": 39.97834300994873, "time_total_s": 6546.297974586487, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6546.297974586487, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 78.80877192982457, "ram_util_percent": 51.940350877192984}}
{"timers": {"training_iteration": 39.70365705745319, "restore_env_runners": 3.0078525680052475e-05, "training_step": 39.70309145099835, "env_runner_sampling_timer": 30.376860059815282, "learner_update_timer": 9.317981009204253, "synch_weights": 0.007169698937447792, "synch_env_connectors": 0.00906268160939238}, "env_runners": {"episode_return_mean": 1.0035395299145309, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001241304693728646, "get_actions": 0.0007511931025777344, "un_batch_to_individual_items": 7.313720412696094e-05, "listify_data_for_vector_env": 0.00014287839840820872, "tensor_to_numpy": 0.00024267060401247616, "remove_single_ts_time_rank_from_batch": 8.79065220902404e-06}}, "connector_pipeline_timer": 0.001669770954944387}, "episode_return_max": 1.2808888888888916, "num_episodes_lifetime": 1560, "episode_duration_sec_mean": 22.984113006508885, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017072747499727816, "add_time_dim_to_batch_and_zero_pad": 4.065459314404265e-05, "add_states_from_episodes_to_batch": 2.064744134503229e-05, "batch_individual_items": 0.00010045004464515266, "add_observations_from_episodes_to_batch": 4.0513997972956386e-05}}, "connector_pipeline_timer": 0.0006299178347115272}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 338000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 338000}, "sample": 29.526853701632202, "num_env_steps_sampled_lifetime": 338000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6970000000000007, "agent_episode_returns_mean": {"default_agent": 1.0035395299145309}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0035395299145309}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.80834708504115, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005829080386354914, "weights_seq_no": 168.0, "env_to_module_sum_episodes_length_in": 92.80834708504115, "env_step_timer": 0.11545733733470576, "time_between_sampling": 10.116658451786382, "num_env_steps_sampled_lifetime_throughput": 50.53861753629862}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.816113913125069e-27, "mean_kl_loss": 0.003727286821231246, "weights_seq_no": 169.0, "vf_loss": 0.011474337428808212, "gradients_default_optimizer_global_norm": 0.611953854560852, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10238336, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011474337428808212, "vf_explained_var": 0.09527748823165894, "entropy": 0.22090278565883636, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03079795092344284, "policy_loss": -0.04227229207754135}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0815422735311268, "add_time_dim_to_batch_and_zero_pad": 3.34839900417276e-05, "add_states_from_episodes_to_batch": 1.1298905887264275e-05, "general_advantage_estimation": 0.06805823051920158, "batch_individual_items": 0.04880569494995054, "add_observations_from_episodes_to_batch": 0.00037324474374506673, "add_one_ts_to_episodes_and_truncate": 0.006910507790395936, "numpy_to_tensor": 0.0012295736120480495}}, "connector_pipeline_timer": 0.20746605534676849}, "num_env_steps_trained_lifetime": 161348792, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10238336, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6001420573411, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 338000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.53861753629862, "done": false, "training_iteration": 169, "trial_id": "8cacd_00000", "date": "2025-05-12_04-08-48", "timestamp": 1746986928, "time_this_iter_s": 39.490652084350586, "time_total_s": 6585.788626670837, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6585.788626670837, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 79.22678571428573, "ram_util_percent": 51.94285714285713}}
{"timers": {"training_iteration": 39.70320878625868, "restore_env_runners": 3.009874043005852e-05, "training_step": 39.70264235986837, "env_runner_sampling_timer": 30.37990587251711, "learner_update_timer": 9.314495779192205, "synch_weights": 0.007158648948100844, "synch_env_connectors": 0.009059392793310552}, "env_runners": {"episode_return_mean": 0.9978675213675214, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001236597458546368, "get_actions": 0.0007502625407958122, "un_batch_to_individual_items": 7.253206242346099e-05, "listify_data_for_vector_env": 0.00014229165299453104, "tensor_to_numpy": 0.00024289454823217524, "remove_single_ts_time_rank_from_batch": 8.7343105280126e-06}}, "connector_pipeline_timer": 0.0016674923135054855}, "episode_return_max": 1.3664444444444461, "num_episodes_lifetime": 1568, "episode_duration_sec_mean": 23.107906304768186, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017057439837642215, "add_time_dim_to_batch_and_zero_pad": 4.057178773812671e-05, "add_states_from_episodes_to_batch": 2.0547476174393527e-05, "batch_individual_items": 0.00010131536990325622, "add_observations_from_episodes_to_batch": 4.022659002156141e-05}}, "connector_pipeline_timer": 0.0006306282532135028}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 340000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 340000}, "sample": 29.537399876639103, "num_env_steps_sampled_lifetime": 340000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7432222222222222, "agent_episode_returns_mean": {"default_agent": 0.9978675213675214}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9978675213675214}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.0311579980742, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005830713478667422, "weights_seq_no": 169.0, "env_to_module_sum_episodes_length_in": 93.0311579980742, "env_step_timer": 0.115053331336347, "time_between_sampling": 10.118408798087426, "num_env_steps_sampled_lifetime_throughput": 50.33445706738615}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.9080569565625346e-27, "mean_kl_loss": 0.00445761950686574, "weights_seq_no": 170.0, "vf_loss": 0.011276695877313614, "gradients_default_optimizer_global_norm": 0.2732592523097992, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10298880, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.011276695877313614, "vf_explained_var": 0.13625484704971313, "entropy": 0.2570704519748688, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.14319553971290588, "policy_loss": -0.1544722318649292}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0815563552554889, "add_time_dim_to_batch_and_zero_pad": 3.3497079844115966e-05, "add_states_from_episodes_to_batch": 1.1302497782414817e-05, "general_advantage_estimation": 0.0676898348245849, "batch_individual_items": 0.04885079250208213, "add_observations_from_episodes_to_batch": 0.0003733924375386471, "add_one_ts_to_episodes_and_truncate": 0.006905163605979024, "numpy_to_tensor": 0.0012300524449065557}}, "connector_pipeline_timer": 0.20715143057711496}, "num_env_steps_trained_lifetime": 162302360, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10298880, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.60374170313, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 340000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.33445706738615, "done": false, "training_iteration": 170, "trial_id": "8cacd_00000", "date": "2025-05-12_04-09-27", "timestamp": 1746986967, "time_this_iter_s": 39.67840385437012, "time_total_s": 6625.4670305252075, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6625.4670305252075, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 78.34035087719299, "ram_util_percent": 51.98596491228071}}
{"timers": {"training_iteration": 39.704854425346106, "restore_env_runners": 3.010975303679364e-05, "training_step": 39.7042814992197, "env_runner_sampling_timer": 30.37866665589192, "learner_update_timer": 9.317215938250282, "synch_weights": 0.007307218458615603, "synch_env_connectors": 0.00904805486540381}, "env_runners": {"episode_return_mean": 0.9173835470085477, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012350028769536912, "get_actions": 0.000749160395062433, "un_batch_to_individual_items": 7.232767280219053e-05, "listify_data_for_vector_env": 0.0001414317965083012, "tensor_to_numpy": 0.00024227481493761062, "remove_single_ts_time_rank_from_batch": 8.735696301162472e-06}}, "connector_pipeline_timer": 0.0016634522766354046}, "episode_return_max": 1.3664444444444461, "num_episodes_lifetime": 1576, "episode_duration_sec_mean": 23.39366463643175, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017000478773681728, "add_time_dim_to_batch_and_zero_pad": 4.048404417720885e-05, "add_states_from_episodes_to_batch": 2.0392409403462087e-05, "batch_individual_items": 0.0001011710197563776, "add_observations_from_episodes_to_batch": 4.008288619913908e-05}}, "connector_pipeline_timer": 0.0006285487915678427}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 342000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 342000}, "sample": 29.547046057973418, "num_env_steps_sampled_lifetime": 342000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7160000000000005, "agent_episode_returns_mean": {"default_agent": 0.9173835470085477}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9173835470085477}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.25341892743738, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005845946229095804, "weights_seq_no": 170.0, "env_to_module_sum_episodes_length_in": 95.25341892743738, "env_step_timer": 0.11431755422435477, "time_between_sampling": 10.119867999814742, "num_env_steps_sampled_lifetime_throughput": 49.849147513010415}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.4540284782812673e-27, "mean_kl_loss": 0.004004211630672216, "weights_seq_no": 171.0, "vf_loss": 0.017459150403738022, "gradients_default_optimizer_global_norm": 0.8429834842681885, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10359424, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017459150403738022, "vf_explained_var": 0.19395482540130615, "entropy": 0.17679128050804138, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1775171309709549, "policy_loss": 0.16005799174308777}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08156993463801065, "add_time_dim_to_batch_and_zero_pad": 3.351330945155472e-05, "add_states_from_episodes_to_batch": 1.1305977949006068e-05, "general_advantage_estimation": 0.0673227446008084, "batch_individual_items": 0.04889448274367631, "add_observations_from_episodes_to_batch": 0.000373543152982088, "add_one_ts_to_episodes_and_truncate": 0.0068998183044712506, "numpy_to_tensor": 0.0012305129937464384}}, "connector_pipeline_timer": 0.2068361960873198}, "num_env_steps_trained_lifetime": 163255928, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10359424, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6072093417974, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 342000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.849147513010415, "done": false, "training_iteration": 171, "trial_id": "8cacd_00000", "date": "2025-05-12_04-10-07", "timestamp": 1746987007, "time_this_iter_s": 39.902344703674316, "time_total_s": 6665.369375228882, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6665.369375228882, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 77.29298245614035, "ram_util_percent": 51.83684210526317}}
{"timers": {"training_iteration": 39.787696321592634, "restore_env_runners": 3.0104655504768882e-05, "training_step": 39.787124306727506, "env_runner_sampling_timer": 30.460838828982972, "learner_update_timer": 9.317873026717788, "synch_weights": 0.007320312274030405, "synch_env_connectors": 0.009092787316743881}, "env_runners": {"episode_return_mean": 0.964083333333336, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001253382678620415, "get_actions": 0.0007535798380530361, "un_batch_to_individual_items": 7.233195629388143e-05, "listify_data_for_vector_env": 0.0001431609581973622, "tensor_to_numpy": 0.00024547025723798766, "remove_single_ts_time_rank_from_batch": 8.632105003408945e-06}}, "connector_pipeline_timer": 0.0016758374116529163}, "episode_return_max": 1.2571111111111142, "num_episodes_lifetime": 1592, "episode_duration_sec_mean": 25.785495356817453, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017174433841827082, "add_time_dim_to_batch_and_zero_pad": 4.030932131660537e-05, "add_states_from_episodes_to_batch": 2.0362203034757436e-05, "batch_individual_items": 0.00010319829268918024, "add_observations_from_episodes_to_batch": 4.1461674736890894e-05}}, "connector_pipeline_timer": 0.0006358922540346233}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 344000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 344000}, "sample": 29.56171202304603, "num_env_steps_sampled_lifetime": 344000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6690000000000007, "agent_episode_returns_mean": {"default_agent": 0.964083333333336}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.964083333333336}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.10872912209543, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005889362871426656, "weights_seq_no": 171.0, "env_to_module_sum_episodes_length_in": 97.10872912209543, "env_step_timer": 0.11603933750986069, "time_between_sampling": 10.12145286437813, "num_env_steps_sampled_lifetime_throughput": 41.566177532374965}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 7.2701423914063365e-28, "mean_kl_loss": 0.003835889510810375, "weights_seq_no": 172.0, "vf_loss": 0.018404031172394753, "gradients_default_optimizer_global_norm": 0.46091216802597046, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 10420224, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.018404031172394753, "vf_explained_var": 0.09578394889831543, "entropy": 0.17726317048072815, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07965792715549469, "policy_loss": -0.0980619564652443}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08158382368735644, "add_time_dim_to_batch_and_zero_pad": 3.353252475864111e-05, "add_states_from_episodes_to_batch": 1.1309578262715841e-05, "general_advantage_estimation": 0.066957685118025, "batch_individual_items": 0.04893710727118865, "add_observations_from_episodes_to_batch": 0.0003736991048729878, "add_one_ts_to_episodes_and_truncate": 0.006894527862632865, "numpy_to_tensor": 0.0012309779263650743}}, "connector_pipeline_timer": 0.2065223040542625}, "num_env_steps_trained_lifetime": 164217328, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 10420224, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.611347253521, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 344000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 41.566177532374965, "done": false, "training_iteration": 172, "trial_id": "8cacd_00000", "date": "2025-05-12_04-10-55", "timestamp": 1746987055, "time_this_iter_s": 48.00536799430847, "time_total_s": 6713.37474322319, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6713.37474322319, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 80.59264705882353, "ram_util_percent": 51.908823529411784}}
{"timers": {"training_iteration": 39.7963403633767, "restore_env_runners": 3.0000608958205077e-05, "training_step": 39.795769154660206, "env_runner_sampling_timer": 30.46964437716313, "learner_update_timer": 9.317714294970603, "synch_weights": 0.007317833161255589, "synch_env_connectors": 0.009088806443594414}, "env_runners": {"episode_return_mean": 0.8620459401709426, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012497015575132982, "get_actions": 0.000752626427250389, "un_batch_to_individual_items": 7.169037002563588e-05, "listify_data_for_vector_env": 0.0001427799958442353, "tensor_to_numpy": 0.0002441839991859132, "remove_single_ts_time_rank_from_batch": 8.552226214343529e-06}}, "connector_pipeline_timer": 0.0016714746098261508}, "episode_return_max": 1.2181111111111147, "num_episodes_lifetime": 1600, "episode_duration_sec_mean": 25.12123033430743, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001718401074502665, "add_time_dim_to_batch_and_zero_pad": 4.002885769615723e-05, "add_states_from_episodes_to_batch": 2.0279825029846077e-05, "batch_individual_items": 0.00010329643594171909, "add_observations_from_episodes_to_batch": 4.142879825049346e-05}}, "connector_pipeline_timer": 0.0006355418947501073}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 346000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 346000}, "sample": 29.575521809732905, "num_env_steps_sampled_lifetime": 346000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6877777777777794, "agent_episode_returns_mean": {"default_agent": 0.8620459401709426}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8620459401709426}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.47500710768995, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005881322958131222, "weights_seq_no": 172.0, "env_to_module_sum_episodes_length_in": 96.47500710768995, "env_step_timer": 0.11640412674144417, "time_between_sampling": 10.123533373774272, "num_env_steps_sampled_lifetime_throughput": 49.103538668367534}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.6350711957031682e-28, "mean_kl_loss": 0.0028247188311070204, "weights_seq_no": 173.0, "vf_loss": 0.016426928341388702, "gradients_default_optimizer_global_norm": 0.5913017392158508, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10480768, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.016426928341388702, "vf_explained_var": 0.028949081897735596, "entropy": 0.2039441615343094, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.1332842856645584, "policy_loss": -0.1497112214565277}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08159763249975155, "add_time_dim_to_batch_and_zero_pad": 3.355456442875138e-05, "add_states_from_episodes_to_batch": 1.1313095972153601e-05, "general_advantage_estimation": 0.0665940003502374, "batch_individual_items": 0.048978883578476226, "add_observations_from_episodes_to_batch": 0.00037384727341085143, "add_one_ts_to_episodes_and_truncate": 0.0068891768377007685, "numpy_to_tensor": 0.0012314514789317662}}, "connector_pipeline_timer": 0.20620880169785796}, "num_env_steps_trained_lifetime": 165170896, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10480768, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.615341686076, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 346000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.103538668367534, "done": false, "training_iteration": 173, "trial_id": "8cacd_00000", "date": "2025-05-12_04-11-36", "timestamp": 1746987096, "time_this_iter_s": 40.66963028907776, "time_total_s": 6754.044373512268, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6754.044373512268, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 77.25172413793103, "ram_util_percent": 51.8551724137931}}
{"timers": {"training_iteration": 39.79265000112294, "restore_env_runners": 2.989260283903444e-05, "training_step": 39.79207980849361, "env_runner_sampling_timer": 30.466846937161513, "learner_update_timer": 9.316849118630893, "synch_weights": 0.0072920848296562975, "synch_env_connectors": 0.00907264038918958}, "env_runners": {"episode_return_mean": 0.8926324786324804, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012502145767802705, "get_actions": 0.0007528608861700232, "un_batch_to_individual_items": 7.147539993235407e-05, "listify_data_for_vector_env": 0.00014227505142426256, "tensor_to_numpy": 0.00024373609311026853, "remove_single_ts_time_rank_from_batch": 8.506560138573765e-06}}, "connector_pipeline_timer": 0.0016694408557618556}, "episode_return_max": 1.3362222222222255, "num_episodes_lifetime": 1608, "episode_duration_sec_mean": 23.234174888037614, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017038207018111508, "add_time_dim_to_batch_and_zero_pad": 3.995417312847699e-05, "add_states_from_episodes_to_batch": 2.0403996436035596e-05, "batch_individual_items": 0.00010362486265434602, "add_observations_from_episodes_to_batch": 4.1441904068095436e-05}}, "connector_pipeline_timer": 0.0006338581414845865}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 348000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 348000}, "sample": 29.58828809737638, "num_env_steps_sampled_lifetime": 348000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6877777777777794, "agent_episode_returns_mean": {"default_agent": 0.8926324786324804}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8926324786324804}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.51871680679325, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005872371987529937, "weights_seq_no": 173.0, "env_to_module_sum_episodes_length_in": 94.51871680679325, "env_step_timer": 0.11635001628907246, "time_between_sampling": 10.125829196958339, "num_env_steps_sampled_lifetime_throughput": 50.625635465822945}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.8175355978515841e-28, "mean_kl_loss": 0.004538796842098236, "weights_seq_no": 174.0, "vf_loss": 0.01409972831606865, "gradients_default_optimizer_global_norm": 0.20575830340385437, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10541312, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01409972831606865, "vf_explained_var": 0.026052892208099365, "entropy": 0.21012553572654724, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.026787949725985527, "policy_loss": 0.0126882279291749}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08161098770343025, "add_time_dim_to_batch_and_zero_pad": 3.357933005278978e-05, "add_states_from_episodes_to_batch": 1.131648236972029e-05, "general_advantage_estimation": 0.06623155907929366, "batch_individual_items": 0.04903685519889097, "add_observations_from_episodes_to_batch": 0.00037398605866739807, "add_one_ts_to_episodes_and_truncate": 0.006883797110481007, "numpy_to_tensor": 0.0012319079326547973}}, "connector_pipeline_timer": 0.2059122335180764}, "num_env_steps_trained_lifetime": 166124464, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10541312, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6191950952543, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 348000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.625635465822945, "done": false, "training_iteration": 174, "trial_id": "8cacd_00000", "date": "2025-05-12_04-12-16", "timestamp": 1746987136, "time_this_iter_s": 39.44352698326111, "time_total_s": 6793.487900495529, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6793.487900495529, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 79.10178571428571, "ram_util_percent": 51.85892857142858}}
{"timers": {"training_iteration": 39.787027415261704, "restore_env_runners": 2.979367680559167e-05, "training_step": 39.786458331558656, "env_runner_sampling_timer": 30.465388476139893, "learner_update_timer": 9.312701929244605, "synch_weights": 0.007277160981363259, "synch_env_connectors": 0.009053013985284155}, "env_runners": {"episode_return_mean": 0.8902510683760693, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012462158611322468, "get_actions": 0.0007494812514986564, "un_batch_to_individual_items": 7.10215757624567e-05, "listify_data_for_vector_env": 0.00014135462750982373, "tensor_to_numpy": 0.00024384126335220594, "remove_single_ts_time_rank_from_batch": 8.41724913386722e-06}}, "connector_pipeline_timer": 0.0016648076519467545}, "episode_return_max": 1.3362222222222255, "num_episodes_lifetime": 1616, "episode_duration_sec_mean": 22.94432411926874, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016963132323520862, "add_time_dim_to_batch_and_zero_pad": 3.970054607246713e-05, "add_states_from_episodes_to_batch": 2.0483557050682746e-05, "batch_individual_items": 0.0001029736110836647, "add_observations_from_episodes_to_batch": 4.230045142424194e-05}}, "connector_pipeline_timer": 0.0006310252297691044}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 350000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 350000}, "sample": 29.59966866157715, "num_env_steps_sampled_lifetime": 350000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.705111111111112, "agent_episode_returns_mean": {"default_agent": 0.8902510683760693}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8902510683760693}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.84656181441623, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005849506727504363, "weights_seq_no": 174.0, "env_to_module_sum_episodes_length_in": 92.84656181441623, "env_step_timer": 0.11583102796909753, "time_between_sampling": 10.127627878604386, "num_env_steps_sampled_lifetime_throughput": 50.8728567449933}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 9.087677989257921e-29, "mean_kl_loss": 0.002463326556608081, "weights_seq_no": 175.0, "vf_loss": 0.00835605151951313, "gradients_default_optimizer_global_norm": 0.21031947433948517, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10601856, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.00835605151951313, "vf_explained_var": 0.01719653606414795, "entropy": 0.16394028067588806, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.09052973240613937, "policy_loss": 0.0821736678481102}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08162411788978516, "add_time_dim_to_batch_and_zero_pad": 3.3606644907888366e-05, "add_states_from_episodes_to_batch": 1.131985972970473e-05, "general_advantage_estimation": 0.06587090683373388, "batch_individual_items": 0.04909324972843979, "add_observations_from_episodes_to_batch": 0.00037412072349159544, "add_one_ts_to_episodes_and_truncate": 0.006878395930122013, "numpy_to_tensor": 0.0012323423721554035}}, "connector_pipeline_timer": 0.2056156083216204}, "num_env_steps_trained_lifetime": 167078032, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10601856, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.622909902081, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 350000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.8728567449933, "done": false, "training_iteration": 175, "trial_id": "8cacd_00000", "date": "2025-05-12_04-12-55", "timestamp": 1746987175, "time_this_iter_s": 39.24894189834595, "time_total_s": 6832.736842393875, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6832.736842393875, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 78.80363636363636, "ram_util_percent": 51.87818181818182}}
{"timers": {"training_iteration": 39.79145713174911, "restore_env_runners": 2.9712740016410562e-05, "training_step": 39.790889025883075, "env_runner_sampling_timer": 30.468503056298502, "learner_update_timer": 9.314007339662155, "synch_weights": 0.007289440381541356, "synch_env_connectors": 0.009042076845440795}, "env_runners": {"episode_return_mean": 0.830138888888889, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001241491330961847, "get_actions": 0.0007504005552905589, "un_batch_to_individual_items": 7.107450914926873e-05, "listify_data_for_vector_env": 0.00014084066088940382, "tensor_to_numpy": 0.00024261150945522017, "remove_single_ts_time_rank_from_batch": 8.381809375993334e-06}}, "connector_pipeline_timer": 0.0016651311183017137}, "episode_return_max": 1.1542222222222236, "num_episodes_lifetime": 1624, "episode_duration_sec_mean": 23.08505111405898, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017024668289108513, "add_time_dim_to_batch_and_zero_pad": 3.957086655267016e-05, "add_states_from_episodes_to_batch": 2.0525531400621647e-05, "batch_individual_items": 0.00010285528714535406, "add_observations_from_episodes_to_batch": 4.2001132318710743e-05}}, "connector_pipeline_timer": 0.0006317511054225385}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 352000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 352000}, "sample": 29.610204779038767, "num_env_steps_sampled_lifetime": 352000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6792222222222228, "agent_episode_returns_mean": {"default_agent": 0.830138888888889}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.830138888888889}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.47716991030097, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005847180785832577, "weights_seq_no": 175.0, "env_to_module_sum_episodes_length_in": 92.47716991030097, "env_step_timer": 0.11525487293969677, "time_between_sampling": 10.129237856101842, "num_env_steps_sampled_lifetime_throughput": 49.61895807869828}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.5438389946289603e-29, "mean_kl_loss": 0.0037559298798441887, "weights_seq_no": 176.0, "vf_loss": 0.009181270375847816, "gradients_default_optimizer_global_norm": 0.41702282428741455, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10662400, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009181270375847816, "vf_explained_var": 0.14054018259048462, "entropy": 0.1884429156780243, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07915322482585907, "policy_loss": -0.08833449333906174}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08163676711364262, "add_time_dim_to_batch_and_zero_pad": 3.363308553303236e-05, "add_states_from_episodes_to_batch": 1.1323527894320369e-05, "general_advantage_estimation": 0.06551214245717753, "batch_individual_items": 0.049147862301878086, "add_observations_from_episodes_to_batch": 0.00037424688641351356, "add_one_ts_to_episodes_and_truncate": 0.006872964883659174, "numpy_to_tensor": 0.0012327983320726402}}, "connector_pipeline_timer": 0.2053185991157416}, "num_env_steps_trained_lifetime": 168031600, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10662400, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6264884932611, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 352000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.61895807869828, "done": false, "training_iteration": 176, "trial_id": "8cacd_00000", "date": "2025-05-12_04-13-35", "timestamp": 1746987215, "time_this_iter_s": 40.24773287773132, "time_total_s": 6872.984575271606, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6872.984575271606, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 76.66379310344827, "ram_util_percent": 51.9103448275862}}
{"timers": {"training_iteration": 39.79097093732164, "restore_env_runners": 2.966061262642814e-05, "training_step": 39.79040389051425, "env_runner_sampling_timer": 30.468689632165503, "learner_update_timer": 9.313308643725515, "synch_weights": 0.007316389977722607, "synch_env_connectors": 0.00905094608698912}, "env_runners": {"episode_return_mean": 0.8723012820512825, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012391357378342376, "get_actions": 0.000747944747168309, "un_batch_to_individual_items": 7.243779784787265e-05, "listify_data_for_vector_env": 0.00014010818075861742, "tensor_to_numpy": 0.00024164098277040894, "remove_single_ts_time_rank_from_batch": 8.263226093553756e-06}}, "connector_pipeline_timer": 0.0016618692409031146}, "episode_return_max": 1.2670000000000017, "num_episodes_lifetime": 1632, "episode_duration_sec_mean": 23.104611132462125, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016910207953915724, "add_time_dim_to_batch_and_zero_pad": 3.9109596913130463e-05, "add_states_from_episodes_to_batch": 2.043059569422128e-05, "batch_individual_items": 0.00010195350671239743, "add_observations_from_episodes_to_batch": 4.237874223201554e-05}}, "connector_pipeline_timer": 0.0006291200821729052}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 354000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 354000}, "sample": 29.619820865863765, "num_env_steps_sampled_lifetime": 354000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6792222222222228, "agent_episode_returns_mean": {"default_agent": 0.8723012820512825}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8723012820512825}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.98045010501482, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005816912856633949, "weights_seq_no": 176.0, "env_to_module_sum_episodes_length_in": 93.98045010501482, "env_step_timer": 0.11453283574419304, "time_between_sampling": 10.131016138294079, "num_env_steps_sampled_lifetime_throughput": 50.21854722432546}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.2719194973144801e-29, "mean_kl_loss": 0.0018548935186117887, "weights_seq_no": 177.0, "vf_loss": 0.008816847577691078, "gradients_default_optimizer_global_norm": 1.2486404180526733, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10722944, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008816847577691078, "vf_explained_var": 0.1219061017036438, "entropy": 0.1841678023338318, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.12869282066822052, "policy_loss": -0.13750967383384705}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08164907963133419, "add_time_dim_to_batch_and_zero_pad": 3.36585066812084e-05, "add_states_from_episodes_to_batch": 1.1327030709586243e-05, "general_advantage_estimation": 0.06515472210746891, "batch_individual_items": 0.049200833818874815, "add_observations_from_episodes_to_batch": 0.0003743646140047579, "add_one_ts_to_episodes_and_truncate": 0.006867502788532763, "numpy_to_tensor": 0.0012332491485541627}}, "connector_pipeline_timer": 0.20502091577324846}, "num_env_steps_trained_lifetime": 168985168, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10722944, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6299332216277, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 354000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.21854722432546, "done": false, "training_iteration": 177, "trial_id": "8cacd_00000", "date": "2025-05-12_04-14-15", "timestamp": 1746987255, "time_this_iter_s": 39.76988387107849, "time_total_s": 6912.754459142685, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6912.754459142685, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 78.78928571428573, "ram_util_percent": 51.91249999999999}}
{"timers": {"training_iteration": 39.822158675178436, "restore_env_runners": 2.95970064917312e-05, "training_step": 39.82159042283907, "env_runner_sampling_timer": 30.498042941673873, "learner_update_timer": 9.315157234678248, "synch_weights": 0.0073014920879643785, "synch_env_connectors": 0.009084911626130671}, "env_runners": {"episode_return_mean": 0.8643450854700873, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012394297704244935, "get_actions": 0.0007493845056006042, "un_batch_to_individual_items": 7.244227638789618e-05, "listify_data_for_vector_env": 0.0001401038565009972, "tensor_to_numpy": 0.00024150675860584687, "remove_single_ts_time_rank_from_batch": 8.28887978477791e-06}}, "connector_pipeline_timer": 0.0016627364702417394}, "episode_return_max": 1.1418888888888918, "num_episodes_lifetime": 1648, "episode_duration_sec_mean": 23.19959976882613, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016856346816557423, "add_time_dim_to_batch_and_zero_pad": 3.9367058939511804e-05, "add_states_from_episodes_to_batch": 2.1115146455128925e-05, "batch_individual_items": 0.00010160233480705276, "add_observations_from_episodes_to_batch": 4.242424760765262e-05}}, "connector_pipeline_timer": 0.0006285866288053885}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 356000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 356000}, "sample": 29.6308504274945, "num_env_steps_sampled_lifetime": 356000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6333333333333337, "agent_episode_returns_mean": {"default_agent": 0.8643450854700873}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.8643450854700873}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.87534134882388, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005805739144818514, "weights_seq_no": 177.0, "env_to_module_sum_episodes_length_in": 96.87534134882388, "env_step_timer": 0.11580625820771911, "time_between_sampling": 10.132726215719275, "num_env_steps_sampled_lifetime_throughput": 46.50620050034827}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.407879170740082e-29, "mean_kl_loss": 0.02133900858461857, "weights_seq_no": 178.0, "vf_loss": 0.016157420352101326, "gradients_default_optimizer_global_norm": 0.2572175860404968, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 10783744, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.016157420352101326, "vf_explained_var": 0.04132348299026489, "entropy": 0.23697353899478912, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.018212255090475082, "policy_loss": 0.002054838929325342}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08166176125196058, "add_time_dim_to_batch_and_zero_pad": 3.3683056097791826e-05, "add_states_from_episodes_to_batch": 1.1330471115706742e-05, "general_advantage_estimation": 0.0647986975106089, "batch_individual_items": 0.049252627019301734, "add_observations_from_episodes_to_batch": 0.00037449325235552514, "add_one_ts_to_episodes_and_truncate": 0.006862187398820744, "numpy_to_tensor": 0.0012336788188726407}}, "connector_pipeline_timer": 0.20472394689779363}, "num_env_steps_trained_lifetime": 169946568, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 10783744, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6340464065775, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 356000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.50620050034827, "done": false, "training_iteration": 178, "trial_id": "8cacd_00000", "date": "2025-05-12_04-14-58", "timestamp": 1746987298, "time_this_iter_s": 42.928707122802734, "time_total_s": 6955.683166265488, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6955.683166265488, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 78.98032786885243, "ram_util_percent": 51.90819672131149}}
{"timers": {"training_iteration": 39.81132553411663, "restore_env_runners": 2.9592036423464384e-05, "training_step": 39.81075655630068, "env_runner_sampling_timer": 30.493788221337134, "learner_update_timer": 9.308604421941453, "synch_weights": 0.007275885167075999, "synch_env_connectors": 0.009077041519872693}, "env_runners": {"episode_return_mean": 0.9465256410256438, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012507600525543626, "get_actions": 0.0007497017951198293, "un_batch_to_individual_items": 7.229689655877794e-05, "listify_data_for_vector_env": 0.0001415076910005924, "tensor_to_numpy": 0.00024000802748735101, "remove_single_ts_time_rank_from_batch": 8.307006669129176e-06}}, "connector_pipeline_timer": 0.001664566142577223}, "episode_return_max": 1.1418888888888918, "num_episodes_lifetime": 1656, "episode_duration_sec_mean": 23.06846780747058, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016904498332133978, "add_time_dim_to_batch_and_zero_pad": 3.9491023620848785e-05, "add_states_from_episodes_to_batch": 2.0975739241210924e-05, "batch_individual_items": 0.00010062398150336482, "add_observations_from_episodes_to_batch": 4.195450687601141e-05}}, "connector_pipeline_timer": 0.0006260406238097071}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 358000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 358000}, "sample": 29.64062919367844, "num_env_steps_sampled_lifetime": 358000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6380000000000015, "agent_episode_returns_mean": {"default_agent": 0.9465256410256438}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9465256410256438}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.22671841749711, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005781237589629118, "weights_seq_no": 178.0, "env_to_module_sum_episodes_length_in": 97.22671841749711, "env_step_timer": 0.11621882194904566, "time_between_sampling": 10.13454675661647, "num_env_steps_sampled_lifetime_throughput": 51.5210849740798}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.703939585370041e-29, "mean_kl_loss": 0.001986542483791709, "weights_seq_no": 179.0, "vf_loss": 0.018448449671268463, "gradients_default_optimizer_global_norm": 0.5425909161567688, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10844288, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.018448449671268463, "vf_explained_var": 0.03175157308578491, "entropy": 0.17710888385772705, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.10004206001758575, "policy_loss": -0.11849050223827362}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0816740514917114, "add_time_dim_to_batch_and_zero_pad": 3.370618867503735e-05, "add_states_from_episodes_to_batch": 1.1333720010684756e-05, "general_advantage_estimation": 0.06444404239347519, "batch_individual_items": 0.04930270395203805, "add_observations_from_episodes_to_batch": 0.00037461520147766053, "add_one_ts_to_episodes_and_truncate": 0.006856806516624183, "numpy_to_tensor": 0.001234083180869678}}, "connector_pipeline_timer": 0.20442613759747066}, "num_env_steps_trained_lifetime": 170900136, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10844288, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6380143345061, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 358000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.5210849740798, "done": false, "training_iteration": 179, "trial_id": "8cacd_00000", "date": "2025-05-12_04-15-37", "timestamp": 1746987337, "time_this_iter_s": 38.75600504875183, "time_total_s": 6994.4391713142395, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6994.4391713142395, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 79.05999999999999, "ram_util_percent": 51.8709090909091}}
{"timers": {"training_iteration": 39.814320477375475, "restore_env_runners": 2.9491116052484638e-05, "training_step": 39.81375240833766, "env_runner_sampling_timer": 30.48868229557376, "learner_update_timer": 9.316728381872018, "synch_weights": 0.007254840315406323, "synch_env_connectors": 0.009061901104666054}, "env_runners": {"episode_return_mean": 0.8736452991453011, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001242603543417532, "get_actions": 0.0007498392649542715, "un_batch_to_individual_items": 7.195149765419334e-05, "listify_data_for_vector_env": 0.00014081154780843256, "tensor_to_numpy": 0.0002410548014194049, "remove_single_ts_time_rank_from_batch": 8.268454903839969e-06}}, "connector_pipeline_timer": 0.0016640012145566396}, "episode_return_max": 1.1316666666666697, "num_episodes_lifetime": 1664, "episode_duration_sec_mean": 22.946174426970174, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016933945088216368, "add_time_dim_to_batch_and_zero_pad": 3.9875799727675786e-05, "add_states_from_episodes_to_batch": 2.0922487518701045e-05, "batch_individual_items": 9.9991077760319e-05, "add_observations_from_episodes_to_batch": 4.209658947308639e-05}}, "connector_pipeline_timer": 0.0006265760331651993}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 360000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 360000}, "sample": 29.64936386630286, "num_env_steps_sampled_lifetime": 360000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7052222222222236, "agent_episode_returns_mean": {"default_agent": 0.8736452991453011}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8736452991453011}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.51181916528431, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005770735675171824, "weights_seq_no": 179.0, "env_to_module_sum_episodes_length_in": 95.51181916528431, "env_step_timer": 0.1162025437718603, "time_between_sampling": 10.13577271230057, "num_env_steps_sampled_lifetime_throughput": 49.76448316257239}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 8.519697926850204e-30, "mean_kl_loss": 0.0035672769881784916, "weights_seq_no": 180.0, "vf_loss": 0.009452907368540764, "gradients_default_optimizer_global_norm": 0.5073397159576416, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10904832, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009452907368540764, "vf_explained_var": 0.029175639152526855, "entropy": 0.20080873370170593, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.04021966829895973, "policy_loss": 0.03076675720512867}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08168605989054216, "add_time_dim_to_batch_and_zero_pad": 3.372815029537384e-05, "add_states_from_episodes_to_batch": 1.1336950880541794e-05, "general_advantage_estimation": 0.06409133534893308, "batch_individual_items": 0.049351289253417564, "add_observations_from_episodes_to_batch": 0.00037473054229196083, "add_one_ts_to_episodes_and_truncate": 0.006851362653331749, "numpy_to_tensor": 0.001234454197745068}}, "connector_pipeline_timer": 0.20412839545846442}, "num_env_steps_trained_lifetime": 171853704, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10904832, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6418394992356, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 360000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.76448316257239, "done": false, "training_iteration": 180, "trial_id": "8cacd_00000", "date": "2025-05-12_04-16-17", "timestamp": 1746987377, "time_this_iter_s": 40.12807583808899, "time_total_s": 7034.5672471523285, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7034.5672471523285, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 77.04736842105264, "ram_util_percent": 51.901754385964914}}
{"timers": {"training_iteration": 39.81572865721174, "restore_env_runners": 2.9408204869141925e-05, "training_step": 39.815160861864285, "env_runner_sampling_timer": 30.489118320568032, "learner_update_timer": 9.317682450713301, "synch_weights": 0.007274058912228504, "synch_env_connectors": 0.0090586730935985}, "env_runners": {"episode_return_mean": 0.8510844017094029, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012433842185726943, "get_actions": 0.0007501045774615811, "un_batch_to_individual_items": 7.201756840138896e-05, "listify_data_for_vector_env": 0.00014049037286120646, "tensor_to_numpy": 0.00024078188662330925, "remove_single_ts_time_rank_from_batch": 8.171399451299542e-06}}, "connector_pipeline_timer": 0.001662450758711465}, "episode_return_max": 1.1316666666666697, "num_episodes_lifetime": 1672, "episode_duration_sec_mean": 22.999567476249187, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001693389027034963, "add_time_dim_to_batch_and_zero_pad": 3.965109353265385e-05, "add_states_from_episodes_to_batch": 2.068158763332868e-05, "batch_individual_items": 0.0001005140234219281, "add_observations_from_episodes_to_batch": 4.2377406119734885e-05}}, "connector_pipeline_timer": 0.0006274067641763967}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 362000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 362000}, "sample": 29.65759470123218, "num_env_steps_sampled_lifetime": 362000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7052222222222236, "agent_episode_returns_mean": {"default_agent": 0.8510844017094029}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8510844017094029}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.5744661514454, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005769049416827456, "weights_seq_no": 180.0, "env_to_module_sum_episodes_length_in": 93.5744661514454, "env_step_timer": 0.11596801292671971, "time_between_sampling": 10.137498077204016, "num_env_steps_sampled_lifetime_throughput": 49.81951862933696}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.259848963425102e-30, "mean_kl_loss": 0.0025177879724651575, "weights_seq_no": 181.0, "vf_loss": 0.008230871520936489, "gradients_default_optimizer_global_norm": 0.4067949950695038, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10965376, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.008230871520936489, "vf_explained_var": 0.09618580341339111, "entropy": 0.2195453941822052, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03936828672885895, "policy_loss": -0.04759916663169861}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08169757450624715, "add_time_dim_to_batch_and_zero_pad": 3.375331206433541e-05, "add_states_from_episodes_to_batch": 1.1340123760949995e-05, "general_advantage_estimation": 0.06374015201104243, "batch_individual_items": 0.04939828639827448, "add_observations_from_episodes_to_batch": 0.00037483876476960285, "add_one_ts_to_episodes_and_truncate": 0.00684594940665337, "numpy_to_tensor": 0.0012348085959650377}}, "connector_pipeline_timer": 0.20383011686837887}, "num_env_steps_trained_lifetime": 172807272, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 10965376, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.645524359237, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 362000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.81951862933696, "done": false, "training_iteration": 181, "trial_id": "8cacd_00000", "date": "2025-05-12_04-16-57", "timestamp": 1746987417, "time_this_iter_s": 39.97303748130798, "time_total_s": 7074.5402846336365, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7074.5402846336365, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 78.23157894736842, "ram_util_percent": 51.898245614035076}}
{"timers": {"training_iteration": 39.825388915189606, "restore_env_runners": 2.9327122841626918e-05, "training_step": 39.82481942579566, "env_runner_sampling_timer": 30.491544614992375, "learner_update_timer": 9.32491225912619, "synch_weights": 0.007271551323112047, "synch_env_connectors": 0.00906456736266301}, "env_runners": {"episode_return_mean": 1.0068279914529923, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012441362182110438, "get_actions": 0.0007483956940426207, "un_batch_to_individual_items": 7.229718055687964e-05, "listify_data_for_vector_env": 0.00014145405332094006, "tensor_to_numpy": 0.00024056074401225555, "remove_single_ts_time_rank_from_batch": 8.23256876518308e-06}}, "connector_pipeline_timer": 0.0016610402177450261}, "episode_return_max": 1.3386666666666684, "num_episodes_lifetime": 1680, "episode_duration_sec_mean": 23.09127202366349, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016891003549887235, "add_time_dim_to_batch_and_zero_pad": 3.944677453992032e-05, "add_states_from_episodes_to_batch": 2.0475882226402012e-05, "batch_individual_items": 0.00010012690161986874, "add_observations_from_episodes_to_batch": 4.209754001651135e-05}}, "connector_pipeline_timer": 0.0006259067963443164}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 364000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 364000}, "sample": 29.665215118041168, "num_env_steps_sampled_lifetime": 364000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7117777777777777, "agent_episode_returns_mean": {"default_agent": 1.0068279914529923}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0068279914529923}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.64203731063374, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005794227562512675, "weights_seq_no": 181.0, "env_to_module_sum_episodes_length_in": 92.64203731063374, "env_step_timer": 0.11542066672725801, "time_between_sampling": 10.139012189183054, "num_env_steps_sampled_lifetime_throughput": 48.94612524724042}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.129924481712551e-30, "mean_kl_loss": 0.002411097753793001, "weights_seq_no": 182.0, "vf_loss": 0.01012222096323967, "gradients_default_optimizer_global_norm": 0.9497869610786438, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11025920, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01012222096323967, "vf_explained_var": 0.1411188244819641, "entropy": 0.19411177933216095, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.023527709767222404, "policy_loss": -0.03364991769194603}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08170937400364914, "add_time_dim_to_batch_and_zero_pad": 3.378776778276288e-05, "add_states_from_episodes_to_batch": 1.1344329488907595e-05, "general_advantage_estimation": 0.06339033508637443, "batch_individual_items": 0.049443638651308935, "add_observations_from_episodes_to_batch": 0.0003749637497436387, "add_one_ts_to_episodes_and_truncate": 0.006840571778643138, "numpy_to_tensor": 0.001235153070800628}}, "connector_pipeline_timer": 0.2035319155805493}, "num_env_steps_trained_lifetime": 173760840, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11025920, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6490713380886, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 364000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.94612524724042, "done": false, "training_iteration": 182, "trial_id": "8cacd_00000", "date": "2025-05-12_04-17-38", "timestamp": 1746987458, "time_this_iter_s": 40.799477338790894, "time_total_s": 7115.339761972427, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7115.339761972427, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 76.80172413793102, "ram_util_percent": 51.91896551724138}}
{"timers": {"training_iteration": 39.8383414916677, "restore_env_runners": 2.924785160562177e-05, "training_step": 39.8377728161677, "env_runner_sampling_timer": 30.504466035532428, "learner_update_timer": 9.324902776474895, "synch_weights": 0.0073152188099032504, "synch_env_connectors": 0.00905340668906023}, "env_runners": {"episode_return_mean": 0.9334861111111117, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012579469591021854, "get_actions": 0.0007531568693967997, "un_batch_to_individual_items": 7.199384156692014e-05, "listify_data_for_vector_env": 0.00014227843648088678, "tensor_to_numpy": 0.00024108842263648856, "remove_single_ts_time_rank_from_batch": 9.078573816636507e-06}}, "connector_pipeline_timer": 0.0016695126842790021}, "episode_return_max": 1.3386666666666684, "num_episodes_lifetime": 1688, "episode_duration_sec_mean": 22.904267879009485, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000169835560652929, "add_time_dim_to_batch_and_zero_pad": 3.8987374556008365e-05, "add_states_from_episodes_to_batch": 2.0423523151565112e-05, "batch_individual_items": 0.00010050957688575849, "add_observations_from_episodes_to_batch": 4.373074342550044e-05}}, "connector_pipeline_timer": 0.0006301904486080247}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 366000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 366000}, "sample": 29.673056582426184, "num_env_steps_sampled_lifetime": 366000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7230000000000001, "agent_episode_returns_mean": {"default_agent": 0.9334861111111117}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9334861111111117}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.42280736507733, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005839935132217911, "weights_seq_no": 182.0, "env_to_module_sum_episodes_length_in": 93.42280736507733, "env_step_timer": 0.1154940173324975, "time_between_sampling": 10.141119079736077, "num_env_steps_sampled_lifetime_throughput": 48.54172495577544}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.0649622408562756e-30, "mean_kl_loss": 0.001306232064962387, "weights_seq_no": 183.0, "vf_loss": 0.0119305569678545, "gradients_default_optimizer_global_norm": 0.7115288972854614, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11086464, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.0119305569678545, "vf_explained_var": 0.11071676015853882, "entropy": 0.16609308123588562, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.006223417818546295, "policy_loss": -0.005707135424017906}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08172075843365224, "add_time_dim_to_batch_and_zero_pad": 3.382275905535364e-05, "add_states_from_episodes_to_batch": 1.134843709009083e-05, "general_advantage_estimation": 0.06304239736499875, "batch_individual_items": 0.04948747849064275, "add_observations_from_episodes_to_batch": 0.0003750815111416024, "add_one_ts_to_episodes_and_truncate": 0.006835166108252401, "numpy_to_tensor": 0.001235472705279838}}, "connector_pipeline_timer": 0.2032336058167895}, "num_env_steps_trained_lifetime": 174714408, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11086464, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6524828249271, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 366000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.54172495577544, "done": false, "training_iteration": 183, "trial_id": "8cacd_00000", "date": "2025-05-12_04-18-19", "timestamp": 1746987499, "time_this_iter_s": 41.13669228553772, "time_total_s": 7156.476454257965, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7156.476454257965, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 77.76949152542372, "ram_util_percent": 51.932203389830505}}
{"timers": {"training_iteration": 39.838662708971015, "restore_env_runners": 2.9165373087898486e-05, "training_step": 39.838094746226055, "env_runner_sampling_timer": 30.50731560736711, "learner_update_timer": 9.322330010740139, "synch_weights": 0.007362129621799061, "synch_env_connectors": 0.00904769062220173}, "env_runners": {"episode_return_mean": 0.9227756410256417, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001253430971967905, "get_actions": 0.0007526244881805403, "un_batch_to_individual_items": 7.188452018936571e-05, "listify_data_for_vector_env": 0.00014138532554381386, "tensor_to_numpy": 0.00024107522799685706, "remove_single_ts_time_rank_from_batch": 9.069916972613964e-06}}, "connector_pipeline_timer": 0.001667953748615333}, "episode_return_max": 1.3282222222222249, "num_episodes_lifetime": 1696, "episode_duration_sec_mean": 23.717205911952323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017087707319946596, "add_time_dim_to_batch_and_zero_pad": 3.878680611542592e-05, "add_states_from_episodes_to_batch": 2.0399513824569158e-05, "batch_individual_items": 0.00010102743815647054, "add_observations_from_episodes_to_batch": 4.403682625701453e-05}}, "connector_pipeline_timer": 0.0006314267991141505}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 368000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 368000}, "sample": 29.680506648584313, "num_env_steps_sampled_lifetime": 368000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.731444444444445, "agent_episode_returns_mean": {"default_agent": 0.9227756410256417}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9227756410256417}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.28356918381145, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005844623564919336, "weights_seq_no": 183.0, "env_to_module_sum_episodes_length_in": 96.28356918381145, "env_step_timer": 0.11474172835380587, "time_between_sampling": 10.143239921820427, "num_env_steps_sampled_lifetime_throughput": 50.061261941156765}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.0649622408562756e-30, "mean_kl_loss": 0.006933772005140781, "weights_seq_no": 184.0, "vf_loss": 0.014299115166068077, "gradients_default_optimizer_global_norm": 0.8782089948654175, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11147008, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014299115166068077, "vf_explained_var": 0.05410283803939819, "entropy": 0.22918449342250824, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0037810516078025103, "policy_loss": -0.010518066585063934}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0817321432775551, "add_time_dim_to_batch_and_zero_pad": 3.385685172591774e-05, "add_states_from_episodes_to_batch": 1.1352398106081665e-05, "general_advantage_estimation": 0.06269581101454227, "batch_individual_items": 0.04952990177922469, "add_observations_from_episodes_to_batch": 0.00037519438093653506, "add_one_ts_to_episodes_and_truncate": 0.0068299104440914474, "numpy_to_tensor": 0.0012358478917623042}}, "connector_pipeline_timer": 0.20293543921654686}, "num_env_steps_trained_lifetime": 175667976, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11147008, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6557611748951, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 368000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.061261941156765, "done": false, "training_iteration": 184, "trial_id": "8cacd_00000", "date": "2025-05-12_04-18-59", "timestamp": 1746987539, "time_this_iter_s": 39.89006018638611, "time_total_s": 7196.366514444351, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7196.366514444351, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 79.29642857142858, "ram_util_percent": 51.941071428571426}}
{"timers": {"training_iteration": 39.864632151901304, "restore_env_runners": 2.9091719343508804e-05, "training_step": 39.86406450178379, "env_runner_sampling_timer": 30.53596939052344, "learner_update_timer": 9.319619251422742, "synch_weights": 0.0073881953255827935, "synch_env_connectors": 0.009065916705980606}, "env_runners": {"episode_return_mean": 0.9401613247863273, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001251392333978979, "get_actions": 0.0007515374968102686, "un_batch_to_individual_items": 7.165567090941726e-05, "listify_data_for_vector_env": 0.00014052890880985664, "tensor_to_numpy": 0.00023980384863821322, "remove_single_ts_time_rank_from_batch": 8.945757583666339e-06}}, "connector_pipeline_timer": 0.001663711115570085}, "episode_return_max": 1.270222222222226, "num_episodes_lifetime": 1712, "episode_duration_sec_mean": 23.28939293816323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017163052608767202, "add_time_dim_to_batch_and_zero_pad": 3.924405152405576e-05, "add_states_from_episodes_to_batch": 2.0239819117997345e-05, "batch_individual_items": 0.0001009526536516648, "add_observations_from_episodes_to_batch": 4.4241713422962625e-05}}, "connector_pipeline_timer": 0.0006332145675922046}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 370000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 370000}, "sample": 29.689609851226884, "num_env_steps_sampled_lifetime": 370000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6707777777777794, "agent_episode_returns_mean": {"default_agent": 0.9401613247863273}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9401613247863273}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.45388289112411, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.000583875733979585, "weights_seq_no": 184.0, "env_to_module_sum_episodes_length_in": 97.45388289112411, "env_step_timer": 0.1155749110932991, "time_between_sampling": 10.145003267083501, "num_env_steps_sampled_lifetime_throughput": 47.02943964507277}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.324811204281378e-31, "mean_kl_loss": 0.0034676804207265377, "weights_seq_no": 185.0, "vf_loss": 0.02016114629805088, "gradients_default_optimizer_global_norm": 1.069767951965332, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 11207808, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.02016114629805088, "vf_explained_var": 0.022138535976409912, "entropy": 0.14536885917186737, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.01729363389313221, "policy_loss": -0.0374547615647316}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08174820490873644, "add_time_dim_to_batch_and_zero_pad": 3.388955026712304e-05, "add_states_from_episodes_to_batch": 1.1356255058128412e-05, "general_advantage_estimation": 0.06235094614135835, "batch_individual_items": 0.049571449534086084, "add_observations_from_episodes_to_batch": 0.00037535223518440577, "add_one_ts_to_episodes_and_truncate": 0.006824912216602742, "numpy_to_tensor": 0.0012361937572446897}}, "connector_pipeline_timer": 0.20264307382762736}, "num_env_steps_trained_lifetime": 176629376, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 11207808, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6597087095813, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 370000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.02943964507277, "done": false, "training_iteration": 185, "trial_id": "8cacd_00000", "date": "2025-05-12_04-19-42", "timestamp": 1746987582, "time_this_iter_s": 42.4527223110199, "time_total_s": 7238.819236755371, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7238.819236755371, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 79.38196721311478, "ram_util_percent": 51.959016393442624}}
{"timers": {"training_iteration": 39.874075648922286, "restore_env_runners": 2.91198021416513e-05, "training_step": 39.87350699530597, "env_runner_sampling_timer": 30.534384582738216, "learner_update_timer": 9.330638329338509, "synch_weights": 0.0073931553623251475, "synch_env_connectors": 0.009072895538927353}, "env_runners": {"episode_return_mean": 0.922061965811968, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001256820083611056, "get_actions": 0.0007520441579824855, "un_batch_to_individual_items": 7.112196370071791e-05, "listify_data_for_vector_env": 0.00014014785541421285, "tensor_to_numpy": 0.00023981831535827464, "remove_single_ts_time_rank_from_batch": 9.20094334808218e-06}}, "connector_pipeline_timer": 0.0016635174646746757}, "episode_return_max": 1.2292222222222255, "num_episodes_lifetime": 1720, "episode_duration_sec_mean": 23.145959342749812, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001714541271019151, "add_time_dim_to_batch_and_zero_pad": 3.9366214278329674e-05, "add_states_from_episodes_to_batch": 2.0220420213377135e-05, "batch_individual_items": 0.00010149097617625399, "add_observations_from_episodes_to_batch": 4.369200764891777e-05}}, "connector_pipeline_timer": 0.0006309955757882655}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 372000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 372000}, "sample": 29.697860767906608, "num_env_steps_sampled_lifetime": 372000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.6707777777777794, "agent_episode_returns_mean": {"default_agent": 0.922061965811968}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.922061965811968}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.20966432786481, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005833607331175041, "weights_seq_no": 185.0, "env_to_module_sum_episodes_length_in": 96.20966432786481, "env_step_timer": 0.11580190356491764, "time_between_sampling": 10.146406433207979, "num_env_steps_sampled_lifetime_throughput": 48.8986880344908}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.662405602140689e-31, "mean_kl_loss": 0.004096178337931633, "weights_seq_no": 186.0, "vf_loss": 0.013846521265804768, "gradients_default_optimizer_global_norm": 0.20304597914218903, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11268352, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013846521265804768, "vf_explained_var": 0.09338200092315674, "entropy": 0.20466411113739014, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08491804450750351, "policy_loss": 0.07107152044773102}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08176403861296634, "add_time_dim_to_batch_and_zero_pad": 3.392106915264501e-05, "add_states_from_episodes_to_batch": 1.1359959631027627e-05, "general_advantage_estimation": 0.06200783462453676, "batch_individual_items": 0.049626841033572476, "add_observations_from_episodes_to_batch": 0.0003755155729089179, "add_one_ts_to_episodes_and_truncate": 0.006820004392619498, "numpy_to_tensor": 0.0012365124306283736}}, "connector_pipeline_timer": 0.20236614910246478}, "num_env_steps_trained_lifetime": 177582944, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11268352, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6635117174562, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 372000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.8986880344908, "done": false, "training_iteration": 186, "trial_id": "8cacd_00000", "date": "2025-05-12_04-20-23", "timestamp": 1746987623, "time_this_iter_s": 40.834736585617065, "time_total_s": 7279.653973340988, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7279.653973340988, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 76.32931034482758, "ram_util_percent": 51.95862068965518}}
{"timers": {"training_iteration": 40.003672756863054, "restore_env_runners": 2.905760411772394e-05, "training_step": 40.00310466978292, "env_runner_sampling_timer": 30.61204453642084, "learner_update_timer": 9.38251205495515, "synch_weights": 0.007457864818718623, "synch_env_connectors": 0.009159590573527701}, "env_runners": {"episode_return_mean": 0.8628333333333347, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012868653886450958, "get_actions": 0.0007633626052300735, "un_batch_to_individual_items": 7.176499580765931e-05, "listify_data_for_vector_env": 0.000141257294476079, "tensor_to_numpy": 0.00024326712792065419, "remove_single_ts_time_rank_from_batch": 9.04341271017213e-06}}, "connector_pipeline_timer": 0.0016854452960079114}, "episode_return_max": 1.2292222222222255, "num_episodes_lifetime": 1728, "episode_duration_sec_mean": 23.92727191447994, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017423172745799858, "add_time_dim_to_batch_and_zero_pad": 4.052412077640617e-05, "add_states_from_episodes_to_batch": 2.0576254778612623e-05, "batch_individual_items": 0.00010326960601975089, "add_observations_from_episodes_to_batch": 4.4779900480423455e-05}}, "connector_pipeline_timer": 0.0006427897741236537}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 374000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 374000}, "sample": 29.70925345335304, "num_env_steps_sampled_lifetime": 374000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.671444444444445, "agent_episode_returns_mean": {"default_agent": 0.8628333333333347}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8628333333333347}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.17720255058771, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0005941780949724395, "weights_seq_no": 186.0, "env_to_module_sum_episodes_length_in": 94.17720255058771, "env_step_timer": 0.11750294097496589, "time_between_sampling": 10.148570200147237, "num_env_steps_sampled_lifetime_throughput": 37.792648240885896}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.3312028010703444e-31, "mean_kl_loss": 0.002319584833458066, "weights_seq_no": 187.0, "vf_loss": 0.009283027611672878, "gradients_default_optimizer_global_norm": 0.6021977066993713, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11328896, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.009283027611672878, "vf_explained_var": 0.09914374351501465, "entropy": 0.17276138067245483, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07979073375463486, "policy_loss": -0.0890737771987915}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08178074147282074, "add_time_dim_to_batch_and_zero_pad": 3.396106870529595e-05, "add_states_from_episodes_to_batch": 1.136409448671789e-05, "general_advantage_estimation": 0.06166607196343746, "batch_individual_items": 0.0496810054982157, "add_observations_from_episodes_to_batch": 0.00037567185865556923, "add_one_ts_to_episodes_and_truncate": 0.0068150909338944455, "numpy_to_tensor": 0.0012369734011687258}}, "connector_pipeline_timer": 0.20209039097472248}, "num_env_steps_trained_lifetime": 178536512, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11328896, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6671726943027, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 374000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 37.792648240885896, "done": false, "training_iteration": 187, "trial_id": "8cacd_00000", "date": "2025-05-12_04-21-16", "timestamp": 1746987676, "time_this_iter_s": 52.851975440979004, "time_total_s": 7332.505948781967, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7332.505948781967, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 70.50000000000001, "ram_util_percent": 51.919999999999995}}
{"timers": {"training_iteration": 40.08914593857443, "restore_env_runners": 2.9110028068973186e-05, "training_step": 40.088575801365096, "env_runner_sampling_timer": 30.681787059616628, "learner_update_timer": 9.398225632125616, "synch_weights": 0.00745304217050675, "synch_env_connectors": 0.009160175667792408}, "env_runners": {"episode_return_mean": 0.8582115384615392, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001296677864284914, "get_actions": 0.0007724970511526495, "un_batch_to_individual_items": 7.223335340318021e-05, "listify_data_for_vector_env": 0.00014302996733667786, "tensor_to_numpy": 0.00024589268216968933, "remove_single_ts_time_rank_from_batch": 1.0361194784604949e-05}}, "connector_pipeline_timer": 0.0017059269391723937}, "episode_return_max": 1.1570000000000027, "num_episodes_lifetime": 1736, "episode_duration_sec_mean": 26.77540731668254, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017773009025416522, "add_time_dim_to_batch_and_zero_pad": 4.1153062584875634e-05, "add_states_from_episodes_to_batch": 2.1581261815175072e-05, "batch_individual_items": 0.00010409503056962199, "add_observations_from_episodes_to_batch": 4.507578759744665e-05}}, "connector_pipeline_timer": 0.0006526584713963515}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 376000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 376000}, "sample": 29.72466995648068, "num_env_steps_sampled_lifetime": 376000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.671444444444445, "agent_episode_returns_mean": {"default_agent": 0.8582115384615392}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.8582115384615392}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.78783863897253, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006002721336938834, "weights_seq_no": 187.0, "env_to_module_sum_episodes_length_in": 92.78783863897253, "env_step_timer": 0.11876606074282603, "time_between_sampling": 10.156831222734835, "num_env_steps_sampled_lifetime_throughput": 41.09300098305231}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.656014005351722e-32, "mean_kl_loss": 0.0017299620667472482, "weights_seq_no": 188.0, "vf_loss": 0.00959494337439537, "gradients_default_optimizer_global_norm": 0.40038707852363586, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11389440, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.00959494337439537, "vf_explained_var": 0.07687830924987793, "entropy": 0.17420370876789093, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.03971752151846886, "policy_loss": 0.030122576281428337}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08179742686081677, "add_time_dim_to_batch_and_zero_pad": 3.399966616012277e-05, "add_states_from_episodes_to_batch": 1.1368060649322909e-05, "general_advantage_estimation": 0.06132605157199796, "batch_individual_items": 0.04973380817896274, "add_observations_from_episodes_to_batch": 0.0003758359970298649, "add_one_ts_to_episodes_and_truncate": 0.0068102891739049015, "numpy_to_tensor": 0.001237409441054933}}, "connector_pipeline_timer": 0.2018150946931248}, "num_env_steps_trained_lifetime": 179490080, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11389440, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6706941004404, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 376000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 41.09300098305231, "done": false, "training_iteration": 188, "trial_id": "8cacd_00000", "date": "2025-05-12_04-22-04", "timestamp": 1746987724, "time_this_iter_s": 48.573909282684326, "time_total_s": 7381.0798580646515, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7381.0798580646515, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 78.17246376811593, "ram_util_percent": 51.9695652173913}}
{"timers": {"training_iteration": 40.14697446430869, "restore_env_runners": 2.910092778916309e-05, "training_step": 40.14640303147143, "env_runner_sampling_timer": 30.73244932923049, "learner_update_timer": 9.405383922714352, "synch_weights": 0.007454192748818313, "synch_env_connectors": 0.00920795791110909}, "env_runners": {"episode_return_mean": 0.9413183760683762, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012943733386049615, "get_actions": 0.0007735425129147831, "un_batch_to_individual_items": 7.233174671823376e-05, "listify_data_for_vector_env": 0.00014237768878345744, "tensor_to_numpy": 0.00024533463063690424, "remove_single_ts_time_rank_from_batch": 1.0204025354786785e-05}}, "connector_pipeline_timer": 0.0017095496397873144}, "episode_return_max": 1.2160000000000013, "num_episodes_lifetime": 1744, "episode_duration_sec_mean": 28.34647238842336, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017842953423366997, "add_time_dim_to_batch_and_zero_pad": 4.140738583691215e-05, "add_states_from_episodes_to_batch": 2.1956523318661993e-05, "batch_individual_items": 0.0001036276270417584, "add_observations_from_episodes_to_batch": 4.5147988400388885e-05}}, "connector_pipeline_timer": 0.0006550029844958439}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 378000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 378000}, "sample": 29.74184544022617, "num_env_steps_sampled_lifetime": 378000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7573333333333334, "agent_episode_returns_mean": {"default_agent": 0.9413183760683762}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9413183760683762}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.90884316220128, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006027715431841091, "weights_seq_no": 188.0, "env_to_module_sum_episodes_length_in": 92.90884316220128, "env_step_timer": 0.11874670526647046, "time_between_sampling": 10.166137414678776, "num_env_steps_sampled_lifetime_throughput": 43.4994237070525}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 3.328007002675861e-32, "mean_kl_loss": 0.002149658277630806, "weights_seq_no": 189.0, "vf_loss": 0.012884900905191898, "gradients_default_optimizer_global_norm": 0.7855539917945862, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11449984, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012884900905191898, "vf_explained_var": 0.07297635078430176, "entropy": 0.19630688428878784, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.016438517719507217, "policy_loss": 0.0035536091309040785}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08181474194690536, "add_time_dim_to_batch_and_zero_pad": 3.404238555880584e-05, "add_states_from_episodes_to_batch": 1.1371911079235747e-05, "general_advantage_estimation": 0.060987743721191146, "batch_individual_items": 0.049785252875545215, "add_observations_from_episodes_to_batch": 0.0003759904954508974, "add_one_ts_to_episodes_and_truncate": 0.006805449400021629, "numpy_to_tensor": 0.0012378399028032385}}, "connector_pipeline_timer": 0.20154075202806168}, "num_env_steps_trained_lifetime": 180443648, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11449984, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.674078361186, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 378000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.4994237070525, "done": false, "training_iteration": 189, "trial_id": "8cacd_00000", "date": "2025-05-12_04-22-50", "timestamp": 1746987770, "time_this_iter_s": 45.898279666900635, "time_total_s": 7426.978137731552, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7426.978137731552, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 77.42923076923077, "ram_util_percent": 51.926153846153845}}
{"timers": {"training_iteration": 40.17996468139563, "restore_env_runners": 2.9009918506219033e-05, "training_step": 40.179394238886715, "env_runner_sampling_timer": 30.759833315508185, "learner_update_timer": 9.411000169647211, "synch_weights": 0.00744598582134057, "synch_env_connectors": 0.009245175341987386}, "env_runners": {"episode_return_mean": 0.9612179487179499, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013070398643565514, "get_actions": 0.0007763411620117571, "un_batch_to_individual_items": 7.327910635913507e-05, "listify_data_for_vector_env": 0.0001440480715839419, "tensor_to_numpy": 0.0002471950315831314, "remove_single_ts_time_rank_from_batch": 1.0096077695895366e-05}}, "connector_pipeline_timer": 0.00172073850326193}, "episode_return_max": 1.290555555555558, "num_episodes_lifetime": 1752, "episode_duration_sec_mean": 26.158494639125294, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017833977344166682, "add_time_dim_to_batch_and_zero_pad": 4.106794652726518e-05, "add_states_from_episodes_to_batch": 2.1789723049440658e-05, "batch_individual_items": 0.00010358766139120185, "add_observations_from_episodes_to_batch": 4.4729085575489984e-05}}, "connector_pipeline_timer": 0.0006561110629713711}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 380000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 380000}, "sample": 29.759697095439975, "num_env_steps_sampled_lifetime": 380000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7358888888888891, "agent_episode_returns_mean": {"default_agent": 0.9612179487179499}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9612179487179499}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.01033199170838, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006069613768919104, "weights_seq_no": 189.0, "env_to_module_sum_episodes_length_in": 95.01033199170838, "env_step_timer": 0.1184560496370787, "time_between_sampling": 10.176254285170488, "num_env_steps_sampled_lifetime_throughput": 45.92179768261542}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.6640035013379305e-32, "mean_kl_loss": 0.004528577905148268, "weights_seq_no": 190.0, "vf_loss": 0.012333756312727928, "gradients_default_optimizer_global_norm": 0.5644630789756775, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11510528, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.012333756312727928, "vf_explained_var": 0.21753597259521484, "entropy": 0.19612912833690643, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06821539252996445, "policy_loss": 0.05588163807988167}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08183159609868623, "add_time_dim_to_batch_and_zero_pad": 3.40876506026547e-05, "add_states_from_episodes_to_batch": 1.1375637694417842e-05, "general_advantage_estimation": 0.06065107640224314, "batch_individual_items": 0.049834999337378144, "add_observations_from_episodes_to_batch": 0.0003761364303038355, "add_one_ts_to_episodes_and_truncate": 0.006800594282698337, "numpy_to_tensor": 0.0012383149643727133}}, "connector_pipeline_timer": 0.2012659240669305}, "num_env_steps_trained_lifetime": 181397216, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11510528, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6773278673068, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 380000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.92179768261542, "done": false, "training_iteration": 190, "trial_id": "8cacd_00000", "date": "2025-05-12_04-23-34", "timestamp": 1746987814, "time_this_iter_s": 43.46527361869812, "time_total_s": 7470.44341135025, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7470.44341135025, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 78.20806451612903, "ram_util_percent": 51.99032258064516}}
{"timers": {"training_iteration": 40.27731669840169, "restore_env_runners": 2.8928819311875283e-05, "training_step": 40.27674546031784, "env_runner_sampling_timer": 30.850016986123077, "learner_update_timer": 9.41819568600077, "synch_weights": 0.007418781963125179, "synch_env_connectors": 0.00922945758856227}, "env_runners": {"episode_return_mean": 0.932541666666669, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013244882910113162, "get_actions": 0.0007865656664447289, "un_batch_to_individual_items": 7.36719954673588e-05, "listify_data_for_vector_env": 0.00014494982224882085, "tensor_to_numpy": 0.0002496772335019379, "remove_single_ts_time_rank_from_batch": 1.0014847271741706e-05}}, "connector_pipeline_timer": 0.001737728031111}, "episode_return_max": 1.1821111111111136, "num_episodes_lifetime": 1768, "episode_duration_sec_mean": 26.760057191500543, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001783826918542243, "add_time_dim_to_batch_and_zero_pad": 4.095386056870757e-05, "add_states_from_episodes_to_batch": 2.1585682298544358e-05, "batch_individual_items": 0.00010347567773224177, "add_observations_from_episodes_to_batch": 4.420544125620185e-05}}, "connector_pipeline_timer": 0.0006564898408704654}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 382000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 382000}, "sample": 29.78195841353808, "num_env_steps_sampled_lifetime": 382000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7035555555555564, "agent_episode_returns_mean": {"default_agent": 0.932541666666669}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.932541666666669}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.02433653960284, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006101417955530599, "weights_seq_no": 190.0, "env_to_module_sum_episodes_length_in": 97.02433653960284, "env_step_timer": 0.12015632215984125, "time_between_sampling": 10.186247102683488, "num_env_steps_sampled_lifetime_throughput": 39.87170093482804}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.6640035013379305e-32, "mean_kl_loss": 0.013648046180605888, "weights_seq_no": 191.0, "vf_loss": 0.014235383830964565, "gradients_default_optimizer_global_norm": 0.35908007621765137, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 11571328, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014235383830964565, "vf_explained_var": 0.06230586767196655, "entropy": 0.1774851530790329, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.026090625673532486, "policy_loss": 0.011855234391987324}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08184822990323685, "add_time_dim_to_batch_and_zero_pad": 3.413193610696111e-05, "add_states_from_episodes_to_batch": 1.1379162586239255e-05, "general_advantage_estimation": 0.06031596283530195, "batch_individual_items": 0.049883432314686775, "add_observations_from_episodes_to_batch": 0.0003762869674103105, "add_one_ts_to_episodes_and_truncate": 0.006795775432781463, "numpy_to_tensor": 0.001238766640720616}}, "connector_pipeline_timer": 0.2009911282798189}, "num_env_steps_trained_lifetime": 182358616, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 11571328, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6812449754689, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 382000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 39.87170093482804, "done": false, "training_iteration": 191, "trial_id": "8cacd_00000", "date": "2025-05-12_04-24-24", "timestamp": 1746987864, "time_this_iter_s": 49.934879541397095, "time_total_s": 7520.378290891647, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7520.378290891647, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 78.34647887323943, "ram_util_percent": 51.97464788732395}}
{"timers": {"training_iteration": 40.320413175657684, "restore_env_runners": 2.896253114079209e-05, "training_step": 40.319839241954675, "env_runner_sampling_timer": 30.88926905257182, "learner_update_timer": 9.422043241070762, "synch_weights": 0.007409440143480501, "synch_env_connectors": 0.009202287012670021}, "env_runners": {"episode_return_mean": 0.9216292735042758, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013367625502417279, "get_actions": 0.0007869715487880836, "un_batch_to_individual_items": 7.3533416924643e-05, "listify_data_for_vector_env": 0.00014679787157016424, "tensor_to_numpy": 0.00024996802777688153, "remove_single_ts_time_rank_from_batch": 1.021113349734167e-05}}, "connector_pipeline_timer": 0.001742345254922178}, "episode_return_max": 1.181222222222226, "num_episodes_lifetime": 1776, "episode_duration_sec_mean": 26.198334936720933, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017992419104364432, "add_time_dim_to_batch_and_zero_pad": 4.195227346362199e-05, "add_states_from_episodes_to_batch": 2.1524785029293943e-05, "batch_individual_items": 0.00010325470374627248, "add_observations_from_episodes_to_batch": 4.465243861860778e-05}}, "connector_pipeline_timer": 0.0006565237934727323}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 384000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 384000}, "sample": 29.804660308695816, "num_env_steps_sampled_lifetime": 384000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7272222222222234, "agent_episode_returns_mean": {"default_agent": 0.9216292735042758}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9216292735042758}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.53711911906481, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006137118367821916, "weights_seq_no": 191.0, "env_to_module_sum_episodes_length_in": 96.53711911906481, "env_step_timer": 0.12101427394875973, "time_between_sampling": 10.197189083259246, "num_env_steps_sampled_lifetime_throughput": 44.772074923611235}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 8.320017506689653e-33, "mean_kl_loss": 0.001773791154846549, "weights_seq_no": 192.0, "vf_loss": 0.019352994859218597, "gradients_default_optimizer_global_norm": 0.5343632102012634, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11631872, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.019352994859218597, "vf_explained_var": 0.06964874267578125, "entropy": 0.14215975999832153, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0076337773352861404, "policy_loss": -0.02698676474392414}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08186514419218661, "add_time_dim_to_batch_and_zero_pad": 3.417462713630758e-05, "add_states_from_episodes_to_batch": 1.1382529416446462e-05, "general_advantage_estimation": 0.05998395438205922, "batch_individual_items": 0.04993025795261537, "add_observations_from_episodes_to_batch": 0.00037642750013158695, "add_one_ts_to_episodes_and_truncate": 0.00679089775043444, "numpy_to_tensor": 0.0012391935520449755}}, "connector_pipeline_timer": 0.2007180154462431}, "num_env_steps_trained_lifetime": 183312184, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11631872, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.685016008681, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 384000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.772074923611235, "done": false, "training_iteration": 192, "trial_id": "8cacd_00000", "date": "2025-05-12_04-25-09", "timestamp": 1746987909, "time_this_iter_s": 44.60988759994507, "time_total_s": 7564.988178491592, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7564.988178491592, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 77.32539682539681, "ram_util_percent": 51.94761904761906}}
{"timers": {"training_iteration": 40.352564025801094, "restore_env_runners": 2.894090583280026e-05, "training_step": 40.351989406435116, "env_runner_sampling_timer": 30.91745420172609, "learner_update_timer": 9.42577950488008, "synch_weights": 0.007638732742031073, "synch_env_connectors": 0.00920027614254389}, "env_runners": {"episode_return_mean": 1.007752136752139, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013373405521523765, "get_actions": 0.0007855417307030468, "un_batch_to_individual_items": 7.402586401034451e-05, "listify_data_for_vector_env": 0.0001466624105423456, "tensor_to_numpy": 0.000249530260524228, "remove_single_ts_time_rank_from_batch": 1.008789755010755e-05}}, "connector_pipeline_timer": 0.001740791226127718}, "episode_return_max": 1.5106666666666706, "num_episodes_lifetime": 1784, "episode_duration_sec_mean": 25.059055868355628, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00018185630068386595, "add_time_dim_to_batch_and_zero_pad": 4.155327004535988e-05, "add_states_from_episodes_to_batch": 2.158591272509335e-05, "batch_individual_items": 0.00010389709471366267, "add_observations_from_episodes_to_batch": 4.5389406615019726e-05}}, "connector_pipeline_timer": 0.0006586865369255201}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 386000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 386000}, "sample": 29.827098404432075, "num_env_steps_sampled_lifetime": 386000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7272222222222234, "agent_episode_returns_mean": {"default_agent": 1.007752136752139}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.007752136752139}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 94.61133222556522, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006132957940301537, "weights_seq_no": 192.0, "env_to_module_sum_episodes_length_in": 94.61133222556522, "env_step_timer": 0.1210186350528164, "time_between_sampling": 10.208451132045866, "num_env_steps_sampled_lifetime_throughput": 45.82978778913735}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 4.1600087533448264e-33, "mean_kl_loss": 0.0019300694111734629, "weights_seq_no": 193.0, "vf_loss": 0.020630843937397003, "gradients_default_optimizer_global_norm": 0.6043150424957275, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11692416, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.020630843937397003, "vf_explained_var": -0.004922628402709961, "entropy": 0.22677366435527802, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.15805134177207947, "policy_loss": 0.13742050528526306}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08188214267216681, "add_time_dim_to_batch_and_zero_pad": 3.422667115148343e-05, "add_states_from_episodes_to_batch": 1.1385820994027926e-05, "general_advantage_estimation": 0.059654691641497955, "batch_individual_items": 0.04997695487435399, "add_observations_from_episodes_to_batch": 0.0003765600435017684, "add_one_ts_to_episodes_and_truncate": 0.006786133344191087, "numpy_to_tensor": 0.001239612558478799}}, "connector_pipeline_timer": 0.20044772253601104}, "num_env_steps_trained_lifetime": 184265752, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11692416, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6886434967314, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 386000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.82978778913735, "done": false, "training_iteration": 193, "trial_id": "8cacd_00000", "date": "2025-05-12_04-25-52", "timestamp": 1746987952, "time_this_iter_s": 43.588391065597534, "time_total_s": 7608.57656955719, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7608.57656955719, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 77.08709677419353, "ram_util_percent": 51.96612903225807}}
{"timers": {"training_iteration": 40.38704786596309, "restore_env_runners": 2.8965496764357163e-05, "training_step": 40.38647273579075, "env_runner_sampling_timer": 30.936748972008836, "learner_update_timer": 9.440973134951266, "synch_weights": 0.007634677414628685, "synch_env_connectors": 0.009349623381115052}, "env_runners": {"episode_return_mean": 1.0120854700854713, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013236192147679933, "get_actions": 0.0007806073672953522, "un_batch_to_individual_items": 7.354351927387871e-05, "listify_data_for_vector_env": 0.00014606900712690963, "tensor_to_numpy": 0.0002486722458807224, "remove_single_ts_time_rank_from_batch": 9.955192816850823e-06}}, "connector_pipeline_timer": 0.0017285217433424794}, "episode_return_max": 1.5106666666666706, "num_episodes_lifetime": 1792, "episode_duration_sec_mean": 24.795808559913333, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017977130050175305, "add_time_dim_to_batch_and_zero_pad": 4.09298317036427e-05, "add_states_from_episodes_to_batch": 2.1148189758044505e-05, "batch_individual_items": 0.00010335700225501133, "add_observations_from_episodes_to_batch": 4.535383007817276e-05}}, "connector_pipeline_timer": 0.0006532284008870677}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 388000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 388000}, "sample": 29.84808770883106, "num_env_steps_sampled_lifetime": 388000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7000000000000002, "agent_episode_returns_mean": {"default_agent": 1.0120854700854713}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0120854700854713}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.89110647481371, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006093642850067578, "weights_seq_no": 193.0, "env_to_module_sum_episodes_length_in": 92.89110647481371, "env_step_timer": 0.11998162627188558, "time_between_sampling": 10.219917221798116, "num_env_steps_sampled_lifetime_throughput": 45.473165742380345}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.0800043766724132e-33, "mean_kl_loss": 0.0021599691826850176, "weights_seq_no": 194.0, "vf_loss": 0.013876073062419891, "gradients_default_optimizer_global_norm": 0.2926464378833771, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11752960, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.013876073062419891, "vf_explained_var": 0.040106356143951416, "entropy": 0.19317302107810974, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.04555220156908035, "policy_loss": -0.059428270906209946}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08189869930812821, "add_time_dim_to_batch_and_zero_pad": 3.42883768234746e-05, "add_states_from_episodes_to_batch": 1.1389168487251634e-05, "general_advantage_estimation": 0.059326888890309744, "batch_individual_items": 0.050022427551862786, "add_observations_from_episodes_to_batch": 0.00037668648325475706, "add_one_ts_to_episodes_and_truncate": 0.006781465026297731, "numpy_to_tensor": 0.0012400346554286646}}, "connector_pipeline_timer": 0.20017734457243905}, "num_env_steps_trained_lifetime": 185219320, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11752960, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.69212993342, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 388000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.473165742380345, "done": false, "training_iteration": 194, "trial_id": "8cacd_00000", "date": "2025-05-12_04-26-36", "timestamp": 1746987996, "time_this_iter_s": 43.822386264801025, "time_total_s": 7652.398955821991, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7652.398955821991, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 72.8095238095238, "ram_util_percent": 52.006349206349206}}
{"timers": {"training_iteration": 40.39497821486346, "restore_env_runners": 2.8923841793358968e-05, "training_step": 40.39440298199287, "env_runner_sampling_timer": 30.947247083128733, "learner_update_timer": 9.438415518321776, "synch_weights": 0.007623835640466512, "synch_env_connectors": 0.009387075147309347}, "env_runners": {"episode_return_mean": 0.920756410256411, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00013098591492659355, "get_actions": 0.0007763933348597053, "un_batch_to_individual_items": 7.3568661493689e-05, "listify_data_for_vector_env": 0.00014570560550874917, "tensor_to_numpy": 0.000247830433463745, "remove_single_ts_time_rank_from_batch": 9.763465300819467e-06}}, "connector_pipeline_timer": 0.00171918996236303}, "episode_return_max": 1.3535555555555572, "num_episodes_lifetime": 1800, "episode_duration_sec_mean": 23.92325607922007, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001777163989441594, "add_time_dim_to_batch_and_zero_pad": 4.086069722828598e-05, "add_states_from_episodes_to_batch": 2.0952265635063257e-05, "batch_individual_items": 0.00010406663832029541, "add_observations_from_episodes_to_batch": 4.499750189176331e-05}}, "connector_pipeline_timer": 0.0006509308059426968}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 390000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 390000}, "sample": 29.868126054699296, "num_env_steps_sampled_lifetime": 390000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7000000000000002, "agent_episode_returns_mean": {"default_agent": 0.920756410256411}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.920756410256411}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 92.42772179126304, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006076649840832586, "weights_seq_no": 194.0, "env_to_module_sum_episodes_length_in": 92.42772179126304, "env_step_timer": 0.11911475095801037, "time_between_sampling": 10.232863520861665, "num_env_steps_sampled_lifetime_throughput": 48.45883524639691}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.0800043766724132e-33, "mean_kl_loss": 0.0053590745665133, "weights_seq_no": 195.0, "vf_loss": 0.007637976668775082, "gradients_default_optimizer_global_norm": 0.3338440954685211, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11813504, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.007637976668775082, "vf_explained_var": 0.15455013513565063, "entropy": 0.18104872107505798, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.11483835428953171, "policy_loss": 0.10720038414001465}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08191471702710311, "add_time_dim_to_batch_and_zero_pad": 3.435207571461548e-05, "add_states_from_episodes_to_batch": 1.1392400448443913e-05, "general_advantage_estimation": 0.059000531284981304, "batch_individual_items": 0.05006675944033418, "add_observations_from_episodes_to_batch": 0.00037680750820861066, "add_one_ts_to_episodes_and_truncate": 0.006776749581427878, "numpy_to_tensor": 0.001240467479183609}}, "connector_pipeline_timer": 0.19990669264588487}, "num_env_steps_trained_lifetime": 186172888, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11813504, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.695477777025, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 390000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.45883524639691, "done": false, "training_iteration": 195, "trial_id": "8cacd_00000", "date": "2025-05-12_04-27-18", "timestamp": 1746988038, "time_this_iter_s": 41.19399118423462, "time_total_s": 7693.592947006226, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7693.592947006226, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 78.97068965517241, "ram_util_percent": 52.032758620689656}}
{"timers": {"training_iteration": 40.39152636298481, "restore_env_runners": 2.890060336361248e-05, "training_step": 40.39095123744291, "env_runner_sampling_timer": 30.930403787597434, "learner_update_timer": 9.451750185108569, "synch_weights": 0.0076807782840810955, "synch_env_connectors": 0.009356516395856487}, "env_runners": {"episode_return_mean": 0.892239316239317, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012973891940653496, "get_actions": 0.0007726706597653769, "un_batch_to_individual_items": 7.286863360370929e-05, "listify_data_for_vector_env": 0.00014423778093178725, "tensor_to_numpy": 0.0002469140651247267, "remove_single_ts_time_rank_from_batch": 9.555678033702688e-06}}, "connector_pipeline_timer": 0.0017095899742654904}, "episode_return_max": 1.233555555555557, "num_episodes_lifetime": 1808, "episode_duration_sec_mean": 22.526438691528885, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017606002280481692, "add_time_dim_to_batch_and_zero_pad": 4.055249313623139e-05, "add_states_from_episodes_to_batch": 2.1065548033940547e-05, "batch_individual_items": 0.0001030996361583514, "add_observations_from_episodes_to_batch": 4.4536459238027755e-05}}, "connector_pipeline_timer": 0.0006475486433036629}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 392000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 392000}, "sample": 29.885351555034674, "num_env_steps_sampled_lifetime": 392000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7271111111111115, "agent_episode_returns_mean": {"default_agent": 0.892239316239317}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.892239316239317}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.81268159017638, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006047811597348549, "weights_seq_no": 195.0, "env_to_module_sum_episodes_length_in": 93.81268159017638, "env_step_timer": 0.11790551769525213, "time_between_sampling": 10.244729980929371, "num_env_steps_sampled_lifetime_throughput": 49.848331184648295}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.0400021883362066e-33, "mean_kl_loss": 0.001782772596925497, "weights_seq_no": 196.0, "vf_loss": 0.014526082202792168, "gradients_default_optimizer_global_norm": 0.46405336260795593, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11874048, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.014526082202792168, "vf_explained_var": 0.09476745128631592, "entropy": 0.14800170063972473, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.15784211456775665, "policy_loss": -0.17236819863319397}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0819304415217675, "add_time_dim_to_batch_and_zero_pad": 3.4420091790176126e-05, "add_states_from_episodes_to_batch": 1.139552885357221e-05, "general_advantage_estimation": 0.05867663244287071, "batch_individual_items": 0.05010977164828093, "add_observations_from_episodes_to_batch": 0.00037692452401512524, "add_one_ts_to_episodes_and_truncate": 0.006772059708952535, "numpy_to_tensor": 0.0012421476929979913}}, "connector_pipeline_timer": 0.1996383790234047}, "num_env_steps_trained_lifetime": 187126456, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11874048, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.6986894507645, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 392000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.848331184648295, "done": false, "training_iteration": 196, "trial_id": "8cacd_00000", "date": "2025-05-12_04-27-58", "timestamp": 1746988078, "time_this_iter_s": 40.07596182823181, "time_total_s": 7733.668908834457, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7733.668908834457, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 75.07719298245614, "ram_util_percent": 52.01754385964912}}
{"timers": {"training_iteration": 40.487375740304984, "restore_env_runners": 2.892859734270474e-05, "training_step": 40.486798393018475, "env_runner_sampling_timer": 31.013042341601455, "learner_update_timer": 9.464980354327475, "synch_weights": 0.0076587195012138105, "synch_env_connectors": 0.00939422123188141}, "env_runners": {"episode_return_mean": 0.9570908119658144, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001297047991579204, "get_actions": 0.0007767192377247796, "un_batch_to_individual_items": 7.338021305915504e-05, "listify_data_for_vector_env": 0.0001438660767160235, "tensor_to_numpy": 0.0002464066156696703, "remove_single_ts_time_rank_from_batch": 9.45617214025822e-06}}, "connector_pipeline_timer": 0.0017157485468864751}, "episode_return_max": 1.262666666666669, "num_episodes_lifetime": 1824, "episode_duration_sec_mean": 25.244747492558172, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017738879793479262, "add_time_dim_to_batch_and_zero_pad": 4.1552162324476964e-05, "add_states_from_episodes_to_batch": 2.1423010886268552e-05, "batch_individual_items": 0.00010299324790293487, "add_observations_from_episodes_to_batch": 4.440687962024187e-05}}, "connector_pipeline_timer": 0.0006507158917420503}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 394000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 394000}, "sample": 29.90661183592859, "num_env_steps_sampled_lifetime": 394000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7267777777777793, "agent_episode_returns_mean": {"default_agent": 0.9570908119658144}, "num_episodes": 16, "module_episode_returns_mean": {"default_policy": 0.9570908119658144}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 96.90217702112001, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006090785226974783, "weights_seq_no": 196.0, "env_to_module_sum_episodes_length_in": 96.90217702112001, "env_step_timer": 0.11969002796861775, "time_between_sampling": 10.256698878671065, "num_env_steps_sampled_lifetime_throughput": 39.918867859860335}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 5.200010941681033e-34, "mean_kl_loss": 0.0042959945276379585, "weights_seq_no": 197.0, "vf_loss": 0.017458632588386536, "gradients_default_optimizer_global_norm": 0.4325938820838928, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 11934848, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.017458632588386536, "vf_explained_var": 0.10312110185623169, "entropy": 0.1932586431503296, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.14111757278442383, "policy_loss": -0.15857619047164917}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08194834714493585, "add_time_dim_to_batch_and_zero_pad": 3.449513233643553e-05, "add_states_from_episodes_to_batch": 1.1399205450417941e-05, "general_advantage_estimation": 0.0583543791944738, "batch_individual_items": 0.05015338758622488, "add_observations_from_episodes_to_batch": 0.0003770472487547449, "add_one_ts_to_episodes_and_truncate": 0.006767574758968566, "numpy_to_tensor": 0.0012438008057879802}}, "connector_pipeline_timer": 0.1993746887743095}, "num_env_steps_trained_lifetime": 188087856, "num_env_steps_trained": 961400, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60800, "num_module_steps_trained_lifetime": 11934848, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.7025673432515, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 394000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 39.918867859860335, "done": false, "training_iteration": 197, "trial_id": "8cacd_00000", "date": "2025-05-12_04-28-48", "timestamp": 1746988128, "time_this_iter_s": 49.99701261520386, "time_total_s": 7783.665921449661, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7783.665921449661, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 77.25633802816901, "ram_util_percent": 52.05774647887324}}
{"timers": {"training_iteration": 40.53436498541193, "restore_env_runners": 2.89993113820112e-05, "training_step": 40.53378774559829, "env_runner_sampling_timer": 31.054955148215434, "learner_update_timer": 9.470042450254185, "synch_weights": 0.007674214316216238, "synch_env_connectors": 0.009391916019567589}, "env_runners": {"episode_return_mean": 1.0189551282051315, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012940422730893983, "get_actions": 0.0007817677912389645, "un_batch_to_individual_items": 7.32903355056548e-05, "listify_data_for_vector_env": 0.000143371031818015, "tensor_to_numpy": 0.00025083072824024817, "remove_single_ts_time_rank_from_batch": 9.260123770224971e-06}}, "connector_pipeline_timer": 0.0017235606360635842}, "episode_return_max": 1.3680000000000043, "num_episodes_lifetime": 1832, "episode_duration_sec_mean": 26.080104321451856, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017747476640578522, "add_time_dim_to_batch_and_zero_pad": 4.2029654979785374e-05, "add_states_from_episodes_to_batch": 2.212702498190512e-05, "batch_individual_items": 0.00010381887815090563, "add_observations_from_episodes_to_batch": 4.5643950784130785e-05}}, "connector_pipeline_timer": 0.0006556940101618387}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 396000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 396000}, "sample": 29.928383893967116, "num_env_steps_sampled_lifetime": 396000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7242222222222239, "agent_episode_returns_mean": {"default_agent": 1.0189551282051315}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 1.0189551282051315}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 97.44384239000587, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006136603470913386, "weights_seq_no": 197.0, "env_to_module_sum_episodes_length_in": 97.44384239000587, "env_step_timer": 0.12088406883152138, "time_between_sampling": 10.269779389424887, "num_env_steps_sampled_lifetime_throughput": 44.16740942355185}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 2.6000054708405165e-34, "mean_kl_loss": 0.0024331691674888134, "weights_seq_no": 198.0, "vf_loss": 0.02628912217915058, "gradients_default_optimizer_global_norm": 0.6134951710700989, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11995392, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.02628912217915058, "vf_explained_var": 0.14451444149017334, "entropy": 0.169386625289917, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1393156349658966, "policy_loss": 0.11302650719881058}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08196649875178844, "add_time_dim_to_batch_and_zero_pad": 3.460471006271388e-05, "add_states_from_episodes_to_batch": 1.1403568962357023e-05, "general_advantage_estimation": 0.05803372474780036, "batch_individual_items": 0.05022251687894488, "add_observations_from_episodes_to_batch": 0.00037716161654730983, "add_one_ts_to_episodes_and_truncate": 0.0067630971520132145, "numpy_to_tensor": 0.001245409311552959}}, "connector_pipeline_timer": 0.19913834694329405}, "num_env_steps_trained_lifetime": 189041424, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 11995392, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.7062978089436, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 396000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.16740942355185, "done": false, "training_iteration": 198, "trial_id": "8cacd_00000", "date": "2025-05-12_04-29-33", "timestamp": 1746988173, "time_this_iter_s": 45.207639932632446, "time_total_s": 7828.873561382294, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7828.873561382294, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 76.6734375, "ram_util_percent": 52.01875}}
{"timers": {"training_iteration": 40.568602916747814, "restore_env_runners": 2.9033318261461352e-05, "training_step": 40.568025701332296, "env_runner_sampling_timer": 31.09008978773328, "learner_update_timer": 9.469174497941651, "synch_weights": 0.007646876173073497, "synch_env_connectors": 0.009414684859388352}, "env_runners": {"episode_return_mean": 0.9531816239316265, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.0001292636898792909, "get_actions": 0.0007867630694636761, "un_batch_to_individual_items": 7.354712434943234e-05, "listify_data_for_vector_env": 0.00014504505297746457, "tensor_to_numpy": 0.0002525997080887638, "remove_single_ts_time_rank_from_batch": 9.078339332768604e-06}}, "connector_pipeline_timer": 0.0017340409927930262}, "episode_return_max": 1.3680000000000043, "num_episodes_lifetime": 1840, "episode_duration_sec_mean": 25.73925211607789, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001816300367301868, "add_time_dim_to_batch_and_zero_pad": 4.2722787715892563e-05, "add_states_from_episodes_to_batch": 2.2807551752050966e-05, "batch_individual_items": 0.00010325784092180737, "add_observations_from_episodes_to_batch": 4.5717613547992986e-05}}, "connector_pipeline_timer": 0.0006598723844951303}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 398000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 398000}, "sample": 29.95089354955563, "num_env_steps_sampled_lifetime": 398000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7242222222222239, "agent_episode_returns_mean": {"default_agent": 0.9531816239316265}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9531816239316265}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 95.78360186037611, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006173608734078915, "weights_seq_no": 198.0, "env_to_module_sum_episodes_length_in": 95.78360186037611, "env_step_timer": 0.12159269940935645, "time_between_sampling": 10.283324376304757, "num_env_steps_sampled_lifetime_throughput": 45.398500676319294}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 1.3000027354202582e-34, "mean_kl_loss": 0.0030076722614467144, "weights_seq_no": 199.0, "vf_loss": 0.01359068974852562, "gradients_default_optimizer_global_norm": 0.32682526111602783, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 12055936, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.01359068974852562, "vf_explained_var": -0.032724976539611816, "entropy": 0.18756842613220215, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0457504577934742, "policy_loss": 0.032159775495529175}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08198469664178937, "add_time_dim_to_batch_and_zero_pad": 3.471795672118337e-05, "add_states_from_episodes_to_batch": 1.1408445283664775e-05, "general_advantage_estimation": 0.0577146513521412, "batch_individual_items": 0.050289698077051644, "add_observations_from_episodes_to_batch": 0.0003772665822592447, "add_one_ts_to_episodes_and_truncate": 0.006758575579721189, "numpy_to_tensor": 0.0012469761371221664}}, "connector_pipeline_timer": 0.19890159178002137}, "num_env_steps_trained_lifetime": 189994992, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 12055936, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.7098834085878, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 398000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.398500676319294, "done": false, "training_iteration": 199, "trial_id": "8cacd_00000", "date": "2025-05-12_04-30-17", "timestamp": 1746988217, "time_this_iter_s": 43.97656440734863, "time_total_s": 7872.850125789642, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7872.850125789642, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 78.4952380952381, "ram_util_percent": 52.01746031746032}}
{"timers": {"training_iteration": 40.588575438830354, "restore_env_runners": 2.893298510678874e-05, "training_step": 40.58799945456897, "env_runner_sampling_timer": 31.110808858455936, "learner_update_timer": 9.468427026612249, "synch_weights": 0.0076487244113495525, "synch_env_connectors": 0.009396247010769644}, "env_runners": {"episode_return_mean": 0.9524476495726513, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 0.00012901044144831062, "get_actions": 0.0007885530125505061, "un_batch_to_individual_items": 7.506091411503204e-05, "listify_data_for_vector_env": 0.00014439296656176479, "tensor_to_numpy": 0.00025236882906057463, "remove_single_ts_time_rank_from_batch": 8.904119879794313e-06}}, "connector_pipeline_timer": 0.0017370592982928468}, "episode_return_max": 1.3918888888888918, "num_episodes_lifetime": 1848, "episode_duration_sec_mean": 24.889830950356238, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00018343476108398943, "add_time_dim_to_batch_and_zero_pad": 4.279174378660388e-05, "add_states_from_episodes_to_batch": 2.269669154555379e-05, "batch_individual_items": 0.00010461516628035919, "add_observations_from_episodes_to_batch": 4.512642673566828e-05}}, "connector_pipeline_timer": 0.0006630411310454451}, "episode_len_min": 216, "num_module_steps_sampled_lifetime": {"default_policy": 400000}, "num_env_steps_sampled": 2000, "episode_len_max": 216, "num_agent_steps_sampled_lifetime": {"default_agent": 400000}, "sample": 29.972845840367828, "num_env_steps_sampled_lifetime": 400000, "num_module_steps_sampled": {"default_policy": 2000}, "env_reset_timer": 2.2562683343749086, "episode_return_min": 0.7245555555555556, "agent_episode_returns_mean": {"default_agent": 0.9524476495726513}, "num_episodes": 8, "module_episode_returns_mean": {"default_policy": 0.9524476495726513}, "num_agent_steps_sampled": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 93.80785496779632, "episode_len_mean": 216.0, "rlmodule_inference_timer": 0.0006212467761388778, "weights_seq_no": 199.0, "env_to_module_sum_episodes_length_in": 93.80785496779632, "env_step_timer": 0.12157914541021962, "time_between_sampling": 10.296033575860125, "num_env_steps_sampled_lifetime_throughput": 46.89624613254794}, "learners": {"default_policy": {"num_trainable_parameters": 73223.0, "curr_kl_coeff": 6.500013677101291e-35, "mean_kl_loss": 0.0028598341159522533, "weights_seq_no": 200.0, "vf_loss": 0.018411977216601372, "gradients_default_optimizer_global_norm": 1.2894614934921265, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 12116480, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.018411977216601372, "vf_explained_var": 0.21108639240264893, "entropy": 0.19366413354873657, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.12440935522317886, "policy_loss": -0.14282135665416718}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.08200323288401477, "add_time_dim_to_batch_and_zero_pad": 3.483337797524124e-05, "add_states_from_episodes_to_batch": 1.141326372154029e-05, "general_advantage_estimation": 0.057397324931920554, "batch_individual_items": 0.050354974399508465, "add_observations_from_episodes_to_batch": 0.00037737491249520666, "add_one_ts_to_episodes_and_truncate": 0.0067539938891596025, "numpy_to_tensor": 0.001248707105248906}}, "connector_pipeline_timer": 0.19866513117522003}, "num_env_steps_trained_lifetime": 190948560, "num_env_steps_trained": 953568, "num_trainable_parameters": 73223.0, "num_module_steps_trained": 60544, "num_module_steps_trained_lifetime": 12116480, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 2000.0, "learner_connector_sum_episodes_length_out": 2016.713326666458, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 400000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.89624613254794, "done": true, "training_iteration": 200, "trial_id": "8cacd_00000", "date": "2025-05-12_04-31-00", "timestamp": 1746988260, "time_this_iter_s": 42.586458683013916, "time_total_s": 7915.436584472656, "pid": 8812, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ec5395360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7915.436584472656, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 78.49499999999999, "ram_util_percent": 52.02333333333333}}
