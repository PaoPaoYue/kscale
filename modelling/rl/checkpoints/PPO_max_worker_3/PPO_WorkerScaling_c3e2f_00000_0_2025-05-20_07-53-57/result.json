{"timers": {"training_iteration": 43.41671913799655, "restore_env_runners": 2.8700000257231295e-05, "training_step": 43.416289837994555, "env_runner_sampling_timer": 32.3714293439989, "learner_update_timer": 11.026677093999751, "synch_weights": 0.01736719999462366}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.16988888888888876, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0019405415611975702, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.177618125250525e-06, "un_batch_to_individual_items": 6.943211340547268e-05, "listify_data_for_vector_env": 0.00013249681310279084, "normalize_and_clip_actions": 0.00020733112246217964, "get_actions": 0.0007720594257190714, "tensor_to_numpy": 0.00027115621425185616}}}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.8545969435406155e-05, "add_states_from_episodes_to_batch": 1.943050162668751e-05, "numpy_to_tensor": 0.00016209336550951895, "add_time_dim_to_batch_and_zero_pad": 3.258673276476523e-05, "batch_individual_items": 0.00011523430964271615}}, "connector_pipeline_timer": 0.0007815016611649774}, "episode_return_max": -0.0020000000000000313, "episode_duration_sec_mean": 23.303330822500357, "num_episodes_lifetime": 8, "rlmodule_inference_timer": 0.0006295874800733312, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": -0.09765277777777777, "env_to_module_sum_episodes_length_out": 95.59269498396193, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11518026020592254, "num_env_steps_sampled_lifetime": 2000, "weights_seq_no": 0.0, "agent_episode_returns_mean": {"default_agent": -0.09765277777777777}, "module_episode_returns_mean": {"default_policy": -0.09765277777777777}, "num_env_steps_sampled": 2000, "sample": 30.658421109750627, "env_to_module_sum_episodes_length_in": 95.59269498396193, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"default_policy": {"num_trainable_parameters": 72452, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02225174941122532, "weights_seq_no": 1.0, "vf_loss_unclipped": 0.0011977716349065304, "total_loss": -0.019828274846076965, "gradients_default_optimizer_global_norm": 0.2802311182022095, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1912534236907959, "entropy": 1.0821812152862549, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.006128466222435236, "num_module_steps_trained_lifetime": 60544, "vf_loss": 0.0011977716349065304}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.043648400001984555, "add_observations_from_episodes_to_batch": 0.00035679999564308673, "add_one_ts_to_episodes_and_truncate": 0.007426700001815334, "add_columns_from_episodes_to_train_batch": 0.07877129999542376, "general_advantage_estimation": 0.13726339900313178, "add_states_from_episodes_to_batch": 1.1000003723893315e-05, "numpy_to_tensor": 0.0013258999970275909, "add_time_dim_to_batch_and_zero_pad": 3.070000093430281e-05}}, "connector_pipeline_timer": 0.26944239899603417}, "num_module_steps_trained_lifetime": 60544, "learner_connector_sum_episodes_length_out": 2016, "num_trainable_parameters": 72452, "num_env_steps_trained_lifetime": 953568, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": NaN, "done": false, "training_iteration": 1, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-55-13", "timestamp": 1747691713, "time_this_iter_s": 43.44265913963318, "time_total_s": 43.44265913963318, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.44265913963318, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 74.25645161290323, "ram_util_percent": 46.76774193548387}}
{"timers": {"training_iteration": 43.36743906379656, "restore_env_runners": 2.870200027246028e-05, "training_step": 43.36700722879461, "env_runner_sampling_timer": 32.34156381664885, "learner_update_timer": 11.007328272149753, "synch_weights": 0.017297432994673727, "synch_env_connectors": 0.009151800004474353}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.8317777777777768, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0019182517434312917, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.519991230321818e-06, "un_batch_to_individual_items": 6.996296834228498e-05, "listify_data_for_vector_env": 0.00013253967402841957, "normalize_and_clip_actions": 0.0002021214161471495, "get_actions": 0.0007696226478704221, "tensor_to_numpy": 0.0002679613641079298}}}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.8768140365984487e-05, "add_states_from_episodes_to_batch": 1.924019489613046e-05, "numpy_to_tensor": 0.0001625596565383213, "add_time_dim_to_batch_and_zero_pad": 3.258447783201786e-05, "batch_individual_items": 0.00011444530647350304}}, "connector_pipeline_timer": 0.0007688736159875745}, "episode_return_max": -0.0020000000000000313, "episode_duration_sec_mean": 22.507104949039647, "num_episodes_lifetime": 16, "rlmodule_inference_timer": 0.0006213198077487417, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": -0.2887895299145297, "env_to_module_sum_episodes_length_out": 94.08568675847273, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11461989769845346, "num_env_steps_sampled_lifetime": 4000, "weights_seq_no": 1.0, "agent_episode_returns_mean": {"default_agent": -0.2887895299145297}, "module_episode_returns_mean": {"default_policy": -0.2887895299145297}, "num_env_steps_sampled": 2000, "sample": 30.65614546174882, "env_to_module_sum_episodes_length_in": 94.08568675847273, "time_between_sampling": 12.894796515751295, "num_env_steps_sampled_lifetime_throughput": 51.78386331673964}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.15162663161754608, "weights_seq_no": 2.0, "vf_loss_unclipped": 0.007441332098096609, "total_loss": 0.16228675842285156, "gradients_default_optimizer_global_norm": 0.34308984875679016, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.18387895822525024, "entropy": 1.055953025817871, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.01609395071864128, "num_module_steps_trained_lifetime": 121088, "vf_loss": 0.007441332098096609}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04366581881228485, "add_observations_from_episodes_to_batch": 0.0003568135556437483, "add_one_ts_to_episodes_and_truncate": 0.007426699831815495, "add_columns_from_episodes_to_train_batch": 0.07877160541552439, "general_advantage_estimation": 0.13725111053323125, "add_states_from_episodes_to_batch": 1.1001063723233528e-05, "numpy_to_tensor": 0.0013259343370278657, "add_time_dim_to_batch_and_zero_pad": 3.0702700934489255e-05}}, "connector_pipeline_timer": 0.2694479086065345}, "num_module_steps_trained_lifetime": 121088, "learner_connector_sum_episodes_length_out": 2016.0, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 1907136, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.78386331673964, "done": false, "training_iteration": 2, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-55-51", "timestamp": 1747691751, "time_this_iter_s": 38.50406622886658, "time_total_s": 81.94672536849976, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.94672536849976, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 75.61454545454546, "ram_util_percent": 50.485454545454544}}
{"timers": {"training_iteration": 43.33516797366858, "restore_env_runners": 2.8649980240152215e-05, "training_step": 43.33473490301672, "env_runner_sampling_timer": 32.33117602570236, "learner_update_timer": 10.985561442718243, "synch_weights": 0.017177900664716438, "synch_env_connectors": 0.009128354004424181}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.8317777777777768, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001899365654844334, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.482607982453353e-06, "un_batch_to_individual_items": 7.017460666461714e-05, "listify_data_for_vector_env": 0.00013249867991480476, "normalize_and_clip_actions": 0.00019507470617545134, "get_actions": 0.0007696224990286582, "tensor_to_numpy": 0.000266501365796399}}}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.892755370790834e-05, "add_states_from_episodes_to_batch": 1.9730450141226332e-05, "numpy_to_tensor": 0.00016179326769058194, "add_time_dim_to_batch_and_zero_pad": 3.253407119913822e-05, "batch_individual_items": 0.00011358751804173804}}, "connector_pipeline_timer": 0.0007552504984069908}, "episode_return_max": 0.07677777777777775, "episode_duration_sec_mean": 22.29199241143222, "num_episodes_lifetime": 24, "rlmodule_inference_timer": 0.0006183481138756411, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": -0.23133547008546992, "env_to_module_sum_episodes_length_out": 92.22256311007892, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11428082212894787, "num_env_steps_sampled_lifetime": 6000, "weights_seq_no": 2.0, "agent_episode_returns_mean": {"default_agent": -0.23133547008546992}, "module_episode_returns_mean": {"default_policy": -0.23133547008546992}, "num_env_steps_sampled": 2000, "sample": 30.653217126143, "env_to_module_sum_episodes_length_in": 92.22256311007892, "time_between_sampling": 12.893217419240845, "num_env_steps_sampled_lifetime_throughput": 49.72883357873397}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.05263742431998253, "weights_seq_no": 3.0, "vf_loss_unclipped": 0.0016811436507850885, "total_loss": -0.04794316366314888, "gradients_default_optimizer_global_norm": 0.12052232772111893, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.2009487748146057, "entropy": 1.027608036994934, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.015065553598105907, "num_module_steps_trained_lifetime": 181632, "vf_loss": 0.0016811436507850885}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04368335196417925, "add_observations_from_episodes_to_batch": 0.0003568284943449107, "add_one_ts_to_episodes_and_truncate": 0.00742668910491551, "add_columns_from_episodes_to_train_batch": 0.07877237665342342, "general_advantage_estimation": 0.1372262301824278, "add_states_from_episodes_to_batch": 1.1002002521825489e-05, "numpy_to_tensor": 0.0013259472701278427, "add_time_dim_to_batch_and_zero_pad": 3.070510693429969e-05}}, "connector_pipeline_timer": 0.2694413503380258}, "num_module_steps_trained_lifetime": 181632, "learner_connector_sum_episodes_length_out": 2016.0, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 2860704, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.72883357873397, "done": false, "training_iteration": 3, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-56-31", "timestamp": 1747691791, "time_this_iter_s": 40.15626096725464, "time_total_s": 122.1029863357544, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 122.1029863357544, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 77.09473684210526, "ram_util_percent": 50.5859649122807}}
{"timers": {"training_iteration": 43.30440539757188, "restore_env_runners": 2.8680480450479077e-05, "training_step": 43.30397073361657, "env_runner_sampling_timer": 32.31176950151532, "learner_update_timer": 10.974320564841069, "synch_weights": 0.017059954668020905, "synch_env_connectors": 0.009116627464369958}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.5677777777777778, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0018776337179814582, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.510063136750058e-06, "un_batch_to_individual_items": 7.020114859082878e-05, "listify_data_for_vector_env": 0.00013312843191288438, "normalize_and_clip_actions": 0.00018891973789388183, "get_actions": 0.0007667755672188489, "tensor_to_numpy": 0.00026406097464656516}}}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.968966465674677e-05, "add_states_from_episodes_to_batch": 2.0085210484039034e-05, "numpy_to_tensor": 0.00016124858540619104, "add_time_dim_to_batch_and_zero_pad": 3.2725424299967824e-05, "batch_individual_items": 0.00011307838015209516}}, "connector_pipeline_timer": 0.0007450504724264944}, "episode_return_max": 0.15399999999999997, "episode_duration_sec_mean": 22.969488500325916, "num_episodes_lifetime": 32, "rlmodule_inference_timer": 0.0006159741931624928, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": -0.11399465811965816, "env_to_module_sum_episodes_length_out": 91.24592817976652, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11361632259340833, "num_env_steps_sampled_lifetime": 8000, "weights_seq_no": 3.0, "agent_episode_returns_mean": {"default_agent": -0.11399465811965816}, "module_episode_returns_mean": {"default_policy": -0.11399465811965816}, "num_env_steps_sampled": 2000, "sample": 30.649089533161845, "env_to_module_sum_episodes_length_in": 91.24592817976652, "time_between_sampling": 12.890051031342344, "num_env_steps_sampled_lifetime_throughput": 49.58314942513018}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06678981333971024, "weights_seq_no": 4.0, "vf_loss_unclipped": 0.0017252311808988452, "total_loss": 0.07010137289762497, "gradients_default_optimizer_global_norm": 0.15351544320583344, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.37274813652038574, "entropy": 0.9900513291358948, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.007931587286293507, "num_module_steps_trained_lifetime": 242176, "vf_loss": 0.0017252311808988452}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04370032281145475, "add_observations_from_episodes_to_batch": 0.00035683976291658246, "add_one_ts_to_episodes_and_truncate": 0.007426474662570389, "add_columns_from_episodes_to_train_batch": 0.07877361428682259, "general_advantage_estimation": 0.1371890116376867, "add_states_from_episodes_to_batch": 1.1002862437988806e-05, "numpy_to_tensor": 0.0013259467611318695, "add_time_dim_to_batch_and_zero_pad": 3.070720454431692e-05}}, "connector_pipeline_timer": 0.2694221127252266}, "num_module_steps_trained_lifetime": 242176, "learner_connector_sum_episodes_length_out": 2016.0, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 3814272, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.58314942513018, "done": false, "training_iteration": 4, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-57-12", "timestamp": 1747691832, "time_this_iter_s": 40.27867817878723, "time_total_s": 162.38166451454163, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.38166451454163, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 75.82280701754387, "ram_util_percent": 50.61052631578947}}
{"timers": {"training_iteration": 43.26885695664613, "restore_env_runners": 2.8730675665473387e-05, "training_step": 43.26842056333047, "env_runner_sampling_timer": 32.28915338196017, "learner_update_timer": 10.961481799782664, "synch_weights": 0.016961448121394124, "synch_env_connectors": 0.00911745019976027}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.5677777777777778, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0018537661712157757, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.387439636840234e-06, "un_batch_to_individual_items": 6.980923473079109e-05, "listify_data_for_vector_env": 0.00013298712121777978, "normalize_and_clip_actions": 0.0001827738435143039, "get_actions": 0.000764171113718921, "tensor_to_numpy": 0.00026014060960651133}}}, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.027122146678236e-05, "add_states_from_episodes_to_batch": 2.02240288537825e-05, "numpy_to_tensor": 0.00016172559524905018, "add_time_dim_to_batch_and_zero_pad": 3.3434135629524923e-05, "batch_individual_items": 0.00011228096874939417}}, "connector_pipeline_timer": 0.0007365076623223018}, "episode_return_max": 0.18644444444444436, "episode_duration_sec_mean": 23.362421000192697, "num_episodes_lifetime": 40, "rlmodule_inference_timer": 0.0006104587885690099, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.005860042735042709, "env_to_module_sum_episodes_length_out": 91.91104927924896, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11264619672855847, "num_env_steps_sampled_lifetime": 10000, "weights_seq_no": 4.0, "agent_episode_returns_mean": {"default_agent": 0.005860042735042709}, "module_episode_returns_mean": {"default_policy": 0.005860042735042709}, "num_env_steps_sampled": 2000, "sample": 30.64370093039483, "env_to_module_sum_episodes_length_in": 91.91104927924896, "time_between_sampling": 12.886142919625293, "num_env_steps_sampled_lifetime_throughput": 50.20526180429436}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07306148111820221, "weights_seq_no": 5.0, "vf_loss_unclipped": 0.000903530977666378, "total_loss": -0.06859694421291351, "gradients_default_optimizer_global_norm": 0.265802264213562, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1321645975112915, "entropy": 0.9026750326156616, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.01780499517917633, "num_module_steps_trained_lifetime": 302720, "vf_loss": 0.000903530977666378}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04371659000658834, "add_observations_from_episodes_to_batch": 0.0003568477632670856, "add_one_ts_to_episodes_and_truncate": 0.007426299880161975, "add_columns_from_episodes_to_train_batch": 0.07877500781988848, "general_advantage_estimation": 0.13713979418082223, "add_states_from_episodes_to_batch": 1.1003764955678337e-05, "numpy_to_tensor": 0.0013259188475886125, "add_time_dim_to_batch_and_zero_pad": 3.07091496914238e-05}}, "connector_pipeline_timer": 0.2693903227796493}, "num_module_steps_trained_lifetime": 302720, "learner_connector_sum_episodes_length_out": 2016.0, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 4767840, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.20526180429436, "done": false, "training_iteration": 5, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-57-52", "timestamp": 1747691872, "time_this_iter_s": 39.766754150390625, "time_total_s": 202.14841866493225, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 202.14841866493225, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 75.3280701754386, "ram_util_percent": 50.64035087719298}}
{"timers": {"training_iteration": 43.23154717882972, "restore_env_runners": 2.864836886907912e-05, "training_step": 43.23110982744714, "env_runner_sampling_timer": 32.265259491570546, "learner_update_timer": 10.948119734084825, "synch_weights": 0.016904499660175414, "synch_env_connectors": 0.009104658697762698}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.05866666666666664, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0018266208954280786, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.317121363923643e-06, "un_batch_to_individual_items": 6.93722936590896e-05, "listify_data_for_vector_env": 0.00013248824335006096, "normalize_and_clip_actions": 0.00017782512953825463, "get_actions": 0.0007567379476665055, "tensor_to_numpy": 0.00025750338967792363}}}, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0186989907566783e-05, "add_states_from_episodes_to_batch": 2.090885671791069e-05, "numpy_to_tensor": 0.00016144641619465872, "add_time_dim_to_batch_and_zero_pad": 3.359706071386286e-05, "batch_individual_items": 0.0001104315295768926}}, "connector_pipeline_timer": 0.000724068922887993}, "episode_return_max": 0.18644444444444436, "episode_duration_sec_mean": 22.854592823152135, "num_episodes_lifetime": 48, "rlmodule_inference_timer": 0.0006018666740073346, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.05070619658119657, "env_to_module_sum_episodes_length_out": 94.6176970596285, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11141733772456255, "num_env_steps_sampled_lifetime": 12000, "weights_seq_no": 5.0, "agent_episode_returns_mean": {"default_agent": 0.05070619658119657}, "module_episode_returns_mean": {"default_policy": 0.05070619658119657}, "num_env_steps_sampled": 2000, "sample": 30.636942577233473, "env_to_module_sum_episodes_length_in": 94.6176970596285, "time_between_sampling": 12.881329243398913, "num_env_steps_sampled_lifetime_throughput": 50.47624784537668}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.042957428842782974, "weights_seq_no": 6.0, "vf_loss_unclipped": 0.002498141024261713, "total_loss": 0.04782131686806679, "gradients_default_optimizer_global_norm": 0.19245192408561707, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10641568899154663, "entropy": 0.8401573896408081, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.011828672140836716, "num_module_steps_trained_lifetime": 363264, "vf_loss": 0.002498141024261713}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.043732976304938484, "add_observations_from_episodes_to_batch": 0.0003568523096342655, "add_one_ts_to_episodes_and_truncate": 0.007425915235934868, "add_columns_from_episodes_to_train_batch": 0.07877840340976466, "general_advantage_estimation": 0.13707897904183136, "add_states_from_episodes_to_batch": 1.1004659136491217e-05, "numpy_to_tensor": 0.0013258793276396223, "add_time_dim_to_batch_and_zero_pad": 3.071116521460995e-05}}, "connector_pipeline_timer": 0.2693488337599113}, "num_module_steps_trained_lifetime": 363264, "learner_connector_sum_episodes_length_out": 2016.0, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 5721408, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.47624784537668, "done": false, "training_iteration": 6, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-58-31", "timestamp": 1747691911, "time_this_iter_s": 39.55586624145508, "time_total_s": 241.70428490638733, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 241.70428490638733, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 75.76071428571427, "ram_util_percent": 50.63035714285714}}
{"timers": {"training_iteration": 43.21042931562139, "restore_env_runners": 2.8658885186345998e-05, "training_step": 43.20999014775265, "env_runner_sampling_timer": 32.259911292874826, "learner_update_timer": 10.932441447104004, "synch_weights": 0.016808165663603474, "synch_env_connectors": 0.009098791120769202}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.048888888888888926, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0018058113976110815, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.749287033637197e-06, "un_batch_to_individual_items": 6.945585243241111e-05, "listify_data_for_vector_env": 0.00013202489563669893, "normalize_and_clip_actions": 0.00017332363548459948, "get_actions": 0.000752877414893473, "tensor_to_numpy": 0.00025444678964120867}}}, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.004063054135987e-05, "add_states_from_episodes_to_batch": 2.091999690881936e-05, "numpy_to_tensor": 0.00016084184188179456, "add_time_dim_to_batch_and_zero_pad": 3.355393660119972e-05, "batch_individual_items": 0.00010891987955514011}}, "connector_pipeline_timer": 0.0007126166780599126}, "episode_return_max": 0.35288888888888936, "episode_duration_sec_mean": 22.245989599183442, "num_episodes_lifetime": 64, "rlmodule_inference_timer": 0.0005962356834351151, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.2145940170940172, "env_to_module_sum_episodes_length_out": 96.14056668820784, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11168925285730327, "num_env_steps_sampled_lifetime": 14000, "weights_seq_no": 6.0, "agent_episode_returns_mean": {"default_agent": 0.2145940170940172}, "module_episode_returns_mean": {"default_policy": 0.2145940170940172}, "num_env_steps_sampled": 2000, "sample": 30.63057876862498, "env_to_module_sum_episodes_length_in": 96.14056668820784, "time_between_sampling": 12.875792789819187, "num_env_steps_sampled_lifetime_throughput": 48.479910497455236}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05256439000368118, "weights_seq_no": 7.0, "vf_loss_unclipped": 0.003631558269262314, "total_loss": 0.05794759839773178, "gradients_default_optimizer_global_norm": 0.2851298749446869, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10985380411148071, "entropy": 0.8748543858528137, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00875820778310299, "num_module_steps_trained_lifetime": 424064, "vf_loss": 0.003631558269262314}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.043748964946821255, "add_observations_from_episodes_to_batch": 0.00035687130019777894, "add_one_ts_to_episodes_and_truncate": 0.007425443464403844, "add_columns_from_episodes_to_train_batch": 0.07878154765446134, "general_advantage_estimation": 0.13700659069590232, "add_states_from_episodes_to_batch": 1.1005445056879358e-05, "numpy_to_tensor": 0.0013258228061047463, "add_time_dim_to_batch_and_zero_pad": 3.07133895121775e-05}}, "connector_pipeline_timer": 0.26929500601348977}, "num_module_steps_trained_lifetime": 424064, "learner_connector_sum_episodes_length_out": 2016.0008, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 6682808, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.479910497455236, "done": false, "training_iteration": 7, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-59-12", "timestamp": 1747691952, "time_this_iter_s": 41.13783407211304, "time_total_s": 282.84211897850037, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 282.84211897850037, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 76.87966101694914, "ram_util_percent": 50.66271186440679}}
{"timers": {"training_iteration": 43.18117392874515, "restore_env_runners": 2.867329637089818e-05, "training_step": 43.1807331805551, "env_runner_sampling_timer": 32.24640532922609, "learner_update_timer": 10.916791752642986, "synch_weights": 0.016704705996917396, "synch_env_connectors": 0.009086790209576841}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.02277777777777776, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017944440324284667, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.68741834492428e-06, "un_batch_to_individual_items": 6.95739469361922e-05, "listify_data_for_vector_env": 0.0001341990326740662, "normalize_and_clip_actions": 0.00016984595453994715, "get_actions": 0.0007521436272651863, "tensor_to_numpy": 0.0002528219421388962}}}, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.096524587617748e-05, "add_states_from_episodes_to_batch": 2.1315195660700144e-05, "numpy_to_tensor": 0.00016100529098334298, "add_time_dim_to_batch_and_zero_pad": 3.3402240325252845e-05, "batch_individual_items": 0.00010817502224445988}}, "connector_pipeline_timer": 0.000705797670407606}, "episode_return_max": 0.35288888888888936, "episode_duration_sec_mean": 23.19572949077925, "num_episodes_lifetime": 72, "rlmodule_inference_timer": 0.0005944383685797537, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.21249893162393169, "env_to_module_sum_episodes_length_out": 95.20888514806694, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11190464234517362, "num_env_steps_sampled_lifetime": 16000, "weights_seq_no": 7.0, "agent_episode_returns_mean": {"default_agent": 0.21249893162393169}, "module_episode_returns_mean": {"default_policy": 0.21249893162393169}, "num_env_steps_sampled": 2000, "sample": 30.624039842520073, "env_to_module_sum_episodes_length_in": 95.20888514806694, "time_between_sampling": 12.86913771873098, "num_env_steps_sampled_lifetime_throughput": 49.547623474065794}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.025927340611815453, "weights_seq_no": 8.0, "vf_loss_unclipped": 0.0036431574262678623, "total_loss": -0.01955568417906761, "gradients_default_optimizer_global_norm": 0.15463964641094208, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0535888671875, "entropy": 0.9074720740318298, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.013642503879964352, "num_module_steps_trained_lifetime": 484608, "vf_loss": 0.0036431574262678623}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04376444425833629, "add_observations_from_episodes_to_batch": 0.00035689209571929163, "add_one_ts_to_episodes_and_truncate": 0.0074247710967794015, "add_columns_from_episodes_to_train_batch": 0.07878451481402327, "general_advantage_estimation": 0.13692260175898716, "add_states_from_episodes_to_batch": 1.1006124793360767e-05, "numpy_to_tensor": 0.001325765737067811, "add_time_dim_to_batch_and_zero_pad": 3.0715308207568686e-05}}, "connector_pipeline_timer": 0.2692286723188203}, "num_module_steps_trained_lifetime": 484608, "learner_connector_sum_episodes_length_out": 2016.0015839999999, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 7636376, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.547623474065794, "done": false, "training_iteration": 8, "trial_id": "c3e2f_00000", "date": "2025-05-20_07-59-53", "timestamp": 1747691993, "time_this_iter_s": 40.30340385437012, "time_total_s": 323.1455228328705, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 323.1455228328705, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 77.47543859649123, "ram_util_percent": 50.54736842105264}}
{"timers": {"training_iteration": 43.150469468317695, "restore_env_runners": 2.8628563430907193e-05, "training_step": 43.15002771760954, "env_runner_sampling_timer": 32.2268998537038, "learner_update_timer": 10.905619208206573, "synch_weights": 0.01667569093690713, "synch_env_connectors": 0.009090899307525381}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.02277777777777776, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017759370496225168, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.612443735504997e-06, "un_batch_to_individual_items": 7.042264376297824e-05, "listify_data_for_vector_env": 0.00013416032432147693, "normalize_and_clip_actions": 0.00016543309360733644, "get_actions": 0.0007464099514352964, "tensor_to_numpy": 0.0002497934008055028}}}, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.134285827093151e-05, "add_states_from_episodes_to_batch": 2.141185774657306e-05, "numpy_to_tensor": 0.00016039520783486425, "add_time_dim_to_batch_and_zero_pad": 3.395709494514825e-05, "batch_individual_items": 0.00010741414857877427}}, "connector_pipeline_timer": 0.0006972012984474219}, "episode_return_max": 0.3240000000000001, "episode_duration_sec_mean": 23.434898553519815, "num_episodes_lifetime": 80, "rlmodule_inference_timer": 0.0005896457657281233, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.16006944444444454, "env_to_module_sum_episodes_length_out": 93.27697707852006, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11149687207210404, "num_env_steps_sampled_lifetime": 18000, "weights_seq_no": 8.0, "agent_episode_returns_mean": {"default_agent": 0.16006944444444454}, "module_episode_returns_mean": {"default_policy": 0.16006944444444454}, "num_env_steps_sampled": 2000, "sample": 30.616502738051416, "env_to_module_sum_episodes_length_in": 93.27697707852006, "time_between_sampling": 12.861365983947717, "num_env_steps_sampled_lifetime_throughput": 49.75396727489407}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.08793844282627106, "weights_seq_no": 9.0, "vf_loss_unclipped": 0.0016418066807091236, "total_loss": 0.09061848372220993, "gradients_default_optimizer_global_norm": 0.20717120170593262, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09425395727157593, "entropy": 0.8956577181816101, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0051911319606006145, "num_module_steps_trained_lifetime": 545152, "vf_loss": 0.0016418066807091236}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04377931744632684, "add_observations_from_episodes_to_batch": 0.00035690942820005363, "add_one_ts_to_episodes_and_truncate": 0.007423879092061067, "add_columns_from_episodes_to_train_batch": 0.0787874868540287, "general_advantage_estimation": 0.13682789062144096, "add_states_from_episodes_to_batch": 1.1006740390598526e-05, "numpy_to_tensor": 0.001325677577131143, "add_time_dim_to_batch_and_zero_pad": 3.0717017190354985e-05}}, "connector_pipeline_timer": 0.2691507317246426}, "num_module_steps_trained_lifetime": 545152, "learner_connector_sum_episodes_length_out": 2016.00235224, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 8589944, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.75396727489407, "done": false, "training_iteration": 9, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-00-33", "timestamp": 1747692033, "time_this_iter_s": 40.128418922424316, "time_total_s": 363.2739417552948, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 363.2739417552948, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 75.43684210526317, "ram_util_percent": 50.608771929824556}}
{"timers": {"training_iteration": 43.14000661996449, "restore_env_runners": 2.8567277836388878e-05, "training_step": 43.13956433776342, "env_runner_sampling_timer": 32.219666619336785, "learner_update_timer": 10.902433869294489, "synch_weights": 0.016630529017588713, "synch_env_connectors": 0.009110353304467292}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.005000000000000022, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017684877704266877, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.4536041308438e-06, "un_batch_to_individual_items": 7.076241142653065e-05, "listify_data_for_vector_env": 0.000135554850743417, "normalize_and_clip_actions": 0.00016278066408678517, "get_actions": 0.0007461106189267174, "tensor_to_numpy": 0.0002497841886366108}}}, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.290138588591371e-05, "add_states_from_episodes_to_batch": 2.110843914127336e-05, "numpy_to_tensor": 0.00015957545375216436, "add_time_dim_to_batch_and_zero_pad": 3.485985613849815e-05, "batch_individual_items": 0.00010643425601494539}}, "connector_pipeline_timer": 0.0006912562991099069}, "episode_return_max": 0.25911111111111146, "episode_duration_sec_mean": 22.79507178494252, "num_episodes_lifetime": 88, "rlmodule_inference_timer": 0.0005860215714395721, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.10368269230769232, "env_to_module_sum_episodes_length_out": 91.84458856570119, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1111552200490403, "num_env_steps_sampled_lifetime": 20000, "weights_seq_no": 9.0, "agent_episode_returns_mean": {"default_agent": 0.10368269230769232}, "module_episode_returns_mean": {"default_policy": 0.10368269230769232}, "num_env_steps_sampled": 2000, "sample": 30.608663217325375, "env_to_module_sum_episodes_length_in": 91.84458856570119, "time_between_sampling": 12.853284663398817, "num_env_steps_sampled_lifetime_throughput": 47.41119150209051}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.026747506111860275, "weights_seq_no": 10.0, "vf_loss_unclipped": 0.00152115267701447, "total_loss": -0.022254690527915955, "gradients_default_optimizer_global_norm": 0.5045748353004456, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06609439849853516, "entropy": 0.881385326385498, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.014858352951705456, "num_module_steps_trained_lifetime": 605696, "vf_loss": 0.00152115267701447}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04379390385593206, "add_observations_from_episodes_to_batch": 0.0003569244948219286, "add_one_ts_to_episodes_and_truncate": 0.007422796720327628, "add_columns_from_episodes_to_train_batch": 0.07879107202135231, "general_advantage_estimation": 0.1367224432964702, "add_states_from_episodes_to_batch": 1.100737306328542e-05, "numpy_to_tensor": 0.0013255551638198851, "add_time_dim_to_batch_and_zero_pad": 3.0718570463299686e-05}}, "connector_pipeline_timer": 0.26906212577451705}, "num_module_steps_trained_lifetime": 605696, "learner_connector_sum_episodes_length_out": 2016.0031049568, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 9543512, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.41119150209051, "done": false, "training_iteration": 10, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-01-15", "timestamp": 1747692075, "time_this_iter_s": 42.12192893028259, "time_total_s": 405.3958706855774, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 405.3958706855774, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 73.82500000000002, "ram_util_percent": 50.60999999999999}}
{"timers": {"training_iteration": 43.14706165870485, "restore_env_runners": 2.8603605036066265e-05, "training_step": 43.14661906432575, "env_runner_sampling_timer": 32.23977311795342, "learner_update_timer": 10.88948019572153, "synch_weights": 0.016530792737354128, "synch_env_connectors": 0.00911853576142239}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": -0.005000000000000022, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001762770583098567, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.585775956505491e-06, "un_batch_to_individual_items": 7.096208155535146e-05, "listify_data_for_vector_env": 0.0001375721106277872, "normalize_and_clip_actions": 0.00015909056939243898, "get_actions": 0.0007468627525992842, "tensor_to_numpy": 0.0002492269858389828}}}, "num_module_steps_sampled_lifetime": {"default_policy": 22000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 22000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.299139565643043e-05, "add_states_from_episodes_to_batch": 2.1025256570368124e-05, "numpy_to_tensor": 0.0001605078256838745, "add_time_dim_to_batch_and_zero_pad": 3.4970909382346904e-05, "batch_individual_items": 0.00010571488416273325}}, "connector_pipeline_timer": 0.0006875071290376728}, "episode_return_max": 0.33533333333333354, "episode_duration_sec_mean": 24.268728052278746, "num_episodes_lifetime": 96, "rlmodule_inference_timer": 0.0005852771439392694, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.17462713675213676, "env_to_module_sum_episodes_length_out": 91.83773361341106, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11091341066546988, "num_env_steps_sampled_lifetime": 22000, "weights_seq_no": 10.0, "agent_episode_returns_mean": {"default_agent": 0.17462713675213676}, "module_episode_returns_mean": {"default_policy": 0.17462713675213676}, "num_env_steps_sampled": 2000, "sample": 30.602181565447417, "env_to_module_sum_episodes_length_in": 91.83773361341106, "time_between_sampling": 12.845998922995213, "num_env_steps_sampled_lifetime_throughput": 45.35004187553095}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.04364713653922081, "weights_seq_no": 11.0, "vf_loss_unclipped": 0.0034670948516577482, "total_loss": 0.047995101660490036, "gradients_default_optimizer_global_norm": 0.11977558583021164, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.03386944532394409, "entropy": 0.8322423100471497, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004404340870678425, "num_module_steps_trained_lifetime": 666240, "vf_loss": 0.0034670948516577482}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04380798173560083, "add_observations_from_episodes_to_batch": 0.00035693930916856723, "add_one_ts_to_episodes_and_truncate": 0.007421758948120014, "add_columns_from_episodes_to_train_batch": 0.07879519585684415, "general_advantage_estimation": 0.13660635406903643, "add_states_from_episodes_to_batch": 1.100799240812431e-05, "numpy_to_tensor": 0.0013254681010169138, "add_time_dim_to_batch_and_zero_pad": 3.072434096877967e-05}}, "connector_pipeline_timer": 0.2689629842305214}, "num_module_steps_trained_lifetime": 666240, "learner_connector_sum_episodes_length_out": 2016.00384238404, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 10497080, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.35004187553095, "done": false, "training_iteration": 11, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-01-59", "timestamp": 1747692119, "time_this_iter_s": 43.86527967453003, "time_total_s": 449.2611503601074, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 449.2611503601074, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 75.71129032258064, "ram_util_percent": 50.638709677419335}}
{"timers": {"training_iteration": 43.11306707100781, "restore_env_runners": 2.855756892143503e-05, "training_step": 43.11262343157254, "env_runner_sampling_timer": 32.22428845551384, "learner_update_timer": 10.870998695914361, "synch_weights": 0.016500541809987366, "synch_env_connectors": 0.00912121741380856}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.07877777777777775, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001746870665816854, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.596087293758588e-06, "un_batch_to_individual_items": 7.072155621021057e-05, "listify_data_for_vector_env": 0.00013675049402447746, "normalize_and_clip_actions": 0.00015588784286338722, "get_actions": 0.0007431342322576677, "tensor_to_numpy": 0.00024751195254234975}}}, "num_module_steps_sampled_lifetime": {"default_policy": 24000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 24000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.279108986423073e-05, "add_states_from_episodes_to_batch": 2.0788983970952957e-05, "numpy_to_tensor": 0.0001606329186278823, "add_time_dim_to_batch_and_zero_pad": 3.5334611804559844e-05, "batch_individual_items": 0.00010583206759122919}}, "connector_pipeline_timer": 0.000684651145842439}, "episode_return_max": 0.3772222222222222, "episode_duration_sec_mean": 24.247576226499824, "num_episodes_lifetime": 104, "rlmodule_inference_timer": 0.0005844790003596102, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.2684102564102564, "env_to_module_sum_episodes_length_out": 93.7653292410754, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1100203153683545, "num_env_steps_sampled_lifetime": 24000, "weights_seq_no": 11.0, "agent_episode_returns_mean": {"default_agent": 0.2684102564102564}, "module_episode_returns_mean": {"default_policy": 0.2684102564102564}, "num_env_steps_sampled": 2000, "sample": 30.594848052334836, "env_to_module_sum_episodes_length_in": 93.7653292410754, "time_between_sampling": 12.839038650392586, "num_env_steps_sampled_lifetime_throughput": 50.19831950483014}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.025200074538588524, "weights_seq_no": 12.0, "vf_loss_unclipped": 0.0029109399765729904, "total_loss": 0.029440797865390778, "gradients_default_optimizer_global_norm": 0.13962925970554352, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.033756136894226074, "entropy": 0.7767326831817627, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.013297799043357372, "num_module_steps_trained_lifetime": 726784, "vf_loss": 0.0029109399765729904}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.043821425677390884, "add_observations_from_episodes_to_batch": 0.0003569489547784561, "add_one_ts_to_episodes_and_truncate": 0.00742051882168398, "add_columns_from_episodes_to_train_batch": 0.07879902497842398, "general_advantage_estimation": 0.1364795359118213, "add_states_from_episodes_to_batch": 1.1009048628921027e-05, "numpy_to_tensor": 0.0013253744839531946, "add_time_dim_to_batch_and_zero_pad": 3.073064420705341e-05}}, "connector_pipeline_timer": 0.26885194683492775}, "num_module_steps_trained_lifetime": 726784, "learner_connector_sum_episodes_length_out": 2016.0045647522393, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 11450648, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.19831950483014, "done": false, "training_iteration": 12, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-02-39", "timestamp": 1747692159, "time_this_iter_s": 39.79313778877258, "time_total_s": 489.05428814888, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 489.05428814888, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 75.60000000000001, "ram_util_percent": 50.663157894736834}}
{"timers": {"training_iteration": 43.11493978646769, "restore_env_runners": 2.8532993255094892e-05, "training_step": 43.11449486242678, "env_runner_sampling_timer": 32.234962076418725, "learner_update_timer": 10.862310261665169, "synch_weights": 0.016383887391892407, "synch_env_connectors": 0.009289660239715787}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.08033333333333326, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017400716019279805, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.728851556504825e-06, "un_batch_to_individual_items": 7.061787357738807e-05, "listify_data_for_vector_env": 0.00013761221739081093, "normalize_and_clip_actions": 0.00015302548186054874, "get_actions": 0.0007417803272894261, "tensor_to_numpy": 0.0002459948251035898}}}, "num_module_steps_sampled_lifetime": {"default_policy": 26000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 26000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.274657233520457e-05, "add_states_from_episodes_to_batch": 2.0502126987107473e-05, "numpy_to_tensor": 0.00016234634842958906, "add_time_dim_to_batch_and_zero_pad": 3.522001977623281e-05, "batch_individual_items": 0.00010589727972571092}}, "connector_pipeline_timer": 0.0006817297963316409}, "episode_return_max": 0.467333333333333, "episode_duration_sec_mean": 23.027444711817505, "num_episodes_lifetime": 120, "rlmodule_inference_timer": 0.0005837579545850917, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.24967307692307697, "env_to_module_sum_episodes_length_out": 96.17526445655238, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11090978152249455, "num_env_steps_sampled_lifetime": 26000, "weights_seq_no": 12.0, "agent_episode_returns_mean": {"default_agent": 0.24967307692307697}, "module_episode_returns_mean": {"default_policy": 0.24967307692307697}, "num_env_steps_sampled": 2000, "sample": 30.58866810689287, "env_to_module_sum_episodes_length_in": 96.17526445655238, "time_between_sampling": 12.831328608618069, "num_env_steps_sampled_lifetime_throughput": 46.06373105527918}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07922179251909256, "weights_seq_no": 13.0, "vf_loss_unclipped": 0.004521663766354322, "total_loss": 0.08477451652288437, "gradients_default_optimizer_global_norm": 0.39615529775619507, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04785388708114624, "entropy": 0.8524656295776367, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.010310732759535313, "num_module_steps_trained_lifetime": 787584, "vf_loss": 0.004521663766354322}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04383487539217128, "add_observations_from_episodes_to_batch": 0.00035697184354534624, "add_one_ts_to_episodes_and_truncate": 0.007419173121881607, "add_columns_from_episodes_to_train_batch": 0.0788029660481869, "general_advantage_estimation": 0.13634279172234348, "add_states_from_episodes_to_batch": 1.1010012925900372e-05, "numpy_to_tensor": 0.001325280712420596, "add_time_dim_to_batch_and_zero_pad": 3.0736768946905104e-05}}, "connector_pipeline_timer": 0.26873098489902325}, "num_module_steps_trained_lifetime": 787584, "learner_connector_sum_episodes_length_out": 2016.0060722888365, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 12412048, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.06373105527918, "done": false, "training_iteration": 13, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-03-23", "timestamp": 1747692203, "time_this_iter_s": 43.318119287490845, "time_total_s": 532.3724074363708, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 532.3724074363708, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 76.54590163934427, "ram_util_percent": 50.61639344262295}}
{"timers": {"training_iteration": 43.09530157585301, "restore_env_runners": 2.8466663316647738e-05, "training_step": 43.0948564640525, "env_runner_sampling_timer": 32.224835070544515, "learner_update_timer": 10.852905944408505, "synch_weights": 0.016275217518016437, "synch_env_connectors": 0.009271656647342145}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.08033333333333326, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017351177815105874, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.967439589214009e-06, "un_batch_to_individual_items": 7.032023605933783e-05, "listify_data_for_vector_env": 0.00013895278680775704, "normalize_and_clip_actions": 0.00015137851298552138, "get_actions": 0.0007431658421914251, "tensor_to_numpy": 0.00024497219201161926}}}, "num_module_steps_sampled_lifetime": {"default_policy": 28000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 28000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2555290253428275e-05, "add_states_from_episodes_to_batch": 2.0367418250347997e-05, "numpy_to_tensor": 0.00016183884254761897, "add_time_dim_to_batch_and_zero_pad": 3.595598091967762e-05, "batch_individual_items": 0.00010508514936837359}}, "connector_pipeline_timer": 0.0006760359658113167}, "episode_return_max": 0.5105555555555559, "episode_duration_sec_mean": 23.798972397452697, "num_episodes_lifetime": 128, "rlmodule_inference_timer": 0.0005840992540661729, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.2518322649572649, "env_to_module_sum_episodes_length_out": 96.05841105247367, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11120078773363529, "num_env_steps_sampled_lifetime": 28000, "weights_seq_no": 13.0, "agent_episode_returns_mean": {"default_agent": 0.2518322649572649}, "module_episode_returns_mean": {"default_policy": 0.2518322649572649}, "num_env_steps_sampled": 2000, "sample": 30.582143303074808, "env_to_module_sum_episodes_length_in": 96.05841105247367, "time_between_sampling": 12.823725873754697, "num_env_steps_sampled_lifetime_throughput": 48.51473293228675}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.11308837682008743, "weights_seq_no": 14.0, "vf_loss_unclipped": 0.006282440386712551, "total_loss": -0.10499688982963562, "gradients_default_optimizer_global_norm": 0.3608284294605255, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.03912538290023804, "entropy": 0.7480086088180542, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.018090475350618362, "num_module_steps_trained_lifetime": 848128, "vf_loss": 0.006282440386712551}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04386459359968799, "add_observations_from_episodes_to_batch": 0.0003569905196416106, "add_one_ts_to_episodes_and_truncate": 0.007417780084193632, "add_columns_from_episodes_to_train_batch": 0.07880703635395687, "general_advantage_estimation": 0.13619590771306425, "add_states_from_episodes_to_batch": 1.1010967032525772e-05, "numpy_to_tensor": 0.0013251567388705028, "add_time_dim_to_batch_and_zero_pad": 3.07427481274802e-05}}, "connector_pipeline_timer": 0.2686161850466535}, "num_module_steps_trained_lifetime": 848128, "learner_connector_sum_episodes_length_out": 2016.0075492182266, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 13365616, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.51473293228675, "done": false, "training_iteration": 14, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-04-04", "timestamp": 1747692244, "time_this_iter_s": 41.16920328140259, "time_total_s": 573.5416107177734, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 573.5416107177734, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 74.7728813559322, "ram_util_percent": 50.61186440677966}}
{"timers": {"training_iteration": 43.06775010043446, "restore_env_runners": 2.8460996697897205e-05, "training_step": 43.06730320375198, "env_runner_sampling_timer": 32.21284826129905, "learner_update_timer": 10.837452211844408, "synch_weights": 0.01616139434280403, "synch_env_connectors": 0.009258799080902772}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.06711111111111098, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001739013408442534, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.410128366451481e-06, "un_batch_to_individual_items": 6.999447371515256e-05, "listify_data_for_vector_env": 0.00013943125711811285, "normalize_and_clip_actions": 0.0001496666658439116, "get_actions": 0.0007514608683211604, "tensor_to_numpy": 0.00024418988223001833}}}, "num_module_steps_sampled_lifetime": {"default_policy": 30000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 30000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2215072119119794e-05, "add_states_from_episodes_to_batch": 2.031156787104965e-05, "numpy_to_tensor": 0.00016241979614986754, "add_time_dim_to_batch_and_zero_pad": 3.648190697822061e-05, "batch_individual_items": 0.00010694425144493845}}, "connector_pipeline_timer": 0.0006747907748786066}, "episode_return_max": 0.5105555555555559, "episode_duration_sec_mean": 23.5461162137212, "num_episodes_lifetime": 136, "rlmodule_inference_timer": 0.0005872850142570831, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.2331282051282052, "env_to_module_sum_episodes_length_out": 94.25729412036287, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1116938867623767, "num_env_steps_sampled_lifetime": 30000, "weights_seq_no": 14.0, "agent_episode_returns_mean": {"default_agent": 0.2331282051282052}, "module_episode_returns_mean": {"default_policy": 0.2331282051282052}, "num_env_steps_sampled": 2000, "sample": 30.575757991419124, "env_to_module_sum_episodes_length_in": 94.25729412036287, "time_between_sampling": 12.815971472881843, "num_env_steps_sampled_lifetime_throughput": 49.486196899647474}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.051249101758003235, "weights_seq_no": 15.0, "vf_loss_unclipped": 0.001835700124502182, "total_loss": 0.05364584922790527, "gradients_default_optimizer_global_norm": 0.27885469794273376, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.02631741762161255, "entropy": 0.7391533255577087, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005610429681837559, "num_module_steps_trained_lifetime": 908672, "vf_loss": 0.001835700124502182}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04389382609481484, "add_observations_from_episodes_to_batch": 0.0003570055450318021, "add_one_ts_to_episodes_and_truncate": 0.007416319569847287, "add_columns_from_episodes_to_train_batch": 0.07881153956560669, "general_advantage_estimation": 0.13603931171469813, "add_states_from_episodes_to_batch": 1.1012161055167848e-05, "numpy_to_tensor": 0.00132512366662071, "add_time_dim_to_batch_and_zero_pad": 3.074950404721961e-05}}, "connector_pipeline_timer": 0.26849163985044133}, "num_module_steps_trained_lifetime": 908672, "learner_connector_sum_episodes_length_out": 2016.0089960017997, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 14319184, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.486196899647474, "done": false, "training_iteration": 15, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-04-44", "timestamp": 1747692284, "time_this_iter_s": 40.35717582702637, "time_total_s": 613.8987865447998, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 613.8987865447998, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 78.22631578947367, "ram_util_percent": 50.61052631578947}}
{"timers": {"training_iteration": 43.03033089733007, "restore_env_runners": 2.84223867850942e-05, "training_step": 43.0298831476145, "env_runner_sampling_timer": 32.19070292680607, "learner_update_timer": 10.822256229495979, "synch_weights": 0.01608102540938165, "synch_env_connectors": 0.009237775090048122}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.06711111111111098, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017260665894741514, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.25820965070347e-06, "un_batch_to_individual_items": 6.950863471817008e-05, "listify_data_for_vector_env": 0.0001401241048394763, "normalize_and_clip_actions": 0.0001473670932336471, "get_actions": 0.0007467411468098543, "tensor_to_numpy": 0.00024334233101022513}}}, "num_module_steps_sampled_lifetime": {"default_policy": 32000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 32000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.200595116031696e-05, "add_states_from_episodes_to_batch": 2.0198514910214586e-05, "numpy_to_tensor": 0.0001619207004164031, "add_time_dim_to_batch_and_zero_pad": 3.639618394251934e-05, "batch_individual_items": 0.00010606433750198692}}, "connector_pipeline_timer": 0.0006683499515350712}, "episode_return_max": 0.44722222222222197, "episode_duration_sec_mean": 23.764966042557646, "num_episodes_lifetime": 144, "rlmodule_inference_timer": 0.0005845895730183477, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.22306944444444438, "env_to_module_sum_episodes_length_out": 92.49369475979925, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11109902249396027, "num_env_steps_sampled_lifetime": 32000, "weights_seq_no": 15.0, "agent_episode_returns_mean": {"default_agent": 0.22306944444444438}, "module_episode_returns_mean": {"default_policy": 0.22306944444444438}, "num_env_steps_sampled": 2000, "sample": 30.568325865038528, "env_to_module_sum_episodes_length_in": 92.49369475979925, "time_between_sampling": 12.807010064723029, "num_env_steps_sampled_lifetime_throughput": 50.75743622851295}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07449138164520264, "weights_seq_no": 16.0, "vf_loss_unclipped": 0.0025923424400389194, "total_loss": -0.07082574814558029, "gradients_default_optimizer_global_norm": 0.22391043603420258, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.01753920316696167, "entropy": 0.6815951466560364, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.010732819326221943, "num_module_steps_trained_lifetime": 969216, "vf_loss": 0.0025923424400389194}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.043922151380578665, "add_observations_from_episodes_to_batch": 0.00035701535086158634, "add_one_ts_to_episodes_and_truncate": 0.007414661387779138, "add_columns_from_episodes_to_train_batch": 0.07881561127918844, "general_advantage_estimation": 0.1358730371255282, "add_states_from_episodes_to_batch": 1.1013240100340915e-05, "numpy_to_tensor": 0.0013250585101421137, "add_time_dim_to_batch_and_zero_pad": 3.0755920573777214e-05}}, "connector_pipeline_timer": 0.268355818479349}, "num_module_steps_trained_lifetime": 969216, "learner_connector_sum_episodes_length_out": 2016.0104130947796, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 15272752, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.75743622851295, "done": false, "training_iteration": 16, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-05-24", "timestamp": 1747692324, "time_this_iter_s": 39.344346046447754, "time_total_s": 653.2431325912476, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 653.2431325912476, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 76.19642857142857, "ram_util_percent": 50.612500000000004}}
{"timers": {"training_iteration": 43.00150900433678, "restore_env_runners": 2.8376162910503278e-05, "training_step": 43.001059776118346, "env_runner_sampling_timer": 32.178040975158005, "learner_update_timer": 10.806200763561009, "synch_weights": 0.01597256215530676, "synch_env_connectors": 0.009243015339147424}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.14055555555555554, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017200207674454542, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.795075621254996e-06, "un_batch_to_individual_items": 6.94652074381043e-05, "listify_data_for_vector_env": 0.00013976876295668142, "normalize_and_clip_actions": 0.00014539689819048857, "get_actions": 0.0007455048772519456, "tensor_to_numpy": 0.00024275671027582883}}}, "num_module_steps_sampled_lifetime": {"default_policy": 34000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 34000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.263140653344311e-05, "add_states_from_episodes_to_batch": 2.0460334120744646e-05, "numpy_to_tensor": 0.00016245247565988843, "add_time_dim_to_batch_and_zero_pad": 3.6705478186615625e-05, "batch_individual_items": 0.00010541080884629853}}, "connector_pipeline_timer": 0.0006675553014718076}, "episode_return_max": 0.44722222222222197, "episode_duration_sec_mean": 23.123774779508985, "num_episodes_lifetime": 152, "rlmodule_inference_timer": 0.0005842328565367628, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.20826175213675208, "env_to_module_sum_episodes_length_out": 91.88701548554039, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11080950731571233, "num_env_steps_sampled_lifetime": 34000, "weights_seq_no": 16.0, "agent_episode_returns_mean": {"default_agent": 0.20826175213675208}, "module_episode_returns_mean": {"default_policy": 0.20826175213675208}, "num_env_steps_sampled": 2000, "sample": 30.56063039439415, "env_to_module_sum_episodes_length_in": 91.88701548554039, "time_between_sampling": 12.79738446266185, "num_env_steps_sampled_lifetime_throughput": 49.659664560475846}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.2081059217453003, "weights_seq_no": 17.0, "vf_loss_unclipped": 0.003678993321955204, "total_loss": -0.20357856154441833, "gradients_default_optimizer_global_norm": 0.26318415999412537, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0778418779373169, "entropy": 0.6282854080200195, "curr_kl_coeff": 0.10000000149011612, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.008483875542879105, "num_module_steps_trained_lifetime": 1029760, "vf_loss": 0.003678993321955204}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04394956038811789, "add_observations_from_episodes_to_batch": 0.0003570278400208177, "add_one_ts_to_episodes_and_truncate": 0.0074128091274952195, "add_columns_from_episodes_to_train_batch": 0.07881943879464176, "general_advantage_estimation": 0.13569735735697014, "add_states_from_episodes_to_batch": 1.101417634869125e-05, "numpy_to_tensor": 0.00132496021442594, "add_time_dim_to_batch_and_zero_pad": 3.0762263819221644e-05}}, "connector_pipeline_timer": 0.26820917997199356}, "num_module_steps_trained_lifetime": 1029760, "learner_connector_sum_episodes_length_out": 2016.0118009463, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 16226320, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.659664560475846, "done": false, "training_iteration": 17, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-06-04", "timestamp": 1747692364, "time_this_iter_s": 40.16405391693115, "time_total_s": 693.4071865081787, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 693.4071865081787, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 76.85263157894735, "ram_util_percent": 50.612280701754386}}
{"timers": {"training_iteration": 42.98071447652345, "restore_env_runners": 2.835040128142898e-05, "training_step": 42.980263828587226, "env_runner_sampling_timer": 32.17407476497641, "learner_update_timer": 10.789477022585421, "synch_weights": 0.015864779533752264, "synch_env_connectors": 0.009222262175802349}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.14055555555555554, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017155422083458176, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.759207763372135e-06, "un_batch_to_individual_items": 6.900601490256198e-05, "listify_data_for_vector_env": 0.000139053128137753, "normalize_and_clip_actions": 0.0001440558108247902, "get_actions": 0.0007458163936068502, "tensor_to_numpy": 0.00024198197214739882}}}, "num_module_steps_sampled_lifetime": {"default_policy": 36000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 36000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3084477991700016e-05, "add_states_from_episodes_to_batch": 2.0868568375924492e-05, "numpy_to_tensor": 0.0001647197452426535, "add_time_dim_to_batch_and_zero_pad": 3.753306376854712e-05, "batch_individual_items": 0.00010490919483114782}}, "connector_pipeline_timer": 0.0006672269855826726}, "episode_return_max": 0.4380000000000001, "episode_duration_sec_mean": 23.185982547288685, "num_episodes_lifetime": 160, "rlmodule_inference_timer": 0.0005825049063822275, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.26585683760683754, "env_to_module_sum_episodes_length_out": 93.07395359352216, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11082692475866626, "num_env_steps_sampled_lifetime": 36000, "weights_seq_no": 17.0, "agent_episode_returns_mean": {"default_agent": 0.26585683760683754}, "module_episode_returns_mean": {"default_policy": 0.26585683760683754}, "num_env_steps_sampled": 2000, "sample": 30.55336249141131, "env_to_module_sum_episodes_length_in": 93.07395359352216, "time_between_sampling": 12.787070344387947, "num_env_steps_sampled_lifetime_throughput": 48.78427141777722}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09485147893428802, "weights_seq_no": 18.0, "vf_loss_unclipped": 0.0019410350359976292, "total_loss": -0.09244555234909058, "gradients_default_optimizer_global_norm": 0.3051719665527344, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.01814889907836914, "entropy": 0.647987961769104, "curr_kl_coeff": 0.05000000074505806, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004648874048143625, "num_module_steps_trained_lifetime": 1090304, "vf_loss": 0.0019410350359976292}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04397643439036801, "add_observations_from_episodes_to_batch": 0.00035705080786170774, "add_one_ts_to_episodes_and_truncate": 0.007410810816278563, "add_columns_from_episodes_to_train_batch": 0.07882335012855772, "general_advantage_estimation": 0.13551238755007092, "add_states_from_episodes_to_batch": 1.1015012547827774e-05, "numpy_to_tensor": 0.0013248379587733588, "add_time_dim_to_batch_and_zero_pad": 3.076829460787782e-05}}, "connector_pipeline_timer": 0.268052623672837}, "num_module_steps_trained_lifetime": 1090304, "learner_connector_sum_episodes_length_out": 2016.0131599994802, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 17179888, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.78427141777722, "done": false, "training_iteration": 18, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-06-45", "timestamp": 1747692405, "time_this_iter_s": 40.938621044158936, "time_total_s": 734.3458075523376, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 734.3458075523376, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 77.52931034482759, "ram_util_percent": 50.61379310344827}}
{"timers": {"training_iteration": 42.94546195808821, "restore_env_runners": 2.8344897275416136e-05, "training_step": 42.94500932163137, "env_runner_sampling_timer": 32.152670642976666, "learner_update_timer": 10.775720352049593, "synch_weights": 0.01576898472842794, "synch_env_connectors": 0.009202368554003025}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.1044444444444444, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001705444819988215, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.556965540336428e-06, "un_batch_to_individual_items": 6.891745329878114e-05, "listify_data_for_vector_env": 0.00013824489580451147, "normalize_and_clip_actions": 0.00014228330641465696, "get_actions": 0.0007429555729932095, "tensor_to_numpy": 0.00024200916913534357}}}, "num_module_steps_sampled_lifetime": {"default_policy": 38000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 38000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.287736799860175e-05, "add_states_from_episodes_to_batch": 2.1001458728211186e-05, "numpy_to_tensor": 0.00016405727544658094, "add_time_dim_to_batch_and_zero_pad": 3.717631658363921e-05, "batch_individual_items": 0.00010433024303277034}}, "connector_pipeline_timer": 0.0006611313437317416}, "episode_return_max": 0.4380000000000001, "episode_duration_sec_mean": 23.713675234327358, "num_episodes_lifetime": 168, "rlmodule_inference_timer": 0.0005798939765219567, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.2560950854700855, "env_to_module_sum_episodes_length_out": 96.3759050960455, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10985934630419646, "num_env_steps_sampled_lifetime": 38000, "weights_seq_no": 18.0, "agent_episode_returns_mean": {"default_agent": 0.2560950854700855}, "module_episode_returns_mean": {"default_policy": 0.2560950854700855}, "num_env_steps_sampled": 2000, "sample": 30.545118747946024, "env_to_module_sum_episodes_length_in": 96.3759050960455, "time_between_sampling": 12.77607154191308, "num_env_steps_sampled_lifetime_throughput": 50.59066647862066}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.048029575496912, "weights_seq_no": 19.0, "vf_loss_unclipped": 0.0031445834320038557, "total_loss": 0.051364798098802567, "gradients_default_optimizer_global_norm": 0.21713873744010925, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.015838623046875, "entropy": 0.6571965217590332, "curr_kl_coeff": 0.02500000037252903, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0038129359018057585, "num_module_steps_trained_lifetime": 1150848, "vf_loss": 0.0031445834320038557}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04400276866653427, "add_observations_from_episodes_to_batch": 0.00035707988356204514, "add_one_ts_to_episodes_and_truncate": 0.007408790550373995, "add_columns_from_episodes_to_train_batch": 0.07882710974181593, "general_advantage_estimation": 0.13531844277357347, "add_states_from_episodes_to_batch": 1.1015760605186073e-05, "numpy_to_tensor": 0.0013247098122126553, "add_time_dim_to_batch_and_zero_pad": 3.0774198554472384e-05}}, "connector_pipeline_timer": 0.2678863682115666}, "num_module_steps_trained_lifetime": 1150848, "learner_connector_sum_episodes_length_out": 2016.0144906915023, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 18133456, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.59066647862066, "done": false, "training_iteration": 19, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-07-24", "timestamp": 1747692444, "time_this_iter_s": 39.472923040390015, "time_total_s": 773.8187305927277, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 773.8187305927277, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 76.03392857142856, "ram_util_percent": 50.69285714285713}}
{"timers": {"training_iteration": 42.98535282887729, "restore_env_runners": 2.8362448266318044e-05, "training_step": 42.98489852278505, "env_runner_sampling_timer": 32.20795604841692, "learner_update_timer": 10.760412363029108, "synch_weights": 0.015677108881115967, "synch_env_connectors": 0.009185373868462625}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.17077777777777797, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017105865077667597, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.517455176322287e-06, "un_batch_to_individual_items": 6.99400762479334e-05, "listify_data_for_vector_env": 0.0001382520074436358, "normalize_and_clip_actions": 0.00014102126172767105, "get_actions": 0.0007474287746914571, "tensor_to_numpy": 0.0002449499252512829}}}, "num_module_steps_sampled_lifetime": {"default_policy": 40000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 40000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.291543009671259e-05, "add_states_from_episodes_to_batch": 2.2051833464081113e-05, "numpy_to_tensor": 0.00016344864954879245, "add_time_dim_to_batch_and_zero_pad": 3.74327860700464e-05, "batch_individual_items": 0.00010484134220421041}}, "connector_pipeline_timer": 0.0006617052851652904}, "episode_return_max": 0.5940000000000015, "episode_duration_sec_mean": 25.343371814057438, "num_episodes_lifetime": 184, "rlmodule_inference_timer": 0.0005848911865472278, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.3847329059829062, "env_to_module_sum_episodes_length_out": 97.24655369937295, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1112624360144492, "num_env_steps_sampled_lifetime": 40000, "weights_seq_no": 19.0, "agent_episode_returns_mean": {"default_agent": 0.3847329059829062}, "module_episode_returns_mean": {"default_policy": 0.3847329059829062}, "num_env_steps_sampled": 2000, "sample": 30.54112949112785, "env_to_module_sum_episodes_length_in": 97.24655369937295, "time_between_sampling": 12.764697824667662, "num_env_steps_sampled_lifetime_throughput": 42.541500056909705}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.12860643863677979, "weights_seq_no": 20.0, "vf_loss_unclipped": 0.005239791236817837, "total_loss": 0.1340678185224533, "gradients_default_optimizer_global_norm": 0.20249538123607635, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06856536865234375, "entropy": 0.6403465867042542, "curr_kl_coeff": 0.02500000037252903, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.008864083327353, "num_module_steps_trained_lifetime": 1211648, "vf_loss": 0.005239791236817837}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04403014568363853, "add_observations_from_episodes_to_batch": 0.00035711827266774734, "add_one_ts_to_episodes_and_truncate": 0.007406818218705463, "add_columns_from_episodes_to_train_batch": 0.07883088986769603, "general_advantage_estimation": 0.13511661497375108, "add_states_from_episodes_to_batch": 1.101640219982951e-05, "numpy_to_tensor": 0.0013246575247869577, "add_time_dim_to_batch_and_zero_pad": 3.0779657592513846e-05}}, "connector_pipeline_timer": 0.26771342793685377}, "num_module_steps_trained_lifetime": 1211648, "learner_connector_sum_episodes_length_out": 2016.016593453684, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 19094856, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 42.541500056909705, "done": false, "training_iteration": 20, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-08-11", "timestamp": 1747692491, "time_this_iter_s": 46.95087242126465, "time_total_s": 820.7696030139923, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 820.7696030139923, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 77.7641791044776, "ram_util_percent": 50.61194029850746}}
{"timers": {"training_iteration": 42.939694366628565, "restore_env_runners": 2.8305823765915033e-05, "training_step": 42.93923466659725, "env_runner_sampling_timer": 32.1843598330028, "learner_update_timer": 10.738379574368825, "synch_weights": 0.015631490792266438, "synch_env_connectors": 0.009186316119836219}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.12099999999999993, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001703443768816415, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.515362681129193e-06, "un_batch_to_individual_items": 6.949240760496565e-05, "listify_data_for_vector_env": 0.00013765312841951377, "normalize_and_clip_actions": 0.00013931746325396844, "get_actions": 0.0007457539519740411, "tensor_to_numpy": 0.0002435304383090808}}}, "num_module_steps_sampled_lifetime": {"default_policy": 42000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 42000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3545564052151155e-05, "add_states_from_episodes_to_batch": 2.195681260801962e-05, "numpy_to_tensor": 0.00016221482724625415, "add_time_dim_to_batch_and_zero_pad": 3.7167031788050814e-05, "batch_individual_items": 0.00010431949674336479}}, "connector_pipeline_timer": 0.0006565314230655008}, "episode_return_max": 0.5940000000000015, "episode_duration_sec_mean": 25.21350421031604, "num_episodes_lifetime": 192, "rlmodule_inference_timer": 0.0005823586041802927, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.34583760683760695, "env_to_module_sum_episodes_length_out": 95.75426675265321, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11096991925550763, "num_env_steps_sampled_lifetime": 42000, "weights_seq_no": 20.0, "agent_episode_returns_mean": {"default_agent": 0.34583760683760695}, "module_episode_returns_mean": {"default_policy": 0.34583760683760695}, "num_env_steps_sampled": 2000, "sample": 30.535974680825824, "env_to_module_sum_episodes_length_in": 95.75426675265321, "time_between_sampling": 12.75370581732314, "num_env_steps_sampled_lifetime_throughput": 51.81322894553212}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.051778413355350494, "weights_seq_no": 21.0, "vf_loss_unclipped": 0.003519931808114052, "total_loss": 0.05569233000278473, "gradients_default_optimizer_global_norm": 0.16272494196891785, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10609608888626099, "entropy": 0.5923826694488525, "curr_kl_coeff": 0.02500000037252903, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.015759490430355072, "num_module_steps_trained_lifetime": 1272192, "vf_loss": 0.003519931808114052}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04405692614353416, "add_observations_from_episodes_to_batch": 0.0003571516460031522, "add_one_ts_to_episodes_and_truncate": 0.007404669314615125, "add_columns_from_episodes_to_train_batch": 0.07883445727018458, "general_advantage_estimation": 0.13490627720564752, "add_states_from_episodes_to_batch": 1.1016979386511223e-05, "numpy_to_tensor": 0.0013246025721289237, "add_time_dim_to_batch_and_zero_pad": 3.078517002987174e-05}}, "connector_pipeline_timer": 0.2675309654709143}, "num_module_steps_trained_lifetime": 1272192, "learner_connector_sum_episodes_length_out": 2016.0186527115527, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 20048424, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.81322894553212, "done": false, "training_iteration": 21, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-08-50", "timestamp": 1747692530, "time_this_iter_s": 38.43493700027466, "time_total_s": 859.204540014267, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 859.204540014267, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 77.32909090909092, "ram_util_percent": 50.607272727272715}}
{"timers": {"training_iteration": 42.924174872082254, "restore_env_runners": 2.8236765557046787e-05, "training_step": 42.92371530605132, "env_runner_sampling_timer": 32.18744855910275, "learner_update_timer": 10.719858950315164, "synch_weights": 0.015543344884349355, "synch_env_connectors": 0.009182998958680553}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.12099999999999993, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016948374894036708, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.485139165336349e-06, "un_batch_to_individual_items": 6.940518501492945e-05, "listify_data_for_vector_env": 0.0001374751885077075, "normalize_and_clip_actions": 0.00013741743796289718, "get_actions": 0.0007427090172811673, "tensor_to_numpy": 0.00024284445279822847}}}, "num_module_steps_sampled_lifetime": {"default_policy": 44000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 44000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.405769946781599e-05, "add_states_from_episodes_to_batch": 2.2153065179112337e-05, "numpy_to_tensor": 0.00016263736369884958, "add_time_dim_to_batch_and_zero_pad": 3.798407625013832e-05, "batch_individual_items": 0.00010408741681159518}}, "connector_pipeline_timer": 0.0006554999054376447}, "episode_return_max": 0.728333333333334, "episode_duration_sec_mean": 23.90176194146212, "num_episodes_lifetime": 200, "rlmodule_inference_timer": 0.0005809009672859626, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.327284188034188, "env_to_module_sum_episodes_length_out": 93.75815918851127, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11093955889615731, "num_env_steps_sampled_lifetime": 44000, "weights_seq_no": 21.0, "agent_episode_returns_mean": {"default_agent": 0.327284188034188}, "module_episode_returns_mean": {"default_policy": 0.327284188034188}, "num_env_steps_sampled": 2000, "sample": 30.53129267659534, "env_to_module_sum_episodes_length_in": 93.75815918851127, "time_between_sampling": 12.741463963492683, "num_env_steps_sampled_lifetime_throughput": 48.23829953753881}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.08778419345617294, "weights_seq_no": 22.0, "vf_loss_unclipped": 0.002909446367993951, "total_loss": 0.09091905504465103, "gradients_default_optimizer_global_norm": 0.11896228790283203, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05394458770751953, "entropy": 0.49675729870796204, "curr_kl_coeff": 0.02500000037252903, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.009016652591526508, "num_module_steps_trained_lifetime": 1332736, "vf_loss": 0.002909446367993951}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044083235149662926, "add_observations_from_episodes_to_batch": 0.0003571812800442816, "add_one_ts_to_episodes_and_truncate": 0.007402341946784716, "add_columns_from_episodes_to_train_batch": 0.07883735011573627, "general_advantage_estimation": 0.13468793865140866, "add_states_from_episodes_to_batch": 1.1017503389307128e-05, "numpy_to_tensor": 0.0013245274027717286, "add_time_dim_to_batch_and_zero_pad": 3.0790934252723627e-05}}, "connector_pipeline_timer": 0.2673391361015996}, "num_module_steps_trained_lifetime": 1332736, "learner_connector_sum_episodes_length_out": 2016.0206691249189, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 21001992, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 44000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.23829953753881, "done": false, "training_iteration": 22, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-09-31", "timestamp": 1747692571, "time_this_iter_s": 41.40313124656677, "time_total_s": 900.6076712608337, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 900.6076712608337, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 77.13559322033899, "ram_util_percent": 50.615254237288134}}
{"timers": {"training_iteration": 42.87798995302149, "restore_env_runners": 2.817639784566402e-05, "training_step": 42.877529685650835, "env_runner_sampling_timer": 32.16356298545177, "learner_update_timer": 10.697660769532018, "synch_weights": 0.01543957343547479, "synch_env_connectors": 0.00916712396908672}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.12377777777777774, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016845834164982876, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.266746677550853e-06, "un_batch_to_individual_items": 6.934463323754403e-05, "listify_data_for_vector_env": 0.0001367374370671589, "normalize_and_clip_actions": 0.00013560714330044038, "get_actions": 0.0007393179472807511, "tensor_to_numpy": 0.000242379764341301}}}, "num_module_steps_sampled_lifetime": {"default_policy": 46000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 46000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.325140378654673e-05, "add_states_from_episodes_to_batch": 2.1691566972116835e-05, "numpy_to_tensor": 0.00016190706008267558, "add_time_dim_to_batch_and_zero_pad": 3.78431597184101e-05, "batch_individual_items": 0.0001030320409628237}}, "connector_pipeline_timer": 0.0006472545546032089}, "episode_return_max": 0.728333333333334, "episode_duration_sec_mean": 23.144501453221263, "num_episodes_lifetime": 208, "rlmodule_inference_timer": 0.0005785304393710129, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.30921474358974366, "env_to_module_sum_episodes_length_out": 92.5933605761248, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11029779876758773, "num_env_steps_sampled_lifetime": 46000, "weights_seq_no": 22.0, "agent_episode_returns_mean": {"default_agent": 0.30921474358974366}, "module_episode_returns_mean": {"default_policy": 0.30921474358974366}, "num_env_steps_sampled": 2000, "sample": 30.52536411706655, "env_to_module_sum_episodes_length_in": 92.5933605761248, "time_between_sampling": 12.72884779893902, "num_env_steps_sampled_lifetime_throughput": 52.11455814134973}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.02244853973388672, "weights_seq_no": 23.0, "vf_loss_unclipped": 0.002836307743564248, "total_loss": 0.02543654292821884, "gradients_default_optimizer_global_norm": 0.32840192317962646, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.041063010692596436, "entropy": 0.4538445770740509, "curr_kl_coeff": 0.02500000037252903, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.006068355403840542, "num_module_steps_trained_lifetime": 1393280, "vf_loss": 0.002836307743564248}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04410879135305486, "add_observations_from_episodes_to_batch": 0.00035720531624027093, "add_one_ts_to_episodes_and_truncate": 0.007399829459379261, "add_columns_from_episodes_to_train_batch": 0.07883993614874964, "general_advantage_estimation": 0.1344615533105346, "add_states_from_episodes_to_batch": 1.1017965214100128e-05, "numpy_to_tensor": 0.0013244532265443872, "add_time_dim_to_batch_and_zero_pad": 3.079643467387049e-05}}, "connector_pipeline_timer": 0.2671379903432245}, "num_module_steps_trained_lifetime": 1393280, "learner_connector_sum_episodes_length_out": 2016.0226433447465, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 21955560, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 46000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.11455814134973, "done": false, "training_iteration": 23, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-10-10", "timestamp": 1747692610, "time_this_iter_s": 38.325746059417725, "time_total_s": 938.9334173202515, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 938.9334173202515, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 78.09629629629632, "ram_util_percent": 50.60925925925925}}
{"timers": {"training_iteration": 42.86321437030123, "restore_env_runners": 2.8169633851165346e-05, "training_step": 42.86275375460427, "env_runner_sampling_timer": 32.16502651215723, "learner_update_timer": 10.681471822086685, "synch_weights": 0.015387703701093337, "synch_env_connectors": 0.009176657729351223}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.12377777777777774, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016859963479515933, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.33609429387304e-06, "un_batch_to_individual_items": 6.990809368304526e-05, "listify_data_for_vector_env": 0.00013764510353597004, "normalize_and_clip_actions": 0.00013507814890452566, "get_actions": 0.0007423862088012481, "tensor_to_numpy": 0.00024089231735337642}}}, "num_module_steps_sampled_lifetime": {"default_policy": 48000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 48000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.344795015097757e-05, "add_states_from_episodes_to_batch": 2.1471322975727182e-05, "numpy_to_tensor": 0.00016271002995133123, "add_time_dim_to_batch_and_zero_pad": 3.750314041526561e-05, "batch_individual_items": 0.00010352427462206107}}, "connector_pipeline_timer": 0.0006449016510705448}, "episode_return_max": 0.5546666666666669, "episode_duration_sec_mean": 22.2379645972865, "num_episodes_lifetime": 216, "rlmodule_inference_timer": 0.0005750960246980447, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.3746698717948719, "env_to_module_sum_episodes_length_out": 93.04534696622203, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11002397216168466, "num_env_steps_sampled_lifetime": 48000, "weights_seq_no": 23.0, "agent_episode_returns_mean": {"default_agent": 0.3746698717948719}, "module_episode_returns_mean": {"default_policy": 0.3746698717948719}, "num_env_steps_sampled": 2000, "sample": 30.519228139582044, "env_to_module_sum_episodes_length_in": 93.04534696622203, "time_between_sampling": 12.715211033332901, "num_env_steps_sampled_lifetime_throughput": 48.211839644116935}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.005054637789726257, "weights_seq_no": 24.0, "vf_loss_unclipped": 0.00311083672568202, "total_loss": 0.00826913584023714, "gradients_default_optimizer_global_norm": 0.22723181545734406, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07060730457305908, "entropy": 0.40968114137649536, "curr_kl_coeff": 0.012500000186264515, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0041461545042693615, "num_module_steps_trained_lifetime": 1453824, "vf_loss": 0.00311083672568202}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04413510565876442, "add_observations_from_episodes_to_batch": 0.0003572275335841878, "add_one_ts_to_episodes_and_truncate": 0.007397208267527424, "add_columns_from_episodes_to_train_batch": 0.07884222535599104, "general_advantage_estimation": 0.13422709903261237, "add_states_from_episodes_to_batch": 1.1018336051821568e-05, "numpy_to_tensor": 0.0013243579011015315, "add_time_dim_to_batch_and_zero_pad": 3.0801605993118714e-05}}, "connector_pipeline_timer": 0.26692910433620676}, "num_module_steps_trained_lifetime": 1453824, "learner_connector_sum_episodes_length_out": 2016.0245760132652, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 22909128, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 48000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.211839644116935, "done": false, "training_iteration": 24, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-10-51", "timestamp": 1747692651, "time_this_iter_s": 41.41672229766846, "time_total_s": 980.3501396179199, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 980.3501396179199, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 75.01694915254237, "ram_util_percent": 50.61355932203389}}
{"timers": {"training_iteration": 42.81516498080819, "restore_env_runners": 2.8235937543152643e-05, "training_step": 42.81469629826818, "env_runner_sampling_timer": 32.137418554145654, "learner_update_timer": 10.661000873965811, "synch_weights": 0.015406633664063226, "synch_env_connectors": 0.00916351414209817}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.19699999999999998, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016704733045223765, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.267598149679475e-06, "un_batch_to_individual_items": 6.959148661477227e-05, "listify_data_for_vector_env": 0.00013697766268565815, "normalize_and_clip_actions": 0.00013288152720799544, "get_actions": 0.0007370362623531356, "tensor_to_numpy": 0.00023843586767340072}}}, "num_module_steps_sampled_lifetime": {"default_policy": 50000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 50000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.355371728135259e-05, "add_states_from_episodes_to_batch": 2.1423122205631995e-05, "numpy_to_tensor": 0.00016350011077769343, "add_time_dim_to_batch_and_zero_pad": 3.7436271823430517e-05, "batch_individual_items": 0.00010267042482829599}}, "connector_pipeline_timer": 0.0006401134366180771}, "episode_return_max": 0.5546666666666669, "episode_duration_sec_mean": 23.514432114873742, "num_episodes_lifetime": 224, "rlmodule_inference_timer": 0.0005687114122331352, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.3866570512820513, "env_to_module_sum_episodes_length_out": 95.53058336733697, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10887048214247219, "num_env_steps_sampled_lifetime": 50000, "weights_seq_no": 24.0, "agent_episode_returns_mean": {"default_agent": 0.3866570512820513}, "module_episode_returns_mean": {"default_policy": 0.3866570512820513}, "num_env_steps_sampled": 2000, "sample": 30.511688419997533, "env_to_module_sum_episodes_length_in": 95.53058336733697, "time_between_sampling": 12.702130689086074, "num_env_steps_sampled_lifetime_throughput": 52.411879220995594}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.11509022116661072, "weights_seq_no": 25.0, "vf_loss_unclipped": 0.00264278263784945, "total_loss": 0.11784045398235321, "gradients_default_optimizer_global_norm": 0.3297651410102844, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.047936856746673584, "entropy": 0.4282968044281006, "curr_kl_coeff": 0.012500000186264515, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.008595127612352371, "num_module_steps_trained_lifetime": 1514368, "vf_loss": 0.00264278263784945}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04416057890922444, "add_observations_from_episodes_to_batch": 0.0003572447460496737, "add_one_ts_to_episodes_and_truncate": 0.0073944224865667065, "add_columns_from_episodes_to_train_batch": 0.0788441163754729, "general_advantage_estimation": 0.13398493209491685, "add_states_from_episodes_to_batch": 1.1018617676030398e-05, "numpy_to_tensor": 0.00132439799684513, "add_time_dim_to_batch_and_zero_pad": 3.080630424204959e-05}}, "connector_pipeline_timer": 0.26671122186029494}, "num_module_steps_trained_lifetime": 1514368, "learner_connector_sum_episodes_length_out": 2016.026467764079, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 23862696, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 50000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.411879220995594, "done": false, "training_iteration": 25, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-11-30", "timestamp": 1747692690, "time_this_iter_s": 38.09317183494568, "time_total_s": 1018.4433114528656, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1018.4433114528656, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 76.96111111111111, "ram_util_percent": 50.69999999999997}}
{"timers": {"training_iteration": 42.78621304996012, "restore_env_runners": 2.8252578188907772e-05, "training_step": 42.78574250624549, "env_runner_sampling_timer": 32.12379646601424, "learner_update_timer": 10.64571127777613, "synch_weights": 0.015347286327466873, "synch_env_connectors": 0.009277091000677943}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.1995555555555555, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016583154289851081, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.088372649778404e-06, "un_batch_to_individual_items": 6.957033150632169e-05, "listify_data_for_vector_env": 0.00013603612036332258, "normalize_and_clip_actions": 0.00013148597604927141, "get_actions": 0.0007327031087529291, "tensor_to_numpy": 0.00023611216474827927}}}, "num_module_steps_sampled_lifetime": {"default_policy": 52000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 52000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.346159868583587e-05, "add_states_from_episodes_to_batch": 2.1296579840684996e-05, "numpy_to_tensor": 0.00016294729477811122, "add_time_dim_to_batch_and_zero_pad": 3.7419315296465276e-05, "batch_individual_items": 0.00010228265637505382}}, "connector_pipeline_timer": 0.0006374142170953135}, "episode_return_max": 0.5373333333333334, "episode_duration_sec_mean": 22.08710856644344, "num_episodes_lifetime": 240, "rlmodule_inference_timer": 0.0005680008616071076, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.32078311965811984, "env_to_module_sum_episodes_length_out": 97.10388082982128, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10900693083198712, "num_env_steps_sampled_lifetime": 52000, "weights_seq_no": 25.0, "agent_episode_returns_mean": {"default_agent": 0.32078311965811984}, "module_episode_returns_mean": {"default_policy": 0.32078311965811984}, "num_env_steps_sampled": 2000, "sample": 30.504078701309826, "env_to_module_sum_episodes_length_in": 97.10388082982128, "time_between_sampling": 12.688206414664158, "num_env_steps_sampled_lifetime_throughput": 49.971929398023555}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.14103733003139496, "weights_seq_no": 26.0, "vf_loss_unclipped": 0.004269463941454887, "total_loss": -0.13671648502349854, "gradients_default_optimizer_global_norm": 0.37691786885261536, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07206851243972778, "entropy": 0.41832610964775085, "curr_kl_coeff": 0.0062500000931322575, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004109015688300133, "num_module_steps_trained_lifetime": 1575168, "vf_loss": 0.004269463941454887}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04420252178430986, "add_observations_from_episodes_to_batch": 0.0003572739815126918, "add_one_ts_to_episodes_and_truncate": 0.007391623080398243, "add_columns_from_episodes_to_train_batch": 0.07884566301202975, "general_advantage_estimation": 0.1337358031660715, "add_states_from_episodes_to_batch": 1.1018841834141535e-05, "numpy_to_tensor": 0.0013245921948838147, "add_time_dim_to_batch_and_zero_pad": 3.081081836561441e-05}}, "connector_pipeline_timer": 0.26650264454366773}, "num_module_steps_trained_lifetime": 1575168, "learner_connector_sum_episodes_length_out": 2016.029119222275, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 24824096, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 52000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.971929398023555, "done": false, "training_iteration": 26, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-12-10", "timestamp": 1747692730, "time_this_iter_s": 39.93916654586792, "time_total_s": 1058.3824779987335, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1058.3824779987335, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 77.35789473684211, "ram_util_percent": 50.68596491228071}}
{"timers": {"training_iteration": 42.73588801219049, "restore_env_runners": 2.8233052445121897e-05, "training_step": 42.73541689491306, "env_runner_sampling_timer": 32.0927007837241, "learner_update_timer": 10.626567153358359, "synch_weights": 0.015252517464158587, "synch_env_connectors": 0.009301279090677482}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.18177777777777765, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016539179128826581, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.957325187136598e-06, "un_batch_to_individual_items": 7.019852372014402e-05, "listify_data_for_vector_env": 0.00013706972162244027, "normalize_and_clip_actions": 0.00013114255058378413, "get_actions": 0.0007295082368603201, "tensor_to_numpy": 0.00023561062927988517}}}, "num_module_steps_sampled_lifetime": {"default_policy": 54000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 54000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.283971601040808e-05, "add_states_from_episodes_to_batch": 2.1190993966054465e-05, "numpy_to_tensor": 0.0001646910718783149, "add_time_dim_to_batch_and_zero_pad": 3.773275013945754e-05, "batch_individual_items": 0.00010122777197493963}}, "connector_pipeline_timer": 0.0006356423504603444}, "episode_return_max": 0.6140000000000013, "episode_duration_sec_mean": 21.84631294933626, "num_episodes_lifetime": 248, "rlmodule_inference_timer": 0.0005686003956384507, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.32380555555555574, "env_to_module_sum_episodes_length_out": 96.21435735165456, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10936983942340311, "num_env_steps_sampled_lifetime": 54000, "weights_seq_no": 26.0, "agent_episode_returns_mean": {"default_agent": 0.32380555555555574}, "module_episode_returns_mean": {"default_policy": 0.32380555555555574}, "num_env_steps_sampled": 2000, "sample": 30.495210962055946, "env_to_module_sum_episodes_length_in": 96.21435735165456, "time_between_sampling": 12.67373233630377, "num_env_steps_sampled_lifetime_throughput": 52.86988847680445}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.028458476066589355, "weights_seq_no": 27.0, "vf_loss_unclipped": 0.004348977003246546, "total_loss": -0.024073628708720207, "gradients_default_optimizer_global_norm": 0.2887435853481293, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10556936264038086, "entropy": 0.4484226703643799, "curr_kl_coeff": 0.0062500000931322575, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005740138702094555, "num_module_steps_trained_lifetime": 1635712, "vf_loss": 0.004348977003246546}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044243414284002434, "add_observations_from_episodes_to_batch": 0.00035730153779141717, "add_one_ts_to_episodes_and_truncate": 0.0073886828401042515, "add_columns_from_episodes_to_train_batch": 0.07884647560421815, "general_advantage_estimation": 0.13347912328259287, "add_states_from_episodes_to_batch": 1.1018959646933785e-05, "numpy_to_tensor": 0.0013247615491618007, "add_time_dim_to_batch_and_zero_pad": 3.081492157619945e-05}}, "connector_pipeline_timer": 0.26628454782118705}, "num_module_steps_trained_lifetime": 1635712, "learner_connector_sum_episodes_length_out": 2016.031715004531, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 25777664, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.86988847680445, "done": false, "training_iteration": 27, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-12-47", "timestamp": 1747692767, "time_this_iter_s": 37.769559383392334, "time_total_s": 1096.1520373821259, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1096.1520373821259, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 77.41296296296296, "ram_util_percent": 50.64814814814813}}
{"timers": {"training_iteration": 42.68594176355859, "restore_env_runners": 2.8161721926618106e-05, "training_step": 42.685470720453914, "env_runner_sampling_timer": 32.063099751046856, "learner_update_timer": 10.60631715615475, "synch_weights": 0.015157150289498428, "synch_env_connectors": 0.009291408299773844}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.18177777777777765, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016418501902919103, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.829812812240858e-06, "un_batch_to_individual_items": 6.990226663903168e-05, "listify_data_for_vector_env": 0.00013582475047272207, "normalize_and_clip_actions": 0.00012956893597401465, "get_actions": 0.0007255723032029894, "tensor_to_numpy": 0.000233819354730219}}}, "num_module_steps_sampled_lifetime": {"default_policy": 56000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 56000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.247316019243833e-05, "add_states_from_episodes_to_batch": 2.1050565842607633e-05, "numpy_to_tensor": 0.00016421015889251885, "add_time_dim_to_batch_and_zero_pad": 3.7641692403474e-05, "batch_individual_items": 9.987139534277755e-05}}, "connector_pipeline_timer": 0.0006299415189617347}, "episode_return_max": 0.6140000000000013, "episode_duration_sec_mean": 22.922077314364916, "num_episodes_lifetime": 256, "rlmodule_inference_timer": 0.000563076183719072, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.31727777777777794, "env_to_module_sum_episodes_length_out": 94.2239733662065, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10879765031869172, "num_env_steps_sampled_lifetime": 56000, "weights_seq_no": 27.0, "agent_episode_returns_mean": {"default_agent": 0.31727777777777794}, "module_episode_returns_mean": {"default_policy": 0.31727777777777794}, "num_env_steps_sampled": 2000, "sample": 30.485130312055777, "env_to_module_sum_episodes_length_in": 94.2239733662065, "time_between_sampling": 12.658291158368998, "num_env_steps_sampled_lifetime_throughput": 52.88994738561282}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.10098964720964432, "weights_seq_no": 28.0, "vf_loss_unclipped": 0.002794477855786681, "total_loss": -0.09817998111248016, "gradients_default_optimizer_global_norm": 0.32587653398513794, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1153486967086792, "entropy": 0.3996095657348633, "curr_kl_coeff": 0.0031250000465661287, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0024319663643836975, "num_module_steps_trained_lifetime": 1696256, "vf_loss": 0.002794477855786681}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04428327810152255, "add_observations_from_episodes_to_batch": 0.0003573251655468183, "add_one_ts_to_episodes_and_truncate": 0.007385621772307837, "add_columns_from_episodes_to_train_batch": 0.07884687942826114, "general_advantage_estimation": 0.13321511690646715, "add_states_from_episodes_to_batch": 1.1019003219126152e-05, "numpy_to_tensor": 0.0013249151071349982, "add_time_dim_to_batch_and_zero_pad": 3.081896164105809e-05}}, "connector_pipeline_timer": 0.2660575350487021}, "num_module_steps_trained_lifetime": 1696256, "learner_connector_sum_episodes_length_out": 2016.0342559592195, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 26731232, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 56000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.88994738561282, "done": false, "training_iteration": 28, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-13-25", "timestamp": 1747692805, "time_this_iter_s": 37.75831055641174, "time_total_s": 1133.9103479385376, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1133.9103479385376, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 78.40188679245283, "ram_util_percent": 50.69056603773585}}
{"timers": {"training_iteration": 42.643864165323016, "restore_env_runners": 2.8503104649049268e-05, "training_step": 42.64339204264939, "env_runner_sampling_timer": 32.049021171656435, "learner_update_timer": 10.578396434873195, "synch_weights": 0.015077412786649227, "synch_env_connectors": 0.00929072221677017}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.1719999999999999, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016499763707860775, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.860177571857847e-06, "un_batch_to_individual_items": 7.000248471968102e-05, "listify_data_for_vector_env": 0.0001366812127230331, "normalize_and_clip_actions": 0.00012999223643439121, "get_actions": 0.0007298955862324722, "tensor_to_numpy": 0.00023444246673341018}}}, "num_module_steps_sampled_lifetime": {"default_policy": 58000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 58000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1975970850136975e-05, "add_states_from_episodes_to_batch": 2.0885522971501087e-05, "numpy_to_tensor": 0.00016496583657562113, "add_time_dim_to_batch_and_zero_pad": 3.7525381739644246e-05, "batch_individual_items": 0.0001007687729651662}}, "connector_pipeline_timer": 0.0006293486550384628}, "episode_return_max": 0.5842222222222228, "episode_duration_sec_mean": 22.189054197740568, "num_episodes_lifetime": 264, "rlmodule_inference_timer": 0.0005678383766220999, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.3621196581196581, "env_to_module_sum_episodes_length_out": 92.6670553459763, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10893175932696544, "num_env_steps_sampled_lifetime": 58000, "weights_seq_no": 28.0, "agent_episode_returns_mean": {"default_agent": 0.3621196581196581}, "module_episode_returns_mean": {"default_policy": 0.3621196581196581}, "num_env_steps_sampled": 2000, "sample": 30.47487598775166, "env_to_module_sum_episodes_length_in": 92.6670553459763, "time_between_sampling": 12.642042068757979, "num_env_steps_sampled_lifetime_throughput": 51.87894724990812}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.001834457740187645, "weights_seq_no": 29.0, "vf_loss_unclipped": 0.004074267111718655, "total_loss": 0.005924418568611145, "gradients_default_optimizer_global_norm": 0.394599974155426, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.004979252815246582, "entropy": 0.41487860679626465, "curr_kl_coeff": 0.0031250000465661287, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005021438002586365, "num_module_steps_trained_lifetime": 1756800, "vf_loss": 0.004074267111718655}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04432200532126377, "add_observations_from_episodes_to_batch": 0.00035736420059341453, "add_one_ts_to_episodes_and_truncate": 0.007383746857683158, "add_columns_from_episodes_to_train_batch": 0.07884919221826243, "general_advantage_estimation": 0.13294394818553618, "add_states_from_episodes_to_batch": 1.1019244023622478e-05, "numpy_to_tensor": 0.0013250289777939623, "add_time_dim_to_batch_and_zero_pad": 3.0823579412563914e-05}}, "connector_pipeline_timer": 0.2658252840469849}, "num_module_steps_trained_lifetime": 1756800, "learner_connector_sum_episodes_length_out": 2016.0367429233138, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 27684800, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.87894724990812, "done": false, "training_iteration": 29, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-14-04", "timestamp": 1747692844, "time_this_iter_s": 38.495121479034424, "time_total_s": 1172.405469417572, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1172.405469417572, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 78.65999999999998, "ram_util_percent": 50.64363636363635}}
{"timers": {"training_iteration": 42.64073636326981, "restore_env_runners": 2.8449073615276914e-05, "training_step": 42.64026369282288, "env_runner_sampling_timer": 32.06244845071988, "learner_update_timer": 10.561886041344469, "synch_weights": 0.015016022658803535, "synch_env_connectors": 0.009278073994553653}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.17055555555555546, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016557074476415304, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.989304117826006e-06, "un_batch_to_individual_items": 7.073409571325547e-05, "listify_data_for_vector_env": 0.00013840082486102476, "normalize_and_clip_actions": 0.00013056749505592057, "get_actions": 0.0007311290213621252, "tensor_to_numpy": 0.00023535270305946154}}}, "num_module_steps_sampled_lifetime": {"default_policy": 60000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 60000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2206695927831586e-05, "add_states_from_episodes_to_batch": 2.0632099792452684e-05, "numpy_to_tensor": 0.0001669076990443114, "add_time_dim_to_batch_and_zero_pad": 3.7275534511674394e-05, "batch_individual_items": 0.00010202351515112423}}, "connector_pipeline_timer": 0.0006315091985648178}, "episode_return_max": 0.6844444444444446, "episode_duration_sec_mean": 23.1156441840951, "num_episodes_lifetime": 272, "rlmodule_inference_timer": 0.0005711490967021204, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.35150320512820515, "env_to_module_sum_episodes_length_out": 92.49943116261085, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10890800145079904, "num_env_steps_sampled_lifetime": 60000, "weights_seq_no": 29.0, "agent_episode_returns_mean": {"default_agent": 0.35150320512820515}, "module_episode_returns_mean": {"default_policy": 0.35150320512820515}, "num_env_steps_sampled": 2000, "sample": 30.46573720038218, "env_to_module_sum_episodes_length_in": 92.49943116261085, "time_between_sampling": 12.624710163447471, "num_env_steps_sampled_lifetime_throughput": 47.16149592592547}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.16009362041950226, "weights_seq_no": 30.0, "vf_loss_unclipped": 0.002476331079378724, "total_loss": 0.16259022057056427, "gradients_default_optimizer_global_norm": 0.28247395157814026, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.12457400560379028, "entropy": 0.41982871294021606, "curr_kl_coeff": 0.0031250000465661287, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.006485035642981529, "num_module_steps_trained_lifetime": 1817344, "vf_loss": 0.002476331079378724}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04435965723880014, "add_observations_from_episodes_to_batch": 0.00035740080242300203, "add_one_ts_to_episodes_and_truncate": 0.0073817632791742015, "add_columns_from_episodes_to_train_batch": 0.0788508809745215, "general_advantage_estimation": 0.13266578813733318, "add_states_from_episodes_to_batch": 1.101938811139405e-05, "numpy_to_tensor": 0.001325118109528666, "add_time_dim_to_batch_and_zero_pad": 3.082783293277196e-05}}, "connector_pipeline_timer": 0.2655841873517976}, "num_module_steps_trained_lifetime": 1817344, "learner_connector_sum_episodes_length_out": 2016.03917672253, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 28638368, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 60000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.16149592592547, "done": false, "training_iteration": 30, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-14-46", "timestamp": 1747692886, "time_this_iter_s": 42.34899926185608, "time_total_s": 1214.754468679428, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1214.754468679428, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 76.21166666666667, "ram_util_percent": 50.63499999999999}}
{"timers": {"training_iteration": 42.59623482946711, "restore_env_runners": 2.841758284108241e-05, "training_step": 42.59576309972462, "env_runner_sampling_timer": 32.038120693872685, "learner_update_timer": 10.54177359711102, "synch_weights": 0.014958537422225483, "synch_env_connectors": 0.009272639254608368}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.17055555555555546, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001657865583947179, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.82987656594774e-06, "un_batch_to_individual_items": 7.055090083819627e-05, "listify_data_for_vector_env": 0.0001391328804725345, "normalize_and_clip_actions": 0.00013012070424193919, "get_actions": 0.0007346929968506084, "tensor_to_numpy": 0.00023519532391004242}}}, "num_module_steps_sampled_lifetime": {"default_policy": 62000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 62000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.225702900410515e-05, "add_states_from_episodes_to_batch": 2.045920595153885e-05, "numpy_to_tensor": 0.00016617303644262445, "add_time_dim_to_batch_and_zero_pad": 3.709510103789126e-05, "batch_individual_items": 0.00010252402943635737}}, "connector_pipeline_timer": 0.0006290136537391625}, "episode_return_max": 0.6844444444444446, "episode_duration_sec_mean": 24.21723429733559, "num_episodes_lifetime": 280, "rlmodule_inference_timer": 0.0005695570382297868, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.32234829059829057, "env_to_module_sum_episodes_length_out": 94.24955833853917, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10838190453346087, "num_env_steps_sampled_lifetime": 62000, "weights_seq_no": 30.0, "agent_episode_returns_mean": {"default_agent": 0.32234829059829057}, "module_episode_returns_mean": {"default_policy": 0.32234829059829057}, "num_env_steps_sampled": 2000, "sample": 30.455957285993886, "env_to_module_sum_episodes_length_in": 94.24955833853917, "time_between_sampling": 12.608202087346774, "num_env_steps_sampled_lifetime_throughput": 52.10963976813834}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.16293394565582275, "weights_seq_no": 31.0, "vf_loss_unclipped": 0.004389201756566763, "total_loss": 0.16733282804489136, "gradients_default_optimizer_global_norm": 0.17820610105991364, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.00867992639541626, "entropy": 0.4407634735107422, "curr_kl_coeff": 0.0015625000232830644, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0030989558435976505, "num_module_steps_trained_lifetime": 1877888, "vf_loss": 0.004389201756566763}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044397291846753596, "add_observations_from_episodes_to_batch": 0.0003574338057959339, "add_one_ts_to_episodes_and_truncate": 0.007379587387449621, "add_columns_from_episodes_to_train_batch": 0.07885470402503392, "general_advantage_estimation": 0.13238092095517534, "add_states_from_episodes_to_batch": 1.1019587393109493e-05, "numpy_to_tensor": 0.001325217785730668, "add_time_dim_to_batch_and_zero_pad": 3.083247902482114e-05}}, "connector_pipeline_timer": 0.2653382985598095}, "num_module_steps_trained_lifetime": 1877888, "learner_connector_sum_episodes_length_out": 2016.04155817147, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 29591936, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 62000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.10963976813834, "done": false, "training_iteration": 31, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-15-24", "timestamp": 1747692924, "time_this_iter_s": 38.204676151275635, "time_total_s": 1252.9591448307037, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1252.9591448307037, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 78.66666666666663, "ram_util_percent": 50.65740740740739}}
{"timers": {"training_iteration": 42.56225898527243, "restore_env_runners": 2.8353407014389875e-05, "training_step": 42.56178798782743, "env_runner_sampling_timer": 32.018790472173954, "learner_update_timer": 10.527220817999932, "synch_weights": 0.014864279047939598, "synch_env_connectors": 0.009248513852042325}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.22233333333333338, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016551836091746987, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.7014177831611e-06, "un_batch_to_individual_items": 7.045160775987255e-05, "listify_data_for_vector_env": 0.0001401610510305749, "normalize_and_clip_actions": 0.00012858754382530396, "get_actions": 0.0007347681842291341, "tensor_to_numpy": 0.0002355116238405243}}}, "num_module_steps_sampled_lifetime": {"default_policy": 64000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 64000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1766204583120165e-05, "add_states_from_episodes_to_batch": 2.0286842714340996e-05, "numpy_to_tensor": 0.00016543981769675473, "add_time_dim_to_batch_and_zero_pad": 3.698615096251147e-05, "batch_individual_items": 0.0001018432274136046}}, "connector_pipeline_timer": 0.0006255015943134418}, "episode_return_max": 0.6696666666666677, "episode_duration_sec_mean": 22.27451749357729, "num_episodes_lifetime": 296, "rlmodule_inference_timer": 0.0005698042687089123, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.37839529914529935, "env_to_module_sum_episodes_length_out": 96.78220194964169, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10933420875330431, "num_env_steps_sampled_lifetime": 64000, "weights_seq_no": 31.0, "agent_episode_returns_mean": {"default_agent": 0.37839529914529935}, "module_episode_returns_mean": {"default_policy": 0.37839529914529935}, "num_env_steps_sampled": 2000, "sample": 30.44641626624058, "env_to_module_sum_episodes_length_in": 96.78220194964169, "time_between_sampling": 12.590834407953302, "num_env_steps_sampled_lifetime_throughput": 50.93190435824858}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.019053082913160324, "weights_seq_no": 32.0, "vf_loss_unclipped": 0.0035286329220980406, "total_loss": 0.022602809593081474, "gradients_default_optimizer_global_norm": 0.15975235402584076, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.003122687339782715, "entropy": 0.4243556261062622, "curr_kl_coeff": 0.0015625000232830644, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.013498746789991856, "num_module_steps_trained_lifetime": 1938688, "vf_loss": 0.0035286329220980406}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044434210896723864, "add_observations_from_episodes_to_batch": 0.0003574770790214665, "add_one_ts_to_episodes_and_truncate": 0.0073773873972313225, "add_columns_from_episodes_to_train_batch": 0.07885801254643875, "general_advantage_estimation": 0.13208959338784654, "add_states_from_episodes_to_batch": 1.1019640750413442e-05, "numpy_to_tensor": 0.0013253295565978302, "add_time_dim_to_batch_and_zero_pad": 3.083681941176178e-05}}, "connector_pipeline_timer": 0.26508470128482553}, "num_module_steps_trained_lifetime": 1938688, "learner_connector_sum_episodes_length_out": 2016.0446880737586, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 30553336, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 64000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.93190435824858, "done": false, "training_iteration": 32, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-16-04", "timestamp": 1747692964, "time_this_iter_s": 39.21722626686096, "time_total_s": 1292.1763710975647, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1292.1763710975647, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 78.68571428571428, "ram_util_percent": 50.714285714285715}}
{"timers": {"training_iteration": 42.552029456759705, "restore_env_runners": 2.84258729629013e-05, "training_step": 42.55155603428918, "env_runner_sampling_timer": 32.00308776552225, "learner_update_timer": 10.5327733980899, "synch_weights": 0.014779119257509219, "synch_env_connectors": 0.0092442047135121}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2097777777777779, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016542781090655653, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.725539771228447e-06, "un_batch_to_individual_items": 7.195454291192338e-05, "listify_data_for_vector_env": 0.00014032108838387148, "normalize_and_clip_actions": 0.000128057274002328, "get_actions": 0.000736134257865582, "tensor_to_numpy": 0.0002341334761178126}}}, "num_module_steps_sampled_lifetime": {"default_policy": 66000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 66000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1821547039258955e-05, "add_states_from_episodes_to_batch": 2.003398392490505e-05, "numpy_to_tensor": 0.00016513742761509108, "add_time_dim_to_batch_and_zero_pad": 3.6842160823088805e-05, "batch_individual_items": 0.00010274874664848383}}, "connector_pipeline_timer": 0.0006258015930803733}, "episode_return_max": 0.6696666666666677, "episode_duration_sec_mean": 23.01193994253831, "num_episodes_lifetime": 304, "rlmodule_inference_timer": 0.0005710815394222318, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.3834188034188037, "env_to_module_sum_episodes_length_out": 96.7836601274671, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1095303839179203, "num_env_steps_sampled_lifetime": 66000, "weights_seq_no": 32.0, "agent_episode_returns_mean": {"default_agent": 0.3834188034188037}, "module_episode_returns_mean": {"default_policy": 0.3834188034188037}, "num_env_steps_sampled": 2000, "sample": 30.436380758538167, "env_to_module_sum_episodes_length_in": 96.7836601274671, "time_between_sampling": 12.572673788694882, "num_env_steps_sampled_lifetime_throughput": 48.038697632061826}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.038082852959632874, "weights_seq_no": 33.0, "vf_loss_unclipped": 0.005594837944954634, "total_loss": -0.03248214349150658, "gradients_default_optimizer_global_norm": 0.11940224468708038, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.006886124610900879, "entropy": 0.4653681814670563, "curr_kl_coeff": 0.0007812500116415322, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0037580998614430428, "num_module_steps_trained_lifetime": 1999232, "vf_loss": 0.005594837944954634}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04447209929650998, "add_observations_from_episodes_to_batch": 0.0003575151534024287, "add_one_ts_to_episodes_and_truncate": 0.0073750238280783365, "add_columns_from_episodes_to_train_batch": 0.07886168075691359, "general_advantage_estimation": 0.13179340456976915, "add_states_from_episodes_to_batch": 1.1020521081976058e-05, "numpy_to_tensor": 0.001325690530269257, "add_time_dim_to_batch_and_zero_pad": 3.0842439742748624e-05}}, "connector_pipeline_timer": 0.2648276569853853}, "num_module_steps_trained_lifetime": 1999232, "learner_connector_sum_episodes_length_out": 2016.0477512221844, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 31506904, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 66000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.038697632061826, "done": false, "training_iteration": 33, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-16-45", "timestamp": 1747693005, "time_this_iter_s": 41.56008505821228, "time_total_s": 1333.736456155777, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1333.736456155777, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 73.59661016949153, "ram_util_percent": 50.672881355932205}}
{"timers": {"training_iteration": 42.51434605606208, "restore_env_runners": 2.8367614207917963e-05, "training_step": 42.513871989816266, "env_runner_sampling_timer": 31.98818566319704, "learner_update_timer": 10.510078011648986, "synch_weights": 0.014690148064910676, "synch_env_connectors": 0.009253219666359455}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2097777777777779, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016502680209421357, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.57282231007505e-06, "un_batch_to_individual_items": 7.224372266390245e-05, "listify_data_for_vector_env": 0.00014055492576818676, "normalize_and_clip_actions": 0.00012740299649970134, "get_actions": 0.0007329720886195577, "tensor_to_numpy": 0.00023598475874230963}}}, "num_module_steps_sampled_lifetime": {"default_policy": 68000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 68000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2130136526238704e-05, "add_states_from_episodes_to_batch": 1.988776975188481e-05, "numpy_to_tensor": 0.0001658615324721671, "add_time_dim_to_batch_and_zero_pad": 3.706820873128845e-05, "batch_individual_items": 0.00010237906974629948}}, "connector_pipeline_timer": 0.0006257220455524159}, "episode_return_max": 0.6751111111111121, "episode_duration_sec_mean": 23.065644162000215, "num_episodes_lifetime": 312, "rlmodule_inference_timer": 0.0005694002360668974, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4387510683760688, "env_to_module_sum_episodes_length_out": 94.97919369905898, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10948722314090353, "num_env_steps_sampled_lifetime": 68000, "weights_seq_no": 33.0, "agent_episode_returns_mean": {"default_agent": 0.4387510683760688}, "module_episode_returns_mean": {"default_policy": 0.4387510683760688}, "num_env_steps_sampled": 2000, "sample": 30.425950217311, "env_to_module_sum_episodes_length_in": 94.97919369905898, "time_between_sampling": 12.556335484993133, "num_env_steps_sampled_lifetime_throughput": 51.43903968848311}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08584210276603699, "weights_seq_no": 34.0, "vf_loss_unclipped": 0.0038877702318131924, "total_loss": -0.08195015788078308, "gradients_default_optimizer_global_norm": 0.0718768835067749, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.11642158031463623, "entropy": 0.4049813449382782, "curr_kl_coeff": 0.0007812500116415322, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005351755768060684, "num_module_steps_trained_lifetime": 2059776, "vf_loss": 0.0038877702318131924}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044508831567210465, "add_observations_from_episodes_to_batch": 0.0003575477285875263, "add_one_ts_to_episodes_and_truncate": 0.007372498751568479, "add_columns_from_episodes_to_train_batch": 0.07886499724192428, "general_advantage_estimation": 0.13149147437861514, "add_states_from_episodes_to_batch": 1.1021331842824046e-05, "numpy_to_tensor": 0.0013260930215116256, "add_time_dim_to_batch_and_zero_pad": 3.0850823985446e-05}}, "connector_pipeline_timer": 0.2645632314917053}, "num_module_steps_trained_lifetime": 2059776, "learner_connector_sum_episodes_length_out": 2016.0507486388344, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 32460472, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 68000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.43903968848311, "done": false, "training_iteration": 34, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-17-24", "timestamp": 1747693044, "time_this_iter_s": 38.8005793094635, "time_total_s": 1372.5370354652405, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1372.5370354652405, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 76.55178571428573, "ram_util_percent": 50.61785714285715}}
{"timers": {"training_iteration": 42.45880312464147, "restore_env_runners": 2.829893802948461e-05, "training_step": 42.45832953305808, "env_runner_sampling_timer": 31.94774589701503, "learner_update_timer": 10.494991891222554, "synch_weights": 0.014672761584269382, "synch_env_connectors": 0.009248006469636041}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2561111111111111, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016434456849051982, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.50407897572736e-06, "un_batch_to_individual_items": 7.201723872768166e-05, "listify_data_for_vector_env": 0.00013949517482784248, "normalize_and_clip_actions": 0.00012710187392695404, "get_actions": 0.0007293650419763892, "tensor_to_numpy": 0.0002346348465172866}}}, "num_module_steps_sampled_lifetime": {"default_policy": 70000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 70000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.181212313998127e-05, "add_states_from_episodes_to_batch": 1.971242848091036e-05, "numpy_to_tensor": 0.0001652225746855777, "add_time_dim_to_batch_and_zero_pad": 3.7162004348562506e-05, "batch_individual_items": 0.00010184616695181071}}, "connector_pipeline_timer": 0.0006225777824788718}, "episode_return_max": 0.6751111111111121, "episode_duration_sec_mean": 22.105709452210878, "num_episodes_lifetime": 320, "rlmodule_inference_timer": 0.0005644619872875155, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.3945673076923079, "env_to_module_sum_episodes_length_out": 93.13021025656352, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10884672487446435, "num_env_steps_sampled_lifetime": 70000, "weights_seq_no": 34.0, "agent_episode_returns_mean": {"default_agent": 0.3945673076923079}, "module_episode_returns_mean": {"default_policy": 0.3945673076923079}, "num_env_steps_sampled": 2000, "sample": 30.4138154494573, "env_to_module_sum_episodes_length_in": 93.13021025656352, "time_between_sampling": 12.539493904318089, "num_env_steps_sampled_lifetime_throughput": 53.97578972351146}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.03780405968427658, "weights_seq_no": 35.0, "vf_loss_unclipped": 0.002649130765348673, "total_loss": 0.04045788571238518, "gradients_default_optimizer_global_norm": 0.20775902271270752, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.01369023323059082, "entropy": 0.3592287302017212, "curr_kl_coeff": 0.0007812500116415322, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00601488770917058, "num_module_steps_trained_lifetime": 2120320, "vf_loss": 0.002649130765348673}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044544488952467313, "add_observations_from_episodes_to_batch": 0.00035757752075346724, "add_one_ts_to_episodes_and_truncate": 0.007369795114205987, "add_columns_from_episodes_to_train_batch": 0.0788675557990588, "general_advantage_estimation": 0.13118328563082668, "add_states_from_episodes_to_batch": 1.1022024336685413e-05, "numpy_to_tensor": 0.0013264610738762679, "add_time_dim_to_batch_and_zero_pad": 3.085894629952702e-05}}, "connector_pipeline_timer": 0.2642904805920004}, "num_module_steps_trained_lifetime": 2120320, "learner_connector_sum_episodes_length_out": 2016.0536813320293, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 33414040, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 70000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.97578972351146, "done": false, "training_iteration": 35, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-18-01", "timestamp": 1747693081, "time_this_iter_s": 36.979981899261475, "time_total_s": 1409.517017364502, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1409.517017364502, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 77.53846153846153, "ram_util_percent": 50.67115384615382}}
{"timers": {"training_iteration": 42.397211563915064, "restore_env_runners": 2.82959486712202e-05, "training_step": 42.39673681724747, "env_runner_sampling_timer": 31.909383620824855, "learner_update_timer": 10.471840262050291, "synch_weights": 0.01459213996843964, "synch_env_connectors": 0.009273509404957966}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.24633333333333315, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016349840901481298, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.573515421792263e-06, "un_batch_to_individual_items": 7.156064106943599e-05, "listify_data_for_vector_env": 0.00013914057663696195, "normalize_and_clip_actions": 0.00012659085884354012, "get_actions": 0.0007248384020654632, "tensor_to_numpy": 0.00023339001217614718}}}, "num_module_steps_sampled_lifetime": {"default_policy": 72000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 72000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.155220867203419e-05, "add_states_from_episodes_to_batch": 1.9447435602037736e-05, "numpy_to_tensor": 0.00016430791414585465, "add_time_dim_to_batch_and_zero_pad": 3.721251358982882e-05, "batch_individual_items": 0.0001006187486472263}}, "connector_pipeline_timer": 0.0006177332328249592}, "episode_return_max": 0.5892222222222219, "episode_duration_sec_mean": 21.41486100633637, "num_episodes_lifetime": 328, "rlmodule_inference_timer": 0.0005605864525240722, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.39260683760683757, "env_to_module_sum_episodes_length_out": 92.39103991643049, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1079666442412674, "num_env_steps_sampled_lifetime": 72000, "weights_seq_no": 35.0, "agent_episode_returns_mean": {"default_agent": 0.39260683760683757}, "module_episode_returns_mean": {"default_policy": 0.39260683760683757}, "num_env_steps_sampled": 2000, "sample": 30.399918573790952, "env_to_module_sum_episodes_length_in": 92.39103991643049, "time_between_sampling": 12.522146792074512, "num_env_steps_sampled_lifetime_throughput": 54.957466498526834}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09876486659049988, "weights_seq_no": 36.0, "vf_loss_unclipped": 0.003970143385231495, "total_loss": -0.09478972852230072, "gradients_default_optimizer_global_norm": 0.09883186221122742, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06383723020553589, "entropy": 0.34947866201400757, "curr_kl_coeff": 0.0007812500116415322, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.006383117754012346, "num_module_steps_trained_lifetime": 2180864, "vf_loss": 0.003970143385231495}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04457972687676281, "add_observations_from_episodes_to_batch": 0.0003576081523033789, "add_one_ts_to_episodes_and_truncate": 0.007366932429714981, "add_columns_from_episodes_to_train_batch": 0.07886996768522603, "general_advantage_estimation": 0.13086908878055645, "add_states_from_episodes_to_batch": 1.1022660847553079e-05, "numpy_to_tensor": 0.0013268924058915156, "add_time_dim_to_batch_and_zero_pad": 3.086697108490287e-05}}, "connector_pipeline_timer": 0.2640110497869406}, "num_module_steps_trained_lifetime": 2180864, "learner_connector_sum_episodes_length_out": 2016.0565502964964, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 34367608, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 72000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.957466498526834, "done": false, "training_iteration": 36, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-18-38", "timestamp": 1747693118, "time_this_iter_s": 36.31840705871582, "time_total_s": 1445.8354244232178, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1445.8354244232178, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 76.94807692307693, "ram_util_percent": 50.711538461538446}}
{"timers": {"training_iteration": 42.36149236893593, "restore_env_runners": 2.8409989224319245e-05, "training_step": 42.361015102734974, "env_runner_sampling_timer": 31.88988677636661, "learner_update_timer": 10.455682190339829, "synch_weights": 0.014517728568734995, "synch_env_connectors": 0.00926504631093027}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.24633333333333315, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001627639953040656, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.414883963193836e-06, "un_batch_to_individual_items": 7.175077596433239e-05, "listify_data_for_vector_env": 0.0001375110141531594, "normalize_and_clip_actions": 0.0001253630282225293, "get_actions": 0.0007218773564050496, "tensor_to_numpy": 0.00023284037770298193}}}, "num_module_steps_sampled_lifetime": {"default_policy": 74000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 74000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.115431598167641e-05, "add_states_from_episodes_to_batch": 1.9840562132416492e-05, "numpy_to_tensor": 0.00016340603906263887, "add_time_dim_to_batch_and_zero_pad": 3.704752292339081e-05, "batch_individual_items": 0.00010167928550509621}}, "connector_pipeline_timer": 0.0006167759555933821}, "episode_return_max": 0.6647777777777776, "episode_duration_sec_mean": 21.810443809192574, "num_episodes_lifetime": 336, "rlmodule_inference_timer": 0.0005572251207757597, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.40612927350427347, "env_to_module_sum_episodes_length_out": 93.42146948013593, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10720568845398618, "num_env_steps_sampled_lifetime": 74000, "weights_seq_no": 36.0, "agent_episode_returns_mean": {"default_agent": 0.40612927350427347}, "module_episode_returns_mean": {"default_policy": 0.40612927350427347}, "num_env_steps_sampled": 2000, "sample": 30.38571480542236, "env_to_module_sum_episodes_length_in": 93.42146948013593, "time_between_sampling": 12.504055258097079, "num_env_steps_sampled_lifetime_throughput": 51.38842602887836}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.14833426475524902, "weights_seq_no": 37.0, "vf_loss_unclipped": 0.003808697685599327, "total_loss": -0.14452195167541504, "gradients_default_optimizer_global_norm": 0.2643894851207733, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.078410804271698, "entropy": 0.3615691661834717, "curr_kl_coeff": 0.0003906250058207661, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004619683604687452, "num_module_steps_trained_lifetime": 2241408, "vf_loss": 0.003808697685599327}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04461406255517765, "add_observations_from_episodes_to_batch": 0.0003576448834698244, "add_one_ts_to_episodes_and_truncate": 0.007364052799602594, "add_columns_from_episodes_to_train_batch": 0.0788722371109902, "general_advantage_estimation": 0.1305490812591291, "add_states_from_episodes_to_batch": 1.1023172425304518e-05, "numpy_to_tensor": 0.0013273404251591405, "add_time_dim_to_batch_and_zero_pad": 3.087456948031384e-05}}, "connector_pipeline_timer": 0.26372475659502265}, "num_module_steps_trained_lifetime": 2241408, "learner_connector_sum_episodes_length_out": 2016.0593565135407, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 35321176, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 74000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.38842602887836, "done": false, "training_iteration": 37, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-19-17", "timestamp": 1747693157, "time_this_iter_s": 38.84998178482056, "time_total_s": 1484.6854062080383, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1484.6854062080383, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 77.14000000000001, "ram_util_percent": 50.71272727272725}}
{"timers": {"training_iteration": 42.31968815580659, "restore_env_runners": 2.8897889316939268e-05, "training_step": 42.31920904426768, "env_runner_sampling_timer": 31.864238111002955, "learner_update_timer": 10.439618522556435, "synch_weights": 0.014423172313070385, "synch_env_connectors": 0.009292451857876092}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26166666666666655, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016217769024862623, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.259079415381193e-06, "un_batch_to_individual_items": 7.122318724499249e-05, "listify_data_for_vector_env": 0.0001367969417950255, "normalize_and_clip_actions": 0.0001244504981130891, "get_actions": 0.0007203513002843888, "tensor_to_numpy": 0.00023284052342494648}}}, "num_module_steps_sampled_lifetime": {"default_policy": 76000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 76000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0995559963172425e-05, "add_states_from_episodes_to_batch": 1.9792186088482524e-05, "numpy_to_tensor": 0.0001622200132662119, "add_time_dim_to_batch_and_zero_pad": 3.712731835767888e-05, "batch_individual_items": 0.00010087214971604603}}, "connector_pipeline_timer": 0.0006138187779232337}, "episode_return_max": 0.6647777777777776, "episode_duration_sec_mean": 22.0443709667107, "num_episodes_lifetime": 344, "rlmodule_inference_timer": 0.0005584046179847846, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.44048931623931636, "env_to_module_sum_episodes_length_out": 96.5574817301312, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10641610651175815, "num_env_steps_sampled_lifetime": 76000, "weights_seq_no": 37.0, "agent_episode_returns_mean": {"default_agent": 0.44048931623931636}, "module_episode_returns_mean": {"default_policy": 0.44048931623931636}, "num_env_steps_sampled": 2000, "sample": 30.370728234062224, "env_to_module_sum_episodes_length_in": 96.5574817301312, "time_between_sampling": 12.485950328509817, "num_env_steps_sampled_lifetime_throughput": 52.27031287252055}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.13507500290870667, "weights_seq_no": 38.0, "vf_loss_unclipped": 0.007755242753773928, "total_loss": -0.1273178607225418, "gradients_default_optimizer_global_norm": 0.19180180132389069, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05342411994934082, "entropy": 0.3221120536327362, "curr_kl_coeff": 0.00019531250291038305, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00489474181085825, "num_module_steps_trained_lifetime": 2301952, "vf_loss": 0.007755242753773928}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04466437990573601, "add_observations_from_episodes_to_batch": 0.00035767973919793476, "add_one_ts_to_episodes_and_truncate": 0.0073610965290495075, "add_columns_from_episodes_to_train_batch": 0.07887577111517095, "general_advantage_estimation": 0.13022333134965172, "add_states_from_episodes_to_batch": 1.1023591505179402e-05, "numpy_to_tensor": 0.0013277712448003902, "add_time_dim_to_batch_and_zero_pad": 3.088180921080997e-05}}, "connector_pipeline_timer": 0.2634498638046641}, "num_module_steps_trained_lifetime": 2301952, "learner_connector_sum_episodes_length_out": 2016.0621009512145, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 36274744, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 76000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.27031287252055, "done": false, "training_iteration": 38, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-19-55", "timestamp": 1747693195, "time_this_iter_s": 38.197060346603394, "time_total_s": 1522.8824665546417, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1522.8824665546417, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 75.81454545454545, "ram_util_percent": 50.71090909090906}}
{"timers": {"training_iteration": 42.33953420093856, "restore_env_runners": 2.8820910364572218e-05, "training_step": 42.33905538951504, "env_runner_sampling_timer": 31.896007789962937, "learner_update_timer": 10.42778134195085, "synch_weights": 0.01433435159000635, "synch_env_connectors": 0.009266070389276704}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.23400000000000018, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016338752151197184, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.130453742410937e-06, "un_batch_to_individual_items": 7.20280700909374e-05, "listify_data_for_vector_env": 0.0001374048750650095, "normalize_and_clip_actions": 0.0001248542118776434, "get_actions": 0.0007245999822977108, "tensor_to_numpy": 0.00023564366721076952}}}, "num_module_steps_sampled_lifetime": {"default_policy": 78000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 78000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.103809608258228e-05, "add_states_from_episodes_to_batch": 1.9717511133491744e-05, "numpy_to_tensor": 0.00016582604655900472, "add_time_dim_to_batch_and_zero_pad": 3.72138388568517e-05, "batch_individual_items": 0.00010306557627167937}}, "connector_pipeline_timer": 0.000621635107073902}, "episode_return_max": 0.686000000000001, "episode_duration_sec_mean": 23.33254822210585, "num_episodes_lifetime": 360, "rlmodule_inference_timer": 0.0005626460801765515, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.48335363247863294, "env_to_module_sum_episodes_length_out": 97.50600678223321, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10811445719618952, "num_env_steps_sampled_lifetime": 78000, "weights_seq_no": 38.0, "agent_episode_returns_mean": {"default_agent": 0.48335363247863294}, "module_episode_returns_mean": {"default_policy": 0.48335363247863294}, "num_env_steps_sampled": 2000, "sample": 30.359012165712443, "env_to_module_sum_episodes_length_in": 97.50600678223321, "time_between_sampling": 12.467857945824923, "num_env_steps_sampled_lifetime_throughput": 45.06451776622851}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.17553682625293732, "weights_seq_no": 39.0, "vf_loss_unclipped": 0.00795153807848692, "total_loss": 0.18348941206932068, "gradients_default_optimizer_global_norm": 0.19318035244941711, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.057966530323028564, "entropy": 0.37658536434173584, "curr_kl_coeff": 0.00019531250291038305, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00544537790119648, "num_module_steps_trained_lifetime": 2362752, "vf_loss": 0.00795153807848692}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04471353388242781, "add_observations_from_episodes_to_batch": 0.0003577302733228883, "add_one_ts_to_episodes_and_truncate": 0.007358518858427493, "add_columns_from_episodes_to_train_batch": 0.07888074475405661, "general_advantage_estimation": 0.12989185873013848, "add_states_from_episodes_to_batch": 1.1023969886358214e-05, "numpy_to_tensor": 0.0013281984539062455, "add_time_dim_to_batch_and_zero_pad": 3.0888986689875434e-05}}, "connector_pipeline_timer": 0.26316991122195366}, "num_module_steps_trained_lifetime": 2362752, "learner_connector_sum_episodes_length_out": 2016.0655845644835, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 37236144, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 78000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.06451776622851, "done": false, "training_iteration": 39, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-20-39", "timestamp": 1747693239, "time_this_iter_s": 44.32043147087097, "time_total_s": 1567.2028980255127, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1567.2028980255127, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 78.18064516129033, "ram_util_percent": 50.71451612903224}}
{"timers": {"training_iteration": 42.32601463639918, "restore_env_runners": 2.8826701244040684e-05, "training_step": 42.32553444608994, "env_runner_sampling_timer": 31.903006756723283, "learner_update_timer": 10.40730311733137, "synch_weights": 0.014290374084142025, "synch_env_connectors": 0.009259620685400129}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2625555555555556, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016433999322439591, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.49334527713532e-06, "un_batch_to_individual_items": 7.264066653628268e-05, "listify_data_for_vector_env": 0.0001379305991638865, "normalize_and_clip_actions": 0.00012665909718231888, "get_actions": 0.0007257574425093482, "tensor_to_numpy": 0.00023838767466856652}}}, "num_module_steps_sampled_lifetime": {"default_policy": 80000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 80000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.081881672242933e-05, "add_states_from_episodes_to_batch": 1.954481002941397e-05, "numpy_to_tensor": 0.00016722712002444046, "add_time_dim_to_batch_and_zero_pad": 3.7122520400962206e-05, "batch_individual_items": 0.00010366768860351876}}, "connector_pipeline_timer": 0.0006240123044098941}, "episode_return_max": 0.686000000000001, "episode_duration_sec_mean": 23.989416092173787, "num_episodes_lifetime": 368, "rlmodule_inference_timer": 0.0005634584241912207, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.42117735042735094, "env_to_module_sum_episodes_length_out": 96.07493121357064, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10903564998424733, "num_env_steps_sampled_lifetime": 80000, "weights_seq_no": 39.0, "agent_episode_returns_mean": {"default_agent": 0.42117735042735094}, "module_episode_returns_mean": {"default_policy": 0.42117735042735094}, "num_env_steps_sampled": 2000, "sample": 30.34815799524472, "env_to_module_sum_episodes_length_in": 96.07493121357064, "time_between_sampling": 12.450545496890639, "num_env_steps_sampled_lifetime_throughput": 48.706891867091876}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08033919334411621, "weights_seq_no": 40.0, "vf_loss_unclipped": 0.002831509103998542, "total_loss": -0.0775069147348404, "gradients_default_optimizer_global_norm": 0.18233738839626312, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.015705347061157227, "entropy": 0.33697378635406494, "curr_kl_coeff": 9.765625145519152e-05, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003912337590008974, "num_module_steps_trained_lifetime": 2423296, "vf_loss": 0.002831509103998542}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04476126848169528, "add_observations_from_episodes_to_batch": 0.00035777590879188366, "add_one_ts_to_episodes_and_truncate": 0.007355861571564916, "add_columns_from_episodes_to_train_batch": 0.07888554911325324, "general_advantage_estimation": 0.12955487677998065, "add_states_from_episodes_to_batch": 1.1024248341177612e-05, "numpy_to_tensor": 0.0013286817217052396, "add_time_dim_to_batch_and_zero_pad": 3.089564243797351e-05}}, "connector_pipeline_timer": 0.262882816334917}, "num_module_steps_trained_lifetime": 2423296, "learner_connector_sum_episodes_length_out": 2016.068992295392, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 38189712, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 80000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.706891867091876, "done": false, "training_iteration": 40, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-21-20", "timestamp": 1747693280, "time_this_iter_s": 41.00532388687134, "time_total_s": 1608.208221912384, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1608.208221912384, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 75.95423728813559, "ram_util_percent": 50.66949152542374}}
{"timers": {"training_iteration": 42.27454919786516, "restore_env_runners": 2.8753434268005674e-05, "training_step": 42.27406870545908, "env_runner_sampling_timer": 31.87247747236609, "learner_update_timer": 10.386461375768103, "synch_weights": 0.014194650353306436, "synch_env_connectors": 0.009253103488543902}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2625555555555556, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016327456788103993, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.455841427556136e-06, "un_batch_to_individual_items": 7.204573345052494e-05, "listify_data_for_vector_env": 0.00013664258992789172, "normalize_and_clip_actions": 0.00012538029196743829, "get_actions": 0.000721366461915979, "tensor_to_numpy": 0.00023675682421555783}}}, "num_module_steps_sampled_lifetime": {"default_policy": 82000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 82000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.040251355936259e-05, "add_states_from_episodes_to_batch": 1.945453925951313e-05, "numpy_to_tensor": 0.00016545201687499653, "add_time_dim_to_batch_and_zero_pad": 3.7244773429573036e-05, "batch_individual_items": 0.00010239841203582806}}, "connector_pipeline_timer": 0.0006194451994987618}, "episode_return_max": 0.7003333333333336, "episode_duration_sec_mean": 23.398337041134884, "num_episodes_lifetime": 376, "rlmodule_inference_timer": 0.0005591631966243696, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4717029914529916, "env_to_module_sum_episodes_length_out": 94.04901843575085, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10843821894948115, "num_env_steps_sampled_lifetime": 82000, "weights_seq_no": 40.0, "agent_episode_returns_mean": {"default_agent": 0.4717029914529916}, "module_episode_returns_mean": {"default_policy": 0.4717029914529916}, "num_env_steps_sampled": 2000, "sample": 30.336101818202014, "env_to_module_sum_episodes_length_in": 94.04901843575085, "time_between_sampling": 12.433678645010012, "num_env_steps_sampled_lifetime_throughput": 53.415523712778345}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.019480956718325615, "weights_seq_no": 41.0, "vf_loss_unclipped": 0.004104715771973133, "total_loss": 0.023586291819810867, "gradients_default_optimizer_global_norm": 0.21170710027217865, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05563044548034668, "entropy": 0.33890077471733093, "curr_kl_coeff": 9.765625145519152e-05, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.006316931452602148, "num_module_steps_trained_lifetime": 2483840, "vf_loss": 0.004104715771973133}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0448074996454889, "add_observations_from_episodes_to_batch": 0.0003578172485241453, "add_one_ts_to_episodes_and_truncate": 0.00735306788855323, "add_columns_from_episodes_to_train_batch": 0.07889008456049094, "general_advantage_estimation": 0.12921264513295347, "add_states_from_episodes_to_batch": 1.102442882959907e-05, "numpy_to_tensor": 0.001329118524302773, "add_time_dim_to_batch_and_zero_pad": 3.09017361723225e-05}}, "connector_pipeline_timer": 0.2625884975340986}, "num_module_steps_trained_lifetime": 2483840, "learner_connector_sum_episodes_length_out": 2016.072325313226, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 39143280, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 82000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.415523712778345, "done": false, "training_iteration": 41, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-21-58", "timestamp": 1747693318, "time_this_iter_s": 37.1954231262207, "time_total_s": 1645.4036450386047, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1645.4036450386047, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 77.43584905660376, "ram_util_percent": 50.66415094339621}}
{"timers": {"training_iteration": 42.228711081276515, "restore_env_runners": 2.869989996088724e-05, "training_step": 42.22823058779449, "env_runner_sampling_timer": 31.83828342582239, "learner_update_timer": 10.374907778220429, "synch_weights": 0.014101813849809679, "synch_env_connectors": 0.009236665463724423}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.27155555555555566, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001628864397409699, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.583507433547759e-06, "un_batch_to_individual_items": 7.141152825184702e-05, "listify_data_for_vector_env": 0.0001361187677331451, "normalize_and_clip_actions": 0.0001250766258203794, "get_actions": 0.0007213640096810714, "tensor_to_numpy": 0.00023560991447492988}}}, "num_module_steps_sampled_lifetime": {"default_policy": 84000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 84000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0027344510734856e-05, "add_states_from_episodes_to_batch": 1.9629030488309968e-05, "numpy_to_tensor": 0.00016440232249271167, "add_time_dim_to_batch_and_zero_pad": 3.696874375929228e-05, "batch_individual_items": 0.00010198259031092997}}, "connector_pipeline_timer": 0.0006162093439683705}, "episode_return_max": 0.7967777777777778, "episode_duration_sec_mean": 21.805326340788618, "num_episodes_lifetime": 384, "rlmodule_inference_timer": 0.0005570574009697934, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5536923076923079, "env_to_module_sum_episodes_length_out": 92.79468189226147, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1078634209288798, "num_env_steps_sampled_lifetime": 84000, "weights_seq_no": 41.0, "agent_episode_returns_mean": {"default_agent": 0.5536923076923079}, "module_episode_returns_mean": {"default_policy": 0.5536923076923079}, "num_env_steps_sampled": 2000, "sample": 30.322714487030247, "env_to_module_sum_episodes_length_in": 92.79468189226147, "time_between_sampling": 12.41614214206626, "num_env_steps_sampled_lifetime_throughput": 52.954823903547904}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.16248494386672974, "weights_seq_no": 42.0, "vf_loss_unclipped": 0.004737761337310076, "total_loss": -0.15774700045585632, "gradients_default_optimizer_global_norm": 0.544431746006012, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.013749301433563232, "entropy": 0.33811309933662415, "curr_kl_coeff": 4.882812572759576e-05, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001839255797676742, "num_module_steps_trained_lifetime": 2544384, "vf_loss": 0.004737761337310076}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044852654029158154, "add_observations_from_episodes_to_batch": 0.00035785670387114045, "add_one_ts_to_episodes_and_truncate": 0.007350099633044206, "add_columns_from_episodes_to_train_batch": 0.07889450735387275, "general_advantage_estimation": 0.12886520028118822, "add_states_from_episodes_to_batch": 1.102461328313892e-05, "numpy_to_tensor": 0.0013295225726762915, "add_time_dim_to_batch_and_zero_pad": 3.0908688467445084e-05}}, "connector_pipeline_timer": 0.26228754981766317}, "num_module_steps_trained_lifetime": 2544384, "learner_connector_sum_episodes_length_out": 2016.0755847714736, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 40096848, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 84000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.954823903547904, "done": false, "training_iteration": 42, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-22-36", "timestamp": 1747693356, "time_this_iter_s": 37.708961725234985, "time_total_s": 1683.1126067638397, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1683.1126067638397, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 76.8377358490566, "ram_util_percent": 50.713207547169795}}
{"timers": {"training_iteration": 42.2453732963637, "restore_env_runners": 2.869190097569431e-05, "training_step": 42.24489166581659, "env_runner_sampling_timer": 31.8539654124142, "learner_update_timer": 10.37596288148821, "synch_weights": 0.014024968711303152, "synch_env_connectors": 0.009220023809075049}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29833333333333323, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016423646230509616, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.540481172744679e-06, "un_batch_to_individual_items": 7.2927790341822e-05, "listify_data_for_vector_env": 0.0001373642234061358, "normalize_and_clip_actions": 0.0001254335652705439, "get_actions": 0.0007284949284616176, "tensor_to_numpy": 0.0002366198520244066}}}, "num_module_steps_sampled_lifetime": {"default_policy": 86000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 86000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.044745695271792e-05, "add_states_from_episodes_to_batch": 1.965125723820544e-05, "numpy_to_tensor": 0.00016746206097655936, "add_time_dim_to_batch_and_zero_pad": 3.774184191084767e-05, "batch_individual_items": 0.00010305415813599667}}, "connector_pipeline_timer": 0.000623933906616744}, "episode_return_max": 0.7967777777777778, "episode_duration_sec_mean": 21.41106106124971, "num_episodes_lifetime": 392, "rlmodule_inference_timer": 0.0005658742574296679, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.48738034188034185, "env_to_module_sum_episodes_length_out": 93.12388493351914, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10863837795884314, "num_env_steps_sampled_lifetime": 86000, "weights_seq_no": 42.0, "agent_episode_returns_mean": {"default_agent": 0.48738034188034185}, "module_episode_returns_mean": {"default_policy": 0.48738034188034185}, "num_env_steps_sampled": 2000, "sample": 30.310947369600232, "env_to_module_sum_episodes_length_in": 93.12388493351914, "time_between_sampling": 12.398648725374338, "num_env_steps_sampled_lifetime_throughput": 45.47600672935253}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06376530230045319, "weights_seq_no": 43.0, "vf_loss_unclipped": 0.005258380435407162, "total_loss": 0.06902410835027695, "gradients_default_optimizer_global_norm": 0.34140777587890625, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.11257374286651611, "entropy": 0.31145331263542175, "curr_kl_coeff": 4.882812572759576e-05, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.008621666580438614, "num_module_steps_trained_lifetime": 2604928, "vf_loss": 0.005258380435407162}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04489764800518996, "add_observations_from_episodes_to_batch": 0.0003578912983862371, "add_one_ts_to_episodes_and_truncate": 0.007346978935856198, "add_columns_from_episodes_to_train_batch": 0.07889978591293031, "general_advantage_estimation": 0.12851280363194467, "add_states_from_episodes_to_batch": 1.1028251605250103e-05, "numpy_to_tensor": 0.001329916648230026, "add_time_dim_to_batch_and_zero_pad": 3.091831154359016e-05}}, "connector_pipeline_timer": 0.26198221266580346}, "num_module_steps_trained_lifetime": 2604928, "learner_connector_sum_episodes_length_out": 2016.078771808025, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 41050416, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 86000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.47600672935253, "done": false, "training_iteration": 43, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-23-20", "timestamp": 1747693400, "time_this_iter_s": 43.92006731033325, "time_total_s": 1727.032674074173, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1727.032674074173, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 73.64761904761907, "ram_util_percent": 50.712698412698394}}
{"timers": {"training_iteration": 42.20907159764007, "restore_env_runners": 2.8640981943968398e-05, "training_step": 42.20858893639843, "env_runner_sampling_timer": 31.837551032790127, "learner_update_timer": 10.356092573413308, "synch_weights": 0.014006651024155575, "synch_env_connectors": 0.009223063570993952}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.15655555555555548, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016387753498038752, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.40652885991981e-06, "un_batch_to_individual_items": 7.299141545783211e-05, "listify_data_for_vector_env": 0.00013679628746048303, "normalize_and_clip_actions": 0.00012553416320906747, "get_actions": 0.0007273509965142605, "tensor_to_numpy": 0.00023542828482921917}}}, "num_module_steps_sampled_lifetime": {"default_policy": 88000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 88000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.022920050737425e-05, "add_states_from_episodes_to_batch": 1.961776489580907e-05, "numpy_to_tensor": 0.0001674184965485183, "add_time_dim_to_batch_and_zero_pad": 3.784548071765325e-05, "batch_individual_items": 0.00010223606391030504}}, "connector_pipeline_timer": 0.0006211661204332178}, "episode_return_max": 0.6884444444444442, "episode_duration_sec_mean": 24.540971423970333, "num_episodes_lifetime": 400, "rlmodule_inference_timer": 0.0005611803698429937, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4342542735042735, "env_to_module_sum_episodes_length_out": 95.47042449570965, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10791018672991066, "num_env_steps_sampled_lifetime": 88000, "weights_seq_no": 43.0, "agent_episode_returns_mean": {"default_agent": 0.4342542735042735}, "module_episode_returns_mean": {"default_policy": 0.4342542735042735}, "num_env_steps_sampled": 2000, "sample": 30.298969193056315, "env_to_module_sum_episodes_length_in": 95.47042449570965, "time_between_sampling": 12.383179448408821, "num_env_steps_sampled_lifetime_throughput": 51.672367621111086}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.01592128723859787, "weights_seq_no": 44.0, "vf_loss_unclipped": 0.003117247484624386, "total_loss": 0.01903872936964035, "gradients_default_optimizer_global_norm": 0.40625283122062683, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09048616886138916, "entropy": 0.3085591793060303, "curr_kl_coeff": 2.441406286379788e-05, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004177136346697807, "num_module_steps_trained_lifetime": 2665472, "vf_loss": 0.003117247484624386}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04494157706629851, "add_observations_from_episodes_to_batch": 0.0003579217353408178, "add_one_ts_to_episodes_and_truncate": 0.007343754912648333, "add_columns_from_episodes_to_train_batch": 0.07890522718007129, "general_advantage_estimation": 0.1281558613656581, "add_states_from_episodes_to_batch": 1.1031714699201688e-05, "numpy_to_tensor": 0.0013302676000158278, "add_time_dim_to_batch_and_zero_pad": 3.092792128952672e-05}}, "connector_pipeline_timer": 0.2616712603219991}, "num_module_steps_trained_lifetime": 2665472, "learner_connector_sum_episodes_length_out": 2016.0818875453683, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 42003984, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 88000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.672367621111086, "done": false, "training_iteration": 44, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-23-58", "timestamp": 1747693438, "time_this_iter_s": 38.648277759552, "time_total_s": 1765.680951833725, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1765.680951833725, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 77.70727272727274, "ram_util_percent": 50.801818181818206}}
{"timers": {"training_iteration": 42.18100060697373, "restore_env_runners": 2.857857215670498e-05, "training_step": 42.18051782435442, "env_runner_sampling_timer": 31.822704846272224, "learner_update_timer": 10.342935989189177, "synch_weights": 0.01393683351396892, "synch_env_connectors": 0.00924073993528949}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26177777777777766, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001630743647604698, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.37723495845748e-06, "un_batch_to_individual_items": 7.252725694482415e-05, "listify_data_for_vector_env": 0.00013641809056035497, "normalize_and_clip_actions": 0.00012489066290622178, "get_actions": 0.0007241539625879458, "tensor_to_numpy": 0.00023378012323724195}}}, "num_module_steps_sampled_lifetime": {"default_policy": 90000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 90000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.985690587736735e-05, "add_states_from_episodes_to_batch": 1.947040355425369e-05, "numpy_to_tensor": 0.00016585820404845577, "add_time_dim_to_batch_and_zero_pad": 3.7808669949726325e-05, "batch_individual_items": 0.00010202399889576232}}, "connector_pipeline_timer": 0.0006192449211929027}, "episode_return_max": 0.7005555555555574, "episode_duration_sec_mean": 21.809865144039016, "num_episodes_lifetime": 416, "rlmodule_inference_timer": 0.0005592088006992462, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.44609081196581263, "env_to_module_sum_episodes_length_out": 97.17550989470028, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10835371960706836, "num_env_steps_sampled_lifetime": 90000, "weights_seq_no": 44.0, "agent_episode_returns_mean": {"default_agent": 0.44609081196581263}, "module_episode_returns_mean": {"default_policy": 0.44609081196581263}, "num_env_steps_sampled": 2000, "sample": 30.2870838168736, "env_to_module_sum_episodes_length_in": 97.17550989470028, "time_between_sampling": 12.36721809728968, "num_env_steps_sampled_lifetime_throughput": 50.611623593846495}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.2076936811208725, "weights_seq_no": 45.0, "vf_loss_unclipped": 0.008097643963992596, "total_loss": -0.19959576427936554, "gradients_default_optimizer_global_norm": 0.29572317004203796, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.03474235534667969, "entropy": 0.2865135073661804, "curr_kl_coeff": 2.441406286379788e-05, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.013040896505117416, "num_module_steps_trained_lifetime": 2726272, "vf_loss": 0.008097643963992596}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04498440824128437, "add_observations_from_episodes_to_batch": 0.00035797890442623037, "add_one_ts_to_episodes_and_truncate": 0.007340487752011453, "add_columns_from_episodes_to_train_batch": 0.07891037984317803, "general_advantage_estimation": 0.12779411312433359, "add_states_from_episodes_to_batch": 1.1035025705876947e-05, "numpy_to_tensor": 0.0013305914511008248, "add_time_dim_to_batch_and_zero_pad": 3.093699700922977e-05}}, "connector_pipeline_timer": 0.261354057323604}, "num_module_steps_trained_lifetime": 2726272, "learner_connector_sum_episodes_length_out": 2016.0857330907838, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 42965384, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 90000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.611623593846495, "done": false, "training_iteration": 45, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-24-38", "timestamp": 1747693478, "time_this_iter_s": 39.42737650871277, "time_total_s": 1805.1083283424377, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1805.1083283424377, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 77.18392857142858, "ram_util_percent": 50.81785714285714}}
{"timers": {"training_iteration": 42.112878333364016, "restore_env_runners": 2.8640786392877303e-05, "training_step": 42.1123946845709, "env_runner_sampling_timer": 31.77381178168949, "learner_update_timer": 10.32379134887724, "synch_weights": 0.013848628178782026, "synch_env_connectors": 0.009276837535966285}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26177777777777766, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001620989765659993, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.250092074110854e-06, "un_batch_to_individual_items": 7.150485188966009e-05, "listify_data_for_vector_env": 0.0001373331578914167, "normalize_and_clip_actions": 0.0001239955519492313, "get_actions": 0.0007196269610530031, "tensor_to_numpy": 0.00023222629010237066}}}, "num_module_steps_sampled_lifetime": {"default_policy": 92000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 92000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.989873763550206e-05, "add_states_from_episodes_to_batch": 1.94735484066428e-05, "numpy_to_tensor": 0.00016506046329923748, "add_time_dim_to_batch_and_zero_pad": 3.759391255826685e-05, "batch_individual_items": 0.0001010305759858131}}, "connector_pipeline_timer": 0.0006181230700333943}, "episode_return_max": 0.7005555555555574, "episode_duration_sec_mean": 21.33244129808687, "num_episodes_lifetime": 424, "rlmodule_inference_timer": 0.0005545406573408554, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4987008547008554, "env_to_module_sum_episodes_length_out": 96.40464053454478, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10803542354438704, "num_env_steps_sampled_lifetime": 92000, "weights_seq_no": 45.0, "agent_episode_returns_mean": {"default_agent": 0.4987008547008554}, "module_episode_returns_mean": {"default_policy": 0.4987008547008554}, "num_env_steps_sampled": 2000, "sample": 30.273107923936966, "env_to_module_sum_episodes_length_in": 96.40464053454478, "time_between_sampling": 12.351141359072626, "num_env_steps_sampled_lifetime_throughput": 56.378746889949326}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08853373676538467, "weights_seq_no": 46.0, "vf_loss_unclipped": 0.006285293027758598, "total_loss": -0.08224835246801376, "gradients_default_optimizer_global_norm": 0.09690345823764801, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.005960702896118164, "entropy": 0.23478148877620697, "curr_kl_coeff": 1.220703143189894e-05, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00366237317211926, "num_module_steps_trained_lifetime": 2786816, "vf_loss": 0.006285293027758598}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04502604599496343, "add_observations_from_episodes_to_batch": 0.00035803036795627744, "add_one_ts_to_episodes_and_truncate": 0.007337082218996732, "add_columns_from_episodes_to_train_batch": 0.0789149216201045, "general_advantage_estimation": 0.12742761803169875, "add_states_from_episodes_to_batch": 1.1038247321168879e-05, "numpy_to_tensor": 0.0013308768484044961, "add_time_dim_to_batch_and_zero_pad": 3.094822842301115e-05}}, "connector_pipeline_timer": 0.2610301074387444}, "num_module_steps_trained_lifetime": 2786816, "learner_connector_sum_episodes_length_out": 2016.0894935365366, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 43918952, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 92000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.378746889949326, "done": false, "training_iteration": 46, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-25-13", "timestamp": 1747693513, "time_this_iter_s": 35.385493993759155, "time_total_s": 1840.493822336197, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1840.493822336197, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 78.21799999999999, "ram_util_percent": 50.808000000000014}}
{"timers": {"training_iteration": 42.06091819042042, "restore_env_runners": 2.8581378511208697e-05, "training_step": 42.06043296811519, "env_runner_sampling_timer": 31.73956831068259, "learner_update_timer": 10.306142354968507, "synch_weights": 0.013775975896973281, "synch_env_connectors": 0.009273644160553839}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2787777777777779, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016123536081091444, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.738449321063719e-06, "un_batch_to_individual_items": 7.10830233463219e-05, "listify_data_for_vector_env": 0.0001363753143815491, "normalize_and_clip_actions": 0.00012319867088079879, "get_actions": 0.0007170702429983169, "tensor_to_numpy": 0.00023069993183369536}}}, "num_module_steps_sampled_lifetime": {"default_policy": 94000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 94000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.9562327203656305e-05, "add_states_from_episodes_to_batch": 1.9275533886423366e-05, "numpy_to_tensor": 0.0001641867124167786, "add_time_dim_to_batch_and_zero_pad": 3.717881235968736e-05, "batch_individual_items": 0.00010114456846303576}}, "connector_pipeline_timer": 0.0006134767976445157}, "episode_return_max": 0.8215555555555569, "episode_duration_sec_mean": 21.036148435220777, "num_episodes_lifetime": 432, "rlmodule_inference_timer": 0.0005522228208910915, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.549052350427351, "env_to_module_sum_episodes_length_out": 94.42398855920602, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10775369645960801, "num_env_steps_sampled_lifetime": 94000, "weights_seq_no": 46.0, "agent_episode_returns_mean": {"default_agent": 0.549052350427351}, "module_episode_returns_mean": {"default_policy": 0.549052350427351}, "num_env_steps_sampled": 2000, "sample": 30.257957790504292, "env_to_module_sum_episodes_length_in": 94.42398855920602, "time_between_sampling": 12.334009690570653, "num_env_steps_sampled_lifetime_throughput": 54.073955112434334}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00020602087897714227, "weights_seq_no": 47.0, "vf_loss_unclipped": 0.005101209506392479, "total_loss": 0.004895245190709829, "gradients_default_optimizer_global_norm": 0.4535970985889435, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.004124045372009277, "entropy": 0.24645933508872986, "curr_kl_coeff": 6.10351571594947e-06, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00347716361284256, "num_module_steps_trained_lifetime": 2847360, "vf_loss": 0.005101209506392479}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.045067148172544334, "add_observations_from_episodes_to_batch": 0.0003580787143251242, "add_one_ts_to_episodes_and_truncate": 0.007333529027767384, "add_columns_from_episodes_to_train_batch": 0.07892148490320773, "general_advantage_estimation": 0.1270566988096048, "add_states_from_episodes_to_batch": 1.1041481001838337e-05, "numpy_to_tensor": 0.0013311199086171053, "add_time_dim_to_batch_and_zero_pad": 3.0964151508690024e-05}}, "connector_pipeline_timer": 0.2607030208552496}, "num_module_steps_trained_lifetime": 2847360, "learner_connector_sum_episodes_length_out": 2016.0931702000653, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 44872520, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 94000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.073955112434334, "done": false, "training_iteration": 47, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-25-50", "timestamp": 1747693550, "time_this_iter_s": 36.93237066268921, "time_total_s": 1877.426192998886, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1877.426192998886, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 76.62830188679247, "ram_util_percent": 50.815094339622654}}
{"timers": {"training_iteration": 42.03637315446615, "restore_env_runners": 2.8502564701586062e-05, "training_step": 42.03588779038406, "env_runner_sampling_timer": 31.727611014685806, "learner_update_timer": 10.293629466258805, "synch_weights": 0.013699997137971143, "synch_env_connectors": 0.009269130718932582}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.25444444444444436, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016170244058420675, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.648979479573091e-06, "un_batch_to_individual_items": 7.085625369319652e-05, "listify_data_for_vector_env": 0.00013667106279475685, "normalize_and_clip_actions": 0.00012408498489301122, "get_actions": 0.0007183851721303741, "tensor_to_numpy": 0.00023423772662763178}}}, "num_module_steps_sampled_lifetime": {"default_policy": 96000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 96000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.9781603312059386e-05, "add_states_from_episodes_to_batch": 1.9537835173629872e-05, "numpy_to_tensor": 0.00016439961201686446, "add_time_dim_to_batch_and_zero_pad": 3.760529885538702e-05, "batch_individual_items": 0.00010206240844255239}}, "connector_pipeline_timer": 0.0006187468678957187}, "episode_return_max": 0.8215555555555569, "episode_duration_sec_mean": 21.898745958672198, "num_episodes_lifetime": 440, "rlmodule_inference_timer": 0.0005525856720125484, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4760844017094017, "env_to_module_sum_episodes_length_out": 92.80364322384696, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10781732777175267, "num_env_steps_sampled_lifetime": 96000, "weights_seq_no": 47.0, "agent_episode_returns_mean": {"default_agent": 0.4760844017094017}, "module_episode_returns_mean": {"default_policy": 0.4760844017094017}, "num_env_steps_sampled": 2000, "sample": 30.24330631415572, "env_to_module_sum_episodes_length_in": 92.80364322384696, "time_between_sampling": 12.316402073106046, "num_env_steps_sampled_lifetime_throughput": 50.40446115398982}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.011360248550772667, "weights_seq_no": 48.0, "vf_loss_unclipped": 0.002805874217301607, "total_loss": -0.008554360829293728, "gradients_default_optimizer_global_norm": 0.5094847679138184, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.00980985164642334, "entropy": 0.2427326887845993, "curr_kl_coeff": 3.051757857974735e-06, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0033790594898164272, "num_module_steps_trained_lifetime": 2907904, "vf_loss": 0.002805874217301607}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04510759154197436, "add_observations_from_episodes_to_batch": 0.0003581273807299128, "add_one_ts_to_episodes_and_truncate": 0.007330067642141109, "add_columns_from_episodes_to_train_batch": 0.07892900923838728, "general_advantage_estimation": 0.12668146225015026, "add_states_from_episodes_to_batch": 1.1044746183840938e-05, "numpy_to_tensor": 0.00133143587994041, "add_time_dim_to_batch_and_zero_pad": 3.0979891309669574e-05}}, "connector_pipeline_timer": 0.26037208564258063}, "num_module_steps_trained_lifetime": 2907904, "learner_connector_sum_episodes_length_out": 2016.0967643809697, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 45826088, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 96000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.40446115398982, "done": false, "training_iteration": 48, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-26-30", "timestamp": 1747693590, "time_this_iter_s": 39.62429451942444, "time_total_s": 1917.0504875183105, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1917.0504875183105, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 77.57500000000002, "ram_util_percent": 50.76607142857142}}
{"timers": {"training_iteration": 42.09214463334152, "restore_env_runners": 2.8564539004695084e-05, "training_step": 42.09165798290021, "env_runner_sampling_timer": 31.78816504736894, "learner_update_timer": 10.288902697176168, "synch_weights": 0.013643594176610551, "synch_env_connectors": 0.009268091401748885}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.25444444444444436, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001629580889056445, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.923082465494988e-06, "un_batch_to_individual_items": 7.212627331621505e-05, "listify_data_for_vector_env": 0.00013692167635515607, "normalize_and_clip_actions": 0.00012503187138679836, "get_actions": 0.0007226701637702492, "tensor_to_numpy": 0.00023634592850060667}}}, "num_module_steps_sampled_lifetime": {"default_policy": 98000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 98000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1154689797711646e-05, "add_states_from_episodes_to_batch": 2.0370564525756216e-05, "numpy_to_tensor": 0.0001646056785314368, "add_time_dim_to_batch_and_zero_pad": 3.736122072685258e-05, "batch_individual_items": 0.00010277029865981625}}, "connector_pipeline_timer": 0.0006213989107602397}, "episode_return_max": 0.6172222222222221, "episode_duration_sec_mean": 24.73952715060652, "num_episodes_lifetime": 448, "rlmodule_inference_timer": 0.0005561610594986315, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.41312606837606847, "env_to_module_sum_episodes_length_out": 92.53040423113829, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10823965215167439, "num_env_steps_sampled_lifetime": 98000, "weights_seq_no": 48.0, "agent_episode_returns_mean": {"default_agent": 0.41312606837606847}, "module_episode_returns_mean": {"default_policy": 0.41312606837606847}, "num_env_steps_sampled": 2000, "sample": 30.232537668149845, "env_to_module_sum_episodes_length_in": 92.53040423113829, "time_between_sampling": 12.298896271321535, "num_env_steps_sampled_lifetime_throughput": 41.93734519780765}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09188614785671234, "weights_seq_no": 49.0, "vf_loss_unclipped": 0.0031923181377351284, "total_loss": -0.08869381994009018, "gradients_default_optimizer_global_norm": 0.25121650099754333, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.025151491165161133, "entropy": 0.19140873849391937, "curr_kl_coeff": 1.5258789289873675e-06, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0015588917303830385, "num_module_steps_trained_lifetime": 2968448, "vf_loss": 0.0031923181377351284}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04514690412909892, "add_observations_from_episodes_to_batch": 0.00035817162593492315, "add_one_ts_to_episodes_and_truncate": 0.007326535061324714, "add_columns_from_episodes_to_train_batch": 0.07893710887827335, "general_advantage_estimation": 0.1263019134820037, "add_states_from_episodes_to_batch": 1.1047891914094967e-05, "numpy_to_tensor": 0.0013317420398467577, "add_time_dim_to_batch_and_zero_pad": 3.099543989925908e-05}}, "connector_pipeline_timer": 0.26003618574187987}, "num_module_steps_trained_lifetime": 2968448, "learner_connector_sum_episodes_length_out": 2016.100277361236, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 46779656, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 98000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 41.93734519780765, "done": false, "training_iteration": 49, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-27-18", "timestamp": 1747693638, "time_this_iter_s": 47.63246011734009, "time_total_s": 1964.6829476356506, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1964.6829476356506, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 74.97761194029849, "ram_util_percent": 50.71492537313431}}
{"timers": {"training_iteration": 42.07540469651812, "restore_env_runners": 2.861889358423114e-05, "training_step": 42.07491635058124, "env_runner_sampling_timer": 31.773474951665193, "learner_update_timer": 10.286914985944382, "synch_weights": 0.013577426234825744, "synch_env_connectors": 0.0092871944877684}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26611111111111097, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016281009397571076, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.829011345263058e-06, "un_batch_to_individual_items": 7.198078226829014e-05, "listify_data_for_vector_env": 0.00013631112328820404, "normalize_and_clip_actions": 0.00012485316099134625, "get_actions": 0.0007228467690042494, "tensor_to_numpy": 0.00023525282035400245}}}, "num_module_steps_sampled_lifetime": {"default_policy": 100000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 100000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.116967026453604e-05, "add_states_from_episodes_to_batch": 2.0576257046329504e-05, "numpy_to_tensor": 0.00016554669936467273, "add_time_dim_to_batch_and_zero_pad": 3.7148049555673195e-05, "batch_individual_items": 0.00010281630787444591}}, "connector_pipeline_timer": 0.0006229431269414459}, "episode_return_max": 0.6074444444444442, "episode_duration_sec_mean": 25.144354591943458, "num_episodes_lifetime": 456, "rlmodule_inference_timer": 0.0005558840235404424, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4115459401709402, "env_to_module_sum_episodes_length_out": 94.15315396766522, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10777639389463614, "num_env_steps_sampled_lifetime": 100000, "weights_seq_no": 49.0, "agent_episode_returns_mean": {"default_agent": 0.4115459401709402}, "module_episode_returns_mean": {"default_policy": 0.4115459401709402}, "num_env_steps_sampled": 2000, "sample": 30.221563702818713, "env_to_module_sum_episodes_length_in": 94.15315396766522, "time_between_sampling": 12.284279421649568, "num_env_steps_sampled_lifetime_throughput": 49.36421354500017}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.19572682678699493, "weights_seq_no": 50.0, "vf_loss_unclipped": 0.004055518191307783, "total_loss": -0.19167131185531616, "gradients_default_optimizer_global_norm": 0.1847345381975174, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.026219308376312256, "entropy": 0.23522011935710907, "curr_kl_coeff": 7.629394644936838e-07, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002872658194974065, "num_module_steps_trained_lifetime": 3028992, "vf_loss": 0.004055518191307783}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.045185193965227355, "add_observations_from_episodes_to_batch": 0.00035821536349757, "add_one_ts_to_episodes_and_truncate": 0.007323067065360163, "add_columns_from_episodes_to_train_batch": 0.07894525741443818, "general_advantage_estimation": 0.12591816568299505, "add_states_from_episodes_to_batch": 1.1051190255717916e-05, "numpy_to_tensor": 0.0013320162329669295, "add_time_dim_to_batch_and_zero_pad": 3.1010939528044674e-05}}, "connector_pipeline_timer": 0.2596951375505289}, "num_module_steps_trained_lifetime": 3028992, "learner_connector_sum_episodes_length_out": 2016.103710405459, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 47733224, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 100000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.36421354500017, "done": false, "training_iteration": 50, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-27-58", "timestamp": 1747693678, "time_this_iter_s": 40.44111347198486, "time_total_s": 2005.1240611076355, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2005.1240611076355, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 74.61724137931034, "ram_util_percent": 50.79137931034484}}
{"timers": {"training_iteration": 42.15067469432296, "restore_env_runners": 2.8569704634034352e-05, "training_step": 42.15018514784547, "env_runner_sampling_timer": 31.862437605328473, "learner_update_timer": 10.273301640684972, "synch_weights": 0.01349515996249211, "synch_env_connectors": 0.00932110254288213}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.23088888888888892, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016357626220898384, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.897149280288414e-06, "un_batch_to_individual_items": 7.213251346336997e-05, "listify_data_for_vector_env": 0.00013714499763879147, "normalize_and_clip_actions": 0.0001248087195991655, "get_actions": 0.0007258018843793935, "tensor_to_numpy": 0.00023663227297365013}}}, "num_module_steps_sampled_lifetime": {"default_policy": 102000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 102000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.095918368464561e-05, "add_states_from_episodes_to_batch": 2.0970420342692315e-05, "numpy_to_tensor": 0.00016826814380314822, "add_time_dim_to_batch_and_zero_pad": 3.796670402882393e-05, "batch_individual_items": 0.00010300208313219629}}, "connector_pipeline_timer": 0.0006266851486139791}, "episode_return_max": 0.7476666666666683, "episode_duration_sec_mean": 26.011475160395303, "num_episodes_lifetime": 472, "rlmodule_inference_timer": 0.0005597618717472342, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.4634583333333341, "env_to_module_sum_episodes_length_out": 96.86038707147999, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10886322821215016, "num_env_steps_sampled_lifetime": 102000, "weights_seq_no": 50.0, "agent_episode_returns_mean": {"default_agent": 0.4634583333333341}, "module_episode_returns_mean": {"default_policy": 0.4634583333333341}, "num_env_steps_sampled": 2000, "sample": 30.21713066873169, "env_to_module_sum_episodes_length_in": 96.86038707147999, "time_between_sampling": 12.270618907923103, "num_env_steps_sampled_lifetime_throughput": 40.13606988449347}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07111722230911255, "weights_seq_no": 51.0, "vf_loss_unclipped": 0.006244359537959099, "total_loss": -0.0648728534579277, "gradients_default_optimizer_global_norm": 0.6804152131080627, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.20054250955581665, "entropy": 0.2518603801727295, "curr_kl_coeff": 3.814697322468419e-07, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002934069372713566, "num_module_steps_trained_lifetime": 3089792, "vf_loss": 0.006244359537959099}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04522223366412044, "add_observations_from_episodes_to_batch": 0.0003582683291460544, "add_one_ts_to_episodes_and_truncate": 0.007319549165808988, "add_columns_from_episodes_to_train_batch": 0.0789528268688916, "general_advantage_estimation": 0.12553061998861828, "add_states_from_episodes_to_batch": 1.1054497840843356e-05, "numpy_to_tensor": 0.0013322704480207275, "add_time_dim_to_batch_and_zero_pad": 3.1026819620019726e-05}}, "connector_pipeline_timer": 0.25934838920423076}, "num_module_steps_trained_lifetime": 3089792, "learner_connector_sum_episodes_length_out": 2016.1078647610611, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 48694624, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 102000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 40.13606988449347, "done": false, "training_iteration": 51, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-28-48", "timestamp": 1747693728, "time_this_iter_s": 49.61973214149475, "time_total_s": 2054.7437932491302, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2054.7437932491302, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 77.74788732394364, "ram_util_percent": 50.78028169014087}}
{"timers": {"training_iteration": 42.148223260199714, "restore_env_runners": 2.858500762410965e-05, "training_step": 42.14773276917702, "env_runner_sampling_timer": 31.8753105324752, "learner_update_timer": 10.258048022878093, "synch_weights": 0.013421129372875503, "synch_env_connectors": 0.009313072507443784}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.23088888888888892, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001641221804240347, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.788458950823912e-06, "un_batch_to_individual_items": 7.154245452985466e-05, "listify_data_for_vector_env": 0.00013975122595208476, "normalize_and_clip_actions": 0.0001237689796450932, "get_actions": 0.000726843361285706, "tensor_to_numpy": 0.00023725080840574994}}}, "num_module_steps_sampled_lifetime": {"default_policy": 104000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 104000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.063596270266613e-05, "add_states_from_episodes_to_batch": 2.114975365040326e-05, "numpy_to_tensor": 0.0001688306349972706, "add_time_dim_to_batch_and_zero_pad": 3.771593552338003e-05, "batch_individual_items": 0.00010261580167510562}}, "connector_pipeline_timer": 0.0006261142232556299}, "episode_return_max": 0.7476666666666683, "episode_duration_sec_mean": 25.298829703069575, "num_episodes_lifetime": 480, "rlmodule_inference_timer": 0.0005634320005211003, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4966057692307699, "env_to_module_sum_episodes_length_out": 97.02983633040628, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10979052586687926, "num_env_steps_sampled_lifetime": 104000, "weights_seq_no": 51.0, "agent_episode_returns_mean": {"default_agent": 0.4966057692307699}, "module_episode_returns_mean": {"default_policy": 0.4966057692307699}, "num_env_steps_sampled": 2000, "sample": 30.213230227024017, "env_to_module_sum_episodes_length_in": 97.02983633040628, "time_between_sampling": 12.258097031107686, "num_env_steps_sampled_lifetime_throughput": 47.64326108705107}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0539199560880661, "weights_seq_no": 52.0, "vf_loss_unclipped": 0.007500968873500824, "total_loss": 0.06142091751098633, "gradients_default_optimizer_global_norm": 0.1492704600095749, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.2185039520263672, "entropy": 0.21417556703090668, "curr_kl_coeff": 1.9073486612342094e-07, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004142811521887779, "num_module_steps_trained_lifetime": 3150336, "vf_loss": 0.007500968873500824}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04525887094943892, "add_observations_from_episodes_to_batch": 0.00035831616394541775, "add_one_ts_to_episodes_and_truncate": 0.007315945017542927, "add_columns_from_episodes_to_train_batch": 0.07896098448821479, "general_advantage_estimation": 0.12513912894156087, "add_states_from_episodes_to_batch": 1.105761415542696e-05, "numpy_to_tensor": 0.0013324842871506298, "add_time_dim_to_batch_and_zero_pad": 3.104208101642278e-05}}, "connector_pipeline_timer": 0.2589977354806037}, "num_module_steps_trained_lifetime": 3150336, "learner_connector_sum_episodes_length_out": 2016.111925658511, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 49648192, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 104000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.64326108705107, "done": false, "training_iteration": 52, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-29-30", "timestamp": 1747693770, "time_this_iter_s": 41.9231493473053, "time_total_s": 2096.6669425964355, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2096.6669425964355, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 76.5135593220339, "ram_util_percent": 50.767796610169476}}
{"timers": {"training_iteration": 42.186796646717674, "restore_env_runners": 2.8590157508139265e-05, "training_step": 42.18630549460524, "env_runner_sampling_timer": 31.906386651850454, "learner_update_timer": 10.265621885089313, "synch_weights": 0.013343389069167646, "synch_env_connectors": 0.00930749480242673}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2403333333333334, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016686760853164555, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.97202163388287e-06, "un_batch_to_individual_items": 7.29123712537902e-05, "listify_data_for_vector_env": 0.000140755076587869, "normalize_and_clip_actions": 0.0001270529511183707, "get_actions": 0.0007394592617031373, "tensor_to_numpy": 0.00024194911695201744}}}, "num_module_steps_sampled_lifetime": {"default_policy": 106000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 106000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.135965718372445e-05, "add_states_from_episodes_to_batch": 2.2177230021030914e-05, "numpy_to_tensor": 0.00017020740569642068, "add_time_dim_to_batch_and_zero_pad": 3.7726005622524965e-05, "batch_individual_items": 0.00010460144937120456}}, "connector_pipeline_timer": 0.0006352588245925524}, "episode_return_max": 0.7403333333333347, "episode_duration_sec_mean": 24.389464574565935, "num_episodes_lifetime": 488, "rlmodule_inference_timer": 0.0005769609824953748, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4490224358974365, "env_to_module_sum_episodes_length_out": 95.2651245379085, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11148187098568024, "num_env_steps_sampled_lifetime": 106000, "weights_seq_no": 52.0, "agent_episode_returns_mean": {"default_agent": 0.4490224358974365}, "module_episode_returns_mean": {"default_policy": 0.4490224358974365}, "num_env_steps_sampled": 2000, "sample": 30.211753139288103, "env_to_module_sum_episodes_length_in": 95.2651245379085, "time_between_sampling": 12.24612803908182, "num_env_steps_sampled_lifetime_throughput": 43.39902356822856}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07682349532842636, "weights_seq_no": 53.0, "vf_loss_unclipped": 0.004910875577479601, "total_loss": 0.08173438161611557, "gradients_default_optimizer_global_norm": 0.3197883367538452, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.02044236660003662, "entropy": 0.15837222337722778, "curr_kl_coeff": 9.536743306171047e-08, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002557842992246151, "num_module_steps_trained_lifetime": 3210880, "vf_loss": 0.004910875577479601}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.045294278254384875, "add_observations_from_episodes_to_batch": 0.0003583662352161377, "add_one_ts_to_episodes_and_truncate": 0.007312201627125182, "add_columns_from_episodes_to_train_batch": 0.07896878147986473, "general_advantage_estimation": 0.12474409790304634, "add_states_from_episodes_to_batch": 1.1060592693774182e-05, "numpy_to_tensor": 0.0013326857423530264, "add_time_dim_to_batch_and_zero_pad": 3.10565845027415e-05}}, "connector_pipeline_timer": 0.2586417873778288}, "num_module_steps_trained_lifetime": 3210880, "learner_connector_sum_episodes_length_out": 2016.1158945515356, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 50601760, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 106000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.39902356822856, "done": false, "training_iteration": 53, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-30-16", "timestamp": 1747693816, "time_this_iter_s": 46.02217245101929, "time_total_s": 2142.689115047455, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2142.689115047455, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 75.48000000000002, "ram_util_percent": 50.72461538461538}}
{"timers": {"training_iteration": 42.13742551255052, "restore_env_runners": 2.860025593140105e-05, "training_step": 42.13693343295921, "env_runner_sampling_timer": 31.869461309911955, "learner_update_timer": 10.253247625958435, "synch_weights": 0.013270378178507703, "synch_env_connectors": 0.009286969834434371}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2507777777777778, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016587690769059474, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.886850229616738e-06, "un_batch_to_individual_items": 7.277830345328857e-05, "listify_data_for_vector_env": 0.00013993918047635804, "normalize_and_clip_actions": 0.00012628918934198997, "get_actions": 0.0007360891250872627, "tensor_to_numpy": 0.00024012487176715985}}}, "num_module_steps_sampled_lifetime": {"default_policy": 108000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 108000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.08914615602377e-05, "add_states_from_episodes_to_batch": 2.182701976134948e-05, "numpy_to_tensor": 0.0001689323496474019, "add_time_dim_to_batch_and_zero_pad": 3.816042455337616e-05, "batch_individual_items": 0.00010394017918031529}}, "connector_pipeline_timer": 0.0006344145827020816}, "episode_return_max": 0.7078888888888906, "episode_duration_sec_mean": 24.151673681123263, "num_episodes_lifetime": 496, "rlmodule_inference_timer": 0.000574426594835938, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4638493589743593, "env_to_module_sum_episodes_length_out": 93.36840509100271, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11085423985979029, "num_env_steps_sampled_lifetime": 108000, "weights_seq_no": 53.0, "agent_episode_returns_mean": {"default_agent": 0.4638493589743593}, "module_episode_returns_mean": {"default_policy": 0.4638493589743593}, "num_env_steps_sampled": 2000, "sample": 30.2080150766415, "env_to_module_sum_episodes_length_in": 93.36840509100271, "time_between_sampling": 12.235901909055835, "num_env_steps_sampled_lifetime_throughput": 53.59310223111176}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.007855843752622604, "weights_seq_no": 54.0, "vf_loss_unclipped": 0.005882638972252607, "total_loss": -0.001973213627934456, "gradients_default_optimizer_global_norm": 0.25250595808029175, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07829880714416504, "entropy": 0.17720286548137665, "curr_kl_coeff": 4.7683716530855236e-08, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004848364740610123, "num_module_steps_trained_lifetime": 3271424, "vf_loss": 0.005882638972252607}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.045328637165936804, "add_observations_from_episodes_to_batch": 0.0003584127734446804, "add_one_ts_to_episodes_and_truncate": 0.00730838924001459, "add_columns_from_episodes_to_train_batch": 0.07897606976283272, "general_advantage_estimation": 0.12434537669240774, "add_states_from_episodes_to_batch": 1.1063445899854438e-05, "numpy_to_tensor": 0.0013328679600228938, "add_time_dim_to_batch_and_zero_pad": 3.107064371186708e-05}}, "connector_pipeline_timer": 0.2582804898729614}, "num_module_steps_trained_lifetime": 3271424, "learner_connector_sum_episodes_length_out": 2016.1197728741338, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 51555328, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 108000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.59310223111176, "done": false, "training_iteration": 54, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-30-53", "timestamp": 1747693853, "time_this_iter_s": 37.26541519165039, "time_total_s": 2179.954530239105, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2179.954530239105, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 76.43773584905661, "ram_util_percent": 50.76981132075475}}
{"timers": {"training_iteration": 42.09849839962498, "restore_env_runners": 2.85422533619617e-05, "training_step": 42.09800543082958, "env_runner_sampling_timer": 31.832698525872814, "learner_update_timer": 10.251087066838851, "synch_weights": 0.013264801396664163, "synch_env_connectors": 0.009275508136059115}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2434444444444443, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016504269284588972, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.700944591574233e-06, "un_batch_to_individual_items": 7.240607111362245e-05, "listify_data_for_vector_env": 0.0001396191998919836, "normalize_and_clip_actions": 0.00012640122558046116, "get_actions": 0.0007331627641327465, "tensor_to_numpy": 0.0002384755666318242}}}, "num_module_steps_sampled_lifetime": {"default_policy": 110000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 110000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.028946004273099e-05, "add_states_from_episodes_to_batch": 2.1602905618023366e-05, "numpy_to_tensor": 0.00016704162075678353, "add_time_dim_to_batch_and_zero_pad": 3.7759241809789716e-05, "batch_individual_items": 0.00010260293859347083}}, "connector_pipeline_timer": 0.0006280560354028983}, "episode_return_max": 0.7358888888888893, "episode_duration_sec_mean": 22.2995281351236, "num_episodes_lifetime": 504, "rlmodule_inference_timer": 0.0005682237065382483, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4879529914529914, "env_to_module_sum_episodes_length_out": 92.53005874017066, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10977691436609463, "num_env_steps_sampled_lifetime": 110000, "weights_seq_no": 54.0, "agent_episode_returns_mean": {"default_agent": 0.4879529914529914}, "module_episode_returns_mean": {"default_policy": 0.4879529914529914}, "num_env_steps_sampled": 2000, "sample": 30.201886617118703, "env_to_module_sum_episodes_length_in": 92.53005874017066, "time_between_sampling": 12.22499166412694, "num_env_steps_sampled_lifetime_throughput": 52.19033491480142}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06140899658203125, "weights_seq_no": 55.0, "vf_loss_unclipped": 0.0028115566819906235, "total_loss": 0.06422056257724762, "gradients_default_optimizer_global_norm": 0.0784807801246643, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.006838560104370117, "entropy": 0.140212744474411, "curr_kl_coeff": 2.3841858265427618e-08, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0018728773575276136, "num_module_steps_trained_lifetime": 3331968, "vf_loss": 0.0028115566819906235}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.045362362841632524, "add_observations_from_episodes_to_batch": 0.0003584599442854227, "add_one_ts_to_episodes_and_truncate": 0.007304450600583326, "add_columns_from_episodes_to_train_batch": 0.07898374417249354, "general_advantage_estimation": 0.12394294985629142, "add_states_from_episodes_to_batch": 1.1066215982763811e-05, "numpy_to_tensor": 0.0013330333047653123, "add_time_dim_to_batch_and_zero_pad": 3.108432607799644e-05}}, "connector_pipeline_timer": 0.2579150889103539}, "num_module_steps_trained_lifetime": 3331968, "learner_connector_sum_episodes_length_out": 2016.123562040825, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 52508896, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 110000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.19033491480142, "done": false, "training_iteration": 55, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-31-32", "timestamp": 1747693892, "time_this_iter_s": 38.263758182525635, "time_total_s": 2218.218288421631, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2218.218288421631, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 73.28909090909092, "ram_util_percent": 50.81454545454548}}
{"timers": {"training_iteration": 42.130400013038766, "restore_env_runners": 2.8585830859684813e-05, "training_step": 42.12990487093129, "env_runner_sampling_timer": 31.86537360409413, "learner_update_timer": 10.250394486100404, "synch_weights": 0.01318116638272282, "synch_env_connectors": 0.009269440054701235}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2434444444444443, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016615095458445326, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.646890013871756e-06, "un_batch_to_individual_items": 7.222926703881438e-05, "listify_data_for_vector_env": 0.00014045460479597327, "normalize_and_clip_actions": 0.00012731503681606387, "get_actions": 0.0007380156547535166, "tensor_to_numpy": 0.00024014407156984255}}}, "num_module_steps_sampled_lifetime": {"default_policy": 112000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 112000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.061744375533423e-05, "add_states_from_episodes_to_batch": 2.1510226476443054e-05, "numpy_to_tensor": 0.00016867661014048903, "add_time_dim_to_batch_and_zero_pad": 3.847755483951644e-05, "batch_individual_items": 0.00010357519782294196}}, "connector_pipeline_timer": 0.0006325415585056468}, "episode_return_max": 0.7358888888888893, "episode_duration_sec_mean": 22.254095268296695, "num_episodes_lifetime": 512, "rlmodule_inference_timer": 0.0005706533179578168, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4354476495726497, "env_to_module_sum_episodes_length_out": 93.43378730858203, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.109874079992009, "num_env_steps_sampled_lifetime": 112000, "weights_seq_no": 55.0, "agent_episode_returns_mean": {"default_agent": 0.4354476495726497}, "module_episode_returns_mean": {"default_policy": 0.4354476495726497}, "num_env_steps_sampled": 2000, "sample": 30.197636077585145, "env_to_module_sum_episodes_length_in": 93.43378730858203, "time_between_sampling": 12.214573247285504, "num_env_steps_sampled_lifetime_throughput": 44.06927551477302}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.028861284255981445, "weights_seq_no": 56.0, "vf_loss_unclipped": 0.003402312286198139, "total_loss": -0.025458984076976776, "gradients_default_optimizer_global_norm": 0.307525098323822, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.08312016725540161, "entropy": 0.15577934682369232, "curr_kl_coeff": 1.1920929132713809e-08, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0035320022143423557, "num_module_steps_trained_lifetime": 3392512, "vf_loss": 0.003402312286198139}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04539578904059727, "add_observations_from_episodes_to_batch": 0.0003585536904315588, "add_one_ts_to_episodes_and_truncate": 0.007300831415116532, "add_columns_from_episodes_to_train_batch": 0.07899582200828438, "general_advantage_estimation": 0.12353675884932834, "add_states_from_episodes_to_batch": 1.1069014319027513e-05, "numpy_to_tensor": 0.0013331680858166134, "add_time_dim_to_batch_and_zero_pad": 3.1097927732094005e-05}}, "connector_pipeline_timer": 0.2575503652000114}, "num_module_steps_trained_lifetime": 3392512, "learner_connector_sum_episodes_length_out": 2016.1272634468949, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 53462464, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 112000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.06927551477302, "done": false, "training_iteration": 56, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-32-17", "timestamp": 1747693937, "time_this_iter_s": 45.30890774726868, "time_total_s": 2263.5271961688995, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2263.5271961688995, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 74.8421875, "ram_util_percent": 50.814062500000006}}
{"timers": {"training_iteration": 42.11398154578838, "restore_env_runners": 2.8588972568889262e-05, "training_step": 42.113485501102, "env_runner_sampling_timer": 31.860456841033155, "learner_update_timer": 10.238957369139396, "synch_weights": 0.013114484718898273, "synch_env_connectors": 0.00924651765414223}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26188888888888895, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001657844271757441, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.524404757754253e-06, "un_batch_to_individual_items": 7.256820148643813e-05, "listify_data_for_vector_env": 0.00014080215311870092, "normalize_and_clip_actions": 0.00012661475190541886, "get_actions": 0.0007361948304463906, "tensor_to_numpy": 0.00023961981759183264}}}, "num_module_steps_sampled_lifetime": {"default_policy": 114000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 114000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0738859106288654e-05, "add_states_from_episodes_to_batch": 2.116671658519295e-05, "numpy_to_tensor": 0.0001674320731571285, "add_time_dim_to_batch_and_zero_pad": 3.823634219030821e-05, "batch_individual_items": 0.00010269949022193892}}, "connector_pipeline_timer": 0.0006286623742964475}, "episode_return_max": 0.6032222222222225, "episode_duration_sec_mean": 24.381419910499762, "num_episodes_lifetime": 520, "rlmodule_inference_timer": 0.0005704209765124943, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.3813205128205131, "env_to_module_sum_episodes_length_out": 96.43075871501132, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10911486942355711, "num_env_steps_sampled_lifetime": 114000, "weights_seq_no": 56.0, "agent_episode_returns_mean": {"default_agent": 0.3813205128205131}, "module_episode_returns_mean": {"default_policy": 0.3813205128205131}, "num_env_steps_sampled": 2000, "sample": 30.192975179872022, "env_to_module_sum_episodes_length_in": 96.43075871501132, "time_between_sampling": 12.205988608100112, "num_env_steps_sampled_lifetime_throughput": 49.30159327469731}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.02308797836303711, "weights_seq_no": 57.0, "vf_loss_unclipped": 0.00327319442294538, "total_loss": 0.026361171156167984, "gradients_default_optimizer_global_norm": 0.1765044629573822, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10913956165313721, "entropy": 0.16623085737228394, "curr_kl_coeff": 1.1920929132713809e-08, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005012895911931992, "num_module_steps_trained_lifetime": 3453056, "vf_loss": 0.00327319442294538}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04542798346919847, "add_observations_from_episodes_to_batch": 0.000358641205660745, "add_one_ts_to_episodes_and_truncate": 0.007297085838298343, "add_columns_from_episodes_to_train_batch": 0.07900736000274211, "general_advantage_estimation": 0.12312720798741912, "add_states_from_episodes_to_batch": 1.10716500673062e-05, "numpy_to_tensor": 0.0013332920679158685, "add_time_dim_to_batch_and_zero_pad": 3.111095892079827e-05}}, "connector_pipeline_timer": 0.2571803533045848}, "num_module_steps_trained_lifetime": 3453056, "learner_connector_sum_episodes_length_out": 2016.1308784686391, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 54416032, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 114000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.30159327469731, "done": false, "training_iteration": 57, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-32-58", "timestamp": 1747693978, "time_this_iter_s": 40.51004505157471, "time_total_s": 2304.0372412204742, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2304.0372412204742, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 75.24137931034481, "ram_util_percent": 50.81551724137932}}
{"timers": {"training_iteration": 42.10136958322046, "restore_env_runners": 2.8603082872001518e-05, "training_step": 42.10087171098099, "env_runner_sampling_timer": 31.86491668013285, "learner_update_timer": 10.221956309827958, "synch_weights": 0.013035668871736674, "synch_env_connectors": 0.009265993477669135}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.273777777777778, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016516948109461858, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.385060840356868e-06, "un_batch_to_individual_items": 7.289343483710283e-05, "listify_data_for_vector_env": 0.00013961392069159416, "normalize_and_clip_actions": 0.00012588594714946046, "get_actions": 0.0007328713955066758, "tensor_to_numpy": 0.00023893680979268327}}}, "num_module_steps_sampled_lifetime": {"default_policy": 116000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 116000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0470131242531874e-05, "add_states_from_episodes_to_batch": 2.0825791280117172e-05, "numpy_to_tensor": 0.0001663016980471352, "add_time_dim_to_batch_and_zero_pad": 3.7945253463259614e-05, "batch_individual_items": 0.0001021449966383947}}, "connector_pipeline_timer": 0.0006238505391261594}, "episode_return_max": 0.7120000000000014, "episode_duration_sec_mean": 23.346767829288044, "num_episodes_lifetime": 536, "rlmodule_inference_timer": 0.0005682159398581942, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.44774465811965897, "env_to_module_sum_episodes_length_out": 97.4865446922611, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10898863535573906, "num_env_steps_sampled_lifetime": 116000, "weights_seq_no": 57.0, "agent_episode_returns_mean": {"default_agent": 0.44774465811965897}, "module_episode_returns_mean": {"default_policy": 0.44774465811965897}, "num_env_steps_sampled": 2000, "sample": 30.188847902577766, "env_to_module_sum_episodes_length_in": 97.4865446922611, "time_between_sampling": 12.197513834531131, "num_env_steps_sampled_lifetime_throughput": 48.85178843421038}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08513661473989487, "weights_seq_no": 58.0, "vf_loss_unclipped": 0.007667120546102524, "total_loss": -0.07746950536966324, "gradients_default_optimizer_global_norm": 0.21993684768676758, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06979894638061523, "entropy": 0.1554248183965683, "curr_kl_coeff": 5.9604645663569045e-09, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003323416458442807, "num_module_steps_trained_lifetime": 3513856, "vf_loss": 0.007667120546102524}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0454590222802236, "add_observations_from_episodes_to_batch": 0.00035873689521637744, "add_one_ts_to_episodes_and_truncate": 0.007293314119874989, "add_columns_from_episodes_to_train_batch": 0.07901806615501007, "general_advantage_estimation": 0.12271412458686343, "add_states_from_episodes_to_batch": 1.1074156199026786e-05, "numpy_to_tensor": 0.0013333853435644086, "add_time_dim_to_batch_and_zero_pad": 3.112343969260023e-05}}, "connector_pipeline_timer": 0.25680475890034626}, "num_module_steps_trained_lifetime": 3513856, "learner_connector_sum_episodes_length_out": 2016.1352084636042, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 55377432, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 116000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.85178843421038, "done": false, "training_iteration": 58, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-33-39", "timestamp": 1747694019, "time_this_iter_s": 40.86770534515381, "time_total_s": 2344.904946565628, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2344.904946565628, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 77.67413793103448, "ram_util_percent": 50.837931034482764}}
{"timers": {"training_iteration": 42.06458660168832, "restore_env_runners": 2.854405202554167e-05, "training_step": 42.06408918617115, "env_runner_sampling_timer": 31.837613560701474, "learner_update_timer": 10.212554012659668, "synch_weights": 0.012958318182963016, "synch_env_connectors": 0.009243311542848324}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2981111111111114, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016510570938943654, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.265607926157297e-06, "un_batch_to_individual_items": 7.248819496711033e-05, "listify_data_for_vector_env": 0.00013979086254488135, "normalize_and_clip_actions": 0.00012553595316461218, "get_actions": 0.0007311863162767684, "tensor_to_numpy": 0.00023924012318724788}}}, "num_module_steps_sampled_lifetime": {"default_policy": 118000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 118000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.006488547253343e-05, "add_states_from_episodes_to_batch": 2.0722367822993583e-05, "numpy_to_tensor": 0.00016505590869613589, "add_time_dim_to_batch_and_zero_pad": 3.7619844111721724e-05, "batch_individual_items": 0.00010132193412236109}}, "connector_pipeline_timer": 0.0006189266552596524}, "episode_return_max": 0.7120000000000014, "episode_duration_sec_mean": 22.92629153447181, "num_episodes_lifetime": 544, "rlmodule_inference_timer": 0.0005661989329078972, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4527414529914537, "env_to_module_sum_episodes_length_out": 96.1449445641814, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10893814452402605, "num_env_steps_sampled_lifetime": 118000, "weights_seq_no": 58.0, "agent_episode_returns_mean": {"default_agent": 0.4527414529914537}, "module_episode_returns_mean": {"default_policy": 0.4527414529914537}, "num_env_steps_sampled": 2000, "sample": 30.1836494340458, "env_to_module_sum_episodes_length_in": 96.1449445641814, "time_between_sampling": 12.188506844121541, "num_env_steps_sampled_lifetime_throughput": 51.959520792231515}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.13928192853927612, "weights_seq_no": 59.0, "vf_loss_unclipped": 0.003995813895016909, "total_loss": -0.1352861225605011, "gradients_default_optimizer_global_norm": 0.33289065957069397, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.014562487602233887, "entropy": 0.14952291548252106, "curr_kl_coeff": 2.9802322831784522e-09, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002414987189695239, "num_module_steps_trained_lifetime": 3574400, "vf_loss": 0.003995813895016909}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04549311090668162, "add_observations_from_episodes_to_batch": 0.00035882954686001383, "add_one_ts_to_episodes_and_truncate": 0.007289461347236205, "add_columns_from_episodes_to_train_batch": 0.07903261621813189, "general_advantage_estimation": 0.12229786917351967, "add_states_from_episodes_to_batch": 1.1077225043106433e-05, "numpy_to_tensor": 0.0013334505744927168, "add_time_dim_to_batch_and_zero_pad": 3.113859975322708e-05}}, "connector_pipeline_timer": 0.25643277524876235}, "num_module_steps_trained_lifetime": 3574400, "learner_connector_sum_episodes_length_out": 2016.1394387708228, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 56331000, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 118000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.959520792231515, "done": false, "training_iteration": 59, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-34-17", "timestamp": 1747694057, "time_this_iter_s": 38.438153982162476, "time_total_s": 2383.3431005477905, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2383.3431005477905, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 76.93454545454547, "ram_util_percent": 50.83636363636365}}
{"timers": {"training_iteration": 42.067228505731414, "restore_env_runners": 2.8478611507004543e-05, "training_step": 42.066731411369425, "env_runner_sampling_timer": 31.849914716114498, "learner_update_timer": 10.202964723573071, "synch_weights": 0.012886709001143677, "synch_env_connectors": 0.009223195427432685}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2981111111111114, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001658223249621271, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.175664471282603e-06, "un_batch_to_individual_items": 7.246255931563031e-05, "listify_data_for_vector_env": 0.00014127466629012379, "normalize_and_clip_actions": 0.0001257568260948535, "get_actions": 0.0007351890086071483, "tensor_to_numpy": 0.00023903544701871742}}}, "num_module_steps_sampled_lifetime": {"default_policy": 120000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 120000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.021082412835459e-05, "add_states_from_episodes_to_batch": 2.089144992699092e-05, "numpy_to_tensor": 0.0001657721148894803, "add_time_dim_to_batch_and_zero_pad": 3.798931594362348e-05, "batch_individual_items": 0.00010119312382385809}}, "connector_pipeline_timer": 0.0006214660684016494}, "episode_return_max": 0.805666666666668, "episode_duration_sec_mean": 23.376011459297143, "num_episodes_lifetime": 552, "rlmodule_inference_timer": 0.0005677296765045376, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.49362072649572714, "env_to_module_sum_episodes_length_out": 94.11319221270581, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10945245183525476, "num_env_steps_sampled_lifetime": 120000, "weights_seq_no": 59.0, "agent_episode_returns_mean": {"default_agent": 0.49362072649572714}, "module_episode_returns_mean": {"default_policy": 0.49362072649572714}, "num_env_steps_sampled": 2000, "sample": 30.17973411498894, "env_to_module_sum_episodes_length_in": 94.11319221270581, "time_between_sampling": 12.17870418238199, "num_env_steps_sampled_lifetime_throughput": 47.17235917775351}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.002766236662864685, "weights_seq_no": 60.0, "vf_loss_unclipped": 0.006050825584679842, "total_loss": 0.003284597769379616, "gradients_default_optimizer_global_norm": 0.3455556035041809, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06894868612289429, "entropy": 0.13489849865436554, "curr_kl_coeff": 1.4901161415892261e-09, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0013526930706575513, "num_module_steps_trained_lifetime": 3634944, "vf_loss": 0.006050825584679842}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04552604385838218, "add_observations_from_episodes_to_batch": 0.00035891989178102324, "add_one_ts_to_episodes_and_truncate": 0.007285594028638226, "add_columns_from_episodes_to_train_batch": 0.07904676559337556, "general_advantage_estimation": 0.12187855804598431, "add_states_from_episodes_to_batch": 1.1080145094447815e-05, "numpy_to_tensor": 0.001333477692268258, "add_time_dim_to_batch_and_zero_pad": 3.115317426912088e-05}}, "connector_pipeline_timer": 0.25605611336431944}, "num_module_steps_trained_lifetime": 3634944, "learner_connector_sum_episodes_length_out": 2016.1435709510508, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 57284568, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 120000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.17235917775351, "done": false, "training_iteration": 60, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-34-59", "timestamp": 1747694099, "time_this_iter_s": 42.34451866149902, "time_total_s": 2425.6876192092896, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2425.6876192092896, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 77.33500000000001, "ram_util_percent": 50.83000000000001}}
{"timers": {"training_iteration": 42.01096787992414, "restore_env_runners": 2.840382539026743e-05, "training_step": 42.0104708935057, "env_runner_sampling_timer": 31.80026449516333, "learner_update_timer": 10.196366427377365, "synch_weights": 0.012874034911126622, "synch_env_connectors": 0.009211468473163719}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2671111111111111, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016496057341336182, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.069204455766784e-06, "un_batch_to_individual_items": 7.219060013449044e-05, "listify_data_for_vector_env": 0.0001406715012987712, "normalize_and_clip_actions": 0.00012444232885485573, "get_actions": 0.0007329178393421839, "tensor_to_numpy": 0.0002365052603986483}}}, "num_module_steps_sampled_lifetime": {"default_policy": 122000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 122000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.983954166043883e-05, "add_states_from_episodes_to_batch": 2.0820998238350705e-05, "numpy_to_tensor": 0.00016412670153747593, "add_time_dim_to_batch_and_zero_pad": 3.776564288276368e-05, "batch_individual_items": 0.00010078246167058848}}, "connector_pipeline_timer": 0.000617049178922131}, "episode_return_max": 0.805666666666668, "episode_duration_sec_mean": 22.80258118626842, "num_episodes_lifetime": 560, "rlmodule_inference_timer": 0.0005653728802086242, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4640256410256412, "env_to_module_sum_episodes_length_out": 92.78980748319006, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1085808053044927, "num_env_steps_sampled_lifetime": 122000, "weights_seq_no": 60.0, "agent_episode_returns_mean": {"default_agent": 0.4640256410256412}, "module_episode_returns_mean": {"default_policy": 0.4640256410256412}, "num_env_steps_sampled": 2000, "sample": 30.173098574029666, "env_to_module_sum_episodes_length_in": 92.78980748319006, "time_between_sampling": 12.169037316064006, "num_env_steps_sampled_lifetime_throughput": 54.59629497368438}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.18590496480464935, "weights_seq_no": 61.0, "vf_loss_unclipped": 0.004026978742331266, "total_loss": -0.1818779855966568, "gradients_default_optimizer_global_norm": 0.35048630833625793, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04338634014129639, "entropy": 0.14673727750778198, "curr_kl_coeff": 1.4901161415892261e-09, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0062636700458824635, "num_module_steps_trained_lifetime": 3695488, "vf_loss": 0.004026978742331266}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04557306468995768, "add_observations_from_episodes_to_batch": 0.0003590036168490401, "add_one_ts_to_episodes_and_truncate": 0.007281628320277843, "add_columns_from_episodes_to_train_batch": 0.07906011365949289, "general_advantage_estimation": 0.12145634982408235, "add_states_from_episodes_to_batch": 1.1082899022596595e-05, "numpy_to_tensor": 0.0013334681326310788, "add_time_dim_to_batch_and_zero_pad": 3.116728343455262e-05}}, "connector_pipeline_timer": 0.2556896851800406}, "num_module_steps_trained_lifetime": 3695488, "learner_connector_sum_episodes_length_out": 2016.1476065437973, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 58238136, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 122000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.59629497368438, "done": false, "training_iteration": 61, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-35-36", "timestamp": 1747694136, "time_this_iter_s": 36.45614504814148, "time_total_s": 2462.143764257431, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2462.143764257431, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 75.5326923076923, "ram_util_percent": 50.811538461538476}}
{"timers": {"training_iteration": 41.98782820944488, "restore_env_runners": 2.837378717869709e-05, "training_step": 41.98732980289065, "env_runner_sampling_timer": 31.774361946451723, "learner_update_timer": 10.199197730183608, "synch_weights": 0.01280236156203146, "synch_env_connectors": 0.009191248788433031}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2671111111111111, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016420581219897669, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.11318217261105e-06, "un_batch_to_individual_items": 7.225611395096502e-05, "listify_data_for_vector_env": 0.0001402969538505408, "normalize_and_clip_actions": 0.00012355744130526617, "get_actions": 0.0007293847659652333, "tensor_to_numpy": 0.00023478283852084648}}}, "num_module_steps_sampled_lifetime": {"default_policy": 124000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 124000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0535146176161335e-05, "add_states_from_episodes_to_batch": 2.0773468668691193e-05, "numpy_to_tensor": 0.00016399972425425706, "add_time_dim_to_batch_and_zero_pad": 3.820361208499721e-05, "batch_individual_items": 0.00010033955277133867}}, "connector_pipeline_timer": 0.0006152102474104416}, "episode_return_max": 0.696666666666667, "episode_duration_sec_mean": 21.476107235731924, "num_episodes_lifetime": 568, "rlmodule_inference_timer": 0.0005636850079213901, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4740021367521371, "env_to_module_sum_episodes_length_out": 93.01405067882929, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10807573585031816, "num_env_steps_sampled_lifetime": 124000, "weights_seq_no": 61.0, "agent_episode_returns_mean": {"default_agent": 0.4740021367521371}, "module_episode_returns_mean": {"default_policy": 0.4740021367521371}, "num_env_steps_sampled": 2000, "sample": 30.16539598131249, "env_to_module_sum_episodes_length_in": 93.01405067882929, "time_between_sampling": 12.158758350465236, "num_env_steps_sampled_lifetime_throughput": 50.287891475314865}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.09783146530389786, "weights_seq_no": 62.0, "vf_loss_unclipped": 0.004180456046015024, "total_loss": 0.10201191157102585, "gradients_default_optimizer_global_norm": 0.2119852602481842, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09668838977813721, "entropy": 0.15009565651416779, "curr_kl_coeff": 7.450580707946131e-10, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002496620872989297, "num_module_steps_trained_lifetime": 3756032, "vf_loss": 0.004180456046015024}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04561941426051588, "add_observations_from_episodes_to_batch": 0.00035908860542605784, "add_one_ts_to_episodes_and_truncate": 0.007277525266681934, "add_columns_from_episodes_to_train_batch": 0.07907334073772876, "general_advantage_estimation": 0.12103206364081408, "add_states_from_episodes_to_batch": 1.1085609857470037e-05, "numpy_to_tensor": 0.0013334253864175723, "add_time_dim_to_batch_and_zero_pad": 3.118172509927463e-05}}, "connector_pipeline_timer": 0.2553202128681108}, "num_module_steps_trained_lifetime": 3756032, "learner_connector_sum_episodes_length_out": 2016.1515470675936, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 59191704, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 124000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.287891475314865, "done": false, "training_iteration": 62, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-36-16", "timestamp": 1747694176, "time_this_iter_s": 39.72718405723572, "time_total_s": 2501.8709483146667, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2501.8709483146667, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 75.22142857142856, "ram_util_percent": 50.8125}}
{"timers": {"training_iteration": 41.96615121764037, "restore_env_runners": 2.8297049282399573e-05, "training_step": 41.96565292715173, "env_runner_sampling_timer": 31.766504086217225, "learner_update_timer": 10.18542317994178, "synch_weights": 0.01275597494645048, "synch_env_connectors": 0.00925688630055224}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3050000000000001, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016384082741201919, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.165961287375336e-06, "un_batch_to_individual_items": 7.267773043758557e-05, "listify_data_for_vector_env": 0.00013892585091630695, "normalize_and_clip_actions": 0.00012453606328406515, "get_actions": 0.0007270809775187633, "tensor_to_numpy": 0.00023582856447659645}}}, "num_module_steps_sampled_lifetime": {"default_policy": 126000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 126000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.049716274104876e-05, "add_states_from_episodes_to_batch": 2.058092900908596e-05, "numpy_to_tensor": 0.00016336362122960847, "add_time_dim_to_batch_and_zero_pad": 3.809228849493179e-05, "batch_individual_items": 9.920624808642728e-05}}, "connector_pipeline_timer": 0.0006127674980937916}, "episode_return_max": 0.696666666666667, "episode_duration_sec_mean": 22.37493242268276, "num_episodes_lifetime": 576, "rlmodule_inference_timer": 0.0005611388749440579, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.49489743589743634, "env_to_module_sum_episodes_length_out": 95.23763323936825, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1073444674657245, "num_env_steps_sampled_lifetime": 126000, "weights_seq_no": 62.0, "agent_episode_returns_mean": {"default_agent": 0.49489743589743634}, "module_episode_returns_mean": {"default_policy": 0.49489743589743634}, "num_env_steps_sampled": 2000, "sample": 30.157518737659267, "env_to_module_sum_episodes_length_in": 95.23763323936825, "time_between_sampling": 12.149046032761735, "num_env_steps_sampled_lifetime_throughput": 50.1084765474994}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.06360146403312683, "weights_seq_no": 63.0, "vf_loss_unclipped": 0.007008611224591732, "total_loss": -0.05659285560250282, "gradients_default_optimizer_global_norm": 0.38045716285705566, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.033094167709350586, "entropy": 0.1785745471715927, "curr_kl_coeff": 3.7252903539730653e-10, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002676696050912142, "num_module_steps_trained_lifetime": 3816576, "vf_loss": 0.007008611224591732}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.045664395793194514, "add_observations_from_episodes_to_batch": 0.0003591727538696347, "add_one_ts_to_episodes_and_truncate": 0.007273380291325852, "add_columns_from_episodes_to_train_batch": 0.07908583671303392, "general_advantage_estimation": 0.12060499099622869, "add_states_from_episodes_to_batch": 1.1088158186082288e-05, "numpy_to_tensor": 0.0013333485483156427, "add_time_dim_to_batch_and_zero_pad": 3.119563120238447e-05}}, "connector_pipeline_timer": 0.2549457684839013}, "num_module_steps_trained_lifetime": 3816576, "learner_connector_sum_episodes_length_out": 2016.1553940202596, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 60145272, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 126000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.1084765474994, "done": false, "training_iteration": 63, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-36-56", "timestamp": 1747694216, "time_this_iter_s": 39.83666491508484, "time_total_s": 2541.7076132297516, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2541.7076132297516, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 76.15964912280701, "ram_util_percent": 50.814035087719304}}
{"timers": {"training_iteration": 41.95621896786397, "restore_env_runners": 2.8227078810751988e-05, "training_step": 41.95572000628015, "env_runner_sampling_timer": 31.76406996469508, "learner_update_timer": 10.17798999320237, "synch_weights": 0.01268763119699472, "synch_env_connectors": 0.009255948437578784}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29344444444444456, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001645725641244333, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.099820596756893e-06, "un_batch_to_individual_items": 7.251559923757451e-05, "listify_data_for_vector_env": 0.00013856000505937835, "normalize_and_clip_actions": 0.00012471319669908983, "get_actions": 0.0007305423580089914, "tensor_to_numpy": 0.0002368161188927458}}}, "num_module_steps_sampled_lifetime": {"default_policy": 128000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 128000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0942791395813494e-05, "add_states_from_episodes_to_batch": 2.0262189214952056e-05, "numpy_to_tensor": 0.00016370264944061755, "add_time_dim_to_batch_and_zero_pad": 3.7844362812104855e-05, "batch_individual_items": 9.89989304970296e-05}}, "connector_pipeline_timer": 0.0006127818486021439}, "episode_return_max": 0.7333333333333344, "episode_duration_sec_mean": 22.37008195366525, "num_episodes_lifetime": 592, "rlmodule_inference_timer": 0.0005605283603227558, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5386068376068385, "env_to_module_sum_episodes_length_out": 97.09416296218174, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10823562884414521, "num_env_steps_sampled_lifetime": 128000, "weights_seq_no": 63.0, "agent_episode_returns_mean": {"default_agent": 0.5386068376068385}, "module_episode_returns_mean": {"default_policy": 0.5386068376068385}, "num_env_steps_sampled": 2000, "sample": 30.150540125542502, "env_to_module_sum_episodes_length_in": 97.09416296218174, "time_between_sampling": 12.139144207977676, "num_env_steps_sampled_lifetime_throughput": 48.72511036215454}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.2521155774593353, "weights_seq_no": 64.0, "vf_loss_unclipped": 0.008038708008825779, "total_loss": -0.24407687783241272, "gradients_default_optimizer_global_norm": 0.4632589817047119, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05652409791946411, "entropy": 0.19313226640224457, "curr_kl_coeff": 1.8626451769865326e-10, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004719221964478493, "num_module_steps_trained_lifetime": 3877376, "vf_loss": 0.008038708008825779}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04570822469379371, "add_observations_from_episodes_to_batch": 0.0003592659804833715, "add_one_ts_to_episodes_and_truncate": 0.007269267162950117, "add_columns_from_episodes_to_train_batch": 0.07909753159475938, "general_advantage_estimation": 0.12017531015817112, "add_states_from_episodes_to_batch": 1.109060698647676e-05, "numpy_to_tensor": 0.0013332415844371898, "add_time_dim_to_batch_and_zero_pad": 3.12088310103049e-05}}, "connector_pipeline_timer": 0.2545667601360887}, "num_module_steps_trained_lifetime": 3877376, "learner_connector_sum_episodes_length_out": 2016.1599488791655, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 61106672, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 128000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.72511036215454, "done": false, "training_iteration": 64, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-37-37", "timestamp": 1747694257, "time_this_iter_s": 40.9925422668457, "time_total_s": 2582.7001554965973, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2582.7001554965973, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 78.09655172413795, "ram_util_percent": 50.801724137931025}}
{"timers": {"training_iteration": 41.912236293725336, "restore_env_runners": 2.8171808004904635e-05, "training_step": 41.91173558575736, "env_runner_sampling_timer": 31.731498198538095, "learner_update_timer": 10.166636847320332, "synch_weights": 0.012627912884971858, "synch_env_connectors": 0.009261573953227383}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32088888888889006, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016334477413498054, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.970513837911241e-06, "un_batch_to_individual_items": 7.232145401896519e-05, "listify_data_for_vector_env": 0.00013696687829167073, "normalize_and_clip_actions": 0.00012369071214160987, "get_actions": 0.0007247429891437799, "tensor_to_numpy": 0.00023529862634781844}}}, "num_module_steps_sampled_lifetime": {"default_policy": 130000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 130000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.174311033516458e-05, "add_states_from_episodes_to_batch": 2.0248103700419044e-05, "numpy_to_tensor": 0.00016390831449875786, "add_time_dim_to_batch_and_zero_pad": 3.826524395428019e-05, "batch_individual_items": 9.936584974953329e-05}}, "connector_pipeline_timer": 0.000614321675443394}, "episode_return_max": 0.7212222222222235, "episode_duration_sec_mean": 22.25107885010437, "num_episodes_lifetime": 600, "rlmodule_inference_timer": 0.0005589433460300964, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5044818376068384, "env_to_module_sum_episodes_length_out": 96.46156626091144, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10835870890204688, "num_env_steps_sampled_lifetime": 130000, "weights_seq_no": 64.0, "agent_episode_returns_mean": {"default_agent": 0.5044818376068384}, "module_episode_returns_mean": {"default_policy": 0.5044818376068384}, "num_env_steps_sampled": 2000, "sample": 30.14213053869394, "env_to_module_sum_episodes_length_in": 96.46156626091144, "time_between_sampling": 12.128918708174414, "num_env_steps_sampled_lifetime_throughput": 53.14251294757998}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.06440430134534836, "weights_seq_no": 65.0, "vf_loss_unclipped": 0.006854264065623283, "total_loss": -0.05755005404353142, "gradients_default_optimizer_global_norm": 0.22485701739788055, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.024432063102722168, "entropy": 0.12861521542072296, "curr_kl_coeff": 9.313225884932663e-11, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0015077058924362063, "num_module_steps_trained_lifetime": 3937920, "vf_loss": 0.006854264065623283}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04575462416680194, "add_observations_from_episodes_to_batch": 0.00035935529528905303, "add_one_ts_to_episodes_and_truncate": 0.0072650120991131295, "add_columns_from_episodes_to_train_batch": 0.07910880790517967, "general_advantage_estimation": 0.11974352787777487, "add_states_from_episodes_to_batch": 1.1092947995036399e-05, "numpy_to_tensor": 0.0013334969549814231, "add_time_dim_to_batch_and_zero_pad": 3.1221877258803237e-05}}, "connector_pipeline_timer": 0.2541880205783834}, "num_module_steps_trained_lifetime": 3937920, "learner_connector_sum_episodes_length_out": 2016.1643971014914, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 62060240, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 130000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.14251294757998, "done": false, "training_iteration": 65, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-38-14", "timestamp": 1747694294, "time_this_iter_s": 37.57685923576355, "time_total_s": 2620.277014732361, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2620.277014732361, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 76.41111111111111, "ram_util_percent": 50.80740740740743}}
{"timers": {"training_iteration": 41.88510865706811, "restore_env_runners": 2.8108089911344892e-05, "training_step": 41.88460771917981, "env_runner_sampling_timer": 31.717183241502656, "learner_update_timer": 10.15386645117712, "synch_weights": 0.01258480975609313, "synch_env_connectors": 0.00927607621370956}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3181111111111122, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016346257387075051, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.125993744649833e-06, "un_batch_to_individual_items": 7.279015626028048e-05, "listify_data_for_vector_env": 0.00013663733666909267, "normalize_and_clip_actions": 0.00012302775734399703, "get_actions": 0.0007261764337044359, "tensor_to_numpy": 0.00023644110281983473}}}, "num_module_steps_sampled_lifetime": {"default_policy": 132000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 132000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1480351153917795e-05, "add_states_from_episodes_to_batch": 2.0213331209938004e-05, "numpy_to_tensor": 0.0001635399877577243, "add_time_dim_to_batch_and_zero_pad": 3.858317168390065e-05, "batch_individual_items": 9.87792379239381e-05}}, "connector_pipeline_timer": 0.0006137568613998357}, "episode_return_max": 0.7212222222222235, "episode_duration_sec_mean": 22.692748834382165, "num_episodes_lifetime": 608, "rlmodule_inference_timer": 0.0005580392564164269, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4775277777777785, "env_to_module_sum_episodes_length_out": 94.50631433673976, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1084730630941608, "num_env_steps_sampled_lifetime": 132000, "weights_seq_no": 65.0, "agent_episode_returns_mean": {"default_agent": 0.4775277777777785}, "module_episode_returns_mean": {"default_policy": 0.4775277777777785}, "num_env_steps_sampled": 2000, "sample": 30.133750169197288, "env_to_module_sum_episodes_length_in": 94.50631433673976, "time_between_sampling": 12.118026383887642, "num_env_steps_sampled_lifetime_throughput": 50.91519330866722}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08295303583145142, "weights_seq_no": 66.0, "vf_loss_unclipped": 0.003618047572672367, "total_loss": -0.07933498173952103, "gradients_default_optimizer_global_norm": 0.39457422494888306, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.03247225284576416, "entropy": 0.14569246768951416, "curr_kl_coeff": 4.6566129424663316e-11, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00321955350227654, "num_module_steps_trained_lifetime": 3998464, "vf_loss": 0.003618047572672367}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04580009112788034, "add_observations_from_episodes_to_batch": 0.0003594430072005007, "add_one_ts_to_episodes_and_truncate": 0.007260927409836514, "add_columns_from_episodes_to_train_batch": 0.07912046616633191, "general_advantage_estimation": 0.1193092730419703, "add_states_from_episodes_to_batch": 1.1095163122565571e-05, "numpy_to_tensor": 0.0013337280539561219, "add_time_dim_to_batch_and_zero_pad": 3.123490169862183e-05}}, "connector_pipeline_timer": 0.2538063994759189}, "num_module_steps_trained_lifetime": 3998464, "learner_connector_sum_episodes_length_out": 2016.1687403644828, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 63013808, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 132000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.91519330866722, "done": false, "training_iteration": 66, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-38-54", "timestamp": 1747694334, "time_this_iter_s": 39.214951038360596, "time_total_s": 2659.4919657707214, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2659.4919657707214, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 78.69454545454543, "ram_util_percent": 50.810909090909114}}
{"timers": {"training_iteration": 41.84547881058747, "restore_env_runners": 2.8072008986033338e-05, "training_step": 41.844977478078015, "env_runner_sampling_timer": 31.692327297137627, "learner_update_timer": 10.139155535705369, "synch_weights": 0.01251288965858431, "synch_env_connectors": 0.009263077451522743}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3087777777777777, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016310272079422684, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.088178923992534e-06, "un_batch_to_individual_items": 7.300810968887036e-05, "listify_data_for_vector_env": 0.00013529084864339838, "normalize_and_clip_actions": 0.0001222380460657454, "get_actions": 0.000725775472694071, "tensor_to_numpy": 0.0002375616650400795}}}, "num_module_steps_sampled_lifetime": {"default_policy": 134000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 134000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1982926043569964e-05, "add_states_from_episodes_to_batch": 2.0049631095891838e-05, "numpy_to_tensor": 0.00016365773884984152, "add_time_dim_to_batch_and_zero_pad": 3.82315128031502e-05, "batch_individual_items": 9.754677555220829e-05}}, "connector_pipeline_timer": 0.0006108099704200019}, "episode_return_max": 0.7161111111111118, "episode_duration_sec_mean": 22.770568878931115, "num_episodes_lifetime": 616, "rlmodule_inference_timer": 0.0005581997338270689, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.49018910256410286, "env_to_module_sum_episodes_length_out": 92.83511750097661, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10812285891699516, "num_env_steps_sampled_lifetime": 134000, "weights_seq_no": 66.0, "agent_episode_returns_mean": {"default_agent": 0.49018910256410286}, "module_episode_returns_mean": {"default_policy": 0.49018910256410286}, "num_env_steps_sampled": 2000, "sample": 30.12452522526801, "env_to_module_sum_episodes_length_in": 92.83511750097661, "time_between_sampling": 12.106463883351884, "num_env_steps_sampled_lifetime_throughput": 52.64250405403032}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05867251008749008, "weights_seq_no": 67.0, "vf_loss_unclipped": 0.004877878352999687, "total_loss": 0.06355038285255432, "gradients_default_optimizer_global_norm": 0.23984317481517792, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06731182336807251, "entropy": 0.1408766806125641, "curr_kl_coeff": 2.3283064712331658e-11, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002956511452794075, "num_module_steps_trained_lifetime": 4059008, "vf_loss": 0.004877878352999687}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04584412589741996, "add_observations_from_episodes_to_batch": 0.0003595235793447103, "add_one_ts_to_episodes_and_truncate": 0.0072567098431351494, "add_columns_from_episodes_to_train_batch": 0.07913142417147011, "general_advantage_estimation": 0.11887263324009377, "add_states_from_episodes_to_batch": 1.1097234653159338e-05, "numpy_to_tensor": 0.001333921941256179, "add_time_dim_to_batch_and_zero_pad": 3.124752346205389e-05}}, "connector_pipeline_timer": 0.25342007282354584}, "num_module_steps_trained_lifetime": 4059008, "learner_connector_sum_episodes_length_out": 2016.1729803225041, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 63967376, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 134000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.64250405403032, "done": false, "training_iteration": 67, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-39-32", "timestamp": 1747694372, "time_this_iter_s": 37.93748378753662, "time_total_s": 2697.429449558258, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2697.429449558258, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 77.57962962962962, "ram_util_percent": 50.81666666666669}}
{"timers": {"training_iteration": 41.795237131351634, "restore_env_runners": 2.814028893428645e-05, "training_step": 41.79473501516723, "env_runner_sampling_timer": 31.656640284526198, "learner_update_timer": 10.124664988858346, "synch_weights": 0.012447218762030931, "synch_env_connectors": 0.009244830676970689}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3087777777777777, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016245177805648537, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.958533161581262e-06, "un_batch_to_individual_items": 7.224766794234435e-05, "listify_data_for_vector_env": 0.00013607715774857486, "normalize_and_clip_actions": 0.00012183175144983074, "get_actions": 0.0007212123587943085, "tensor_to_numpy": 0.0002356248268471227}}}, "num_module_steps_sampled_lifetime": {"default_policy": 136000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 136000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.215697045962709e-05, "add_states_from_episodes_to_batch": 1.9878670992460482e-05, "numpy_to_tensor": 0.0001631101667641286, "add_time_dim_to_batch_and_zero_pad": 3.789026586959446e-05, "batch_individual_items": 9.684716976796008e-05}}, "connector_pipeline_timer": 0.00060799670050157}, "episode_return_max": 0.7265555555555556, "episode_duration_sec_mean": 22.11242394678804, "num_episodes_lifetime": 624, "rlmodule_inference_timer": 0.0005557877970198339, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5403482905982908, "env_to_module_sum_episodes_length_out": 92.46660973079317, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10739509957214415, "num_env_steps_sampled_lifetime": 136000, "weights_seq_no": 67.0, "agent_episode_returns_mean": {"default_agent": 0.5403482905982908}, "module_episode_returns_mean": {"default_policy": 0.5403482905982908}, "num_env_steps_sampled": 2000, "sample": 30.113814564307468, "env_to_module_sum_episodes_length_in": 92.46660973079317, "time_between_sampling": 12.094189613495686, "num_env_steps_sampled_lifetime_throughput": 54.21008740722422}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.008747633546590805, "weights_seq_no": 68.0, "vf_loss_unclipped": 0.004519537556916475, "total_loss": -0.004228096455335617, "gradients_default_optimizer_global_norm": 0.04886123538017273, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.005544602870941162, "entropy": 0.127585306763649, "curr_kl_coeff": 1.1641532356165829e-11, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0017218786524608731, "num_module_steps_trained_lifetime": 4119552, "vf_loss": 0.004519537556916475}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.045886658622556024, "add_observations_from_episodes_to_batch": 0.00035962502574494185, "add_one_ts_to_episodes_and_truncate": 0.007252363515126857, "add_columns_from_episodes_to_train_batch": 0.07914189776988884, "general_advantage_estimation": 0.11843369539695035, "add_states_from_episodes_to_batch": 1.1099165236516057e-05, "numpy_to_tensor": 0.0013340973080045067, "add_time_dim_to_batch_and_zero_pad": 3.1259939300174736e-05}}, "connector_pipeline_timer": 0.25302934090447265}, "num_module_steps_trained_lifetime": 4119552, "learner_connector_sum_episodes_length_out": 2016.1771186073286, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 64920944, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 136000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.21008740722422, "done": false, "training_iteration": 68, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-40-09", "timestamp": 1747694409, "time_this_iter_s": 36.84268498420715, "time_total_s": 2734.272134542465, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2734.272134542465, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 77.71346153846153, "ram_util_percent": 50.83846153846155}}
{"timers": {"training_iteration": 41.74783411813815, "restore_env_runners": 2.807788603904738e-05, "training_step": 41.747332048115545, "env_runner_sampling_timer": 31.627278898500943, "learner_update_timer": 10.106688331249728, "synch_weights": 0.012380777574418382, "synch_env_connectors": 0.009252804380201311}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3295555555555558, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016149184256814154, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.943279129052534e-06, "un_batch_to_individual_items": 7.154385468335712e-05, "listify_data_for_vector_env": 0.00013550287148786087, "normalize_and_clip_actions": 0.00012116062982050091, "get_actions": 0.0007179240877618473, "tensor_to_numpy": 0.00023322857630089214}}}, "num_module_steps_sampled_lifetime": {"default_policy": 138000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 138000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.188868245287341e-05, "add_states_from_episodes_to_batch": 1.9630412417738856e-05, "numpy_to_tensor": 0.00016227383822405494, "add_time_dim_to_batch_and_zero_pad": 3.770110040301053e-05, "batch_individual_items": 9.66151951713291e-05}}, "connector_pipeline_timer": 0.0006061753098761227}, "episode_return_max": 0.7517777777777779, "episode_duration_sec_mean": 21.97374375806843, "num_episodes_lifetime": 632, "rlmodule_inference_timer": 0.000553388867275977, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5419006410256412, "env_to_module_sum_episodes_length_out": 93.9707057554018, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10668735357035683, "num_env_steps_sampled_lifetime": 138000, "weights_seq_no": 68.0, "agent_episode_returns_mean": {"default_agent": 0.5419006410256412}, "module_episode_returns_mean": {"default_policy": 0.5419006410256412}, "num_env_steps_sampled": 2000, "sample": 30.101885050918092, "env_to_module_sum_episodes_length_in": 93.9707057554018, "time_between_sampling": 12.081152938290762, "num_env_steps_sampled_lifetime_throughput": 53.85733227021274}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.004059134051203728, "weights_seq_no": 69.0, "vf_loss_unclipped": 0.0019602077081799507, "total_loss": -0.00209893099963665, "gradients_default_optimizer_global_norm": 0.22502420842647552, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0016058087348937988, "entropy": 0.1473264992237091, "curr_kl_coeff": 5.8207661780829145e-12, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0037658321671187878, "num_module_steps_trained_lifetime": 4180096, "vf_loss": 0.0019602077081799507}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04592802716059959, "add_observations_from_episodes_to_batch": 0.0003597278108595943, "add_one_ts_to_episodes_and_truncate": 0.007247905602695056, "add_columns_from_episodes_to_train_batch": 0.07915201254382181, "general_advantage_estimation": 0.11799308491734564, "add_states_from_episodes_to_batch": 1.1102507484588345e-05, "numpy_to_tensor": 0.0013342900052237857, "add_time_dim_to_batch_and_zero_pad": 3.1271702068798096e-05}}, "connector_pipeline_timer": 0.2526353220963986}, "num_module_steps_trained_lifetime": 4180096, "learner_connector_sum_episodes_length_out": 2016.1811568284243, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 65874512, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 138000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.85733227021274, "done": false, "training_iteration": 69, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-40-46", "timestamp": 1747694446, "time_this_iter_s": 37.06983518600464, "time_total_s": 2771.34196972847, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2771.34196972847, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 76.88679245283018, "ram_util_percent": 50.811320754716995}}
{"timers": {"training_iteration": 41.7136129466968, "restore_env_runners": 2.8104107187999935e-05, "training_step": 41.713110495374394, "env_runner_sampling_timer": 31.61133644418593, "learner_update_timer": 10.088465883007231, "synch_weights": 0.012319514798711259, "synch_env_connectors": 0.00923350533637164}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3316666666666675, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016097905586894624, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.928892698236668e-06, "un_batch_to_individual_items": 7.142827765769182e-05, "listify_data_for_vector_env": 0.00013582396265201713, "normalize_and_clip_actions": 0.00012056774909219826, "get_actions": 0.0007163290760015772, "tensor_to_numpy": 0.0002321292655658915}}}, "num_module_steps_sampled_lifetime": {"default_policy": 140000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 140000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.187250561477383e-05, "add_states_from_episodes_to_batch": 1.945638467528479e-05, "numpy_to_tensor": 0.00016189212938221438, "add_time_dim_to_batch_and_zero_pad": 3.824046369191331e-05, "batch_individual_items": 9.747990668980232e-05}}, "connector_pipeline_timer": 0.0006058696309309364}, "episode_return_max": 0.725666666666668, "episode_duration_sec_mean": 21.813720622125963, "num_episodes_lifetime": 648, "rlmodule_inference_timer": 0.0005536165452536425, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.4414166666666674, "env_to_module_sum_episodes_length_out": 96.8663498019178, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1073585339751524, "num_env_steps_sampled_lifetime": 140000, "weights_seq_no": 69.0, "agent_episode_returns_mean": {"default_agent": 0.4414166666666674}, "module_episode_returns_mean": {"default_policy": 0.4414166666666674}, "num_env_steps_sampled": 2000, "sample": 30.090104340547146, "env_to_module_sum_episodes_length_in": 96.8663498019178, "time_between_sampling": 12.067474887443138, "num_env_steps_sampled_lifetime_throughput": 52.083269212593}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0020989133045077324, "weights_seq_no": 70.0, "vf_loss_unclipped": 0.004778672009706497, "total_loss": 0.002679757308214903, "gradients_default_optimizer_global_norm": 0.26343920826911926, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.03881204128265381, "entropy": 0.14202335476875305, "curr_kl_coeff": 2.9103830890414573e-12, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0016568382270634174, "num_module_steps_trained_lifetime": 4240896, "vf_loss": 0.004778672009706497}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0459680571520201, "add_observations_from_episodes_to_batch": 0.00035983900776930867, "add_one_ts_to_episodes_and_truncate": 0.007243488172159934, "add_columns_from_episodes_to_train_batch": 0.07916178979249915, "general_advantage_estimation": 0.11755041805779358, "add_states_from_episodes_to_batch": 1.1105712971091053e-05, "numpy_to_tensor": 0.0013344893287677692, "add_time_dim_to_batch_and_zero_pad": 3.128314358798397e-05}}, "connector_pipeline_timer": 0.2522376171103956}, "num_module_steps_trained_lifetime": 4240896, "learner_connector_sum_episodes_length_out": 2016.1858965732374, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 66835912, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 140000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.083269212593, "done": false, "training_iteration": 70, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-41-24", "timestamp": 1747694484, "time_this_iter_s": 38.3410267829895, "time_total_s": 2809.6829965114594, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2809.6829965114594, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 78.38545454545454, "ram_util_percent": 50.792727272727255}}
{"timers": {"training_iteration": 41.682646389699784, "restore_env_runners": 2.8036066137296347e-05, "training_step": 41.682144422890595, "env_runner_sampling_timer": 31.592289265804105, "learner_update_timer": 10.076584243587098, "synch_weights": 0.012281905650710651, "synch_env_connectors": 0.009213091282988571}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3316666666666675, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001624195061770307, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.874542602258796e-06, "un_batch_to_individual_items": 7.097823840282748e-05, "listify_data_for_vector_env": 0.00013700192831952223, "normalize_and_clip_actions": 0.0001201472561413507, "get_actions": 0.0007221854370375966, "tensor_to_numpy": 0.00023673483120767612}}}, "num_module_steps_sampled_lifetime": {"default_policy": 142000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 142000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.299496850236807e-05, "add_states_from_episodes_to_batch": 1.922603719348544e-05, "numpy_to_tensor": 0.00016264803564576414, "add_time_dim_to_batch_and_zero_pad": 3.819871241676884e-05, "batch_individual_items": 9.717672971674164e-05}}, "connector_pipeline_timer": 0.0006077369274008177}, "episode_return_max": 0.725666666666668, "episode_duration_sec_mean": 21.978371611653667, "num_episodes_lifetime": 656, "rlmodule_inference_timer": 0.0005548546333782174, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5033856837606847, "env_to_module_sum_episodes_length_out": 97.21842151529484, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10864844028936914, "num_env_steps_sampled_lifetime": 142000, "weights_seq_no": 70.0, "agent_episode_returns_mean": {"default_agent": 0.5033856837606847}, "module_episode_returns_mean": {"default_policy": 0.5033856837606847}, "num_env_steps_sampled": 2000, "sample": 30.07829747605952, "env_to_module_sum_episodes_length_in": 97.21842151529484, "time_between_sampling": 12.053036653280085, "num_env_steps_sampled_lifetime_throughput": 51.542717146066515}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.15502341091632843, "weights_seq_no": 71.0, "vf_loss_unclipped": 0.00761194946244359, "total_loss": 0.16263535618782043, "gradients_default_optimizer_global_norm": 0.17963433265686035, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09678447246551514, "entropy": 0.1335095316171646, "curr_kl_coeff": 1.4551915445207286e-12, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0008575637475587428, "num_module_steps_trained_lifetime": 4301440, "vf_loss": 0.00761194946244359}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046010362030695896, "add_observations_from_episodes_to_batch": 0.0003599707479595467, "add_one_ts_to_episodes_and_truncate": 0.007239062519675608, "add_columns_from_episodes_to_train_batch": 0.07917400248484874, "general_advantage_estimation": 0.11710633055694084, "add_states_from_episodes_to_batch": 1.1108894097140767e-05, "numpy_to_tensor": 0.0013347206268401423, "add_time_dim_to_batch_and_zero_pad": 3.1294579106621945e-05}}, "connector_pipeline_timer": 0.25184326725160283}, "num_module_steps_trained_lifetime": 4301440, "learner_connector_sum_episodes_length_out": 2016.1905234074713, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 67789480, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 142000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.542717146066515, "done": false, "training_iteration": 71, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-42-03", "timestamp": 1747694523, "time_this_iter_s": 38.633800745010376, "time_total_s": 2848.3167972564697, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2848.3167972564697, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 77.91090909090909, "ram_util_percent": 50.7327272727273}}
{"timers": {"training_iteration": 41.66181325927275, "restore_env_runners": 2.800570548779775e-05, "training_step": 41.6613093431317, "env_runner_sampling_timer": 31.578197916256084, "learner_update_timer": 10.069889281501199, "synch_weights": 0.012209007594230643, "synch_env_connectors": 0.009211415370112776}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.34644444444444517, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001623832610182392, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.13546665051759e-06, "un_batch_to_individual_items": 7.06704324653581e-05, "listify_data_for_vector_env": 0.0001377820840015717, "normalize_and_clip_actions": 0.00011975426217713098, "get_actions": 0.0007208135305978023, "tensor_to_numpy": 0.0002381075205428173}}}, "num_module_steps_sampled_lifetime": {"default_policy": 144000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 144000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.305733674003873e-05, "add_states_from_episodes_to_batch": 1.910913229042368e-05, "numpy_to_tensor": 0.0001629070792535897, "add_time_dim_to_batch_and_zero_pad": 3.7761846033123787e-05, "batch_individual_items": 9.752736747229791e-05}}, "connector_pipeline_timer": 0.0006078530814154963}, "episode_return_max": 0.7160000000000015, "episode_duration_sec_mean": 22.950281872327512, "num_episodes_lifetime": 664, "rlmodule_inference_timer": 0.0005576006176671706, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5098867521367528, "env_to_module_sum_episodes_length_out": 95.50416324279696, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10886567154183764, "num_env_steps_sampled_lifetime": 144000, "weights_seq_no": 71.0, "agent_episode_returns_mean": {"default_agent": 0.5098867521367528}, "module_episode_returns_mean": {"default_policy": 0.5098867521367528}, "num_env_steps_sampled": 2000, "sample": 30.066400942849125, "env_to_module_sum_episodes_length_in": 95.50416324279696, "time_between_sampling": 12.038239537070625, "num_env_steps_sampled_lifetime_throughput": 50.391181899978214}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05101313069462776, "weights_seq_no": 72.0, "vf_loss_unclipped": 0.003958663437515497, "total_loss": 0.05497179180383682, "gradients_default_optimizer_global_norm": 0.429049015045166, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.043573975563049316, "entropy": 0.11902430653572083, "curr_kl_coeff": 7.275957722603643e-13, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003181493142619729, "num_module_steps_trained_lifetime": 4361984, "vf_loss": 0.003958663437515497}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04605162282608289, "add_observations_from_episodes_to_batch": 0.000360095219445266, "add_one_ts_to_episodes_and_truncate": 0.0072346284214236155, "add_columns_from_episodes_to_train_batch": 0.07918582437437235, "general_advantage_estimation": 0.11666047945429953, "add_states_from_episodes_to_batch": 1.1111891029634769e-05, "numpy_to_tensor": 0.0013349188100185083, "add_time_dim_to_batch_and_zero_pad": 3.1305367600063364e-05}}, "connector_pipeline_timer": 0.2514456585882747}, "num_module_steps_trained_lifetime": 4361984, "learner_connector_sum_episodes_length_out": 2016.1950391153632, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 68743048, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 144000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.391181899978214, "done": false, "training_iteration": 72, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-42-43", "timestamp": 1747694563, "time_this_iter_s": 39.61347055435181, "time_total_s": 2887.9302678108215, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2887.9302678108215, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 76.33214285714287, "ram_util_percent": 50.80714285714286}}
{"timers": {"training_iteration": 41.66982865258998, "restore_env_runners": 2.7949648465096036e-05, "training_step": 41.66932481761035, "env_runner_sampling_timer": 31.59435004975354, "learner_update_timer": 10.061803042936228, "synch_weights": 0.01215856651830787, "synch_env_connectors": 0.009190851216404942}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3256666666666668, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016205270738958836, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.158836995781363e-06, "un_batch_to_individual_items": 7.030312612989149e-05, "listify_data_for_vector_env": 0.00013686625616479513, "normalize_and_clip_actions": 0.00011960874783613522, "get_actions": 0.0007202434502349313, "tensor_to_numpy": 0.00023748305910357035}}}, "num_module_steps_sampled_lifetime": {"default_policy": 146000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 146000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2432147813586725e-05, "add_states_from_episodes_to_batch": 1.8929859566666815e-05, "numpy_to_tensor": 0.00016346879720457983, "add_time_dim_to_batch_and_zero_pad": 3.8351471053181724e-05, "batch_individual_items": 9.661919942164245e-05}}, "connector_pipeline_timer": 0.0006064259729640828}, "episode_return_max": 0.7160000000000015, "episode_duration_sec_mean": 24.292772646134207, "num_episodes_lifetime": 672, "rlmodule_inference_timer": 0.0005567035590746688, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.46585256410256437, "env_to_module_sum_episodes_length_out": 93.56740168958927, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10877183669340308, "num_env_steps_sampled_lifetime": 146000, "weights_seq_no": 72.0, "agent_episode_returns_mean": {"default_agent": 0.46585256410256437}, "module_episode_returns_mean": {"default_policy": 0.46585256410256437}, "num_env_steps_sampled": 2000, "sample": 30.0562077784831, "env_to_module_sum_episodes_length_in": 93.56740168958927, "time_between_sampling": 12.023942595265598, "num_env_steps_sampled_lifetime_throughput": 47.0197840636947}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.05504308640956879, "weights_seq_no": 73.0, "vf_loss_unclipped": 0.004049389623105526, "total_loss": -0.05099368840456009, "gradients_default_optimizer_global_norm": 0.7502952218055725, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.007297098636627197, "entropy": 0.11208558827638626, "curr_kl_coeff": 3.6379788613018216e-13, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0017469825688749552, "num_module_steps_trained_lifetime": 4422528, "vf_loss": 0.004049389623105526}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04610609841945862, "add_observations_from_episodes_to_batch": 0.00036021219442670705, "add_one_ts_to_episodes_and_truncate": 0.007230160918884851, "add_columns_from_episodes_to_train_batch": 0.0791970313658571, "general_advantage_estimation": 0.11621280231065598, "add_states_from_episodes_to_batch": 1.1114767134060842e-05, "numpy_to_tensor": 0.0013351498574707952, "add_time_dim_to_batch_and_zero_pad": 3.131574086548029e-05}}, "connector_pipeline_timer": 0.25105882126158796}, "num_module_steps_trained_lifetime": 4422528, "learner_connector_sum_episodes_length_out": 2016.1994454567566, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 69696616, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 146000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.0197840636947, "done": false, "training_iteration": 73, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-43-25", "timestamp": 1747694605, "time_this_iter_s": 42.48317813873291, "time_total_s": 2930.4134459495544, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2930.4134459495544, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 76.51500000000001, "ram_util_percent": 50.813333333333354}}
{"timers": {"training_iteration": 41.64865364318409, "restore_env_runners": 2.7893152005006847e-05, "training_step": 41.64814967955428, "env_runner_sampling_timer": 31.584215929966057, "learner_update_timer": 10.05082856291683, "synch_weights": 0.01209205885312966, "synch_env_connectors": 0.009209094704292932}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3256666666666668, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016341528841402621, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.127460353516011e-06, "un_batch_to_individual_items": 7.067338161799161e-05, "listify_data_for_vector_env": 0.00013694849602258118, "normalize_and_clip_actions": 0.00011965932122265366, "get_actions": 0.0007266563426674475, "tensor_to_numpy": 0.0002415936985039713}}}, "num_module_steps_sampled_lifetime": {"default_policy": 148000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 148000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.251678060703602e-05, "add_states_from_episodes_to_batch": 1.9760158981961304e-05, "numpy_to_tensor": 0.00016499732017620367, "add_time_dim_to_batch_and_zero_pad": 3.850802197317758e-05, "batch_individual_items": 9.682788942055396e-05}}, "connector_pipeline_timer": 0.0006096518098906735}, "episode_return_max": 0.7940000000000007, "episode_duration_sec_mean": 23.391618612325708, "num_episodes_lifetime": 680, "rlmodule_inference_timer": 0.000559763103870268, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5279166666666669, "env_to_module_sum_episodes_length_out": 92.635518615937, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10875744160923817, "num_env_steps_sampled_lifetime": 148000, "weights_seq_no": 73.0, "agent_episode_returns_mean": {"default_agent": 0.5279166666666669}, "module_episode_returns_mean": {"default_policy": 0.5279166666666669}, "num_env_steps_sampled": 2000, "sample": 30.046241781622523, "env_to_module_sum_episodes_length_in": 92.635518615937, "time_between_sampling": 12.010560889105625, "num_env_steps_sampled_lifetime_throughput": 50.45819495895257}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.1364261955022812, "weights_seq_no": 74.0, "vf_loss_unclipped": 0.0064056129194796085, "total_loss": -0.13002058863639832, "gradients_default_optimizer_global_norm": 0.3913211226463318, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04625678062438965, "entropy": 0.15935590863227844, "curr_kl_coeff": 1.8189894306509108e-13, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0027192493434995413, "num_module_steps_trained_lifetime": 4483072, "vf_loss": 0.0064056129194796085}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046158885798684754, "add_observations_from_episodes_to_batch": 0.000360324790386215, "add_one_ts_to_episodes_and_truncate": 0.00722557805345494, "add_columns_from_episodes_to_train_batch": 0.07920766430507488, "general_advantage_estimation": 0.11576339932193964, "add_states_from_episodes_to_batch": 1.1117564526864076e-05, "numpy_to_tensor": 0.0013353397520928262, "add_time_dim_to_batch_and_zero_pad": 3.1325716128660016e-05}}, "connector_pipeline_timer": 0.2506678239854762}, "num_module_steps_trained_lifetime": 4483072, "learner_connector_sum_episodes_length_out": 2016.2037441674106, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 70650184, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 148000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.45819495895257, "done": false, "training_iteration": 74, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-44-05", "timestamp": 1747694645, "time_this_iter_s": 39.57445955276489, "time_total_s": 2969.9879055023193, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2969.9879055023193, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 76.56315789473683, "ram_util_percent": 50.81578947368422}}
{"timers": {"training_iteration": 41.634908121982235, "restore_env_runners": 2.7841220539976523e-05, "training_step": 41.63440422698871, "env_runner_sampling_timer": 31.578509946196384, "learner_update_timer": 10.042846132987668, "synch_weights": 0.012033649264594812, "synch_env_connectors": 0.00923029975723135}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32455555555555576, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016389217668135217, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.122454481471174e-06, "un_batch_to_individual_items": 7.129508930445167e-05, "listify_data_for_vector_env": 0.00013803182822549935, "normalize_and_clip_actions": 0.00012000852871357107, "get_actions": 0.0007278808452695332, "tensor_to_numpy": 0.000242347383169394}}}, "num_module_steps_sampled_lifetime": {"default_policy": 150000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 150000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.371204372630976e-05, "add_states_from_episodes_to_batch": 1.9723766504948218e-05, "numpy_to_tensor": 0.00016694752522263646, "add_time_dim_to_batch_and_zero_pad": 3.89114289928224e-05, "batch_individual_items": 9.70688408357641e-05}}, "connector_pipeline_timer": 0.0006157980714090733}, "episode_return_max": 0.7940000000000007, "episode_duration_sec_mean": 23.122672465671922, "num_episodes_lifetime": 688, "rlmodule_inference_timer": 0.0005627748720326001, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5586891025641028, "env_to_module_sum_episodes_length_out": 93.41679227413134, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10859640682228897, "num_env_steps_sampled_lifetime": 150000, "weights_seq_no": 74.0, "agent_episode_returns_mean": {"default_agent": 0.5586891025641028}, "module_episode_returns_mean": {"default_policy": 0.5586891025641028}, "num_env_steps_sampled": 2000, "sample": 30.036631083130366, "env_to_module_sum_episodes_length_in": 93.41679227413134, "time_between_sampling": 11.997109356124275, "num_env_steps_sampled_lifetime_throughput": 49.56140225344162}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.030484646558761597, "weights_seq_no": 75.0, "vf_loss_unclipped": 0.0040076859295368195, "total_loss": 0.034492336213588715, "gradients_default_optimizer_global_norm": 0.20813368260860443, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04154527187347412, "entropy": 0.12429679185152054, "curr_kl_coeff": 9.094947153254554e-14, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0034120052587240934, "num_module_steps_trained_lifetime": 4543616, "vf_loss": 0.0040076859295368195}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0462105610603843, "add_observations_from_episodes_to_batch": 0.0003604406332067397, "add_one_ts_to_episodes_and_truncate": 0.007220867649242188, "add_columns_from_episodes_to_train_batch": 0.07921783888227173, "general_advantage_estimation": 0.1153123642227665, "add_states_from_episodes_to_batch": 1.1120214495588668e-05, "numpy_to_tensor": 0.0013355244038367783, "add_time_dim_to_batch_and_zero_pad": 3.133550031311605e-05}}, "connector_pipeline_timer": 0.25027349809256066}, "num_module_steps_trained_lifetime": 4543616, "learner_connector_sum_episodes_length_out": 2016.207936959306, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 71603752, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 150000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.56140225344162, "done": false, "training_iteration": 75, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-44-45", "timestamp": 1747694685, "time_this_iter_s": 40.29012179374695, "time_total_s": 3010.2780272960663, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3010.2780272960663, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 76.79649122807018, "ram_util_percent": 50.84210526315789}}
{"timers": {"training_iteration": 41.56662474664241, "restore_env_runners": 2.7839808333763713e-05, "training_step": 41.56612041359881, "env_runner_sampling_timer": 31.527411149344406, "learner_update_timer": 10.025721318927795, "synch_weights": 0.011972409771924599, "synch_env_connectors": 0.009209990759613465}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32455555555555576, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016272322605241844, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.048306726706706e-06, "un_batch_to_individual_items": 7.091277640642787e-05, "listify_data_for_vector_env": 0.0001372943604270645, "normalize_and_clip_actions": 0.00011951532506602069, "get_actions": 0.0007232735623150464, "tensor_to_numpy": 0.0002396178152660138}}}, "num_module_steps_sampled_lifetime": {"default_policy": 152000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 152000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.4028677648753896e-05, "add_states_from_episodes_to_batch": 1.9583088661846198e-05, "numpy_to_tensor": 0.00016525759042477784, "add_time_dim_to_batch_and_zero_pad": 3.846961442973803e-05, "batch_individual_items": 9.649660615804609e-05}}, "connector_pipeline_timer": 0.0006127914983837232}, "episode_return_max": 0.7830000000000005, "episode_duration_sec_mean": 22.963581883018307, "num_episodes_lifetime": 696, "rlmodule_inference_timer": 0.0005595231131324249, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.49540384615384647, "env_to_module_sum_episodes_length_out": 96.27801879055455, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10742676009936473, "num_env_steps_sampled_lifetime": 152000, "weights_seq_no": 75.0, "agent_episode_returns_mean": {"default_agent": 0.49540384615384647}, "module_episode_returns_mean": {"default_policy": 0.49540384615384647}, "num_env_steps_sampled": 2000, "sample": 30.024751603781844, "env_to_module_sum_episodes_length_in": 96.27801879055455, "time_between_sampling": 11.984017320849953, "num_env_steps_sampled_lifetime_throughput": 57.34088817781363}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.06466953456401825, "weights_seq_no": 76.0, "vf_loss_unclipped": 0.00846712477505207, "total_loss": -0.05620240420103073, "gradients_default_optimizer_global_norm": 0.4006495177745819, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.0015292167663574219, "entropy": 0.0796365812420845, "curr_kl_coeff": 4.547473576627277e-14, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0011616582050919533, "num_module_steps_trained_lifetime": 4604160, "vf_loss": 0.00846712477505207}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046260586418169415, "add_observations_from_episodes_to_batch": 0.0003605507366920138, "add_one_ts_to_episodes_and_truncate": 0.007216033825308516, "add_columns_from_episodes_to_train_batch": 0.07922710950119397, "general_advantage_estimation": 0.1148597247356447, "add_states_from_episodes_to_batch": 1.1122759708553891e-05, "numpy_to_tensor": 0.001335669588569977, "add_time_dim_to_batch_and_zero_pad": 3.1344796242067374e-05}}, "connector_pipeline_timer": 0.24987483207470518}, "num_module_steps_trained_lifetime": 4604160, "learner_connector_sum_episodes_length_out": 2016.2120255209466, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 72557320, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 152000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.34088817781363, "done": false, "training_iteration": 76, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-45-20", "timestamp": 1747694720, "time_this_iter_s": 34.82253170013428, "time_total_s": 3045.1005589962006, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3045.1005589962006, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 78.93673469387755, "ram_util_percent": 50.90816326530612}}
{"timers": {"training_iteration": 41.523917443905965, "restore_env_runners": 2.7802410266529573e-05, "training_step": 41.52341261819285, "env_runner_sampling_timer": 31.499781626640953, "learner_update_timer": 10.010663636678524, "synch_weights": 0.011913265674268408, "synch_env_connectors": 0.009200139851987364}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3180000000000008, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016166676835935256, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.096229738889344e-06, "un_batch_to_individual_items": 7.037083696473278e-05, "listify_data_for_vector_env": 0.00013681950785712757, "normalize_and_clip_actions": 0.00011822190300028997, "get_actions": 0.0007185590632375083, "tensor_to_numpy": 0.00023837515285357445}}}, "num_module_steps_sampled_lifetime": {"default_policy": 154000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 154000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3465748302480864e-05, "add_states_from_episodes_to_batch": 1.95708412597085e-05, "numpy_to_tensor": 0.00016301844047160544, "add_time_dim_to_batch_and_zero_pad": 3.794806312681845e-05, "batch_individual_items": 9.584180838428304e-05}}, "connector_pipeline_timer": 0.0006063586408552139}, "episode_return_max": 0.7837777777777791, "episode_duration_sec_mean": 20.73118612526846, "num_episodes_lifetime": 712, "rlmodule_inference_timer": 0.000555467973260365, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5152361111111119, "env_to_module_sum_episodes_length_out": 97.4487612951943, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10749183963256977, "num_env_steps_sampled_lifetime": 154000, "weights_seq_no": 76.0, "agent_episode_returns_mean": {"default_agent": 0.5152361111111119}, "module_episode_returns_mean": {"default_policy": 0.5152361111111119}, "num_env_steps_sampled": 2000, "sample": 30.01223849739222, "env_to_module_sum_episodes_length_in": 97.4487612951943, "time_between_sampling": 11.969640760985115, "num_env_steps_sampled_lifetime_throughput": 53.52105511870943}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.015396036207675934, "weights_seq_no": 77.0, "vf_loss_unclipped": 0.004861282184720039, "total_loss": 0.020257331430912018, "gradients_default_optimizer_global_norm": 0.2955320477485657, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.062104880809783936, "entropy": 0.1281791627407074, "curr_kl_coeff": 4.547473576627277e-14, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.006871605291962624, "num_module_steps_trained_lifetime": 4664960, "vf_loss": 0.004861282184720039}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04630888074269242, "add_observations_from_episodes_to_batch": 0.00036066892404415735, "add_one_ts_to_episodes_and_truncate": 0.00721119342108876, "add_columns_from_episodes_to_train_batch": 0.07923575659385004, "general_advantage_estimation": 0.11440553184184364, "add_states_from_episodes_to_batch": 1.1127111995869827e-05, "numpy_to_tensor": 0.0013357947071681673, "add_time_dim_to_batch_and_zero_pad": 3.135349270274711e-05}}, "connector_pipeline_timer": 0.2494722326072975}, "num_module_steps_trained_lifetime": 4664960, "learner_connector_sum_episodes_length_out": 2016.2168115176585, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 73518720, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 154000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.52105511870943, "done": false, "training_iteration": 77, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-45-57", "timestamp": 1747694757, "time_this_iter_s": 37.31054878234863, "time_total_s": 3082.411107778549, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3082.411107778549, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 78.12264150943396, "ram_util_percent": 50.91509433962265}}
{"timers": {"training_iteration": 41.54255028595689, "restore_env_runners": 2.7839386161363678e-05, "training_step": 41.542044822500905, "env_runner_sampling_timer": 31.517090467034546, "learner_update_timer": 10.012051518151704, "synch_weights": 0.011848641007515084, "synch_env_connectors": 0.009193041453491988}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3180000000000008, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00163550827102516, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.039095284502458e-06, "un_batch_to_individual_items": 6.99779475338998e-05, "listify_data_for_vector_env": 0.0001395907651362573, "normalize_and_clip_actions": 0.00011921479622842832, "get_actions": 0.0007302570645835129, "tensor_to_numpy": 0.00024140782959699414}}}, "num_module_steps_sampled_lifetime": {"default_policy": 156000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 156000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.491781000704134e-05, "add_states_from_episodes_to_batch": 1.94275726382164e-05, "numpy_to_tensor": 0.0001634383924611896, "add_time_dim_to_batch_and_zero_pad": 3.772684167271587e-05, "batch_individual_items": 9.762959905692795e-05}}, "connector_pipeline_timer": 0.000611346074873643}, "episode_return_max": 0.667111111111112, "episode_duration_sec_mean": 22.08889090145294, "num_episodes_lifetime": 720, "rlmodule_inference_timer": 0.0005600529450235952, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.44154487179487245, "env_to_module_sum_episodes_length_out": 96.20493840239358, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1091459491964376, "num_env_steps_sampled_lifetime": 156000, "weights_seq_no": 77.0, "agent_episode_returns_mean": {"default_agent": 0.44154487179487245}, "module_episode_returns_mean": {"default_policy": 0.44154487179487245}, "num_env_steps_sampled": 2000, "sample": 30.00166812906217, "env_to_module_sum_episodes_length_in": 96.20493840239358, "time_between_sampling": 11.95460502691837, "num_env_steps_sampled_lifetime_throughput": 46.00804984781086}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.003382395952939987, "weights_seq_no": 78.0, "vf_loss_unclipped": 0.0036949804052710533, "total_loss": 0.007077386602759361, "gradients_default_optimizer_global_norm": 0.24902717769145966, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.004689812660217285, "entropy": 0.12153130769729614, "curr_kl_coeff": 2.2737367883136385e-14, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003571585286408663, "num_module_steps_trained_lifetime": 4725504, "vf_loss": 0.0036949804052710533}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046356162722083726, "add_observations_from_episodes_to_batch": 0.0003607798825758886, "add_one_ts_to_episodes_and_truncate": 0.00720625212157142, "add_columns_from_episodes_to_train_batch": 0.07924439215370331, "general_advantage_estimation": 0.11394979281344508, "add_states_from_episodes_to_batch": 1.1131284961959413e-05, "numpy_to_tensor": 0.0013359254064358329, "add_time_dim_to_batch_and_zero_pad": 3.136210075436945e-05}}, "connector_pipeline_timer": 0.24906697224603028}, "num_module_steps_trained_lifetime": 4725504, "learner_connector_sum_episodes_length_out": 2016.2214805918838, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 74472288, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 156000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.00804984781086, "done": false, "training_iteration": 78, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-46-41", "timestamp": 1747694801, "time_this_iter_s": 43.40250897407532, "time_total_s": 3125.8136167526245, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3125.8136167526245, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 75.28064516129035, "ram_util_percent": 50.87258064516131}}
{"timers": {"training_iteration": 41.5182609732973, "restore_env_runners": 2.787699230486393e-05, "training_step": 41.51775479247587, "env_runner_sampling_timer": 31.501298794634202, "learner_update_timer": 10.003618045900176, "synch_weights": 0.01178361659743615, "synch_env_connectors": 0.009172072038903759}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3065555555555557, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016349851572635492, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.959824372004385e-06, "un_batch_to_individual_items": 7.009863760449246e-05, "listify_data_for_vector_env": 0.00014117950121394056, "normalize_and_clip_actions": 0.00011853502426722265, "get_actions": 0.0007290962165006486, "tensor_to_numpy": 0.00024098049973060915}}}, "num_module_steps_sampled_lifetime": {"default_policy": 158000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 158000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.449189582676112e-05, "add_states_from_episodes_to_batch": 1.93940439936668e-05, "numpy_to_tensor": 0.0001641857172450707, "add_time_dim_to_batch_and_zero_pad": 3.744076892465455e-05, "batch_individual_items": 9.94091917331346e-05}}, "connector_pipeline_timer": 0.0006126018426963602}, "episode_return_max": 0.7071111111111115, "episode_duration_sec_mean": 24.104239337731087, "num_episodes_lifetime": 728, "rlmodule_inference_timer": 0.000561066537927109, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.48868910256410286, "env_to_module_sum_episodes_length_out": 94.17284172793288, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1091171580924892, "num_env_steps_sampled_lifetime": 158000, "weights_seq_no": 78.0, "agent_episode_returns_mean": {"default_agent": 0.48868910256410286}, "module_episode_returns_mean": {"default_policy": 0.48868910256410286}, "num_env_steps_sampled": 2000, "sample": 29.991083440101214, "env_to_module_sum_episodes_length_in": 94.17284172793288, "time_between_sampling": 11.94115894465733, "num_env_steps_sampled_lifetime_throughput": 51.039587694534816}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09566391259431839, "weights_seq_no": 79.0, "vf_loss_unclipped": 0.003592537250369787, "total_loss": -0.09207138419151306, "gradients_default_optimizer_global_norm": 0.1966734677553177, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07218331098556519, "entropy": 0.11386235803365707, "curr_kl_coeff": 1.1368683941568192e-14, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0020076935179531574, "num_module_steps_trained_lifetime": 4786048, "vf_loss": 0.003592537250369787}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046401996983813046, "add_observations_from_episodes_to_batch": 0.00036088524504466086, "add_one_ts_to_episodes_and_truncate": 0.007201212858702509, "add_columns_from_episodes_to_train_batch": 0.07925269571670046, "general_advantage_estimation": 0.11349330460242993, "add_states_from_episodes_to_batch": 1.1135271757214707e-05, "numpy_to_tensor": 0.0013360149822473802, "add_time_dim_to_batch_and_zero_pad": 3.137035129632395e-05}}, "connector_pipeline_timer": 0.24865902707872778}, "num_module_steps_trained_lifetime": 4786048, "learner_connector_sum_episodes_length_out": 2016.226034603473, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 75425856, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 158000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.039587694534816, "done": false, "training_iteration": 79, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-47-20", "timestamp": 1747694840, "time_this_iter_s": 39.12942600250244, "time_total_s": 3164.943042755127, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3164.943042755127, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 77.71090909090908, "ram_util_percent": 50.86727272727274}}
{"timers": {"training_iteration": 41.49721708301431, "restore_env_runners": 2.7879222411460223e-05, "training_step": 41.49671057100107, "env_runner_sampling_timer": 31.49168905884789, "learner_update_timer": 9.992124786731164, "synch_weights": 0.011843798431467763, "synch_env_connectors": 0.009150551318560308}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.28822222222222216, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016300592080616093, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.849181884875222e-06, "un_batch_to_individual_items": 7.040897228555389e-05, "listify_data_for_vector_env": 0.00014059880217096369, "normalize_and_clip_actions": 0.00011831097711233501, "get_actions": 0.0007252630573065246, "tensor_to_numpy": 0.0002403460817181555}}}, "num_module_steps_sampled_lifetime": {"default_policy": 160000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 160000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.430680217324647e-05, "add_states_from_episodes_to_batch": 1.9707898635156583e-05, "numpy_to_tensor": 0.00016324997699601493, "add_time_dim_to_batch_and_zero_pad": 3.746004990642174e-05, "batch_individual_items": 9.904411739307768e-05}}, "connector_pipeline_timer": 0.0006099373922052395}, "episode_return_max": 0.7071111111111115, "episode_duration_sec_mean": 23.805569014163737, "num_episodes_lifetime": 736, "rlmodule_inference_timer": 0.0005588816853762961, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4819946581196583, "env_to_module_sum_episodes_length_out": 92.78381471300443, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10867248657201897, "num_env_steps_sampled_lifetime": 160000, "weights_seq_no": 79.0, "agent_episode_returns_mean": {"default_agent": 0.4819946581196583}, "module_episode_returns_mean": {"default_policy": 0.4819946581196583}, "num_env_steps_sampled": 2000, "sample": 29.98055309441205, "env_to_module_sum_episodes_length_in": 92.78381471300443, "time_between_sampling": 11.927674230642934, "num_env_steps_sampled_lifetime_throughput": 50.652582103380546}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.04311392083764076, "weights_seq_no": 80.0, "vf_loss_unclipped": 0.0028864324558526278, "total_loss": 0.04600035026669502, "gradients_default_optimizer_global_norm": 0.2951372265815735, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.0025157928466796875, "entropy": 0.1097148135304451, "curr_kl_coeff": 5.684341970784096e-15, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002929395530372858, "num_module_steps_trained_lifetime": 4846592, "vf_loss": 0.0028864324558526278}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046446800784035076, "add_observations_from_episodes_to_batch": 0.00036098899227632054, "add_one_ts_to_episodes_and_truncate": 0.007196150385878745, "add_columns_from_episodes_to_train_batch": 0.0792619015792225, "general_advantage_estimation": 0.11303547977635377, "add_states_from_episodes_to_batch": 1.1139055687603493e-05, "numpy_to_tensor": 0.0013360746440018879, "add_time_dim_to_batch_and_zero_pad": 3.137803061705122e-05}}, "connector_pipeline_timer": 0.2482495568175466}, "num_module_steps_trained_lifetime": 4846592, "learner_connector_sum_episodes_length_out": 2016.230475386771, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 76379424, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 160000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.652582103380546, "done": false, "training_iteration": 80, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-48-00", "timestamp": 1747694880, "time_this_iter_s": 39.436644554138184, "time_total_s": 3204.379687309265, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3204.379687309265, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 75.51403508771932, "ram_util_percent": 50.87894736842106}}
{"timers": {"training_iteration": 41.457194805484164, "restore_env_runners": 2.7814430216136524e-05, "training_step": 41.45668760659106, "env_runner_sampling_timer": 31.466412473969392, "learner_update_timer": 9.97737646644384, "synch_weights": 0.011802458447191036, "synch_env_connectors": 0.00919827980531853}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.28822222222222216, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001620917116735666, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.930781946743863e-06, "un_batch_to_individual_items": 7.041977107577745e-05, "listify_data_for_vector_env": 0.00013897240570987768, "normalize_and_clip_actions": 0.0001179346918685402, "get_actions": 0.000721327582619775, "tensor_to_numpy": 0.00023900691015345133}}}, "num_module_steps_sampled_lifetime": {"default_policy": 162000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 162000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.367012359077278e-05, "add_states_from_episodes_to_batch": 1.96874694674535e-05, "numpy_to_tensor": 0.00016217930132445351, "add_time_dim_to_batch_and_zero_pad": 3.752096617603026e-05, "batch_individual_items": 9.86982399352231e-05}}, "connector_pipeline_timer": 0.0006071084962130123}, "episode_return_max": 0.6984444444444446, "episode_duration_sec_mean": 22.253729097028483, "num_episodes_lifetime": 744, "rlmodule_inference_timer": 0.0005567295100006752, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.46177136752136777, "env_to_module_sum_episodes_length_out": 92.90513010586344, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1078817541483394, "num_env_steps_sampled_lifetime": 162000, "weights_seq_no": 80.0, "agent_episode_returns_mean": {"default_agent": 0.46177136752136777}, "module_episode_returns_mean": {"default_policy": 0.46177136752136777}, "num_env_steps_sampled": 2000, "sample": 29.968945867024892, "env_to_module_sum_episodes_length_in": 92.90513010586344, "time_between_sampling": 11.914439962228236, "num_env_steps_sampled_lifetime_throughput": 53.050087553261825}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.15647995471954346, "weights_seq_no": 81.0, "vf_loss_unclipped": 0.0045744311064481735, "total_loss": 0.16105438768863678, "gradients_default_optimizer_global_norm": 0.3619409203529358, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04124397039413452, "entropy": 0.138824000954628, "curr_kl_coeff": 2.842170985392048e-15, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002742151264101267, "num_module_steps_trained_lifetime": 4907136, "vf_loss": 0.0045744311064481735}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04649019866865424, "add_observations_from_episodes_to_batch": 0.00036108711603850797, "add_one_ts_to_episodes_and_truncate": 0.007190970561225257, "add_columns_from_episodes_to_train_batch": 0.07927078291532241, "general_advantage_estimation": 0.1125768287064391, "add_states_from_episodes_to_batch": 1.1142750411853575e-05, "numpy_to_tensor": 0.0013360980910235663, "add_time_dim_to_batch_and_zero_pad": 3.138567931631931e-05}}, "connector_pipeline_timer": 0.24783736062948117}, "num_module_steps_trained_lifetime": 4907136, "learner_connector_sum_episodes_length_out": 2016.2348047509429, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 77332992, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 162000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.050087553261825, "done": false, "training_iteration": 81, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-48-37", "timestamp": 1747694917, "time_this_iter_s": 37.51414465904236, "time_total_s": 3241.8938319683075, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3241.8938319683075, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 77.1754716981132, "ram_util_percent": 50.89056603773585}}
{"timers": {"training_iteration": 41.423463720249366, "restore_env_runners": 2.7863285930088902e-05, "training_step": 41.42295590834512, "env_runner_sampling_timer": 31.43943151671973, "learner_update_timer": 9.970674584109442, "synch_weights": 0.011755664862757222, "synch_env_connectors": 0.009206847017221697}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3056666666666666, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016085246142364716, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.90792718738799e-06, "un_batch_to_individual_items": 6.986041641758535e-05, "listify_data_for_vector_env": 0.00013780425557460965, "normalize_and_clip_actions": 0.00011725589561461474, "get_actions": 0.0007157700583942762, "tensor_to_numpy": 0.00023635771354617592}}}, "num_module_steps_sampled_lifetime": {"default_policy": 164000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 164000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.30523546826229e-05, "add_states_from_episodes_to_batch": 1.9888460044946938e-05, "numpy_to_tensor": 0.00016132177193507304, "add_time_dim_to_batch_and_zero_pad": 3.778874548909444e-05, "batch_individual_items": 9.854478995147215e-05}}, "connector_pipeline_timer": 0.0006048689939366214}, "episode_return_max": 0.7421111111111116, "episode_duration_sec_mean": 21.801517034884455, "num_episodes_lifetime": 752, "rlmodule_inference_timer": 0.0005533598365146655, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4874647435897438, "env_to_module_sum_episodes_length_out": 95.0069057886725, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10670344485284308, "num_env_steps_sampled_lifetime": 164000, "weights_seq_no": 81.0, "agent_episode_returns_mean": {"default_agent": 0.4874647435897438}, "module_episode_returns_mean": {"default_policy": 0.4874647435897438}, "num_env_steps_sampled": 2000, "sample": 29.956004690853888, "env_to_module_sum_episodes_length_in": 95.0069057886725, "time_between_sampling": 11.901045732395644, "num_env_steps_sampled_lifetime_throughput": 52.33136192931102}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.048133768141269684, "weights_seq_no": 82.0, "vf_loss_unclipped": 0.005363635718822479, "total_loss": -0.042770132422447205, "gradients_default_optimizer_global_norm": 0.324783056974411, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.08441799879074097, "entropy": 0.11664187908172607, "curr_kl_coeff": 1.421085492696024e-15, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0023377069737762213, "num_module_steps_trained_lifetime": 4967680, "vf_loss": 0.005363635718822479}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046532273265402005, "add_observations_from_episodes_to_batch": 0.0003612014284260359, "add_one_ts_to_episodes_and_truncate": 0.007185806528026301, "add_columns_from_episodes_to_train_batch": 0.07927964337434176, "general_advantage_estimation": 0.11211696543984513, "add_states_from_episodes_to_batch": 1.1146297335965416e-05, "numpy_to_tensor": 0.0013360994116401112, "add_time_dim_to_batch_and_zero_pad": 3.1392887238413754e-05}}, "connector_pipeline_timer": 0.24742264588909496}, "num_module_steps_trained_lifetime": 4967680, "learner_connector_sum_episodes_length_out": 2016.2390244802928, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 78286560, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 164000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.33136192931102, "done": false, "training_iteration": 82, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-49-15", "timestamp": 1747694955, "time_this_iter_s": 38.09996485710144, "time_total_s": 3279.993796825409, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3279.993796825409, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 74.62037037037037, "ram_util_percent": 50.914814814814825}}
{"timers": {"training_iteration": 41.4086943503269, "restore_env_runners": 2.7845653093662225e-05, "training_step": 41.40818544154168, "env_runner_sampling_timer": 31.43111029241254, "learner_update_timer": 9.964265218688393, "synch_weights": 0.011714930214103267, "synch_env_connectors": 0.009201731547040378}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2873333333333336, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016033627815864766, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.815889041779945e-06, "un_batch_to_individual_items": 6.947316240149613e-05, "listify_data_for_vector_env": 0.0001371992908822064, "normalize_and_clip_actions": 0.00011720078795487716, "get_actions": 0.0007140026709792771, "tensor_to_numpy": 0.00023462580519849523}}}, "num_module_steps_sampled_lifetime": {"default_policy": 166000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 166000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2865559813055745e-05, "add_states_from_episodes_to_batch": 1.960515325045522e-05, "numpy_to_tensor": 0.00016075672099729793, "add_time_dim_to_batch_and_zero_pad": 3.748517515862302e-05, "batch_individual_items": 9.799983495451392e-05}}, "connector_pipeline_timer": 0.0006019279996720401}, "episode_return_max": 0.821222222222224, "episode_duration_sec_mean": 21.71406074992354, "num_episodes_lifetime": 768, "rlmodule_inference_timer": 0.0005501349030022525, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5398579059829068, "env_to_module_sum_episodes_length_out": 97.02117502892946, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10679028829230412, "num_env_steps_sampled_lifetime": 166000, "weights_seq_no": 82.0, "agent_episode_returns_mean": {"default_agent": 0.5398579059829068}, "module_episode_returns_mean": {"default_policy": 0.5398579059829068}, "num_env_steps_sampled": 2000, "sample": 29.94345142087358, "env_to_module_sum_episodes_length_in": 97.02117502892946, "time_between_sampling": 11.888278502629582, "num_env_steps_sampled_lifetime_throughput": 49.96860094664562}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05060253292322159, "weights_seq_no": 83.0, "vf_loss_unclipped": 0.008804685436189175, "total_loss": 0.05940721184015274, "gradients_default_optimizer_global_norm": 0.18705950677394867, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.022884726524353027, "entropy": 0.07720045000314713, "curr_kl_coeff": 7.10542746348012e-16, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0012434411328285933, "num_module_steps_trained_lifetime": 5028480, "vf_loss": 0.008804685436189175}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046573191050347504, "add_observations_from_episodes_to_batch": 0.00036132738585397853, "add_one_ts_to_episodes_and_truncate": 0.007180653788435115, "add_columns_from_episodes_to_train_batch": 0.07928791687588917, "general_advantage_estimation": 0.11165594148571233, "add_states_from_episodes_to_batch": 1.114969904719695e-05, "numpy_to_tensor": 0.0013360945760353057, "add_time_dim_to_batch_and_zero_pad": 3.1399562434701855e-05}}, "connector_pipeline_timer": 0.24700503836745344}, "num_module_steps_trained_lifetime": 5028480, "learner_connector_sum_episodes_length_out": 2016.2439363345804, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 79247960, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 166000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.96860094664562, "done": false, "training_iteration": 83, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-49-55", "timestamp": 1747694995, "time_this_iter_s": 39.96163630485535, "time_total_s": 3319.9554331302643, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3319.9554331302643, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 75.93684210526318, "ram_util_percent": 50.92982456140351}}
{"timers": {"training_iteration": 41.39301591321367, "restore_env_runners": 2.7879196537381522e-05, "training_step": 41.3925057345162, "env_runner_sampling_timer": 31.420018022408442, "learner_update_timer": 9.959745960971501, "synch_weights": 0.011645881911955272, "synch_env_connectors": 0.009185200221588908}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26255555555555565, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016039734510178475, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.747553100100827e-06, "un_batch_to_individual_items": 6.931923458165288e-05, "listify_data_for_vector_env": 0.00013764150826614066, "normalize_and_clip_actions": 0.00011780444087915939, "get_actions": 0.0007157995515172813, "tensor_to_numpy": 0.0002333943305259336}}}, "num_module_steps_sampled_lifetime": {"default_policy": 168000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 168000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.337139637542296e-05, "add_states_from_episodes_to_batch": 1.9505144578375714e-05, "numpy_to_tensor": 0.00016070565559579166, "add_time_dim_to_batch_and_zero_pad": 3.775884480817157e-05, "batch_individual_items": 9.744771755174668e-05}}, "connector_pipeline_timer": 0.0006018883803590214}, "episode_return_max": 0.821222222222224, "episode_duration_sec_mean": 22.113493835308102, "num_episodes_lifetime": 776, "rlmodule_inference_timer": 0.0005489217035097411, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4585833333333341, "env_to_module_sum_episodes_length_out": 96.53420185186458, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10715219711022428, "num_env_steps_sampled_lifetime": 168000, "weights_seq_no": 83.0, "agent_episode_returns_mean": {"default_agent": 0.4585833333333341}, "module_episode_returns_mean": {"default_policy": 0.4585833333333341}, "num_env_steps_sampled": 2000, "sample": 29.930479987993593, "env_to_module_sum_episodes_length_in": 96.53420185186458, "time_between_sampling": 11.875945212420383, "num_env_steps_sampled_lifetime_throughput": 50.10612120969833}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0815674364566803, "weights_seq_no": 84.0, "vf_loss_unclipped": 0.00370106752961874, "total_loss": 0.08526850491762161, "gradients_default_optimizer_global_norm": 0.192315012216568, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07038211822509766, "entropy": 0.07076971232891083, "curr_kl_coeff": 3.55271373174006e-16, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001154402270913124, "num_module_steps_trained_lifetime": 5089024, "vf_loss": 0.00370106752961874}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046628242302066976, "add_observations_from_episodes_to_batch": 0.0003614457139909041, "add_one_ts_to_episodes_and_truncate": 0.007175447242983356, "add_columns_from_episodes_to_train_batch": 0.07929569162296811, "general_advantage_estimation": 0.11119409563411839, "add_states_from_episodes_to_batch": 1.11537780940813e-05, "numpy_to_tensor": 0.0013361131272014342, "add_time_dim_to_batch_and_zero_pad": 3.1407294838569296e-05}}, "connector_pipeline_timer": 0.24660021103135632}, "num_module_steps_trained_lifetime": 5089024, "learner_connector_sum_episodes_length_out": 2016.2487260493344, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 80201528, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 168000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.10612120969833, "done": false, "training_iteration": 84, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-50-35", "timestamp": 1747695035, "time_this_iter_s": 39.85719656944275, "time_total_s": 3359.812629699707, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3359.812629699707, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 73.83508771929826, "ram_util_percent": 50.91929824561403}}
{"timers": {"training_iteration": 41.44106937750148, "restore_env_runners": 2.7895404562736393e-05, "training_step": 41.44055946659107, "env_runner_sampling_timer": 31.475889488894342, "learner_update_timer": 9.951988070061802, "synch_weights": 0.011584641102856045, "synch_env_connectors": 0.009182691219372664}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26255555555555565, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016193023186628572, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.654161195250512e-06, "un_batch_to_individual_items": 7.009455665242749e-05, "listify_data_for_vector_env": 0.00013908408843942601, "normalize_and_clip_actions": 0.00011837293619482717, "get_actions": 0.0007236524046159725, "tensor_to_numpy": 0.00023434131970704572}}}, "num_module_steps_sampled_lifetime": {"default_policy": 170000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 170000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.4316541148837886e-05, "add_states_from_episodes_to_batch": 2.0402468294917488e-05, "numpy_to_tensor": 0.0001627693898501039, "add_time_dim_to_batch_and_zero_pad": 3.814587932240153e-05, "batch_individual_items": 9.71567146017283e-05}}, "connector_pipeline_timer": 0.0006081019387052403}, "episode_return_max": 0.7253333333333348, "episode_duration_sec_mean": 25.536251878346004, "num_episodes_lifetime": 784, "rlmodule_inference_timer": 0.0005542574976890439, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5070630341880348, "env_to_module_sum_episodes_length_out": 94.608640332734, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10838770330336432, "num_env_steps_sampled_lifetime": 170000, "weights_seq_no": 84.0, "agent_episode_returns_mean": {"default_agent": 0.5070630341880348}, "module_episode_returns_mean": {"default_policy": 0.5070630341880348}, "num_env_steps_sampled": 2000, "sample": 29.92238143958265, "env_to_module_sum_episodes_length_in": 94.608640332734, "time_between_sampling": 11.864710323636187, "num_env_steps_sampled_lifetime_throughput": 43.21459729861621}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06660156697034836, "weights_seq_no": 85.0, "vf_loss_unclipped": 0.006344422232359648, "total_loss": 0.0729459747672081, "gradients_default_optimizer_global_norm": 0.08553308993577957, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.007144927978515625, "entropy": 0.14940211176872253, "curr_kl_coeff": 1.77635686587003e-16, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0017072010086849332, "num_module_steps_trained_lifetime": 5149568, "vf_loss": 0.006344422232359648}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04668202159964726, "add_observations_from_episodes_to_batch": 0.00036155740282681415, "add_one_ts_to_episodes_and_truncate": 0.007170315933062049, "add_columns_from_episodes_to_train_batch": 0.07930375601331785, "general_advantage_estimation": 0.11073114251540797, "add_states_from_episodes_to_batch": 1.1157680590614068e-05, "numpy_to_tensor": 0.0013360964078866567, "add_time_dim_to_batch_and_zero_pad": 3.1414802638209356e-05}}, "connector_pipeline_timer": 0.24619331994804428}, "num_module_steps_trained_lifetime": 5149568, "learner_connector_sum_episodes_length_out": 2016.2533955761598, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 81155096, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 170000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.21459729861621, "done": false, "training_iteration": 85, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-51-22", "timestamp": 1747695082, "time_this_iter_s": 46.2144455909729, "time_total_s": 3406.02707529068, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3406.02707529068, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 79.14, "ram_util_percent": 50.91076923076922}}
{"timers": {"training_iteration": 41.47496340054644, "restore_env_runners": 2.813845049009788e-05, "training_step": 41.47445246974512, "env_runner_sampling_timer": 31.495962496275414, "learner_update_timer": 9.965868891911173, "synch_weights": 0.01152480869182908, "synch_env_connectors": 0.009165930317210087}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29733333333333334, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016312422670912154, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.579125948436462e-06, "un_batch_to_individual_items": 7.113670457816613e-05, "listify_data_for_vector_env": 0.00013996752403845768, "normalize_and_clip_actions": 0.00011937468399689561, "get_actions": 0.0007290861767885807, "tensor_to_numpy": 0.00023651153749586426}}}, "num_module_steps_sampled_lifetime": {"default_policy": 172000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 172000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.4464447898608596e-05, "add_states_from_episodes_to_batch": 2.0438055323399653e-05, "numpy_to_tensor": 0.00016472886055073093, "add_time_dim_to_batch_and_zero_pad": 3.864894427384286e-05, "batch_individual_items": 9.91175595884252e-05}}, "connector_pipeline_timer": 0.000615905774824206}, "episode_return_max": 0.7856666666666666, "episode_duration_sec_mean": 24.74677163213416, "num_episodes_lifetime": 792, "rlmodule_inference_timer": 0.0005600048570263941, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5767318376068378, "env_to_module_sum_episodes_length_out": 92.88862254498575, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10905836048005195, "num_env_steps_sampled_lifetime": 172000, "weights_seq_no": 85.0, "agent_episode_returns_mean": {"default_agent": 0.5767318376068378}, "module_episode_returns_mean": {"default_policy": 0.5767318376068378}, "num_env_steps_sampled": 2000, "sample": 29.915096603926077, "env_to_module_sum_episodes_length_in": 92.88862254498575, "time_between_sampling": 11.854155737663392, "num_env_steps_sampled_lifetime_throughput": 44.53759701886365}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.05256679281592369, "weights_seq_no": 86.0, "vf_loss_unclipped": 0.004822109825909138, "total_loss": -0.04774468392133713, "gradients_default_optimizer_global_norm": 0.1150500699877739, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.010033130645751953, "entropy": 0.0868271067738533, "curr_kl_coeff": 8.88178432935015e-17, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001872799708507955, "num_module_steps_trained_lifetime": 5210112, "vf_loss": 0.004822109825909138}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046738328637245516, "add_observations_from_episodes_to_batch": 0.0003617699833142427, "add_one_ts_to_episodes_and_truncate": 0.007165495704614759, "add_columns_from_episodes_to_train_batch": 0.07931956051709814, "general_advantage_estimation": 0.11028775509010826, "add_states_from_episodes_to_batch": 1.1161549659508437e-05, "numpy_to_tensor": 0.0013361307816458065, "add_time_dim_to_batch_and_zero_pad": 3.142219955257618e-05}}, "connector_pipeline_timer": 0.24581674693649552}, "num_module_steps_trained_lifetime": 5210112, "learner_connector_sum_episodes_length_out": 2016.257946839844, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 82108664, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 172000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.53759701886365, "done": false, "training_iteration": 86, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-52-07", "timestamp": 1747695127, "time_this_iter_s": 44.846097230911255, "time_total_s": 3450.873172521591, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3450.873172521591, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 71.1140625, "ram_util_percent": 50.940625}}
{"timers": {"training_iteration": 41.47372391702097, "restore_env_runners": 2.807706598691519e-05, "training_step": 41.47321222552771, "env_runner_sampling_timer": 31.500521141152635, "learner_update_timer": 9.960131903632046, "synch_weights": 0.011463211604890952, "synch_env_connectors": 0.009148713014006243}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29733333333333334, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016348910871920792, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.700265031983036e-06, "un_batch_to_individual_items": 7.186602503178992e-05, "listify_data_for_vector_env": 0.00013979331120042107, "normalize_and_clip_actions": 0.00011980853618776798, "get_actions": 0.0007297406834064084, "tensor_to_numpy": 0.00023626140550617669}}}, "num_module_steps_sampled_lifetime": {"default_policy": 174000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 174000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.388232697798792e-05, "add_states_from_episodes_to_batch": 2.1031005856359677e-05, "numpy_to_tensor": 0.00016468633889065156, "add_time_dim_to_batch_and_zero_pad": 3.839197081593123e-05, "batch_individual_items": 9.889738389175599e-05}}, "connector_pipeline_timer": 0.000615592623303163}, "episode_return_max": 0.7856666666666666, "episode_duration_sec_mean": 24.58857062122157, "num_episodes_lifetime": 800, "rlmodule_inference_timer": 0.0005643840643531627, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5470448717948719, "env_to_module_sum_episodes_length_out": 92.42542975819296, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10879355891081227, "num_env_steps_sampled_lifetime": 174000, "weights_seq_no": 86.0, "agent_episode_returns_mean": {"default_agent": 0.5470448717948719}, "module_episode_returns_mean": {"default_policy": 0.5470448717948719}, "num_env_steps_sampled": 2000, "sample": 29.908949554192525, "env_to_module_sum_episodes_length_in": 92.42542975819296, "time_between_sampling": 11.84681510872636, "num_env_steps_sampled_lifetime_throughput": 48.28319486157743}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.16687604784965515, "weights_seq_no": 87.0, "vf_loss_unclipped": 0.004738151095807552, "total_loss": 0.17161419987678528, "gradients_default_optimizer_global_norm": 0.5073790550231934, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.02243208885192871, "entropy": 0.09626300632953644, "curr_kl_coeff": 4.440892164675075e-17, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001433757832273841, "num_module_steps_trained_lifetime": 5270656, "vf_loss": 0.004738151095807552}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04679288550173202, "add_observations_from_episodes_to_batch": 0.0003619738564514577, "add_one_ts_to_episodes_and_truncate": 0.007160582639043043, "add_columns_from_episodes_to_train_batch": 0.0793344470449015, "general_advantage_estimation": 0.10984323573896321, "add_states_from_episodes_to_batch": 1.1165225579304392e-05, "numpy_to_tensor": 0.001336189278288919, "add_time_dim_to_batch_and_zero_pad": 3.142909704853602e-05}}, "connector_pipeline_timer": 0.24543629007248283}, "num_module_steps_trained_lifetime": 5270656, "learner_connector_sum_episodes_length_out": 2016.2623817386966, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 83062232, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 174000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.28319486157743, "done": false, "training_iteration": 87, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-52-48", "timestamp": 1747695168, "time_this_iter_s": 41.36988139152527, "time_total_s": 3492.2430539131165, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3492.2430539131165, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 77.235593220339, "ram_util_percent": 50.989830508474576}}
{"timers": {"training_iteration": 41.450003436160834, "restore_env_runners": 2.816629537954469e-05, "training_step": 41.44949038358243, "env_runner_sampling_timer": 31.484084296641107, "learner_update_timer": 9.952895436005745, "synch_weights": 0.011414116488887922, "synch_env_connectors": 0.009141713883859324}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.34233333333333343, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001632920116091944, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.640740291692742e-06, "un_batch_to_individual_items": 7.124664398736058e-05, "listify_data_for_vector_env": 0.00013927278755405817, "normalize_and_clip_actions": 0.00011901078051292515, "get_actions": 0.0007277652687141736, "tensor_to_numpy": 0.00023829824336163053}}}, "num_module_steps_sampled_lifetime": {"default_policy": 176000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 176000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.354046203728188e-05, "add_states_from_episodes_to_batch": 2.102269580979429e-05, "numpy_to_tensor": 0.0001639451961754674, "add_time_dim_to_batch_and_zero_pad": 3.8211952819259836e-05, "batch_individual_items": 9.792676820466726e-05}}, "connector_pipeline_timer": 0.0006129990082227539}, "episode_return_max": 0.8092222222222223, "episode_duration_sec_mean": 24.06245807781726, "num_episodes_lifetime": 808, "rlmodule_inference_timer": 0.000562399620048347, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5748653846153847, "env_to_module_sum_episodes_length_out": 93.81056662882152, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10795072338224009, "num_env_steps_sampled_lifetime": 176000, "weights_seq_no": 87.0, "agent_episode_returns_mean": {"default_agent": 0.5748653846153847}, "module_episode_returns_mean": {"default_policy": 0.5748653846153847}, "num_env_steps_sampled": 2000, "sample": 29.90190550109098, "env_to_module_sum_episodes_length_in": 93.81056662882152, "time_between_sampling": 11.839348514709764, "num_env_steps_sampled_lifetime_throughput": 51.04046416080194}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.04640449211001396, "weights_seq_no": 88.0, "vf_loss_unclipped": 0.00592876598238945, "total_loss": -0.040475714951753616, "gradients_default_optimizer_global_norm": 0.1836148053407669, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.028210699558258057, "entropy": 0.13077418506145477, "curr_kl_coeff": 2.2204460823375376e-17, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00352428387850523, "num_module_steps_trained_lifetime": 5331200, "vf_loss": 0.00592876598238945}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04684592608606488, "add_observations_from_episodes_to_batch": 0.00036216809512719454, "add_one_ts_to_episodes_and_truncate": 0.007155554825212072, "add_columns_from_episodes_to_train_batch": 0.07934878401609688, "general_advantage_estimation": 0.10939816705933202, "add_states_from_episodes_to_batch": 1.1168791825958577e-05, "numpy_to_tensor": 0.0013362281219209086, "add_time_dim_to_batch_and_zero_pad": 3.1435674374604824e-05}}, "connector_pipeline_timer": 0.2450530648610566}, "num_module_steps_trained_lifetime": 5331200, "learner_connector_sum_episodes_length_out": 2016.2667021448883, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 84015800, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 176000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.04046416080194, "done": false, "training_iteration": 88, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-53-27", "timestamp": 1747695207, "time_this_iter_s": 39.11797022819519, "time_total_s": 3531.3610241413116, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3531.3610241413116, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 75.25714285714285, "ram_util_percent": 50.933928571428574}}
{"timers": {"training_iteration": 41.433363031099226, "restore_env_runners": 2.834763245880002e-05, "training_step": 41.43284926904659, "env_runner_sampling_timer": 31.4788469968247, "learner_update_timer": 9.941541020795674, "synch_weights": 0.01136357032402777, "synch_env_connectors": 0.009129975744993841}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.30033333333333345, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001625979909375766, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.880967471133086e-06, "un_batch_to_individual_items": 7.079932396541993e-05, "listify_data_for_vector_env": 0.00013824613596641019, "normalize_and_clip_actions": 0.00011845503237270185, "get_actions": 0.0007246294706236765, "tensor_to_numpy": 0.0002374180265966402}}}, "num_module_steps_sampled_lifetime": {"default_policy": 178000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 178000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3039841062052014e-05, "add_states_from_episodes_to_batch": 2.1344464747718338e-05, "numpy_to_tensor": 0.00016438095365084218, "add_time_dim_to_batch_and_zero_pad": 3.7787261074608956e-05, "batch_individual_items": 9.723242905009703e-05}}, "connector_pipeline_timer": 0.0006131962059647304}, "episode_return_max": 0.8205555555555574, "episode_duration_sec_mean": 21.984737174096644, "num_episodes_lifetime": 824, "rlmodule_inference_timer": 0.0005597519472278553, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.4816367521367529, "env_to_module_sum_episodes_length_out": 96.90022545175088, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10850074232763025, "num_env_steps_sampled_lifetime": 178000, "weights_seq_no": 88.0, "agent_episode_returns_mean": {"default_agent": 0.4816367521367529}, "module_episode_returns_mean": {"default_policy": 0.4816367521367529}, "num_env_steps_sampled": 2000, "sample": 29.895168578670443, "env_to_module_sum_episodes_length_in": 96.90022545175088, "time_between_sampling": 11.831971234231212, "num_env_steps_sampled_lifetime_throughput": 50.17197393571173}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05678130313754082, "weights_seq_no": 89.0, "vf_loss_unclipped": 0.005197789054363966, "total_loss": 0.06197910010814667, "gradients_default_optimizer_global_norm": 0.15049321949481964, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.006378650665283203, "entropy": 0.09092480689287186, "curr_kl_coeff": 3.3306692062243676e-17, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.022843414917588234, "num_module_steps_trained_lifetime": 5392000, "vf_loss": 0.005197789054363966}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04689741565026051, "add_observations_from_episodes_to_batch": 0.00036236624164331135, "add_one_ts_to_episodes_and_truncate": 0.007150506549393278, "add_columns_from_episodes_to_train_batch": 0.07936310003346381, "general_advantage_estimation": 0.10895205385971987, "add_states_from_episodes_to_batch": 1.1172150224580397e-05, "numpy_to_tensor": 0.0013362737297526323, "add_time_dim_to_batch_and_zero_pad": 3.1441577243872404e-05}}, "connector_pipeline_timer": 0.2446672037552514}, "num_module_steps_trained_lifetime": 5392000, "learner_connector_sum_episodes_length_out": 2016.2717099047823, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 84977200, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 178000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.17197393571173, "done": false, "training_iteration": 89, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-54-07", "timestamp": 1747695247, "time_this_iter_s": 39.803017377853394, "time_total_s": 3571.164041519165, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3571.164041519165, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 78.03571428571429, "ram_util_percent": 50.99821428571429}}
{"timers": {"training_iteration": 41.400468819058254, "restore_env_runners": 2.8379156131711418e-05, "training_step": 41.399954169626106, "env_runner_sampling_timer": 31.45041338544644, "learner_update_timer": 9.937111036267705, "synch_weights": 0.011331527620782829, "synch_env_connectors": 0.00912571698755004}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.30033333333333345, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016176448645760873, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.831907947078761e-06, "un_batch_to_individual_items": 7.031423916571419e-05, "listify_data_for_vector_env": 0.00013770457567806373, "normalize_and_clip_actions": 0.00011841358403448786, "get_actions": 0.0007206620236130267, "tensor_to_numpy": 0.00023569319359764536}}}, "num_module_steps_sampled_lifetime": {"default_policy": 180000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 180000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2890049366595465e-05, "add_states_from_episodes_to_batch": 2.124118392396932e-05, "numpy_to_tensor": 0.00016461832941085718, "add_time_dim_to_batch_and_zero_pad": 3.800084460993405e-05, "batch_individual_items": 9.676098745122042e-05}}, "connector_pipeline_timer": 0.0006124119067662801}, "episode_return_max": 0.8205555555555574, "episode_duration_sec_mean": 22.103000092808823, "num_episodes_lifetime": 832, "rlmodule_inference_timer": 0.0005577732818818004, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5222745726495737, "env_to_module_sum_episodes_length_out": 97.4420415897247, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10854696818280753, "num_env_steps_sampled_lifetime": 180000, "weights_seq_no": 89.0, "agent_episode_returns_mean": {"default_agent": 0.5222745726495737}, "module_episode_returns_mean": {"default_policy": 0.5222745726495737}, "num_env_steps_sampled": 2000, "sample": 29.887020857300055, "env_to_module_sum_episodes_length_in": 97.4420415897247, "time_between_sampling": 11.82408760177734, "num_env_steps_sampled_lifetime_throughput": 52.33361635954757}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.000274317484581843, "weights_seq_no": 90.0, "vf_loss_unclipped": 0.009081142954528332, "total_loss": 0.008806836791336536, "gradients_default_optimizer_global_norm": 0.40854641795158386, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.03512156009674072, "entropy": 0.10591566562652588, "curr_kl_coeff": 1.6653346031121838e-17, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0007656284724362195, "num_module_steps_trained_lifetime": 5452544, "vf_loss": 0.009081142954528332}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.046947256310663585, "add_observations_from_episodes_to_batch": 0.00036255458841954596, "add_one_ts_to_episodes_and_truncate": 0.007145354943608688, "add_columns_from_episodes_to_train_batch": 0.07937671690208203, "general_advantage_estimation": 0.10850531190739417, "add_states_from_episodes_to_batch": 1.1175274576004996e-05, "numpy_to_tensor": 0.001336286402615, "add_time_dim_to_batch_and_zero_pad": 3.1447028487886026e-05}}, "connector_pipeline_timer": 0.244278209165176}, "num_module_steps_trained_lifetime": 5452544, "learner_connector_sum_episodes_length_out": 2016.276590839264, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 85930768, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 180000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.33361635954757, "done": false, "training_iteration": 90, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-54-45", "timestamp": 1747695285, "time_this_iter_s": 38.159762144088745, "time_total_s": 3609.323803663254, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3609.323803663254, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 75.55555555555556, "ram_util_percent": 50.97777777777778}}
{"timers": {"training_iteration": 41.36165593739766, "restore_env_runners": 2.8315364572112593e-05, "training_step": 41.36114182945983, "env_runner_sampling_timer": 31.421338770561952, "learner_update_timer": 9.927437639465046, "synch_weights": 0.011267861344568223, "synch_env_connectors": 0.009122850817701145}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.36188888888888954, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016112869596858722, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.728741977453712e-06, "un_batch_to_individual_items": 6.98210847278671e-05, "listify_data_for_vector_env": 0.00013676424191291266, "normalize_and_clip_actions": 0.00011729425901113545, "get_actions": 0.0007193171325645277, "tensor_to_numpy": 0.00023500695082522352}}}, "num_module_steps_sampled_lifetime": {"default_policy": 182000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 182000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2540746201472516e-05, "add_states_from_episodes_to_batch": 2.081534131206066e-05, "numpy_to_tensor": 0.0001646824550036565, "add_time_dim_to_batch_and_zero_pad": 3.7663845501640145e-05, "batch_individual_items": 9.617522913625487e-05}}, "connector_pipeline_timer": 0.0006088639997776931}, "episode_return_max": 0.792666666666668, "episode_duration_sec_mean": 21.77075702633703, "num_episodes_lifetime": 840, "rlmodule_inference_timer": 0.0005556151150671655, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5246891025641036, "env_to_module_sum_episodes_length_out": 95.78194018147093, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10818353033252658, "num_env_steps_sampled_lifetime": 182000, "weights_seq_no": 90.0, "agent_episode_returns_mean": {"default_agent": 0.5246891025641036}, "module_episode_returns_mean": {"default_policy": 0.5246891025641036}, "num_env_steps_sampled": 2000, "sample": 29.877417174965377, "env_to_module_sum_episodes_length_in": 95.78194018147093, "time_between_sampling": 11.816256928195608, "num_env_steps_sampled_lifetime_throughput": 53.04459596139079}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.12203056365251541, "weights_seq_no": 91.0, "vf_loss_unclipped": 0.0056772115640342236, "total_loss": 0.12770776450634003, "gradients_default_optimizer_global_norm": 0.6547258496284485, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09180158376693726, "entropy": 0.16603748500347137, "curr_kl_coeff": 8.326673015560919e-18, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0026373635046184063, "num_module_steps_trained_lifetime": 5513088, "vf_loss": 0.0056772115640342236}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04699564546639324, "add_observations_from_episodes_to_batch": 0.0003627346916363661, "add_one_ts_to_episodes_and_truncate": 0.007140334459284973, "add_columns_from_episodes_to_train_batch": 0.07938965550332422, "general_advantage_estimation": 0.10805879169872856, "add_states_from_episodes_to_batch": 1.1178239225141875e-05, "numpy_to_tensor": 0.001336284964646728, "add_time_dim_to_batch_and_zero_pad": 3.145224654973529e-05}}, "connector_pipeline_timer": 0.24388741055662683}, "num_module_steps_trained_lifetime": 5513088, "learner_connector_sum_episodes_length_out": 2016.2813469840653, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 86884336, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 182000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.04459596139079, "done": false, "training_iteration": 91, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-55-23", "timestamp": 1747695323, "time_this_iter_s": 37.53409814834595, "time_total_s": 3646.8579018115997, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3646.8579018115997, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 75.32777777777777, "ram_util_percent": 50.93333333333334}}
{"timers": {"training_iteration": 41.33028179374371, "restore_env_runners": 2.8233210928953535e-05, "training_step": 41.32976866988526, "env_runner_sampling_timer": 31.39667283831631, "learner_update_timer": 9.920725306330436, "synch_weights": 0.011273108731143356, "synch_env_connectors": 0.009102807309575762}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.28844444444444456, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016040720326480564, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.621488222170141e-06, "un_batch_to_individual_items": 6.996185270044083e-05, "listify_data_for_vector_env": 0.00013636984827015812, "normalize_and_clip_actions": 0.00011710900232564332, "get_actions": 0.0007156034660215753, "tensor_to_numpy": 0.0002329700360503575}}}, "num_module_steps_sampled_lifetime": {"default_policy": 184000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 184000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.191412882546838e-05, "add_states_from_episodes_to_batch": 2.0854537364997772e-05, "numpy_to_tensor": 0.00016323537169660507, "add_time_dim_to_batch_and_zero_pad": 3.762208864911084e-05, "batch_individual_items": 9.635338580953497e-05}}, "connector_pipeline_timer": 0.0006065253958582647}, "episode_return_max": 0.792666666666668, "episode_duration_sec_mean": 21.541070506663136, "num_episodes_lifetime": 848, "rlmodule_inference_timer": 0.0005544419732817552, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4816111111111114, "env_to_module_sum_episodes_length_out": 93.80632166240274, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10777019723619663, "num_env_steps_sampled_lifetime": 184000, "weights_seq_no": 91.0, "agent_episode_returns_mean": {"default_agent": 0.4816111111111114}, "module_episode_returns_mean": {"default_policy": 0.4816111111111114}, "num_env_steps_sampled": 2000, "sample": 29.86693604777605, "env_to_module_sum_episodes_length_in": 93.80632166240274, "time_between_sampling": 11.808085191496975, "num_env_steps_sampled_lifetime_throughput": 52.2286948031387}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07528313249349594, "weights_seq_no": 92.0, "vf_loss_unclipped": 0.004764563404023647, "total_loss": -0.07051858305931091, "gradients_default_optimizer_global_norm": 0.39177948236465454, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1091192364692688, "entropy": 0.08372438699007034, "curr_kl_coeff": 4.1633365077804595e-18, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0006074014236219227, "num_module_steps_trained_lifetime": 5573632, "vf_loss": 0.004764563404023647}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04704271281317689, "add_observations_from_episodes_to_batch": 0.0003629101573297075, "add_one_ts_to_episodes_and_truncate": 0.007135312739153418, "add_columns_from_episodes_to_train_batch": 0.07940272500045113, "general_advantage_estimation": 0.10761147443304571, "add_states_from_episodes_to_batch": 1.118107705383008e-05, "numpy_to_tensor": 0.0013362594767979028, "add_time_dim_to_batch_and_zero_pad": 3.145714554798137e-05}}, "connector_pipeline_timer": 0.24349459612873228}, "num_module_steps_trained_lifetime": 5573632, "learner_connector_sum_episodes_length_out": 2016.2859803468868, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 87837904, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 184000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.2286948031387, "done": false, "training_iteration": 92, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-56-01", "timestamp": 1747695361, "time_this_iter_s": 38.23901033401489, "time_total_s": 3685.0969121456146, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3685.0969121456146, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 76.38518518518521, "ram_util_percent": 51.00925925925926}}
{"timers": {"training_iteration": 41.29909831561629, "restore_env_runners": 2.8169878886527372e-05, "training_step": 41.29857579099636, "env_runner_sampling_timer": 31.37362520844313, "learner_update_timer": 9.912645424567156, "synch_weights": 0.011208279643837629, "synch_env_connectors": 0.009092075236494645}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.28844444444444456, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016050605517358798, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.5591260072850945e-06, "un_batch_to_individual_items": 6.957017225660052e-05, "listify_data_for_vector_env": 0.00013601527566992774, "normalize_and_clip_actions": 0.00011661962731656098, "get_actions": 0.0007152689206851659, "tensor_to_numpy": 0.00023479221993875145}}}, "num_module_steps_sampled_lifetime": {"default_policy": 186000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 186000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.136338474551167e-05, "add_states_from_episodes_to_batch": 2.0742920575551846e-05, "numpy_to_tensor": 0.00016325708897368398, "add_time_dim_to_batch_and_zero_pad": 3.7342018025085625e-05, "batch_individual_items": 9.610575105409514e-05}}, "connector_pipeline_timer": 0.0006061607203557282}, "episode_return_max": 0.8171111111111112, "episode_duration_sec_mean": 21.81599316352759, "num_episodes_lifetime": 856, "rlmodule_inference_timer": 0.0005537809679529076, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4933824786324787, "env_to_module_sum_episodes_length_out": 92.78049866229672, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10718057134857474, "num_env_steps_sampled_lifetime": 186000, "weights_seq_no": 92.0, "agent_episode_returns_mean": {"default_agent": 0.4933824786324787}, "module_episode_returns_mean": {"default_policy": 0.4933824786324787}, "num_env_steps_sampled": 2000, "sample": 29.855728895156858, "env_to_module_sum_episodes_length_in": 92.78049866229672, "time_between_sampling": 11.799711461319328, "num_env_steps_sampled_lifetime_throughput": 52.238156098836185}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.011350647546350956, "weights_seq_no": 93.0, "vf_loss_unclipped": 0.003790175775066018, "total_loss": -0.007560483645647764, "gradients_default_optimizer_global_norm": 0.06784410774707794, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.001587510108947754, "entropy": 0.09518594294786453, "curr_kl_coeff": 2.0816682538902298e-18, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002874055877327919, "num_module_steps_trained_lifetime": 5634176, "vf_loss": 0.003790175775066018}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04708838263847841, "add_observations_from_episodes_to_batch": 0.0003630776302405214, "add_one_ts_to_episodes_and_truncate": 0.007130185709978854, "add_columns_from_episodes_to_train_batch": 0.0794152679421852, "general_advantage_estimation": 0.10716388159350707, "add_states_from_episodes_to_batch": 1.1183770301861381e-05, "numpy_to_tensor": 0.0013362015002096777, "add_time_dim_to_batch_and_zero_pad": 3.146185134154869e-05}}, "connector_pipeline_timer": 0.24309942747844046}, "num_module_steps_trained_lifetime": 5634176, "learner_connector_sum_episodes_length_out": 2016.2904929077536, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 88791472, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 186000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.238156098836185, "done": false, "training_iteration": 93, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-56-40", "timestamp": 1747695400, "time_this_iter_s": 38.22750639915466, "time_total_s": 3723.3244185447693, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3723.3244185447693, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 75.72909090909091, "ram_util_percent": 51.00909090909091}}
{"timers": {"training_iteration": 41.26913252247014, "restore_env_runners": 2.825618006217219e-05, "training_step": 41.268608648096325, "env_runner_sampling_timer": 31.34947451289874, "learner_update_timer": 9.906865153791468, "synch_weights": 0.011171596847386236, "synch_env_connectors": 0.00907576849406604}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.30900000000000005, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015973519360842178, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.477530618185397e-06, "un_batch_to_individual_items": 6.968939327260715e-05, "listify_data_for_vector_env": 0.0001351742950570404, "normalize_and_clip_actions": 0.00011666767030243835, "get_actions": 0.0007109482779811931, "tensor_to_numpy": 0.0002331676101176676}}}, "num_module_steps_sampled_lifetime": {"default_policy": 188000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 188000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.083989590991621e-05, "add_states_from_episodes_to_batch": 2.0810552503294718e-05, "numpy_to_tensor": 0.00016320216759216268, "add_time_dim_to_batch_and_zero_pad": 3.744890699716717e-05, "batch_individual_items": 9.537268379214713e-05}}, "connector_pipeline_timer": 0.0006032828794796997}, "episode_return_max": 0.8171111111111112, "episode_duration_sec_mean": 21.765517342009005, "num_episodes_lifetime": 864, "rlmodule_inference_timer": 0.0005500869284148434, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5149155982905986, "env_to_module_sum_episodes_length_out": 93.43796344050888, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10633511135668648, "num_env_steps_sampled_lifetime": 188000, "weights_seq_no": 93.0, "agent_episode_returns_mean": {"default_agent": 0.5149155982905986}, "module_episode_returns_mean": {"default_policy": 0.5149155982905986}, "num_env_steps_sampled": 2000, "sample": 29.843467412113988, "env_to_module_sum_episodes_length_in": 93.43796344050888, "time_between_sampling": 11.791080092233942, "num_env_steps_sampled_lifetime_throughput": 52.119533598740794}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.09805366396903992, "weights_seq_no": 94.0, "vf_loss_unclipped": 0.006375877186655998, "total_loss": 0.10442955046892166, "gradients_default_optimizer_global_norm": 0.5513905882835388, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.029071033000946045, "entropy": 0.08410809934139252, "curr_kl_coeff": 1.0408341269451149e-18, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002113914117217064, "num_module_steps_trained_lifetime": 5694720, "vf_loss": 0.006375877186655998}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04713263004599292, "add_observations_from_episodes_to_batch": 0.000363239702677627, "add_one_ts_to_episodes_and_truncate": 0.007124965300113818, "add_columns_from_episodes_to_train_batch": 0.07942718798268396, "general_advantage_estimation": 0.1067158265833159, "add_states_from_episodes_to_batch": 1.1186341577218339e-05, "numpy_to_tensor": 0.0013361085572058027, "add_time_dim_to_batch_and_zero_pad": 3.146613730506247e-05}}, "connector_pipeline_timer": 0.24270160824164183}, "num_module_steps_trained_lifetime": 5694720, "learner_connector_sum_episodes_length_out": 2016.2948866193683, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 89745040, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 188000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.119533598740794, "done": false, "training_iteration": 94, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-57-18", "timestamp": 1747695438, "time_this_iter_s": 38.35065031051636, "time_total_s": 3761.6750688552856, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3761.6750688552856, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 75.24444444444445, "ram_util_percent": 51.00925925925926}}
{"timers": {"training_iteration": 41.229850122165445, "restore_env_runners": 2.8773618314100343e-05, "training_step": 41.22932450853534, "env_runner_sampling_timer": 31.3279009436597, "learner_update_timer": 9.889214256283525, "synch_weights": 0.011111300878930344, "synch_env_connectors": 0.009352777809114195}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2894444444444445, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015904699482455907, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.387164052790097e-06, "un_batch_to_individual_items": 7.025490049043506e-05, "listify_data_for_vector_env": 0.00013393428717097384, "normalize_and_clip_actions": 0.00011665058444395904, "get_actions": 0.0007069035000530716, "tensor_to_numpy": 0.00023252541915970624}}}, "num_module_steps_sampled_lifetime": {"default_policy": 190000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 190000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.108242462639254e-05, "add_states_from_episodes_to_batch": 2.0622645385319873e-05, "numpy_to_tensor": 0.00016209714721341828, "add_time_dim_to_batch_and_zero_pad": 3.715654613887292e-05, "batch_individual_items": 9.503401654384306e-05}}, "connector_pipeline_timer": 0.0006009048930000143}, "episode_return_max": 0.7692222222222226, "episode_duration_sec_mean": 21.701797652126444, "num_episodes_lifetime": 872, "rlmodule_inference_timer": 0.0005501330216873464, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5249700854700857, "env_to_module_sum_episodes_length_out": 96.1615574597736, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.105467083082788, "num_env_steps_sampled_lifetime": 190000, "weights_seq_no": 94.0, "agent_episode_returns_mean": {"default_agent": 0.5249700854700857}, "module_episode_returns_mean": {"default_policy": 0.5249700854700857}, "num_env_steps_sampled": 2000, "sample": 29.830571417874538, "env_to_module_sum_episodes_length_in": 96.1615574597736, "time_between_sampling": 11.782748238475069, "num_env_steps_sampled_lifetime_throughput": 53.35175563337794}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.008044697344303131, "weights_seq_no": 95.0, "vf_loss_unclipped": 0.004969186149537563, "total_loss": 0.01301388069987297, "gradients_default_optimizer_global_norm": 0.3865206241607666, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1094316840171814, "entropy": 0.08219487965106964, "curr_kl_coeff": 5.204170634725574e-19, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0030929497443139553, "num_module_steps_trained_lifetime": 5755264, "vf_loss": 0.004969186149537563}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04717541695699364, "add_observations_from_episodes_to_batch": 0.0003633925159029616, "add_one_ts_to_episodes_and_truncate": 0.007119649409875121, "add_columns_from_episodes_to_train_batch": 0.07943874575557854, "general_advantage_estimation": 0.10626705315516856, "add_states_from_episodes_to_batch": 1.1188743049648912e-05, "numpy_to_tensor": 0.0013360371529122224, "add_time_dim_to_batch_and_zero_pad": 3.146977136417212e-05}}, "connector_pipeline_timer": 0.24230116901673143}, "num_module_steps_trained_lifetime": 5755264, "learner_connector_sum_episodes_length_out": 2016.29916340746, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 90698608, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 190000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.35175563337794, "done": false, "training_iteration": 95, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-57-55", "timestamp": 1747695475, "time_this_iter_s": 37.357101917266846, "time_total_s": 3799.0321707725525, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3799.0321707725525, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 77.55660377358491, "ram_util_percent": 51.013207547169806}}
{"timers": {"training_iteration": 41.2442400414138, "restore_env_runners": 2.8717882078532398e-05, "training_step": 41.243715045919984, "env_runner_sampling_timer": 31.345842848263125, "learner_update_timer": 9.885715362150663, "synch_weights": 0.011057141870097063, "synch_env_connectors": 0.009347680030982826}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.26288888888888934, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015922653415224124, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.543869194934706e-06, "un_batch_to_individual_items": 6.985495754102112e-05, "listify_data_for_vector_env": 0.00013339585140417206, "normalize_and_clip_actions": 0.00011640130512858403, "get_actions": 0.0007101293740290768, "tensor_to_numpy": 0.00023227541737023535}}}, "num_module_steps_sampled_lifetime": {"default_policy": 192000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 192000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1504827583753244e-05, "add_states_from_episodes_to_batch": 2.0380505535349295e-05, "numpy_to_tensor": 0.00016334434841833582, "add_time_dim_to_batch_and_zero_pad": 3.691449943773074e-05, "batch_individual_items": 9.549921850645779e-05}}, "connector_pipeline_timer": 0.0006057530822809901}, "episode_return_max": 0.8113333333333353, "episode_duration_sec_mean": 23.29033285548128, "num_episodes_lifetime": 888, "rlmodule_inference_timer": 0.0005512424600842513, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.513861111111112, "env_to_module_sum_episodes_length_out": 97.45026093717678, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10657332263282292, "num_env_steps_sampled_lifetime": 192000, "weights_seq_no": 95.0, "agent_episode_returns_mean": {"default_agent": 0.513861111111112}, "module_episode_returns_mean": {"default_policy": 0.513861111111112}, "num_env_steps_sampled": 2000, "sample": 29.820264544685898, "env_to_module_sum_episodes_length_in": 97.45026093717678, "time_between_sampling": 11.77358083301812, "num_env_steps_sampled_lifetime_throughput": 46.787647994499}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.032881565392017365, "weights_seq_no": 96.0, "vf_loss_unclipped": 0.007862589322030544, "total_loss": 0.040744148194789886, "gradients_default_optimizer_global_norm": 0.2077442705631256, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0397222638130188, "entropy": 0.1126515120267868, "curr_kl_coeff": 2.602085317362787e-19, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0024035980459302664, "num_module_steps_trained_lifetime": 5816064, "vf_loss": 0.007862589322030544}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04723131484686959, "add_observations_from_episodes_to_batch": 0.00036359012889349793, "add_one_ts_to_episodes_and_truncate": 0.0071159381309108495, "add_columns_from_episodes_to_train_batch": 0.07945157947421694, "general_advantage_estimation": 0.10581795238292552, "add_states_from_episodes_to_batch": 1.119116785880325e-05, "numpy_to_tensor": 0.0013359656658491305, "add_time_dim_to_batch_and_zero_pad": 3.147342612902937e-05}}, "connector_pipeline_timer": 0.24191644727559528}, "num_module_steps_trained_lifetime": 5816064, "learner_connector_sum_episodes_length_out": 2016.3041251711277, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 91660008, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 192000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.787647994499, "done": false, "training_iteration": 96, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-58-38", "timestamp": 1747695518, "time_this_iter_s": 42.68447494506836, "time_total_s": 3841.716645717621, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3841.716645717621, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 77.40983606557377, "ram_util_percent": 51.01967213114754}}
{"timers": {"training_iteration": 41.20576292411972, "restore_env_runners": 2.878870321887181e-05, "training_step": 41.205237158580765, "env_runner_sampling_timer": 31.316118636790552, "learner_update_timer": 9.87699561863912, "synch_weights": 0.011023917451365543, "synch_env_connectors": 0.009339587230649326}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.30500000000000077, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001589753364734698, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.556474177063612e-06, "un_batch_to_individual_items": 6.94487111562786e-05, "listify_data_for_vector_env": 0.00013252537157161127, "normalize_and_clip_actions": 0.00011671956272390468, "get_actions": 0.0007108173119636806, "tensor_to_numpy": 0.00023139101458626176}}}, "num_module_steps_sampled_lifetime": {"default_policy": 194000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 194000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.192867523592174e-05, "add_states_from_episodes_to_batch": 2.044371146113344e-05, "numpy_to_tensor": 0.00016246009256536836, "add_time_dim_to_batch_and_zero_pad": 3.6977566566321794e-05, "batch_individual_items": 9.534267799592376e-05}}, "connector_pipeline_timer": 0.0006045868630858782}, "episode_return_max": 0.8113333333333353, "episode_duration_sec_mean": 22.733914779681843, "num_episodes_lifetime": 896, "rlmodule_inference_timer": 0.0005499590653708822, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5302991452991462, "env_to_module_sum_episodes_length_out": 96.30824095803321, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10657849446263322, "num_env_steps_sampled_lifetime": 194000, "weights_seq_no": 96.0, "agent_episode_returns_mean": {"default_agent": 0.5302991452991462}, "module_episode_returns_mean": {"default_policy": 0.5302991452991462}, "num_env_steps_sampled": 2000, "sample": 29.80881640107083, "env_to_module_sum_episodes_length_in": 96.30824095803321, "time_between_sampling": 11.764610458541197, "num_env_steps_sampled_lifetime_throughput": 53.37715040408328}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.06435079872608185, "weights_seq_no": 97.0, "vf_loss_unclipped": 0.006042900029569864, "total_loss": -0.05830788612365723, "gradients_default_optimizer_global_norm": 0.38731878995895386, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.022145986557006836, "entropy": 0.05588269233703613, "curr_kl_coeff": 1.3010426586813936e-19, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0020415978506207466, "num_module_steps_trained_lifetime": 5876608, "vf_loss": 0.006042900029569864}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.047285929307052735, "add_observations_from_episodes_to_batch": 0.0003637777603720531, "add_one_ts_to_episodes_and_truncate": 0.007112093022484874, "add_columns_from_episodes_to_train_batch": 0.07946368905360705, "general_advantage_estimation": 0.10536861841071188, "add_states_from_episodes_to_batch": 1.1194255297579738e-05, "numpy_to_tensor": 0.0013360674748118847, "add_time_dim_to_batch_and_zero_pad": 3.1478030821918876e-05}}, "connector_pipeline_timer": 0.24152951410168041}, "num_module_steps_trained_lifetime": 5876608, "learner_connector_sum_episodes_length_out": 2016.3089577831813, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 92613576, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 194000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.37715040408328, "done": false, "training_iteration": 97, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-59-16", "timestamp": 1747695556, "time_this_iter_s": 37.411818504333496, "time_total_s": 3879.1284642219543, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3879.1284642219543, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 76.62830188679246, "ram_util_percent": 51.083018867924515}}
{"timers": {"training_iteration": 41.17318380988857, "restore_env_runners": 2.870181618924516e-05, "training_step": 41.17265863600498, "env_runner_sampling_timer": 31.292772986562657, "learner_update_timer": 9.867803056322714, "synch_weights": 0.010982376276883761, "synch_env_connectors": 0.009314950358402631}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32944444444444476, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015880343023432948, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.426611254942369e-06, "un_batch_to_individual_items": 6.994040030932364e-05, "listify_data_for_vector_env": 0.00013263613889343264, "normalize_and_clip_actions": 0.00011680562474735605, "get_actions": 0.0007097890501399206, "tensor_to_numpy": 0.00022992019444877102}}}, "num_module_steps_sampled_lifetime": {"default_policy": 196000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 196000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1558225303658337e-05, "add_states_from_episodes_to_batch": 2.115405494129566e-05, "numpy_to_tensor": 0.00016100620573425192, "add_time_dim_to_batch_and_zero_pad": 3.675423563858655e-05, "batch_individual_items": 9.471060164877734e-05}}, "connector_pipeline_timer": 0.0006016638632583628}, "episode_return_max": 0.7000000000000008, "episode_duration_sec_mean": 21.777477318275835, "num_episodes_lifetime": 904, "rlmodule_inference_timer": 0.0005470164777509088, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5053525641025645, "env_to_module_sum_episodes_length_out": 94.27729796375624, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10624667195215234, "num_env_steps_sampled_lifetime": 196000, "weights_seq_no": 97.0, "agent_episode_returns_mean": {"default_agent": 0.5053525641025645}, "module_episode_returns_mean": {"default_policy": 0.5053525641025645}, "num_env_steps_sampled": 2000, "sample": 29.796527730158438, "env_to_module_sum_episodes_length_in": 94.27729796375624, "time_between_sampling": 11.755269681192278, "num_env_steps_sampled_lifetime_throughput": 52.60098704108278}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.014729958027601242, "weights_seq_no": 98.0, "vf_loss_unclipped": 0.0047683510929346085, "total_loss": 0.019498325884342194, "gradients_default_optimizer_global_norm": 0.578201949596405, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.060505211353302, "entropy": 0.09486384689807892, "curr_kl_coeff": 6.505213293406968e-20, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0029159097466617823, "num_module_steps_trained_lifetime": 5937152, "vf_loss": 0.0047683510929346085}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04733907881654745, "add_observations_from_episodes_to_batch": 0.0003639561902084984, "add_one_ts_to_episodes_and_truncate": 0.007108133672414077, "add_columns_from_episodes_to_train_batch": 0.07947521480346192, "general_advantage_estimation": 0.10491880387270427, "add_states_from_episodes_to_batch": 1.1197111870752628e-05, "numpy_to_tensor": 0.0013361404110289977, "add_time_dim_to_batch_and_zero_pad": 3.148228607851571e-05}}, "connector_pipeline_timer": 0.24113989416651657}, "num_module_steps_trained_lifetime": 5937152, "learner_connector_sum_episodes_length_out": 2016.3136633304769, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 93567144, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 196000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.60098704108278, "done": false, "training_iteration": 98, "trial_id": "c3e2f_00000", "date": "2025-05-20_08-59-54", "timestamp": 1747695594, "time_this_iter_s": 37.962846755981445, "time_total_s": 3917.091310977936, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3917.091310977936, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 76.1962962962963, "ram_util_percent": 51.0611111111111}}
{"timers": {"training_iteration": 41.13645569038974, "restore_env_runners": 2.8622798083216228e-05, "training_step": 41.13593100024491, "env_runner_sampling_timer": 31.263175906737036, "learner_update_timer": 9.860709301319503, "synch_weights": 0.010948472514132427, "synch_env_connectors": 0.009299043854796503}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32944444444444476, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015865478761737674, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.36870399221085e-06, "un_batch_to_individual_items": 7.022934909927764e-05, "listify_data_for_vector_env": 0.00013213775838900966, "normalize_and_clip_actions": 0.00011581134273341864, "get_actions": 0.0007088670929568583, "tensor_to_numpy": 0.00022876381355268498}}}, "num_module_steps_sampled_lifetime": {"default_policy": 198000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 198000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1381050039894885e-05, "add_states_from_episodes_to_batch": 2.0949391085366052e-05, "numpy_to_tensor": 0.00016079438647236457, "add_time_dim_to_batch_and_zero_pad": 3.653368359642864e-05, "batch_individual_items": 9.450579972085119e-05}}, "connector_pipeline_timer": 0.0005990510964477087}, "episode_return_max": 0.8496666666666668, "episode_duration_sec_mean": 21.518710547489857, "num_episodes_lifetime": 912, "rlmodule_inference_timer": 0.0005450705466765759, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5834412393162396, "env_to_module_sum_episodes_length_out": 92.82230476390549, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10571780452503776, "num_env_steps_sampled_lifetime": 198000, "weights_seq_no": 98.0, "agent_episode_returns_mean": {"default_agent": 0.5834412393162396}, "module_episode_returns_mean": {"default_policy": 0.5834412393162396}, "num_env_steps_sampled": 2000, "sample": 29.78317881413548, "env_to_module_sum_episodes_length_in": 92.82230476390549, "time_between_sampling": 11.745827861618352, "num_env_steps_sampled_lifetime_throughput": 53.23343254952567}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.13320627808570862, "weights_seq_no": 99.0, "vf_loss_unclipped": 0.004608497954905033, "total_loss": 0.13781477510929108, "gradients_default_optimizer_global_norm": 0.5077604055404663, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.038466036319732666, "entropy": 0.10396251082420349, "curr_kl_coeff": 3.252606646703484e-20, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0024850459303706884, "num_module_steps_trained_lifetime": 5997696, "vf_loss": 0.004608497954905033}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04739042709302134, "add_observations_from_episodes_to_batch": 0.0003641251436728157, "add_one_ts_to_episodes_and_truncate": 0.007104066660042864, "add_columns_from_episodes_to_train_batch": 0.07948614209941389, "general_advantage_estimation": 0.10446893068361554, "add_states_from_episodes_to_batch": 1.1199771886390953e-05, "numpy_to_tensor": 0.0013361846517736993, "add_time_dim_to_batch_and_zero_pad": 3.148617842692413e-05}}, "connector_pipeline_timer": 0.24074765914874635}, "num_module_steps_trained_lifetime": 5997696, "learner_connector_sum_episodes_length_out": 2016.3182438710483, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 94520712, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 198000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.23343254952567, "done": false, "training_iteration": 99, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-00-31", "timestamp": 1747695631, "time_this_iter_s": 37.51550531387329, "time_total_s": 3954.606816291809, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3954.606816291809, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 76.34150943396226, "ram_util_percent": 51.04528301886792}}
{"timers": {"training_iteration": 41.094767325585856, "restore_env_runners": 2.883557004575872e-05, "training_step": 41.09424229434249, "env_runner_sampling_timer": 31.230086523129668, "learner_update_timer": 9.852112184936335, "synch_weights": 0.010947991799000915, "synch_env_connectors": 0.009278395416233466}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3104444444444445, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015841331791834094, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.266518575555383e-06, "un_batch_to_individual_items": 7.036137456273512e-05, "listify_data_for_vector_env": 0.00013259828676611134, "normalize_and_clip_actions": 0.00011550894403773013, "get_actions": 0.0007076921206174529, "tensor_to_numpy": 0.00022874807575387713}}}, "num_module_steps_sampled_lifetime": {"default_policy": 200000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 200000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.13615393933153e-05, "add_states_from_episodes_to_batch": 2.0689823018789724e-05, "numpy_to_tensor": 0.00016019491116770108, "add_time_dim_to_batch_and_zero_pad": 3.634655692756165e-05, "batch_individual_items": 9.358573940136355e-05}}, "connector_pipeline_timer": 0.000595741410212477}, "episode_return_max": 0.8496666666666668, "episode_duration_sec_mean": 21.30021435361421, "num_episodes_lifetime": 920, "rlmodule_inference_timer": 0.0005437003324672838, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5411976495726498, "env_to_module_sum_episodes_length_out": 92.8392546425742, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.105174743712975, "num_env_steps_sampled_lifetime": 200000, "weights_seq_no": 99.0, "agent_episode_returns_mean": {"default_agent": 0.5411976495726498}, "module_episode_returns_mean": {"default_policy": 0.5411976495726498}, "num_env_steps_sampled": 2000, "sample": 29.768949887862682, "env_to_module_sum_episodes_length_in": 92.8392546425742, "time_between_sampling": 11.73626187157528, "num_env_steps_sampled_lifetime_throughput": 53.991377782293895}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.13811655342578888, "weights_seq_no": 100.0, "vf_loss_unclipped": 0.00525824585929513, "total_loss": -0.1328583061695099, "gradients_default_optimizer_global_norm": 0.2403188794851303, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.043279290199279785, "entropy": 0.07285434752702713, "curr_kl_coeff": 1.626303323351742e-20, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0008851594757288694, "num_module_steps_trained_lifetime": 6058240, "vf_loss": 0.00525824585929513}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04744025806608421, "add_observations_from_episodes_to_batch": 0.00036428993244858466, "add_one_ts_to_episodes_and_truncate": 0.007099968014551516, "add_columns_from_episodes_to_train_batch": 0.07949677261796671, "general_advantage_estimation": 0.10401863100792144, "add_states_from_episodes_to_batch": 1.1202478991087967e-05, "numpy_to_tensor": 0.0013362323736624037, "add_time_dim_to_batch_and_zero_pad": 3.149696469969006e-05}}, "connector_pipeline_timer": 0.24035317000191458}, "num_module_steps_trained_lifetime": 6058240, "learner_connector_sum_episodes_length_out": 2016.3227014344752, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 95474280, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 200000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.991377782293895, "done": false, "training_iteration": 100, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-01-08", "timestamp": 1747695668, "time_this_iter_s": 36.98482131958008, "time_total_s": 3991.591637611389, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3991.591637611389, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 76.57735849056604, "ram_util_percent": 51.15471698113206}}
{"timers": {"training_iteration": 41.049322943000014, "restore_env_runners": 2.8808214368175344e-05, "training_step": 41.048797138069055, "env_runner_sampling_timer": 31.200793644568353, "learner_update_timer": 9.836017197076982, "synch_weights": 0.01089188788100711, "synch_env_connectors": 0.009277629462066863}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2864444444444446, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015772518149559979, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.15057935615337e-06, "un_batch_to_individual_items": 6.994910656952475e-05, "listify_data_for_vector_env": 0.00013173644052820235, "normalize_and_clip_actions": 0.00011573145362621945, "get_actions": 0.0007037547391300703, "tensor_to_numpy": 0.00022672220218271477}}}, "num_module_steps_sampled_lifetime": {"default_policy": 202000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 202000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0847943357505946e-05, "add_states_from_episodes_to_batch": 2.048015701727682e-05, "numpy_to_tensor": 0.0001627431668003387, "add_time_dim_to_batch_and_zero_pad": 3.6128865926115186e-05, "batch_individual_items": 9.241467795741171e-05}}, "connector_pipeline_timer": 0.000595690979810504}, "episode_return_max": 0.7651111111111113, "episode_duration_sec_mean": 21.383692902913026, "num_episodes_lifetime": 928, "rlmodule_inference_timer": 0.0005394371648121997, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4859284188034189, "env_to_module_sum_episodes_length_out": 94.81715319836174, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10429310399968929, "num_env_steps_sampled_lifetime": 202000, "weights_seq_no": 100.0, "agent_episode_returns_mean": {"default_agent": 0.4859284188034189}, "module_episode_returns_mean": {"default_policy": 0.4859284188034189}, "num_env_steps_sampled": 2000, "sample": 29.75350145731119, "env_to_module_sum_episodes_length_in": 94.81715319836174, "time_between_sampling": 11.72620677037393, "num_env_steps_sampled_lifetime_throughput": 54.39995385377697}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.010011552833020687, "weights_seq_no": 101.0, "vf_loss_unclipped": 0.005462974309921265, "total_loss": 0.01547451876103878, "gradients_default_optimizer_global_norm": 0.7589318156242371, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.018938839435577393, "entropy": 0.08037786185741425, "curr_kl_coeff": 8.13151661675871e-21, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0014710547402501106, "num_module_steps_trained_lifetime": 6118784, "vf_loss": 0.005462974309921265}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.047490551686975815, "add_observations_from_episodes_to_batch": 0.000364481572934885, "add_one_ts_to_episodes_and_truncate": 0.007096124405303817, "add_columns_from_episodes_to_train_batch": 0.07951103272193791, "general_advantage_estimation": 0.1035680367726727, "add_states_from_episodes_to_batch": 1.1205231977060935e-05, "numpy_to_tensor": 0.0013362400926479393, "add_time_dim_to_batch_and_zero_pad": 3.150808662895536e-05}}, "connector_pipeline_timer": 0.23996272232210492}, "num_module_steps_trained_lifetime": 6118784, "learner_connector_sum_episodes_length_out": 2016.3270380222464, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 96427848, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 202000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.39995385377697, "done": false, "training_iteration": 101, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-01-45", "timestamp": 1747695705, "time_this_iter_s": 36.56530785560608, "time_total_s": 4028.1569454669952, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4028.1569454669952, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 76.67307692307692, "ram_util_percent": 51.27115384615385}}
{"timers": {"training_iteration": 41.03035133613004, "restore_env_runners": 2.873613226851348e-05, "training_step": 41.02982578424834, "env_runner_sampling_timer": 31.19258194164264, "learner_update_timer": 9.825319429146234, "synch_weights": 0.010829370002196645, "synch_env_connectors": 0.00926445117742543}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.24833333333333346, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00157474278793018, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.150222328033516e-06, "un_batch_to_individual_items": 6.949240392797746e-05, "listify_data_for_vector_env": 0.00013237726956604503, "normalize_and_clip_actions": 0.00011533014316271101, "get_actions": 0.0007030972950695277, "tensor_to_numpy": 0.00022615798806278534}}}, "num_module_steps_sampled_lifetime": {"default_policy": 204000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 204000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.052683004759775e-05, "add_states_from_episodes_to_batch": 2.0302339890958904e-05, "numpy_to_tensor": 0.000162426049638907, "add_time_dim_to_batch_and_zero_pad": 3.666235095006248e-05, "batch_individual_items": 9.20046249498566e-05}}, "connector_pipeline_timer": 0.0005944338783428489}, "episode_return_max": 0.7608888888888905, "episode_duration_sec_mean": 21.799543295007354, "num_episodes_lifetime": 944, "rlmodule_inference_timer": 0.000541249622869867, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.49670299145299224, "env_to_module_sum_episodes_length_out": 96.99258895549703, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10482251377360999, "num_env_steps_sampled_lifetime": 204000, "weights_seq_no": 101.0, "agent_episode_returns_mean": {"default_agent": 0.49670299145299224}, "module_episode_returns_mean": {"default_policy": 0.49670299145299224}, "num_env_steps_sampled": 2000, "sample": 29.738995414355134, "env_to_module_sum_episodes_length_in": 96.99258895549703, "time_between_sampling": 11.715706325211162, "num_env_steps_sampled_lifetime_throughput": 50.98868596332326}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0641738623380661, "weights_seq_no": 102.0, "vf_loss_unclipped": 0.00786312110722065, "total_loss": 0.07203695178031921, "gradients_default_optimizer_global_norm": 0.3561045229434967, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.048205792903900146, "entropy": 0.09093638509511948, "curr_kl_coeff": 1.2197274925138065e-20, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0874946340918541, "num_module_steps_trained_lifetime": 6179584, "vf_loss": 0.00786312110722065}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04753955408964323, "add_observations_from_episodes_to_batch": 0.00036467886161854995, "add_one_ts_to_episodes_and_truncate": 0.007092288751439676, "add_columns_from_episodes_to_train_batch": 0.07952471750656746, "general_advantage_estimation": 0.10311734627902826, "add_states_from_episodes_to_batch": 1.1207859655406999e-05, "numpy_to_tensor": 0.0013362286140164792, "add_time_dim_to_batch_and_zero_pad": 3.1520186423546627e-05}}, "connector_pipeline_timer": 0.23957031094889114}, "num_module_steps_trained_lifetime": 6179584, "learner_connector_sum_episodes_length_out": 2016.3320556081187, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 97389248, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 204000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.98868596332326, "done": false, "training_iteration": 102, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-02-24", "timestamp": 1747695744, "time_this_iter_s": 39.16767334938049, "time_total_s": 4067.3246188163757, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4067.3246188163757, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 77.61428571428571, "ram_util_percent": 51.36964285714286}}
{"timers": {"training_iteration": 40.987927922388685, "restore_env_runners": 2.8750770917098907e-05, "training_step": 40.9874016200259, "env_runner_sampling_timer": 31.163584523586255, "learner_update_timer": 9.811951600114822, "synch_weights": 0.01077113230213834, "synch_env_connectors": 0.009241465665651859}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.24833333333333346, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015704330269025234, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.05537858460677e-06, "un_batch_to_individual_items": 6.89116956685265e-05, "listify_data_for_vector_env": 0.00013123740745815655, "normalize_and_clip_actions": 0.0001160400071809891, "get_actions": 0.0007002224759420291, "tensor_to_numpy": 0.00022710418582161195}}}, "num_module_steps_sampled_lifetime": {"default_policy": 206000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 206000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.064498214529034e-05, "add_states_from_episodes_to_batch": 2.0277872699426602e-05, "numpy_to_tensor": 0.00016230281484720058, "add_time_dim_to_batch_and_zero_pad": 3.706973564679708e-05, "batch_individual_items": 9.175605051984954e-05}}, "connector_pipeline_timer": 0.000594209250545606}, "episode_return_max": 0.8402222222222239, "episode_duration_sec_mean": 21.910857836797312, "num_episodes_lifetime": 952, "rlmodule_inference_timer": 0.0005417695327329537, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5150534188034198, "env_to_module_sum_episodes_length_out": 96.6560067306747, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10494920161290217, "num_env_steps_sampled_lifetime": 206000, "weights_seq_no": 102.0, "agent_episode_returns_mean": {"default_agent": 0.5150534188034198}, "module_episode_returns_mean": {"default_policy": 0.5150534188034198}, "num_env_steps_sampled": 2000, "sample": 29.723591150919628, "env_to_module_sum_episodes_length_in": 96.6560067306747, "time_between_sampling": 11.704774140396065, "num_env_steps_sampled_lifetime_throughput": 54.25802203937701}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.03930710628628731, "weights_seq_no": 103.0, "vf_loss_unclipped": 0.00946025736629963, "total_loss": 0.048767369240522385, "gradients_default_optimizer_global_norm": 0.11489316821098328, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1630130410194397, "entropy": 0.06163792684674263, "curr_kl_coeff": 1.2197274925138065e-20, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.016688715666532516, "num_module_steps_trained_lifetime": 6240128, "vf_loss": 0.00946025736629963}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.047586899059088715, "add_observations_from_episodes_to_batch": 0.0003648671863711926, "add_one_ts_to_episodes_and_truncate": 0.007088401888212686, "add_columns_from_episodes_to_train_batch": 0.07953766778223223, "general_advantage_estimation": 0.1026661980015794, "add_states_from_episodes_to_batch": 1.1210304257250827e-05, "numpy_to_tensor": 0.0013361887409482776, "add_time_dim_to_batch_and_zero_pad": 3.1531643413422754e-05}}, "connector_pipeline_timer": 0.23917495279091006}, "num_module_steps_trained_lifetime": 6240128, "learner_connector_sum_episodes_length_out": 2016.3369401384712, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 98342816, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 206000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.25802203937701, "done": false, "training_iteration": 103, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-03-01", "timestamp": 1747695781, "time_this_iter_s": 36.8031370639801, "time_total_s": 4104.127755880356, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4104.127755880356, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 77.48269230769232, "ram_util_percent": 51.59807692307691}}
{"timers": {"training_iteration": 40.95959947437477, "restore_env_runners": 2.8670263256176947e-05, "training_step": 40.95907246603563, "env_runner_sampling_timer": 31.149396865050377, "learner_update_timer": 9.79786003262365, "synch_weights": 0.010717520979096328, "synch_env_connectors": 0.009221650008972685}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2800000000000001, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015657742815042117, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.045070044323914e-06, "un_batch_to_individual_items": 6.877125613622163e-05, "listify_data_for_vector_env": 0.0001301018899729748, "normalize_and_clip_actions": 0.00011589858725995686, "get_actions": 0.0006987364425938133, "tensor_to_numpy": 0.0002263695091622793}}}, "num_module_steps_sampled_lifetime": {"default_policy": 208000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 208000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.038663130121492e-05, "add_states_from_episodes_to_batch": 2.024812293930583e-05, "numpy_to_tensor": 0.0001624973198126253, "add_time_dim_to_batch_and_zero_pad": 3.676096015982843e-05, "batch_individual_items": 9.172700952501206e-05}}, "connector_pipeline_timer": 0.000593516597234659}, "episode_return_max": 0.8402222222222239, "episode_duration_sec_mean": 21.766560329375423, "num_episodes_lifetime": 960, "rlmodule_inference_timer": 0.0005440875119597323, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.47901495726495796, "env_to_module_sum_episodes_length_out": 94.76198302123541, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10502034300955902, "num_env_steps_sampled_lifetime": 208000, "weights_seq_no": 103.0, "agent_episode_returns_mean": {"default_agent": 0.47901495726495796}, "module_episode_returns_mean": {"default_policy": 0.47901495726495796}, "num_env_steps_sampled": 2000, "sample": 29.707917393538747, "env_to_module_sum_episodes_length_in": 94.76198302123541, "time_between_sampling": 11.69340500664453, "num_env_steps_sampled_lifetime_throughput": 52.30673988862602}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.022846335545182228, "weights_seq_no": 104.0, "vf_loss_unclipped": 0.003098876681178808, "total_loss": -0.019747469574213028, "gradients_default_optimizer_global_norm": 0.2855399549007416, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.005540728569030762, "entropy": 0.07193554192781448, "curr_kl_coeff": 6.0986374625690325e-21, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0021460417192429304, "num_module_steps_trained_lifetime": 6300672, "vf_loss": 0.003098876681178808}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.047632760903736866, "add_observations_from_episodes_to_batch": 0.00036504889674250613, "add_one_ts_to_episodes_and_truncate": 0.007084400003375095, "add_columns_from_episodes_to_train_batch": 0.07954982701063294, "general_advantage_estimation": 0.10221473232505138, "add_states_from_episodes_to_batch": 1.1212949181337755e-05, "numpy_to_tensor": 0.0013361105124797875, "add_time_dim_to_batch_and_zero_pad": 3.154349924453796e-05}}, "connector_pipeline_timer": 0.23877684851499406}, "num_module_steps_trained_lifetime": 6300672, "learner_connector_sum_episodes_length_out": 2016.341693772656, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 99296384, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 208000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 52.30673988862602, "done": false, "training_iteration": 104, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-03-39", "timestamp": 1747695819, "time_this_iter_s": 38.17264795303345, "time_total_s": 4142.300403833389, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4142.300403833389, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 76.25000000000001, "ram_util_percent": 51.766666666666694}}
{"timers": {"training_iteration": 40.936189594941, "restore_env_runners": 2.8695560598271098e-05, "training_step": 40.9356613366853, "env_runner_sampling_timer": 31.129734638469937, "learner_update_timer": 9.794162563537473, "synch_weights": 0.010666110769302701, "synch_env_connectors": 0.009208739508853488}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2800000000000001, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001564084265757331, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.084551386439898e-06, "un_batch_to_individual_items": 6.874557254754709e-05, "listify_data_for_vector_env": 0.00013082050213230064, "normalize_and_clip_actions": 0.00011618042544628876, "get_actions": 0.0006982154265280379, "tensor_to_numpy": 0.00022466372261040955}}}, "num_module_steps_sampled_lifetime": {"default_policy": 210000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 210000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0546812233407154e-05, "add_states_from_episodes_to_batch": 2.0100316936996366e-05, "numpy_to_tensor": 0.00016327833169937472, "add_time_dim_to_batch_and_zero_pad": 3.719201673168983e-05, "batch_individual_items": 9.205282853008317e-05}}, "connector_pipeline_timer": 0.0005962821231232131}, "episode_return_max": 0.7451111111111116, "episode_duration_sec_mean": 22.081634282758596, "num_episodes_lifetime": 968, "rlmodule_inference_timer": 0.0005444162355493595, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5211666666666671, "env_to_module_sum_episodes_length_out": 92.99287293048995, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10479508683904065, "num_env_steps_sampled_lifetime": 210000, "weights_seq_no": 104.0, "agent_episode_returns_mean": {"default_agent": 0.5211666666666671}, "module_episode_returns_mean": {"default_policy": 0.5211666666666671}, "num_env_steps_sampled": 2000, "sample": 29.692194104324873, "env_to_module_sum_episodes_length_in": 92.99287293048995, "time_between_sampling": 11.68215967244941, "num_env_steps_sampled_lifetime_throughput": 51.68639510261897}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.13869106769561768, "weights_seq_no": 105.0, "vf_loss_unclipped": 0.005043375305831432, "total_loss": -0.13364768028259277, "gradients_default_optimizer_global_norm": 0.21296930313110352, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05001574754714966, "entropy": 0.059685368090867996, "curr_kl_coeff": 3.0493187312845163e-21, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0024461711291223764, "num_module_steps_trained_lifetime": 6361216, "vf_loss": 0.005043375305831432}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.047676954911685665, "add_observations_from_episodes_to_batch": 0.00036522604618786204, "add_one_ts_to_episodes_and_truncate": 0.00708027112604513, "add_columns_from_episodes_to_train_batch": 0.07956140855768801, "general_advantage_estimation": 0.10176343590225378, "add_states_from_episodes_to_batch": 1.1217260177042101e-05, "numpy_to_tensor": 0.0013360012997063729, "add_time_dim_to_batch_and_zero_pad": 3.1554744794757535e-05}}, "connector_pipeline_timer": 0.2383764971294171}, "num_module_steps_trained_lifetime": 6361216, "learner_connector_sum_episodes_length_out": 2016.3463186401432, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 100249952, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 210000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.68639510261897, "done": false, "training_iteration": 105, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-04-18", "timestamp": 1747695858, "time_this_iter_s": 38.634658336639404, "time_total_s": 4180.935062170029, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4180.935062170029, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 75.81272727272729, "ram_util_percent": 51.88909090909091}}
{"timers": {"training_iteration": 40.90286879903161, "restore_env_runners": 2.8624604963548704e-05, "training_step": 40.90233918035845, "env_runner_sampling_timer": 31.116524459755187, "learner_update_timer": 9.77405115927212, "synch_weights": 0.010657977661626487, "synch_env_connectors": 0.009189062123799172}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.303888888888889, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001561490269133647, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.981576434640489e-06, "un_batch_to_individual_items": 6.860834852639204e-05, "listify_data_for_vector_env": 0.0001304337875711255, "normalize_and_clip_actions": 0.00011560723285171182, "get_actions": 0.0006979336673305238, "tensor_to_numpy": 0.00022374324792600415}}}, "num_module_steps_sampled_lifetime": {"default_policy": 212000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 212000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.084411968060408e-05, "add_states_from_episodes_to_batch": 1.990663644867318e-05, "numpy_to_tensor": 0.0001626037651082162, "add_time_dim_to_batch_and_zero_pad": 3.7071938002946533e-05, "batch_individual_items": 9.201117696565903e-05}}, "connector_pipeline_timer": 0.0005949418689246454}, "episode_return_max": 0.7451111111111116, "episode_duration_sec_mean": 22.33605628909705, "num_episodes_lifetime": 976, "rlmodule_inference_timer": 0.0005452763212642831, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4974070512820515, "env_to_module_sum_episodes_length_out": 92.43342237214523, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10430133688480488, "num_env_steps_sampled_lifetime": 212000, "weights_seq_no": 105.0, "agent_episode_returns_mean": {"default_agent": 0.4974070512820515}, "module_episode_returns_mean": {"default_policy": 0.4974070512820515}, "num_env_steps_sampled": 2000, "sample": 29.676705190977057, "env_to_module_sum_episodes_length_in": 92.43342237214523, "time_between_sampling": 11.671211761857476, "num_env_steps_sampled_lifetime_throughput": 53.0753932811274}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.035320620983839035, "weights_seq_no": 106.0, "vf_loss_unclipped": 0.005128777585923672, "total_loss": 0.040449392050504684, "gradients_default_optimizer_global_norm": 0.14070887863636017, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06436747312545776, "entropy": 0.0654330849647522, "curr_kl_coeff": 1.5246593656422581e-21, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001790677197277546, "num_module_steps_trained_lifetime": 6421760, "vf_loss": 0.005128777585923672}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04772014157338505, "add_observations_from_episodes_to_batch": 0.0003653958777542936, "add_one_ts_to_episodes_and_truncate": 0.00707602638626164, "add_columns_from_episodes_to_train_batch": 0.07957252127120111, "general_advantage_estimation": 0.10131236872467951, "add_states_from_episodes_to_batch": 1.122153365736444e-05, "numpy_to_tensor": 0.0013358957201374992, "add_time_dim_to_batch_and_zero_pad": 3.157077108433689e-05}}, "connector_pipeline_timer": 0.23797478089680016}, "num_module_steps_trained_lifetime": 6421760, "learner_connector_sum_episodes_length_out": 2016.3508168409035, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 101203520, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 212000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 53.0753932811274, "done": false, "training_iteration": 106, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-04-56", "timestamp": 1747695896, "time_this_iter_s": 37.61871814727783, "time_total_s": 4218.5537803173065, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4218.5537803173065, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 77.69814814814812, "ram_util_percent": 52.03148148148148}}
{"timers": {"training_iteration": 40.86020292280134, "restore_env_runners": 2.858235888010062e-05, "training_step": 40.85967283131486, "env_runner_sampling_timer": 31.08738254354762, "learner_update_timer": 9.760577466049414, "synch_weights": 0.010606371885023539, "synch_env_connectors": 0.009172406502528686}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2991111111111113, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015551488069767002, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.921646125011414e-06, "un_batch_to_individual_items": 6.809539984558673e-05, "listify_data_for_vector_env": 0.00013026261103457916, "normalize_and_clip_actions": 0.00011516872883897988, "get_actions": 0.0006957832292226184, "tensor_to_numpy": 0.00022187704526966211}}}, "num_module_steps_sampled_lifetime": {"default_policy": 214000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 214000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.047792744638762e-05, "add_states_from_episodes_to_batch": 1.9585562269768552e-05, "numpy_to_tensor": 0.0001611603059661025, "add_time_dim_to_batch_and_zero_pad": 3.6782295178984386e-05, "batch_individual_items": 9.16029274129428e-05}}, "connector_pipeline_timer": 0.0005907962193030496}, "episode_return_max": 0.7746666666666671, "episode_duration_sec_mean": 21.84189862378844, "num_episodes_lifetime": 984, "rlmodule_inference_timer": 0.0005451131063584621, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.47664102564102584, "env_to_module_sum_episodes_length_out": 93.6972831304814, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10337890674967162, "num_env_steps_sampled_lifetime": 214000, "weights_seq_no": 106.0, "agent_episode_returns_mean": {"default_agent": 0.47664102564102584}, "module_episode_returns_mean": {"default_policy": 0.47664102564102584}, "num_env_steps_sampled": 2000, "sample": 29.66025628268201, "env_to_module_sum_episodes_length_in": 93.6972831304814, "time_between_sampling": 11.659488646076078, "num_env_steps_sampled_lifetime_throughput": 54.48048640148398}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.142472505569458, "weights_seq_no": 107.0, "vf_loss_unclipped": 0.005669665522873402, "total_loss": -0.13680283725261688, "gradients_default_optimizer_global_norm": 0.34044376015663147, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1397649049758911, "entropy": 0.11664868891239166, "curr_kl_coeff": 7.623296828211291e-22, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001101895933970809, "num_module_steps_trained_lifetime": 6482304, "vf_loss": 0.005669665522873402}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.047762287196459474, "add_observations_from_episodes_to_batch": 0.00036555654008463756, "add_one_ts_to_episodes_and_truncate": 0.0070716680141612595, "add_columns_from_episodes_to_train_batch": 0.07958285774958795, "general_advantage_estimation": 0.10086117026706688, "add_states_from_episodes_to_batch": 1.1225699941707421e-05, "numpy_to_tensor": 0.0013358094020304988, "add_time_dim_to_batch_and_zero_pad": 3.159177137395922e-05}}, "connector_pipeline_timer": 0.23757101962922253}, "num_module_steps_trained_lifetime": 6482304, "learner_connector_sum_episodes_length_out": 2016.3551904457845, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 102157088, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 214000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.48048640148398, "done": false, "training_iteration": 107, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-05-32", "timestamp": 1747695932, "time_this_iter_s": 36.65241885185242, "time_total_s": 4255.206199169159, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4255.206199169159, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 76.60000000000001, "ram_util_percent": 52.225000000000016}}
{"timers": {"training_iteration": 40.809549670673285, "restore_env_runners": 2.866353524819521e-05, "training_step": 40.80901882810171, "env_runner_sampling_timer": 31.053021722312167, "learner_update_timer": 9.744336211288937, "synch_weights": 0.010555771166199369, "synch_env_connectors": 0.009160245437539105}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29277777777777814, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015549915554820561, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.809356059992608e-06, "un_batch_to_individual_items": 6.781782167559527e-05, "listify_data_for_vector_env": 0.00012992508661395342, "normalize_and_clip_actions": 0.00011483748339866987, "get_actions": 0.0006957017767389764, "tensor_to_numpy": 0.00022365165821394668}}}, "num_module_steps_sampled_lifetime": {"default_policy": 216000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 216000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.021424052874416e-05, "add_states_from_episodes_to_batch": 1.9352182836956604e-05, "numpy_to_tensor": 0.00015987747710731348, "add_time_dim_to_batch_and_zero_pad": 3.6709014968827674e-05, "batch_individual_items": 9.110610449245788e-05}}, "connector_pipeline_timer": 0.0005877422579020941}, "episode_return_max": 0.8574444444444456, "episode_duration_sec_mean": 20.87450595061434, "num_episodes_lifetime": 1000, "rlmodule_inference_timer": 0.0005413530755328482, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.4885448717948726, "env_to_module_sum_episodes_length_out": 97.09114544515135, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10249859167099895, "num_env_steps_sampled_lifetime": 216000, "weights_seq_no": 107.0, "agent_episode_returns_mean": {"default_agent": 0.4885448717948726}, "module_episode_returns_mean": {"default_policy": 0.4885448717948726}, "num_env_steps_sampled": 2000, "sample": 29.64258533583792, "env_to_module_sum_episodes_length_in": 97.09114544515135, "time_between_sampling": 11.64750580690569, "num_env_steps_sampled_lifetime_throughput": 55.75749182714106}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.12222035229206085, "weights_seq_no": 108.0, "vf_loss_unclipped": 0.006606403272598982, "total_loss": -0.11561394482851028, "gradients_default_optimizer_global_norm": 0.4267841875553131, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0877348780632019, "entropy": 0.05640410631895065, "curr_kl_coeff": 3.8116484141056453e-22, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0013129586586728692, "num_module_steps_trained_lifetime": 6542848, "vf_loss": 0.006606403272598982}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.047824914902515274, "add_observations_from_episodes_to_batch": 0.00036570804958004446, "add_one_ts_to_episodes_and_truncate": 0.007067203006864305, "add_columns_from_episodes_to_train_batch": 0.07959232382617978, "general_advantage_estimation": 0.10040989273173352, "add_states_from_episodes_to_batch": 1.1229840746524163e-05, "numpy_to_tensor": 0.0013357794807137655, "add_time_dim_to_batch_and_zero_pad": 3.162084458062283e-05}}, "connector_pipeline_timer": 0.2371867373884071}, "num_module_steps_trained_lifetime": 6542848, "learner_connector_sum_episodes_length_out": 2016.3594414968838, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 103110656, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 216000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 55.75749182714106, "done": false, "training_iteration": 108, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-06-08", "timestamp": 1747695968, "time_this_iter_s": 35.81064796447754, "time_total_s": 4291.0168471336365, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4291.0168471336365, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 76.7843137254902, "ram_util_percent": 52.311764705882375}}
{"timers": {"training_iteration": 40.833211044366536, "restore_env_runners": 2.870089988898352e-05, "training_step": 40.832678943220664, "env_runner_sampling_timer": 31.076664214779, "learner_update_timer": 9.744401850886106, "synch_weights": 0.010508559454542633, "synch_env_connectors": 0.009138041983149138}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.30311111111111216, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015594605966239607, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.783826476035194e-06, "un_batch_to_individual_items": 6.78081256685348e-05, "listify_data_for_vector_env": 0.0001300533985631026, "normalize_and_clip_actions": 0.00011533999964309949, "get_actions": 0.0006986398207645299, "tensor_to_numpy": 0.00022500303398361476}}}, "num_module_steps_sampled_lifetime": {"default_policy": 218000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 218000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.074184662592143e-05, "add_states_from_episodes_to_batch": 1.9246761157351444e-05, "numpy_to_tensor": 0.00015964214685214756, "add_time_dim_to_batch_and_zero_pad": 3.682171695893853e-05, "batch_individual_items": 9.11400263542553e-05}}, "connector_pipeline_timer": 0.000588687522187392}, "episode_return_max": 0.6626666666666677, "episode_duration_sec_mean": 22.772291872221594, "num_episodes_lifetime": 1008, "rlmodule_inference_timer": 0.0005463023717355952, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4569626068376076, "env_to_module_sum_episodes_length_out": 97.82008394043343, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10353412994920533, "num_env_steps_sampled_lifetime": 218000, "weights_seq_no": 108.0, "agent_episode_returns_mean": {"default_agent": 0.4569626068376076}, "module_episode_returns_mean": {"default_policy": 0.4569626068376076}, "num_env_steps_sampled": 2000, "sample": 29.627545683301456, "env_to_module_sum_episodes_length_in": 97.82008394043343, "time_between_sampling": 11.634997717673112, "num_env_steps_sampled_lifetime_throughput": 46.247898575930016}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.11925438791513443, "weights_seq_no": 109.0, "vf_loss_unclipped": 0.006297918502241373, "total_loss": 0.12555231153964996, "gradients_default_optimizer_global_norm": 0.2616212069988251, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.01098567247390747, "entropy": 0.06182621046900749, "curr_kl_coeff": 3.8116484141056453e-22, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.011327138170599937, "num_module_steps_trained_lifetime": 6603392, "vf_loss": 0.006297918502241373}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04788552011573027, "add_observations_from_episodes_to_batch": 0.0003658510732318769, "add_one_ts_to_episodes_and_truncate": 0.0070626827729120085, "add_columns_from_episodes_to_train_batch": 0.07960161258546505, "general_advantage_estimation": 0.09995877729008046, "add_states_from_episodes_to_batch": 1.1233766164785196e-05, "numpy_to_tensor": 0.001335711766883302, "add_time_dim_to_batch_and_zero_pad": 3.1649127145923064e-05}}, "connector_pipeline_timer": 0.23680030863044535}, "num_module_steps_trained_lifetime": 6603392, "learner_connector_sum_episodes_length_out": 2016.3635720079167, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 104064224, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 218000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.247898575930016, "done": false, "training_iteration": 109, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-06-52", "timestamp": 1747696012, "time_this_iter_s": 43.196346044540405, "time_total_s": 4334.213193178177, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4334.213193178177, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 76.2606557377049, "ram_util_percent": 52.30655737704916}}
{"timers": {"training_iteration": 40.890137119192865, "restore_env_runners": 2.8631890876582988e-05, "training_step": 40.88960402705848, "env_runner_sampling_timer": 31.126662368431198, "learner_update_timer": 9.75134624584725, "synch_weights": 0.01048944686002014, "synch_env_connectors": 0.00914855656328833}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29033333333333383, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015849367897665207, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.769076394972247e-06, "un_batch_to_individual_items": 6.810408105120996e-05, "listify_data_for_vector_env": 0.0001319626000633658, "normalize_and_clip_actions": 0.00011811967422406796, "get_actions": 0.0007142283892317208, "tensor_to_numpy": 0.00022682006717765645}}}, "num_module_steps_sampled_lifetime": {"default_policy": 220000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 220000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.229653658609904e-05, "add_states_from_episodes_to_batch": 1.9414856789220088e-05, "numpy_to_tensor": 0.0001624066155023577, "add_time_dim_to_batch_and_zero_pad": 3.717354628238046e-05, "batch_individual_items": 9.187176984307338e-05}}, "connector_pipeline_timer": 0.0005979507900818635}, "episode_return_max": 0.8332222222222242, "episode_duration_sec_mean": 26.345356652847492, "num_episodes_lifetime": 1016, "rlmodule_inference_timer": 0.0005537819832825354, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4814262820512828, "env_to_module_sum_episodes_length_out": 96.20878366771622, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10580065603500757, "num_env_steps_sampled_lifetime": 220000, "weights_seq_no": 109.0, "agent_episode_returns_mean": {"default_agent": 0.4814262820512828}, "module_episode_returns_mean": {"default_policy": 0.4814262820512828}, "num_env_steps_sampled": 2000, "sample": 29.618258070258083, "env_to_module_sum_episodes_length_in": 96.20878366771622, "time_between_sampling": 11.624002543010818, "num_env_steps_sampled_lifetime_throughput": 42.90647415163731}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0468955934047699, "weights_seq_no": 110.0, "vf_loss_unclipped": 0.00746756000444293, "total_loss": 0.05436315760016441, "gradients_default_optimizer_global_norm": 0.31069570779800415, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.004068911075592041, "entropy": 0.07472074776887894, "curr_kl_coeff": 1.9058242070528227e-22, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0013699254486709833, "num_module_steps_trained_lifetime": 6663936, "vf_loss": 0.00746756000444293}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04794636356309126, "add_observations_from_episodes_to_batch": 0.0003659892256062095, "add_one_ts_to_episodes_and_truncate": 0.007058137953338522, "add_columns_from_episodes_to_train_batch": 0.07961330351678196, "general_advantage_estimation": 0.09950808865788721, "add_states_from_episodes_to_batch": 1.1237630090555728e-05, "numpy_to_tensor": 0.0013356591193809623, "add_time_dim_to_batch_and_zero_pad": 3.167692197539193e-05}}, "connector_pipeline_timer": 0.2364169361933038}, "num_module_steps_trained_lifetime": 6663936, "learner_connector_sum_episodes_length_out": 2016.3675839645791, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 105017792, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 220000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 42.90647415163731, "done": false, "training_iteration": 110, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-07-38", "timestamp": 1747696058, "time_this_iter_s": 46.54474496841431, "time_total_s": 4380.757938146591, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4380.757938146591, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 79.28787878787877, "ram_util_percent": 52.27575757575758}}
{"timers": {"training_iteration": 40.92465789253091, "restore_env_runners": 2.856357195430646e-05, "training_step": 40.92412557331787, "env_runner_sampling_timer": 31.152650856376887, "learner_update_timer": 9.759887498288796, "synch_weights": 0.010483080391436752, "synch_env_connectors": 0.00916258499767986}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29033333333333383, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016089352315035528, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.763223893165502e-06, "un_batch_to_individual_items": 6.913657234484326e-05, "listify_data_for_vector_env": 0.00013489521477662287, "normalize_and_clip_actions": 0.00011961698438099257, "get_actions": 0.0007241331025524048, "tensor_to_numpy": 0.00022807779495345422}}}, "num_module_steps_sampled_lifetime": {"default_policy": 222000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 222000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.257293847710632e-05, "add_states_from_episodes_to_batch": 2.022699157830277e-05, "numpy_to_tensor": 0.0001632262805029583, "add_time_dim_to_batch_and_zero_pad": 3.779378463773857e-05, "batch_individual_items": 9.326523941085504e-05}}, "connector_pipeline_timer": 0.0006104242747772715}, "episode_return_max": 0.8332222222222242, "episode_duration_sec_mean": 27.008634518569895, "num_episodes_lifetime": 1024, "rlmodule_inference_timer": 0.0005597109164638141, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.519470085470086, "env_to_module_sum_episodes_length_out": 94.18707917036167, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10750131981291461, "num_env_steps_sampled_lifetime": 222000, "weights_seq_no": 110.0, "agent_episode_returns_mean": {"default_agent": 0.519470085470086}, "module_episode_returns_mean": {"default_policy": 0.519470085470086}, "num_env_steps_sampled": 2000, "sample": 29.612608190271065, "env_to_module_sum_episodes_length_in": 94.18707917036167, "time_between_sampling": 11.613738920717115, "num_env_steps_sampled_lifetime_throughput": 44.8969595498521}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.04606100544333458, "weights_seq_no": 111.0, "vf_loss_unclipped": 0.004649151116609573, "total_loss": -0.0414118617773056, "gradients_default_optimizer_global_norm": 0.2850223779678345, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09575861692428589, "entropy": 0.09490471333265305, "curr_kl_coeff": 9.529121035264113e-23, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002943579573184252, "num_module_steps_trained_lifetime": 6724480, "vf_loss": 0.004649151116609573}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04800602919939326, "add_observations_from_episodes_to_batch": 0.00036611942982544833, "add_one_ts_to_episodes_and_truncate": 0.007053531461879669, "add_columns_from_episodes_to_train_batch": 0.07962537785811342, "general_advantage_estimation": 0.09905737451060881, "add_states_from_episodes_to_batch": 1.1241393361566759e-05, "numpy_to_tensor": 0.0013356154036522096, "add_time_dim_to_batch_and_zero_pad": 3.170426599571797e-05}}, "connector_pipeline_timer": 0.23603268159384203}, "num_module_steps_trained_lifetime": 6724480, "learner_connector_sum_episodes_length_out": 2016.3714793249076, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 105971360, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 222000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.8969595498521, "done": false, "training_iteration": 111, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-08-23", "timestamp": 1747696103, "time_this_iter_s": 44.37196063995361, "time_total_s": 4425.129898786545, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4425.129898786545, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 78.7142857142857, "ram_util_percent": 52.5031746031746}}
{"timers": {"training_iteration": 40.931210172175575, "restore_env_runners": 2.8573936233106573e-05, "training_step": 40.93067667115469, "env_runner_sampling_timer": 31.160976574373077, "learner_update_timer": 9.758091985305914, "synch_weights": 0.01050258159754079, "synch_env_connectors": 0.009210033147665482}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.30088888888888915, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016215095509846387, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.676208578477592e-06, "un_batch_to_individual_items": 7.099190472474198e-05, "listify_data_for_vector_env": 0.0001360772473958929, "normalize_and_clip_actions": 0.00012101144517099197, "get_actions": 0.0007304677136852446, "tensor_to_numpy": 0.00022929825653242466}}}, "num_module_steps_sampled_lifetime": {"default_policy": 224000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 224000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2965186071482555e-05, "add_states_from_episodes_to_batch": 2.035363076066466e-05, "numpy_to_tensor": 0.00016464120526771565, "add_time_dim_to_batch_and_zero_pad": 3.9280982221602125e-05, "batch_individual_items": 9.508284691943566e-05}}, "connector_pipeline_timer": 0.0006174181759695209}, "episode_return_max": 0.7926666666666677, "episode_duration_sec_mean": 26.086162662492544, "num_episodes_lifetime": 1032, "rlmodule_inference_timer": 0.0005657961774634879, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5291880341880345, "env_to_module_sum_episodes_length_out": 93.05911147229082, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10826363615088556, "num_env_steps_sampled_lifetime": 224000, "weights_seq_no": 111.0, "agent_episode_returns_mean": {"default_agent": 0.5291880341880345}, "module_episode_returns_mean": {"default_policy": 0.5291880341880345}, "num_env_steps_sampled": 2000, "sample": 29.608720193795143, "env_to_module_sum_episodes_length_in": 93.05911147229082, "time_between_sampling": 11.60401285325166, "num_env_steps_sampled_lifetime_throughput": 47.97941500543518}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08239296823740005, "weights_seq_no": 112.0, "vf_loss_unclipped": 0.00319157843478024, "total_loss": -0.07920139282941818, "gradients_default_optimizer_global_norm": 0.28441813588142395, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.03951108455657959, "entropy": 0.0830630287528038, "curr_kl_coeff": 4.7645605176320567e-23, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0021661214996129274, "num_module_steps_trained_lifetime": 6785024, "vf_loss": 0.00319157843478024}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04806454897661351, "add_observations_from_episodes_to_batch": 0.00036625134103783973, "add_one_ts_to_episodes_and_truncate": 0.007048888126454509, "add_columns_from_episodes_to_train_batch": 0.07963747227216605, "general_advantage_estimation": 0.09860722945741072, "add_states_from_episodes_to_batch": 1.1245127604326323e-05, "numpy_to_tensor": 0.001335597486326561, "add_time_dim_to_batch_and_zero_pad": 3.173126544363494e-05}}, "connector_pipeline_timer": 0.2356478657426502}, "num_module_steps_trained_lifetime": 6785024, "learner_connector_sum_episodes_length_out": 2016.375260019633, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 106924928, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 224000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.97941500543518, "done": false, "training_iteration": 112, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-09-04", "timestamp": 1747696144, "time_this_iter_s": 41.59751296043396, "time_total_s": 4466.727411746979, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4466.727411746979, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 78.79152542372883, "ram_util_percent": 52.5271186440678}}
{"timers": {"training_iteration": 40.99508326814379, "restore_env_runners": 2.8498196869108442e-05, "training_step": 40.99455040513315, "env_runner_sampling_timer": 31.222303927609317, "learner_update_timer": 9.760688605162839, "synch_weights": 0.010453992781586487, "synch_env_connectors": 0.009217342816227742}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3087777777777776, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016513725816741987, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.631939000352736e-06, "un_batch_to_individual_items": 7.325891677070722e-05, "listify_data_for_vector_env": 0.00014060809682944688, "normalize_and_clip_actions": 0.0001234388710622421, "get_actions": 0.0007417614904507972, "tensor_to_numpy": 0.0002323339081291737}}}, "num_module_steps_sampled_lifetime": {"default_policy": 226000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 226000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.294010579809282e-05, "add_states_from_episodes_to_batch": 2.034203377559846e-05, "numpy_to_tensor": 0.00016712738545840875, "add_time_dim_to_batch_and_zero_pad": 4.127420509934417e-05, "batch_individual_items": 9.637293183391905e-05}}, "connector_pipeline_timer": 0.0006257244691422757}, "episode_return_max": 0.7506666666666668, "episode_duration_sec_mean": 25.727818033163622, "num_episodes_lifetime": 1040, "rlmodule_inference_timer": 0.0005722242676258385, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4931891025641027, "env_to_module_sum_episodes_length_out": 93.58418957234045, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11014973801686756, "num_env_steps_sampled_lifetime": 226000, "weights_seq_no": 112.0, "agent_episode_returns_mean": {"default_agent": 0.4931891025641027}, "module_episode_returns_mean": {"default_policy": 0.4931891025641027}, "num_env_steps_sampled": 2000, "sample": 29.61007830279442, "env_to_module_sum_episodes_length_in": 93.58418957234045, "time_between_sampling": 11.594204192188073, "num_env_steps_sampled_lifetime_throughput": 42.18562101892313}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.11111731827259064, "weights_seq_no": 113.0, "vf_loss_unclipped": 0.00478776590898633, "total_loss": -0.1063295528292656, "gradients_default_optimizer_global_norm": 0.2519996166229248, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09359145164489746, "entropy": 0.05949998274445534, "curr_kl_coeff": 2.3822802588160283e-23, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.000847965944558382, "num_module_steps_trained_lifetime": 6845568, "vf_loss": 0.00478776590898633}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04812390666536953, "add_observations_from_episodes_to_batch": 0.000366387822083429, "add_one_ts_to_episodes_and_truncate": 0.007044450064591727, "add_columns_from_episodes_to_train_batch": 0.07965290437015213, "general_advantage_estimation": 0.09815691090782536, "add_states_from_episodes_to_batch": 1.1250073023055573e-05, "numpy_to_tensor": 0.00133592074570703, "add_time_dim_to_batch_and_zero_pad": 3.176107447616398e-05}}, "connector_pipeline_timer": 0.23526765365022267}, "num_module_steps_trained_lifetime": 6845568, "learner_connector_sum_episodes_length_out": 2016.3789279525313, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 107878496, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 226000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 42.18562101892313, "done": false, "training_iteration": 113, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-09-52", "timestamp": 1747696192, "time_this_iter_s": 47.335045337677, "time_total_s": 4514.062457084656, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4514.062457084656, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 78.75294117647059, "ram_util_percent": 52.5264705882353}}
{"timers": {"training_iteration": 41.08446699534235, "restore_env_runners": 2.8462214904677224e-05, "training_step": 41.08393499996183, "env_runner_sampling_timer": 31.31751260016322, "learner_update_timer": 9.754918068151232, "synch_weights": 0.010402424863787296, "synch_env_connectors": 0.009199499388054014}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29255555555555557, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016768856607889103, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.541087274760814e-06, "un_batch_to_individual_items": 7.555135668238096e-05, "listify_data_for_vector_env": 0.0001433904532738359, "normalize_and_clip_actions": 0.0001265512313802301, "get_actions": 0.00075215302694058, "tensor_to_numpy": 0.00023544609633742845}}}, "num_module_steps_sampled_lifetime": {"default_policy": 228000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 228000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.378723190228754e-05, "add_states_from_episodes_to_batch": 2.157616171931104e-05, "numpy_to_tensor": 0.00016921450460505107, "add_time_dim_to_batch_and_zero_pad": 4.184864059844651e-05, "batch_individual_items": 9.761412332343175e-05}}, "connector_pipeline_timer": 0.0006333879381545381}, "episode_return_max": 0.694777777777778, "episode_duration_sec_mean": 29.249153760202226, "num_episodes_lifetime": 1048, "rlmodule_inference_timer": 0.0005802866333866684, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.49986752136752166, "env_to_module_sum_episodes_length_out": 96.16158119918842, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.111556082766485, "num_env_steps_sampled_lifetime": 228000, "weights_seq_no": 113.0, "agent_episode_returns_mean": {"default_agent": 0.49986752136752166}, "module_episode_returns_mean": {"default_policy": 0.49986752136752166}, "num_env_steps_sampled": 2000, "sample": 29.619082399409503, "env_to_module_sum_episodes_length_in": 96.16158119918842, "time_between_sampling": 11.58512654918517, "num_env_steps_sampled_lifetime_throughput": 39.98351888388147}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.026750190183520317, "weights_seq_no": 114.0, "vf_loss_unclipped": 0.008067073300480843, "total_loss": -0.018683109432458878, "gradients_default_optimizer_global_norm": 0.3108838200569153, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10108208656311035, "entropy": 0.05899488180875778, "curr_kl_coeff": 1.1911401294080142e-23, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002831120742484927, "num_module_steps_trained_lifetime": 6906112, "vf_loss": 0.008067073300480843}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04818200929545295, "add_observations_from_episodes_to_batch": 0.00036651806837444654, "add_one_ts_to_episodes_and_truncate": 0.007039963805153953, "add_columns_from_episodes_to_train_batch": 0.07966831937885087, "general_advantage_estimation": 0.09770663614628616, "add_states_from_episodes_to_batch": 1.1254825020489181e-05, "numpy_to_tensor": 0.0013362090401516078, "add_time_dim_to_batch_and_zero_pad": 3.1790694201836924e-05}}, "connector_pipeline_timer": 0.234886117692969}, "num_module_steps_trained_lifetime": 6906112, "learner_connector_sum_episodes_length_out": 2016.3824850007695, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 108832064, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 228000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 39.98351888388147, "done": false, "training_iteration": 114, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-10-42", "timestamp": 1747696242, "time_this_iter_s": 49.9511775970459, "time_total_s": 4564.013634681702, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4564.013634681702, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 83.05857142857145, "ram_util_percent": 52.535714285714285}}
{"timers": {"training_iteration": 41.1070154743189, "restore_env_runners": 2.8449592716744942e-05, "training_step": 41.10648297489215, "env_runner_sampling_timer": 31.34248727625156, "learner_update_timer": 9.752536455309754, "synch_weights": 0.01035395661515604, "synch_env_connectors": 0.009190511404135349}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.276777777777778, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001674757998513102, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.559905462307389e-06, "un_batch_to_individual_items": 7.603775701051186e-05, "listify_data_for_vector_env": 0.00014269199473436028, "normalize_and_clip_actions": 0.00012839333322372384, "get_actions": 0.0007507268085821412, "tensor_to_numpy": 0.00023375049482830823}}}, "num_module_steps_sampled_lifetime": {"default_policy": 230000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 230000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.305958969180493e-05, "add_states_from_episodes_to_batch": 2.2579032556432795e-05, "numpy_to_tensor": 0.00016863636383276405, "add_time_dim_to_batch_and_zero_pad": 4.158162522244616e-05, "batch_individual_items": 9.836678496265878e-05}}, "connector_pipeline_timer": 0.000634069049672595}, "episode_return_max": 0.98177777777778, "episode_duration_sec_mean": 26.284854620788582, "num_episodes_lifetime": 1064, "rlmodule_inference_timer": 0.0005809643544930293, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5564358974358984, "env_to_module_sum_episodes_length_out": 97.56517781012535, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11273765084644408, "num_env_steps_sampled_lifetime": 230000, "weights_seq_no": 114.0, "agent_episode_returns_mean": {"default_agent": 0.5564358974358984}, "module_episode_returns_mean": {"default_policy": 0.5564358974358984}, "num_env_steps_sampled": 2000, "sample": 29.629598822936558, "env_to_module_sum_episodes_length_in": 97.56517781012535, "time_between_sampling": 11.575894893491165, "num_env_steps_sampled_lifetime_throughput": 46.04566971814782}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.03314393013715744, "weights_seq_no": 115.0, "vf_loss_unclipped": 0.008242477662861347, "total_loss": 0.04138641059398651, "gradients_default_optimizer_global_norm": 0.43261805176734924, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.12117671966552734, "entropy": 0.10147199034690857, "curr_kl_coeff": 5.955700647040071e-24, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0034833569079637527, "num_module_steps_trained_lifetime": 6966912, "vf_loss": 0.008242477662861347}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04823895880226778, "add_observations_from_episodes_to_batch": 0.0003666557709579655, "add_one_ts_to_episodes_and_truncate": 0.007035530345898318, "add_columns_from_episodes_to_train_batch": 0.07968415470693878, "general_advantage_estimation": 0.09725675348888727, "add_states_from_episodes_to_batch": 1.1259356971010348e-05, "numpy_to_tensor": 0.0013364666066326095, "add_time_dim_to_batch_and_zero_pad": 3.181928542603982e-05}}, "connector_pipeline_timer": 0.234504267549495}, "num_module_steps_trained_lifetime": 6966912, "learner_connector_sum_episodes_length_out": 2016.3867330152477, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 109793464, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 230000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.04566971814782, "done": false, "training_iteration": 115, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-11-25", "timestamp": 1747696285, "time_this_iter_s": 43.35679364204407, "time_total_s": 4607.370428323746, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4607.370428323746, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 78.06129032258065, "ram_util_percent": 52.54677419354839}}
{"timers": {"training_iteration": 41.10293875043573, "restore_env_runners": 2.8443096796378938e-05, "training_step": 41.10240554200322, "env_runner_sampling_timer": 31.340932213379094, "learner_update_timer": 9.750055097726639, "synch_weights": 0.010314246049068767, "synch_env_connectors": 0.009180507290106289}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3020000000000001, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016736828350398319, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.491140549784604e-06, "un_batch_to_individual_items": 7.611369225929471e-05, "listify_data_for_vector_env": 0.00014386190815476746, "normalize_and_clip_actions": 0.00012999475930787705, "get_actions": 0.0007473150479064349, "tensor_to_numpy": 0.00023275494365287747}}}, "num_module_steps_sampled_lifetime": {"default_policy": 232000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 232000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2649772579224395e-05, "add_states_from_episodes_to_batch": 2.2323783833540493e-05, "numpy_to_tensor": 0.00016750671948858215, "add_time_dim_to_batch_and_zero_pad": 4.096203510290717e-05, "batch_individual_items": 9.823048999042665e-05}}, "connector_pipeline_timer": 0.0006308184216146884}, "episode_return_max": 0.916666666666669, "episode_duration_sec_mean": 24.293601443739483, "num_episodes_lifetime": 1072, "rlmodule_inference_timer": 0.0005781440961809302, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5695117521367531, "env_to_module_sum_episodes_length_out": 96.52343752036086, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11314643806361321, "num_env_steps_sampled_lifetime": 232000, "weights_seq_no": 115.0, "agent_episode_returns_mean": {"default_agent": 0.5695117521367531}, "module_episode_returns_mean": {"default_policy": 0.5695117521367531}, "num_env_steps_sampled": 2000, "sample": 29.63959246828306, "env_to_module_sum_episodes_length_in": 96.52343752036086, "time_between_sampling": 11.566891675537372, "num_env_steps_sampled_lifetime_throughput": 49.0418003564345}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.015744855627417564, "weights_seq_no": 116.0, "vf_loss_unclipped": 0.009507625363767147, "total_loss": 0.02525247074663639, "gradients_default_optimizer_global_norm": 0.2303915172815323, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.011248886585235596, "entropy": 0.06684854626655579, "curr_kl_coeff": 2.9778503235200354e-24, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0005470032338052988, "num_module_steps_trained_lifetime": 7027456, "vf_loss": 0.009507625363767147}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04829419483801656, "add_observations_from_episodes_to_batch": 0.00036678655768298895, "add_one_ts_to_episodes_and_truncate": 0.007031128639447916, "add_columns_from_episodes_to_train_batch": 0.07969975475652726, "general_advantage_estimation": 0.09680701964102179, "add_states_from_episodes_to_batch": 1.1265012800374658e-05, "numpy_to_tensor": 0.0013366829908801991, "add_time_dim_to_batch_and_zero_pad": 3.1846975756211906e-05}}, "connector_pipeline_timer": 0.23412059566712157}, "num_module_steps_trained_lifetime": 7027456, "learner_connector_sum_episodes_length_out": 2016.3908578209364, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 110747032, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 232000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.0418003564345, "done": false, "training_iteration": 116, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-12-06", "timestamp": 1747696326, "time_this_iter_s": 40.717517614364624, "time_total_s": 4648.08794593811, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4648.08794593811, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 77.39827586206896, "ram_util_percent": 52.57068965517242}}
{"timers": {"training_iteration": 41.098866018661404, "restore_env_runners": 2.8382665787831835e-05, "training_step": 41.09832947131318, "env_runner_sampling_timer": 31.338025806125284, "learner_update_timer": 9.748891188599368, "synch_weights": 0.010309783588515383, "synch_env_connectors": 0.009180012217194106}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3020000000000001, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016718800624911942, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.4675118335256484e-06, "un_batch_to_individual_items": 7.676052677677563e-05, "listify_data_for_vector_env": 0.00014416033538780908, "normalize_and_clip_actions": 0.00012957726321186013, "get_actions": 0.0007464704863932003, "tensor_to_numpy": 0.00023253113976950463}}}, "num_module_steps_sampled_lifetime": {"default_policy": 234000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 234000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.276425049018185e-05, "add_states_from_episodes_to_batch": 2.3218074633780012e-05, "numpy_to_tensor": 0.00016858137123555492, "add_time_dim_to_batch_and_zero_pad": 4.072281252621619e-05, "batch_individual_items": 9.85696954244196e-05}}, "connector_pipeline_timer": 0.0006336715800036802}, "episode_return_max": 0.880888888888891, "episode_duration_sec_mean": 23.890295419749375, "num_episodes_lifetime": 1080, "rlmodule_inference_timer": 0.000578412983294654, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.522591880341881, "env_to_module_sum_episodes_length_out": 94.48997330704012, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11332341451858148, "num_env_steps_sampled_lifetime": 234000, "weights_seq_no": 116.0, "agent_episode_returns_mean": {"default_agent": 0.522591880341881}, "module_episode_returns_mean": {"default_policy": 0.522591880341881}, "num_env_steps_sampled": 2000, "sample": 29.649121632898588, "env_to_module_sum_episodes_length_in": 94.48997330704012, "time_between_sampling": 11.557961347862271, "num_env_steps_sampled_lifetime_throughput": 49.03825467192623}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.022925419732928276, "weights_seq_no": 117.0, "vf_loss_unclipped": 0.004071417730301619, "total_loss": -0.01885400153696537, "gradients_default_optimizer_global_norm": 0.24792036414146423, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.15638291835784912, "entropy": 0.0986400842666626, "curr_kl_coeff": 1.4889251617600177e-24, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0030264793895184994, "num_module_steps_trained_lifetime": 7088000, "vf_loss": 0.004071417730301619}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04835358337716995, "add_observations_from_episodes_to_batch": 0.00036691294309643726, "add_one_ts_to_episodes_and_truncate": 0.007026660354091794, "add_columns_from_episodes_to_train_batch": 0.07971712884965307, "general_advantage_estimation": 0.09635775851476493, "add_states_from_episodes_to_batch": 1.1270949577387078e-05, "numpy_to_tensor": 0.001336898240782224, "add_time_dim_to_batch_and_zero_pad": 3.187547035088315e-05}}, "connector_pipeline_timer": 0.23374326832564066}, "num_module_steps_trained_lifetime": 7088000, "learner_connector_sum_episodes_length_out": 2016.3948614572098, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 111700600, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 234000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.03825467192623, "done": false, "training_iteration": 117, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-12-47", "timestamp": 1747696367, "time_this_iter_s": 40.72511601448059, "time_total_s": 4688.813061952591, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4688.813061952591, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 77.5551724137931, "ram_util_percent": 52.60344827586208}}
{"timers": {"training_iteration": 41.09832643415479, "restore_env_runners": 2.8349839149442373e-05, "training_step": 41.09778910528003, "env_runner_sampling_timer": 31.33937374071403, "learner_update_timer": 9.746997886743369, "synch_weights": 0.01031453075265069, "synch_env_connectors": 0.009258061085066722}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3057777777777777, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016708643536253523, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.503014122093672e-06, "un_batch_to_individual_items": 7.622380196730706e-05, "listify_data_for_vector_env": 0.00014408128922480289, "normalize_and_clip_actions": 0.00012905010092466703, "get_actions": 0.000748257120980516, "tensor_to_numpy": 0.00023166548132168884}}}, "num_module_steps_sampled_lifetime": {"default_policy": 236000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 236000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.287373566747568e-05, "add_states_from_episodes_to_batch": 2.2801598641270924e-05, "numpy_to_tensor": 0.00016823353206292494, "add_time_dim_to_batch_and_zero_pad": 4.0628321042316786e-05, "batch_individual_items": 9.880274300176353e-05}}, "connector_pipeline_timer": 0.0006311229100425227}, "episode_return_max": 0.7238888888888897, "episode_duration_sec_mean": 24.11597476123972, "num_episodes_lifetime": 1088, "rlmodule_inference_timer": 0.0005759335335160229, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.430488247863248, "env_to_module_sum_episodes_length_out": 92.96387440004465, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11330658787397105, "num_env_steps_sampled_lifetime": 236000, "weights_seq_no": 117.0, "agent_episode_returns_mean": {"default_agent": 0.430488247863248}, "module_episode_returns_mean": {"default_policy": 0.430488247863248}, "num_env_steps_sampled": 2000, "sample": 29.658433912217138, "env_to_module_sum_episodes_length_in": 92.96387440004465, "time_between_sampling": 11.549095896225104, "num_env_steps_sampled_lifetime_throughput": 48.61066919810058}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.034331344068050385, "weights_seq_no": 118.0, "vf_loss_unclipped": 0.004763389937579632, "total_loss": 0.039094723761081696, "gradients_default_optimizer_global_norm": 0.22866681218147278, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0864139199256897, "entropy": 0.06281888484954834, "curr_kl_coeff": 7.4446258088000885e-25, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0014307615347206593, "num_module_steps_trained_lifetime": 7148544, "vf_loss": 0.004763389937579632}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04841180337605609, "add_observations_from_episodes_to_batch": 0.0003670362121456242, "add_one_ts_to_episodes_and_truncate": 0.007022193581578753, "add_columns_from_episodes_to_train_batch": 0.07973518416544123, "general_advantage_estimation": 0.09590884979906872, "add_states_from_episodes_to_batch": 1.1277041117325567e-05, "numpy_to_tensor": 0.0013371722173867713, "add_time_dim_to_batch_and_zero_pad": 3.1903890356458045e-05}}, "connector_pipeline_timer": 0.23336586014142266}, "num_module_steps_trained_lifetime": 7148544, "learner_connector_sum_episodes_length_out": 2016.3987459349758, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 112654168, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 236000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.61066919810058, "done": false, "training_iteration": 118, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-13-28", "timestamp": 1747696408, "time_this_iter_s": 41.06718921661377, "time_total_s": 4729.880251169205, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4729.880251169205, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 78.08275862068966, "ram_util_percent": 52.53793103448276}}
{"timers": {"training_iteration": 41.09645303285324, "restore_env_runners": 2.8261340787582635e-05, "training_step": 41.095916379267244, "env_runner_sampling_timer": 31.34250001337691, "learner_update_timer": 9.742017655845965, "synch_weights": 0.010296631445068347, "synch_env_connectors": 0.009291181474213263}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2869999999999999, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016833125471040562, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.018696543444749e-06, "un_batch_to_individual_items": 7.7915778452747e-05, "listify_data_for_vector_env": 0.00014416416552027843, "normalize_and_clip_actions": 0.0001317558992232473, "get_actions": 0.0007503116324912411, "tensor_to_numpy": 0.0002350173066171559}}}, "num_module_steps_sampled_lifetime": {"default_policy": 238000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 238000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.291477583296046e-05, "add_states_from_episodes_to_batch": 2.242417072997958e-05, "numpy_to_tensor": 0.0001688907962366989, "add_time_dim_to_batch_and_zero_pad": 4.0971028594496973e-05, "batch_individual_items": 9.89671447877833e-05}}, "connector_pipeline_timer": 0.0006325957483098217}, "episode_return_max": 0.7700000000000001, "episode_duration_sec_mean": 24.008638669248494, "num_episodes_lifetime": 1096, "rlmodule_inference_timer": 0.0005807981370777518, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5335341880341882, "env_to_module_sum_episodes_length_out": 92.87054867860904, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1136952095600123, "num_env_steps_sampled_lifetime": 238000, "weights_seq_no": 118.0, "agent_episode_returns_mean": {"default_agent": 0.5335341880341882}, "module_episode_returns_mean": {"default_policy": 0.5335341880341882}, "num_env_steps_sampled": 2000, "sample": 29.668067232885157, "env_to_module_sum_episodes_length_in": 92.87054867860904, "time_between_sampling": 11.540348483345074, "num_env_steps_sampled_lifetime_throughput": 48.76712251718992}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.14849786460399628, "weights_seq_no": 119.0, "vf_loss_unclipped": 0.0032319528982043266, "total_loss": 0.15172982215881348, "gradients_default_optimizer_global_norm": 0.3647812306880951, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07752758264541626, "entropy": 0.05562235042452812, "curr_kl_coeff": 3.7223129044000443e-25, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0013597519136965275, "num_module_steps_trained_lifetime": 7209088, "vf_loss": 0.0032319528982043266}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04846896718662668, "add_observations_from_episodes_to_batch": 0.0003671551445198095, "add_one_ts_to_episodes_and_truncate": 0.007017652148480807, "add_columns_from_episodes_to_train_batch": 0.07975303600202853, "general_advantage_estimation": 0.09546035273183495, "add_states_from_episodes_to_batch": 1.1282893731194633e-05, "numpy_to_tensor": 0.0013374316946356637, "add_time_dim_to_batch_and_zero_pad": 3.1931344415030515e-05}}, "connector_pipeline_timer": 0.232987512904057}, "num_module_steps_trained_lifetime": 7209088, "learner_connector_sum_episodes_length_out": 2016.4025132370407, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 113607736, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 238000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.76712251718992, "done": false, "training_iteration": 119, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-14-09", "timestamp": 1747696449, "time_this_iter_s": 40.93218111991882, "time_total_s": 4770.8124322891235, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4770.8124322891235, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 79.61206896551724, "ram_util_percent": 52.51724137931034}}
{"timers": {"training_iteration": 41.09256104122472, "restore_env_runners": 2.8318727349289815e-05, "training_step": 41.09202216117461, "env_runner_sampling_timer": 31.337683628963145, "learner_update_timer": 9.742985157257527, "synch_weights": 0.010251711140562182, "synch_env_connectors": 0.009297227659487995}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2869999999999999, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016757782351938637, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.078892697068247e-06, "un_batch_to_individual_items": 7.733170873806442e-05, "listify_data_for_vector_env": 0.0001444080822449529, "normalize_and_clip_actions": 0.00013091609757918618, "get_actions": 0.0007454770989224401, "tensor_to_numpy": 0.00023459732268955218}}}, "num_module_steps_sampled_lifetime": {"default_policy": 240000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 240000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.241343814230032e-05, "add_states_from_episodes_to_batch": 2.22136875757406e-05, "numpy_to_tensor": 0.0001677314622740948, "add_time_dim_to_batch_and_zero_pad": 4.0580493543925564e-05, "batch_individual_items": 9.851587196826462e-05}}, "connector_pipeline_timer": 0.0006286908774882049}, "episode_return_max": 0.7700000000000001, "episode_duration_sec_mean": 24.623213450047913, "num_episodes_lifetime": 1104, "rlmodule_inference_timer": 0.0005804152684572946, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5233141025641026, "env_to_module_sum_episodes_length_out": 94.71835386281273, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11314794509140108, "num_env_steps_sampled_lifetime": 240000, "weights_seq_no": 119.0, "agent_episode_returns_mean": {"default_agent": 0.5233141025641026}, "module_episode_returns_mean": {"default_policy": 0.5233141025641026}, "num_env_steps_sampled": 2000, "sample": 29.67688108729631, "env_to_module_sum_episodes_length_in": 94.71835386281273, "time_between_sampling": 11.53108061013739, "num_env_steps_sampled_lifetime_throughput": 49.021009303331326}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.25457432866096497, "weights_seq_no": 120.0, "vf_loss_unclipped": 0.0049482593312859535, "total_loss": -0.2496260553598404, "gradients_default_optimizer_global_norm": 0.21044468879699707, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.030810952186584473, "entropy": 0.046909626573324203, "curr_kl_coeff": 1.8611564522000221e-25, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0021530715748667717, "num_module_steps_trained_lifetime": 7269632, "vf_loss": 0.0049482593312859535}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.048559465130848384, "add_observations_from_episodes_to_batch": 0.0003672643146251816, "add_one_ts_to_episodes_and_truncate": 0.007013027734686631, "add_columns_from_episodes_to_train_batch": 0.07977062843346744, "general_advantage_estimation": 0.09501220336096529, "add_states_from_episodes_to_batch": 1.1288931588649375e-05, "numpy_to_tensor": 0.0013376661851179884, "add_time_dim_to_batch_and_zero_pad": 3.1959359003396404e-05}}, "connector_pipeline_timer": 0.2326424666656246}, "num_module_steps_trained_lifetime": 7269632, "learner_connector_sum_episodes_length_out": 2016.4061653184708, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 114561304, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 240000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.021009303331326, "done": false, "training_iteration": 120, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-14-50", "timestamp": 1747696490, "time_this_iter_s": 40.72410988807678, "time_total_s": 4811.5365421772, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4811.5365421772, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 76.52586206896552, "ram_util_percent": 52.58620689655172}}
{"timers": {"training_iteration": 41.108345901072475, "restore_env_runners": 2.8240540108816962e-05, "training_step": 41.1078073978229, "env_runner_sampling_timer": 31.352253412213457, "learner_update_timer": 9.744253506404906, "synch_weights": 0.010198885029178553, "synch_env_connectors": 0.009286283382926575}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3110000000000009, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016739020812688806, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.996052666193022e-06, "un_batch_to_individual_items": 7.696935072969998e-05, "listify_data_for_vector_env": 0.00014629125588534395, "normalize_and_clip_actions": 0.00012988216902745975, "get_actions": 0.0007451838221995018, "tensor_to_numpy": 0.00023298689160442857}}}, "num_module_steps_sampled_lifetime": {"default_policy": 242000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 242000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.238671408034961e-05, "add_states_from_episodes_to_batch": 2.1739839097888262e-05, "numpy_to_tensor": 0.00016764531817207355, "add_time_dim_to_batch_and_zero_pad": 3.993611347093401e-05, "batch_individual_items": 9.761949385280609e-05}}, "connector_pipeline_timer": 0.0006268052883773895}, "episode_return_max": 0.7018888888888907, "episode_duration_sec_mean": 23.932714058346253, "num_episodes_lifetime": 1120, "rlmodule_inference_timer": 0.0005785128012659428, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.4937200854700861, "env_to_module_sum_episodes_length_out": 97.05466286991968, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11390995457010389, "num_env_steps_sampled_lifetime": 242000, "weights_seq_no": 120.0, "agent_episode_returns_mean": {"default_agent": 0.4937200854700861}, "module_episode_returns_mean": {"default_policy": 0.4937200854700861}, "num_env_steps_sampled": 2000, "sample": 29.686466332319, "env_to_module_sum_episodes_length_in": 97.05466286991968, "time_between_sampling": 11.522372159370393, "num_env_steps_sampled_lifetime_throughput": 46.65171908219307}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.04220256209373474, "weights_seq_no": 121.0, "vf_loss_unclipped": 0.006982340477406979, "total_loss": -0.035220205783843994, "gradients_default_optimizer_global_norm": 0.25254717469215393, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.02338474988937378, "entropy": 0.061170097440481186, "curr_kl_coeff": 9.305782261000111e-26, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004258797038346529, "num_module_steps_trained_lifetime": 7330432, "vf_loss": 0.006982340477406979}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04864766637946647, "add_observations_from_episodes_to_batch": 0.00036738670581432196, "add_one_ts_to_episodes_and_truncate": 0.007008452153953713, "add_columns_from_episodes_to_train_batch": 0.07978822962277676, "general_advantage_estimation": 0.09456433939223953, "add_states_from_episodes_to_batch": 1.1295080399751272e-05, "numpy_to_tensor": 0.0013378606926214263, "add_time_dim_to_batch_and_zero_pad": 3.198736016565544e-05}}, "connector_pipeline_timer": 0.23229543579077017}, "num_module_steps_trained_lifetime": 7330432, "learner_connector_sum_episodes_length_out": 2016.4105041069486, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 115522704, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 242000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.65171908219307, "done": false, "training_iteration": 121, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-15-33", "timestamp": 1747696533, "time_this_iter_s": 42.68835210800171, "time_total_s": 4854.224894285202, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4854.224894285202, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 77.22950819672128, "ram_util_percent": 52.58688524590164}}
{"timers": {"training_iteration": 41.09999212428169, "restore_env_runners": 2.818513468998896e-05, "training_step": 41.09945362206465, "env_runner_sampling_timer": 31.349448405261377, "learner_update_timer": 9.738721598390876, "synch_weights": 0.01018005517894659, "synch_env_connectors": 0.009283814549096233}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2948888888888889, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016719000008230264, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.868621970377221e-06, "un_batch_to_individual_items": 7.680133480098107e-05, "listify_data_for_vector_env": 0.00014639277147004116, "normalize_and_clip_actions": 0.00012885413994089204, "get_actions": 0.0007448891947034384, "tensor_to_numpy": 0.00023298072298431793}}}, "num_module_steps_sampled_lifetime": {"default_policy": 244000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 244000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.180833327206127e-05, "add_states_from_episodes_to_batch": 2.1309474183034508e-05, "numpy_to_tensor": 0.00016786599844036717, "add_time_dim_to_batch_and_zero_pad": 4.0295494868920297e-05, "batch_individual_items": 9.841974351207356e-05}}, "connector_pipeline_timer": 0.0006261900577489016}, "episode_return_max": 0.7477777777777798, "episode_duration_sec_mean": 23.989318352237486, "num_episodes_lifetime": 1128, "rlmodule_inference_timer": 0.0005774398480426856, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4781378205128212, "env_to_module_sum_episodes_length_out": 96.86987127269667, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11454752819431022, "num_env_steps_sampled_lifetime": 244000, "weights_seq_no": 121.0, "agent_episode_returns_mean": {"default_agent": 0.4781378205128212}, "module_episode_returns_mean": {"default_policy": 0.4781378205128212}, "num_env_steps_sampled": 2000, "sample": 29.695609928272848, "env_to_module_sum_episodes_length_in": 96.86987127269667, "time_between_sampling": 11.51408350437821, "num_env_steps_sampled_lifetime_throughput": 49.560941450958815}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.09458396583795547, "weights_seq_no": 122.0, "vf_loss_unclipped": 0.005334197077900171, "total_loss": 0.0999181717634201, "gradients_default_optimizer_global_norm": 0.1626233458518982, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.0304948091506958, "entropy": 0.06897833198308945, "curr_kl_coeff": 4.6528911305000553e-26, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0010855699656531215, "num_module_steps_trained_lifetime": 7390976, "vf_loss": 0.005334197077900171}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.048733357816499415, "add_observations_from_episodes_to_batch": 0.00036751863274877276, "add_one_ts_to_episodes_and_truncate": 0.007004082192062344, "add_columns_from_episodes_to_train_batch": 0.0798056061753564, "general_advantage_estimation": 0.09411688221255195, "add_states_from_episodes_to_batch": 1.130104734161622e-05, "numpy_to_tensor": 0.0013380193233563974, "add_time_dim_to_batch_and_zero_pad": 3.201445536864239e-05}}, "connector_pipeline_timer": 0.23194625464654633}, "num_module_steps_trained_lifetime": 7390976, "learner_connector_sum_episodes_length_out": 2016.414715503125, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 116476272, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 244000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.560941450958815, "done": false, "training_iteration": 122, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-16-13", "timestamp": 1747696573, "time_this_iter_s": 40.288063526153564, "time_total_s": 4894.512957811356, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4894.512957811356, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 78.47719298245613, "ram_util_percent": 52.52280701754386}}
{"timers": {"training_iteration": 41.09386888127891, "restore_env_runners": 2.8097283292349684e-05, "training_step": 41.093330428084, "env_runner_sampling_timer": 31.34819694263873, "learner_update_timer": 9.733731710206957, "synch_weights": 0.01029811663713784, "synch_env_connectors": 0.00925956340359229}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2948888888888889, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016694554363208805, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.754201147514629e-06, "un_batch_to_individual_items": 7.650441543277299e-05, "listify_data_for_vector_env": 0.00014587363958382596, "normalize_and_clip_actions": 0.00012754650281027887, "get_actions": 0.0007436243001644531, "tensor_to_numpy": 0.00023443745562190817}}}, "num_module_steps_sampled_lifetime": {"default_policy": 246000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 246000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.281711849070507e-05, "add_states_from_episodes_to_batch": 2.0999328259320384e-05, "numpy_to_tensor": 0.00016843688988894178, "add_time_dim_to_batch_and_zero_pad": 4.0019544520144114e-05, "batch_individual_items": 0.00010050313192173921}}, "connector_pipeline_timer": 0.0006276022718720382}, "episode_return_max": 0.805222222222224, "episode_duration_sec_mean": 24.19329219580637, "num_episodes_lifetime": 1136, "rlmodule_inference_timer": 0.0005764702541241897, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5067500000000007, "env_to_module_sum_episodes_length_out": 95.00606473331294, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11469484108899596, "num_env_steps_sampled_lifetime": 246000, "weights_seq_no": 122.0, "agent_episode_returns_mean": {"default_agent": 0.5067500000000007}, "module_episode_returns_mean": {"default_policy": 0.5067500000000007}, "num_env_steps_sampled": 2000, "sample": 29.704431983277168, "env_to_module_sum_episodes_length_in": 95.00606473331294, "time_between_sampling": 11.505470988900953, "num_env_steps_sampled_lifetime_throughput": 49.29774545232475}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07434411346912384, "weights_seq_no": 123.0, "vf_loss_unclipped": 0.004873625934123993, "total_loss": 0.07921774685382843, "gradients_default_optimizer_global_norm": 0.8904919624328613, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.15255337953567505, "entropy": 0.05362318456172943, "curr_kl_coeff": 2.3264455652500277e-26, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0009717736975289881, "num_module_steps_trained_lifetime": 7451520, "vf_loss": 0.004873625934123993}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.048817126208253896, "add_observations_from_episodes_to_batch": 0.0003676615724742044, "add_one_ts_to_episodes_and_truncate": 0.006999622394193208, "add_columns_from_episodes_to_train_batch": 0.07982287761412267, "general_advantage_estimation": 0.09367003905251875, "add_states_from_episodes_to_batch": 1.1306895436477124e-05, "numpy_to_tensor": 0.0013381662855079567, "add_time_dim_to_batch_and_zero_pad": 3.204063993127418e-05}}, "connector_pipeline_timer": 0.23159557136202788}, "num_module_steps_trained_lifetime": 7451520, "learner_connector_sum_episodes_length_out": 2016.418801620967, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 117429840, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 246000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.29774545232475, "done": false, "training_iteration": 123, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-16-54", "timestamp": 1747696614, "time_this_iter_s": 40.520891189575195, "time_total_s": 4935.033849000931, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4935.033849000931, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 78.92456140350878, "ram_util_percent": 52.515789473684215}}
{"timers": {"training_iteration": 41.09133687881618, "restore_env_runners": 2.8089310500914746e-05, "training_step": 41.09079705915319, "env_runner_sampling_timer": 31.349309939242325, "learner_update_timer": 9.730064131424909, "synch_weights": 0.010321098470721398, "synch_env_connectors": 0.009361860769563508}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3045555555555557, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001673066042731523, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.688590555877437e-06, "un_batch_to_individual_items": 7.673947602703044e-05, "listify_data_for_vector_env": 0.0001464006354930086, "normalize_and_clip_actions": 0.00012882678305333096, "get_actions": 0.0007453901996005668, "tensor_to_numpy": 0.0002360300099894887}}}, "num_module_steps_sampled_lifetime": {"default_policy": 248000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 248000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3906924386038495e-05, "add_states_from_episodes_to_batch": 2.095026576886149e-05, "numpy_to_tensor": 0.00016882014458643695, "add_time_dim_to_batch_and_zero_pad": 3.970677880469964e-05, "batch_individual_items": 0.00010028143463723848}}, "connector_pipeline_timer": 0.0006284210627916352}, "episode_return_max": 0.9182222222222223, "episode_duration_sec_mean": 24.03322392991413, "num_episodes_lifetime": 1144, "rlmodule_inference_timer": 0.0005796843530849093, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5304455128205132, "env_to_module_sum_episodes_length_out": 93.18461887024247, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.114713205886465, "num_env_steps_sampled_lifetime": 248000, "weights_seq_no": 123.0, "agent_episode_returns_mean": {"default_agent": 0.5304455128205132}, "module_episode_returns_mean": {"default_policy": 0.5304455128205132}, "num_env_steps_sampled": 2000, "sample": 29.713212704892577, "env_to_module_sum_episodes_length_in": 93.18461887024247, "time_between_sampling": 11.496679205471686, "num_env_steps_sampled_lifetime_throughput": 48.82497827306546}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.005722074303776026, "weights_seq_no": 124.0, "vf_loss_unclipped": 0.005804260727018118, "total_loss": 0.011526349931955338, "gradients_default_optimizer_global_norm": 0.3178562521934509, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07496219873428345, "entropy": 0.056737020611763, "curr_kl_coeff": 1.1632227826250138e-26, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0033592628315091133, "num_module_steps_trained_lifetime": 7512064, "vf_loss": 0.005804260727018118}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.048898921116291925, "add_observations_from_episodes_to_batch": 0.0003677995115420005, "add_one_ts_to_episodes_and_truncate": 0.006995144194062192, "add_columns_from_episodes_to_train_batch": 0.07984001709319617, "general_advantage_estimation": 0.09322388022746492, "add_states_from_episodes_to_batch": 1.1312906464529148e-05, "numpy_to_tensor": 0.001338281556484424, "add_time_dim_to_batch_and_zero_pad": 3.2071339357286655e-05}}, "connector_pipeline_timer": 0.231243414037335}, "num_module_steps_trained_lifetime": 7512064, "learner_connector_sum_episodes_length_out": 2016.422764544902, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 118383408, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 248000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.82497827306546, "done": false, "training_iteration": 124, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-17-35", "timestamp": 1747696655, "time_this_iter_s": 40.85626196861267, "time_total_s": 4975.8901109695435, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4975.8901109695435, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 78.42931034482758, "ram_util_percent": 52.58620689655173}}
{"timers": {"training_iteration": 41.08078727800803, "restore_env_runners": 2.80744173840927e-05, "training_step": 41.08024694854166, "env_runner_sampling_timer": 31.341756465409958, "learner_update_timer": 9.727076962530623, "synch_weights": 0.010313488486007806, "synch_env_connectors": 0.009353002161822131}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3045555555555557, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016747136753218817, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.763170708221725e-06, "un_batch_to_individual_items": 7.607945112487461e-05, "listify_data_for_vector_env": 0.00014587901942759033, "normalize_and_clip_actions": 0.00012872670782653565, "get_actions": 0.0007456867941529012, "tensor_to_numpy": 0.00023863759814551184}}}, "num_module_steps_sampled_lifetime": {"default_policy": 250000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 250000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.4284296679191635e-05, "add_states_from_episodes_to_batch": 2.07043968975173e-05, "numpy_to_tensor": 0.00016876781300311693, "add_time_dim_to_batch_and_zero_pad": 3.9167481825598794e-05, "batch_individual_items": 9.95377419070109e-05}}, "connector_pipeline_timer": 0.0006291019563696862}, "episode_return_max": 0.9182222222222223, "episode_duration_sec_mean": 24.013329693048245, "num_episodes_lifetime": 1152, "rlmodule_inference_timer": 0.0005779229662176396, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.544681623931624, "env_to_module_sum_episodes_length_out": 92.5245620427042, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11437638380965821, "num_env_steps_sampled_lifetime": 250000, "weights_seq_no": 124.0, "agent_episode_returns_mean": {"default_agent": 0.544681623931624}, "module_episode_returns_mean": {"default_policy": 0.544681623931624}, "num_env_steps_sampled": 2000, "sample": 29.721474962602766, "env_to_module_sum_episodes_length_in": 92.5245620427042, "time_between_sampling": 11.487706177823917, "num_env_steps_sampled_lifetime_throughput": 49.8587833500049}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.04756730794906616, "weights_seq_no": 125.0, "vf_loss_unclipped": 0.00442163972184062, "total_loss": 0.051988959312438965, "gradients_default_optimizer_global_norm": 0.3085107207298279, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.11977297067642212, "entropy": 0.057426076382398605, "curr_kl_coeff": 5.816113913125069e-27, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0012993261916562915, "num_module_steps_trained_lifetime": 7572608, "vf_loss": 0.00442163972184062}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.048979355173548324, "add_observations_from_episodes_to_batch": 0.0003679300356712225, "add_one_ts_to_episodes_and_truncate": 0.006990599605694535, "add_columns_from_episodes_to_train_batch": 0.0798567193049269, "general_advantage_estimation": 0.09277845915500658, "add_states_from_episodes_to_batch": 1.1318716582468147e-05, "numpy_to_tensor": 0.0013384234854124752, "add_time_dim_to_batch_and_zero_pad": 3.2101110730963776e-05}}, "connector_pipeline_timer": 0.2308901471320003}, "num_module_steps_trained_lifetime": 7572608, "learner_connector_sum_episodes_length_out": 2016.4266063301961, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 119336976, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 250000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.8587833500049, "done": false, "training_iteration": 125, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-18-15", "timestamp": 1747696695, "time_this_iter_s": 40.05058717727661, "time_total_s": 5015.94069814682, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5015.94069814682, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 78.23333333333333, "ram_util_percent": 52.61578947368421}}
{"timers": {"training_iteration": 41.09023947661795, "restore_env_runners": 2.7990673255115443e-05, "training_step": 41.08969960644621, "env_runner_sampling_timer": 31.35254658116582, "learner_update_timer": 9.725784560885376, "synch_weights": 0.010270204601116785, "synch_env_connectors": 0.009334284140151907}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3486666666666668, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016722277790974054, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.766711794325441e-06, "un_batch_to_individual_items": 7.608913469658811e-05, "listify_data_for_vector_env": 0.0001445962679668764, "normalize_and_clip_actions": 0.00012866348917791573, "get_actions": 0.0007472269118932981, "tensor_to_numpy": 0.000237446907486113}}}, "num_module_steps_sampled_lifetime": {"default_policy": 252000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 252000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.369110400405761e-05, "add_states_from_episodes_to_batch": 2.1131019540467854e-05, "numpy_to_tensor": 0.00016889751363268648, "add_time_dim_to_batch_and_zero_pad": 3.902982706318266e-05, "batch_individual_items": 9.946541432950182e-05}}, "connector_pipeline_timer": 0.0006297341474465907}, "episode_return_max": 0.8056666666666663, "episode_duration_sec_mean": 24.552797201586493, "num_episodes_lifetime": 1160, "rlmodule_inference_timer": 0.0005816299563301344, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5724230769230771, "env_to_module_sum_episodes_length_out": 93.66224629659585, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11387666681131131, "num_env_steps_sampled_lifetime": 252000, "weights_seq_no": 125.0, "agent_episode_returns_mean": {"default_agent": 0.5724230769230771}, "module_episode_returns_mean": {"default_policy": 0.5724230769230771}, "num_env_steps_sampled": 2000, "sample": 29.729888900904612, "env_to_module_sum_episodes_length_in": 93.66224629659585, "time_between_sampling": 11.478433242741431, "num_env_steps_sampled_lifetime_throughput": 47.49530206986997}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.14046531915664673, "weights_seq_no": 126.0, "vf_loss_unclipped": 0.007279244717210531, "total_loss": -0.13318607211112976, "gradients_default_optimizer_global_norm": 0.725638210773468, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.12105011940002441, "entropy": 0.08304786682128906, "curr_kl_coeff": 2.9080569565625346e-27, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0012834192020818591, "num_module_steps_trained_lifetime": 7633152, "vf_loss": 0.007279244717210531}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0490582995675477, "add_observations_from_episodes_to_batch": 0.00036805181936653186, "add_one_ts_to_episodes_and_truncate": 0.006985985264674406, "add_columns_from_episodes_to_train_batch": 0.07987386099081403, "general_advantage_estimation": 0.09233375420597448, "add_states_from_episodes_to_batch": 1.132442920742743e-05, "numpy_to_tensor": 0.0013385465476061786, "add_time_dim_to_batch_and_zero_pad": 3.2130019543062764e-05}}, "connector_pipeline_timer": 0.23053644179346866}, "num_module_steps_trained_lifetime": 7633152, "learner_connector_sum_episodes_length_out": 2016.43032900333, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 120290544, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.49530206986997, "done": false, "training_iteration": 126, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-18-57", "timestamp": 1747696737, "time_this_iter_s": 42.04281306266785, "time_total_s": 5057.983511209488, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5057.983511209488, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 76.86500000000001, "ram_util_percent": 52.63333333333333}}
{"timers": {"training_iteration": 41.082796856531786, "restore_env_runners": 2.7977766518365887e-05, "training_step": 41.08225550806171, "env_runner_sampling_timer": 31.34797998553416, "learner_update_timer": 9.722932098776504, "synch_weights": 0.010244314555148609, "synch_env_connectors": 0.009330393298706897}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3342222222222227, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016684717637526721, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.752301629208772e-06, "un_batch_to_individual_items": 7.582386270581153e-05, "listify_data_for_vector_env": 0.00014326583196452505, "normalize_and_clip_actions": 0.00012830823660893236, "get_actions": 0.0007439682061228165, "tensor_to_numpy": 0.00023852093575191512}}}, "num_module_steps_sampled_lifetime": {"default_policy": 254000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 254000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3578627027556364e-05, "add_states_from_episodes_to_batch": 2.098541737050041e-05, "numpy_to_tensor": 0.0001692922559085613, "add_time_dim_to_batch_and_zero_pad": 3.9148041776674044e-05, "batch_individual_items": 9.878491310414052e-05}}, "connector_pipeline_timer": 0.0006292770994282403}, "episode_return_max": 0.8056666666666663, "episode_duration_sec_mean": 24.115549726461023, "num_episodes_lifetime": 1168, "rlmodule_inference_timer": 0.0005797263346657449, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5569412393162397, "env_to_module_sum_episodes_length_out": 96.91874906657739, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11321272925207856, "num_env_steps_sampled_lifetime": 254000, "weights_seq_no": 126.0, "agent_episode_returns_mean": {"default_agent": 0.5569412393162397}, "module_episode_returns_mean": {"default_policy": 0.5569412393162397}, "num_env_steps_sampled": 2000, "sample": 29.737529291147453, "env_to_module_sum_episodes_length_in": 96.91874906657739, "time_between_sampling": 11.469800787296105, "num_env_steps_sampled_lifetime_throughput": 49.463317968386534}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.052136171609163284, "weights_seq_no": 127.0, "vf_loss_unclipped": 0.008013381622731686, "total_loss": -0.04412279278039932, "gradients_default_optimizer_global_norm": 0.21290360391139984, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.08839315176010132, "entropy": 0.04044974222779274, "curr_kl_coeff": 1.4540284782812673e-27, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0014669857919216156, "num_module_steps_trained_lifetime": 7693696, "vf_loss": 0.008013381622731686}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.049135317418149714, "add_observations_from_episodes_to_batch": 0.0003681660643841094, "add_one_ts_to_episodes_and_truncate": 0.006981304480514623, "add_columns_from_episodes_to_train_batch": 0.07989096486105249, "general_advantage_estimation": 0.09188962509000698, "add_states_from_episodes_to_batch": 1.1330175707789493e-05, "numpy_to_tensor": 0.0013387141362077844, "add_time_dim_to_batch_and_zero_pad": 3.2164650067500934e-05}}, "connector_pipeline_timer": 0.2301813296369943}, "num_module_steps_trained_lifetime": 7693696, "learner_connector_sum_episodes_length_out": 2016.433934562368, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 121244112, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 254000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.463317968386534, "done": false, "training_iteration": 127, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-19-37", "timestamp": 1747696777, "time_this_iter_s": 40.363044023513794, "time_total_s": 5098.346555233002, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5098.346555233002, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 77.65789473684211, "ram_util_percent": 52.6859649122807}}
{"timers": {"training_iteration": 41.10267233850649, "restore_env_runners": 2.7919988870129507e-05, "training_step": 41.10213043352106, "env_runner_sampling_timer": 31.368023820818827, "learner_update_timer": 9.722805174188744, "synch_weights": 0.010203376409573145, "synch_env_connectors": 0.009325363365728652}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3362222222222233, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016707823487241873, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.948189204260362e-06, "un_batch_to_individual_items": 7.500020190958253e-05, "listify_data_for_vector_env": 0.00014323820650910136, "normalize_and_clip_actions": 0.0001271113648342884, "get_actions": 0.0007438185967663264, "tensor_to_numpy": 0.00023998054161753618}}}, "num_module_steps_sampled_lifetime": {"default_policy": 256000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 256000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.445268271613688e-05, "add_states_from_episodes_to_batch": 2.0889606575904427e-05, "numpy_to_tensor": 0.0001673233672795773, "add_time_dim_to_batch_and_zero_pad": 3.9055450370149246e-05, "batch_individual_items": 9.78571750909314e-05}}, "connector_pipeline_timer": 0.0006286388003638482}, "episode_return_max": 0.8046666666666683, "episode_duration_sec_mean": 24.03949793576878, "num_episodes_lifetime": 1184, "rlmodule_inference_timer": 0.00058102039464269, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5085138888888898, "env_to_module_sum_episodes_length_out": 97.74746009308343, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11399199514698409, "num_env_steps_sampled_lifetime": 256000, "weights_seq_no": 127.0, "agent_episode_returns_mean": {"default_agent": 0.5085138888888898}, "module_episode_returns_mean": {"default_policy": 0.5085138888888898}, "num_env_steps_sampled": 2000, "sample": 29.74642795813695, "env_to_module_sum_episodes_length_in": 97.74746009308343, "time_between_sampling": 11.46136477312611, "num_env_steps_sampled_lifetime_throughput": 46.3468801041193}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.05889994651079178, "weights_seq_no": 128.0, "vf_loss_unclipped": 0.006656254641711712, "total_loss": -0.0522436760365963, "gradients_default_optimizer_global_norm": 0.19006696343421936, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.025236785411834717, "entropy": 0.057764727622270584, "curr_kl_coeff": 7.2701423914063365e-28, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0035203243605792522, "num_module_steps_trained_lifetime": 7754496, "vf_loss": 0.006656254641711712}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04921007273188266, "add_observations_from_episodes_to_batch": 0.00036829988931939725, "add_one_ts_to_episodes_and_truncate": 0.006976889533511114, "add_columns_from_episodes_to_train_batch": 0.07990775893788683, "general_advantage_estimation": 0.09144602683093803, "add_states_from_episodes_to_batch": 1.1335904835130654e-05, "numpy_to_tensor": 0.0013388485583824578, "add_time_dim_to_batch_and_zero_pad": 3.219810497991091e-05}}, "connector_pipeline_timer": 0.22982442351967058}, "num_module_steps_trained_lifetime": 7754496, "learner_connector_sum_episodes_length_out": 2016.438224977325, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 122205512, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 256000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.3468801041193, "done": false, "training_iteration": 128, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-20-20", "timestamp": 1747696820, "time_this_iter_s": 43.08895182609558, "time_total_s": 5141.435507059097, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5141.435507059097, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 77.22741935483872, "ram_util_percent": 52.6758064516129}}
{"timers": {"training_iteration": 41.099949900601395, "restore_env_runners": 2.7854789010219117e-05, "training_step": 41.09940872766586, "env_runner_sampling_timer": 31.36741651688066, "learner_update_timer": 9.720710681656865, "synch_weights": 0.010181536645442973, "synch_env_connectors": 0.0093309017420292}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3362222222222233, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016763818918173617, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.963334455122443e-06, "un_batch_to_individual_items": 7.63303895885085e-05, "listify_data_for_vector_env": 0.00014384666984835635, "normalize_and_clip_actions": 0.0001275960377287684, "get_actions": 0.000745608801088593, "tensor_to_numpy": 0.00024183910284556042}}}, "num_module_steps_sampled_lifetime": {"default_policy": 258000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 258000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3878847282008865e-05, "add_states_from_episodes_to_batch": 2.0866509966403924e-05, "numpy_to_tensor": 0.00016950669254561803, "add_time_dim_to_batch_and_zero_pad": 3.884435367034356e-05, "batch_individual_items": 9.768895246479923e-05}}, "connector_pipeline_timer": 0.0006288617383692919}, "episode_return_max": 0.7936666666666683, "episode_duration_sec_mean": 24.278984218227517, "num_episodes_lifetime": 1192, "rlmodule_inference_timer": 0.0005804447256973988, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5063611111111117, "env_to_module_sum_episodes_length_out": 96.21647546985457, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11427517868434751, "num_env_steps_sampled_lifetime": 258000, "weights_seq_no": 128.0, "agent_episode_returns_mean": {"default_agent": 0.5063611111111117}, "module_episode_returns_mean": {"default_policy": 0.5063611111111117}, "num_env_steps_sampled": 2000, "sample": 29.75510867629869, "env_to_module_sum_episodes_length_in": 96.21647546985457, "time_between_sampling": 11.453256750694063, "num_env_steps_sampled_lifetime_throughput": 48.8746643371717}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.08518081158399582, "weights_seq_no": 129.0, "vf_loss_unclipped": 0.00716035719960928, "total_loss": 0.09234119951725006, "gradients_default_optimizer_global_norm": 0.5080417990684509, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10852599143981934, "entropy": 0.07762406021356583, "curr_kl_coeff": 3.6350711957031682e-28, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0038252610247582197, "num_module_steps_trained_lifetime": 7815040, "vf_loss": 0.00716035719960928}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.049282922417699, "add_observations_from_episodes_to_batch": 0.00036843303114892793, "add_one_ts_to_episodes_and_truncate": 0.0069724073349998065, "add_columns_from_episodes_to_train_batch": 0.07992465898669857, "general_advantage_estimation": 0.09100309179454165, "add_states_from_episodes_to_batch": 1.1341506362151296e-05, "numpy_to_tensor": 0.0013389698807000484, "add_time_dim_to_batch_and_zero_pad": 3.223442432880448e-05}}, "connector_pipeline_timer": 0.22946630760182996}, "num_module_steps_trained_lifetime": 7815040, "learner_connector_sum_episodes_length_out": 2016.4423861905266, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 123159080, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 258000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.8746643371717, "done": false, "training_iteration": 129, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-21-01", "timestamp": 1747696861, "time_this_iter_s": 40.847790479660034, "time_total_s": 5182.283297538757, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5182.283297538757, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 78.05172413793102, "ram_util_percent": 52.643103448275866}}
{"timers": {"training_iteration": 41.09472491743533, "restore_env_runners": 2.785324111930388e-05, "training_step": 41.09418310222919, "env_runner_sampling_timer": 31.364174331511833, "learner_update_timer": 9.71875993388029, "synch_weights": 0.01014944027893678, "synch_env_connectors": 0.009313458724651787}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3533333333333337, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016719794613552943, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.879304509391029e-06, "un_batch_to_individual_items": 7.625029072758457e-05, "listify_data_for_vector_env": 0.00014335841882059052, "normalize_and_clip_actions": 0.0001272333012581495, "get_actions": 0.0007441461284167349, "tensor_to_numpy": 0.00024080079365791218}}}, "num_module_steps_sampled_lifetime": {"default_policy": 260000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 260000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.398604913110241e-05, "add_states_from_episodes_to_batch": 2.046168492913636e-05, "numpy_to_tensor": 0.00017008222405688424, "add_time_dim_to_batch_and_zero_pad": 3.955154352839711e-05, "batch_individual_items": 9.757269923491118e-05}}, "connector_pipeline_timer": 0.0006304028455421087}, "episode_return_max": 0.7936666666666683, "episode_duration_sec_mean": 24.003973138633928, "num_episodes_lifetime": 1200, "rlmodule_inference_timer": 0.0005802840217952931, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5414059829059833, "env_to_module_sum_episodes_length_out": 94.18465983002719, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11403744489810475, "num_env_steps_sampled_lifetime": 260000, "weights_seq_no": 129.0, "agent_episode_returns_mean": {"default_agent": 0.5414059829059833}, "module_episode_returns_mean": {"default_policy": 0.5414059829059833}, "num_env_steps_sampled": 2000, "sample": 29.762909514355478, "env_to_module_sum_episodes_length_in": 94.18465983002719, "time_between_sampling": 11.445073757707878, "num_env_steps_sampled_lifetime_throughput": 49.192276732548535}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.006144993007183075, "weights_seq_no": 130.0, "vf_loss_unclipped": 0.003969644196331501, "total_loss": -0.00217534601688385, "gradients_default_optimizer_global_norm": 0.26988762617111206, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05736339092254639, "entropy": 0.056496188044548035, "curr_kl_coeff": 1.8175355978515841e-28, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002193823689594865, "num_module_steps_trained_lifetime": 7875584, "vf_loss": 0.003969644196331501}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04935404882252579, "add_observations_from_episodes_to_batch": 0.00036856025015244095, "add_one_ts_to_episodes_and_truncate": 0.0069680489215052325, "add_columns_from_episodes_to_train_batch": 0.0799420446586404, "general_advantage_estimation": 0.09056081694619017, "add_states_from_episodes_to_batch": 1.1347062267826659e-05, "numpy_to_tensor": 0.0013391253817148856, "add_time_dim_to_batch_and_zero_pad": 3.227353747988457e-05}}, "connector_pipeline_timer": 0.2291077729799943}, "num_module_steps_trained_lifetime": 7875584, "learner_connector_sum_episodes_length_out": 2016.4464203569664, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 124112648, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 260000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.192276732548535, "done": false, "training_iteration": 130, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-21-42", "timestamp": 1747696902, "time_this_iter_s": 40.59491801261902, "time_total_s": 5222.878215551376, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5222.878215551376, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 77.22807017543862, "ram_util_percent": 52.67368421052631}}
{"timers": {"training_iteration": 41.09026316912097, "restore_env_runners": 2.785570873775577e-05, "training_step": 41.08972140206689, "env_runner_sampling_timer": 31.36169146408667, "learner_update_timer": 9.716785000511518, "synch_weights": 0.010146804876138038, "synch_env_connectors": 0.009299612137384256}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.34655555555555595, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016709585206234208, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.051733046520017e-06, "un_batch_to_individual_items": 7.51975620161283e-05, "listify_data_for_vector_env": 0.00014306013367426247, "normalize_and_clip_actions": 0.0001278933482696871, "get_actions": 0.0007464227117445428, "tensor_to_numpy": 0.00023962703466480639}}}, "num_module_steps_sampled_lifetime": {"default_policy": 262000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 262000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.360199361571056e-05, "add_states_from_episodes_to_batch": 2.0408954141663162e-05, "numpy_to_tensor": 0.00017181065433122413, "add_time_dim_to_batch_and_zero_pad": 3.9370701650686836e-05, "batch_individual_items": 9.67375000696584e-05}}, "connector_pipeline_timer": 0.0006298712537713497}, "episode_return_max": 0.7286666666666672, "episode_duration_sec_mean": 23.567128111443147, "num_episodes_lifetime": 1208, "rlmodule_inference_timer": 0.000581198671942187, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5021623931623935, "env_to_module_sum_episodes_length_out": 92.98691178025373, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11387327718960971, "num_env_steps_sampled_lifetime": 262000, "weights_seq_no": 130.0, "agent_episode_returns_mean": {"default_agent": 0.5021623931623935}, "module_episode_returns_mean": {"default_policy": 0.5021623931623935}, "num_env_steps_sampled": 2000, "sample": 29.7703598421121, "env_to_module_sum_episodes_length_in": 92.98691178025373, "time_between_sampling": 11.437454034993957, "num_env_steps_sampled_lifetime_throughput": 48.87831849132227}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08183955401182175, "weights_seq_no": 131.0, "vf_loss_unclipped": 0.004360072780400515, "total_loss": -0.07747948169708252, "gradients_default_optimizer_global_norm": 0.581503689289093, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05939704179763794, "entropy": 0.05441795289516449, "curr_kl_coeff": 9.087677989257921e-29, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0021888187620788813, "num_module_steps_trained_lifetime": 7936128, "vf_loss": 0.004360072780400515}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.049423577357014234, "add_observations_from_episodes_to_batch": 0.00036867887147293315, "add_one_ts_to_episodes_and_truncate": 0.006963627275546929, "add_columns_from_episodes_to_train_batch": 0.0799591329312447, "general_advantage_estimation": 0.09011943244562658, "add_states_from_episodes_to_batch": 1.135282290487938e-05, "numpy_to_tensor": 0.001339398415721234, "add_time_dim_to_batch_and_zero_pad": 3.2312684925713705e-05}}, "connector_pipeline_timer": 0.22874829760983473}, "num_module_steps_trained_lifetime": 7936128, "learner_connector_sum_episodes_length_out": 2016.4503296014584, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 125066216, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 262000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.87831849132227, "done": false, "training_iteration": 131, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-22-23", "timestamp": 1747696943, "time_this_iter_s": 40.668128490448, "time_total_s": 5263.546344041824, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5263.546344041824, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 77.6810344827586, "ram_util_percent": 52.71034482758619}}
{"timers": {"training_iteration": 41.08380424478973, "restore_env_runners": 2.785215163433618e-05, "training_step": 41.083261641406224, "env_runner_sampling_timer": 31.35989053219578, "learner_update_timer": 9.71210537911642, "synch_weights": 0.010170488827340804, "synch_env_connectors": 0.009301586016001421}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.34655555555555595, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016708891693785967, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.018249410865997e-06, "un_batch_to_individual_items": 7.384731026472187e-05, "listify_data_for_vector_env": 0.00014411205251766454, "normalize_and_clip_actions": 0.00012780615401497485, "get_actions": 0.0007460465913310233, "tensor_to_numpy": 0.00023908463379403462}}}, "num_module_steps_sampled_lifetime": {"default_policy": 264000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 264000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3851685026374856e-05, "add_states_from_episodes_to_batch": 2.0210472660527564e-05, "numpy_to_tensor": 0.00017169534561051972, "add_time_dim_to_batch_and_zero_pad": 3.971605285117297e-05, "batch_individual_items": 9.778443861215966e-05}}, "connector_pipeline_timer": 0.0006297334540957633}, "episode_return_max": 0.7142222222222224, "episode_duration_sec_mean": 23.888623958221544, "num_episodes_lifetime": 1216, "rlmodule_inference_timer": 0.0005793325242425829, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5416944444444446, "env_to_module_sum_episodes_length_out": 93.4084942518177, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1134800579099081, "num_env_steps_sampled_lifetime": 264000, "weights_seq_no": 131.0, "agent_episode_returns_mean": {"default_agent": 0.5416944444444446}, "module_episode_returns_mean": {"default_policy": 0.5416944444444446}, "num_env_steps_sampled": 2000, "sample": 29.777443736948022, "env_to_module_sum_episodes_length_in": 93.4084942518177, "time_between_sampling": 11.429812900170036, "num_env_steps_sampled_lifetime_throughput": 49.34082905287958}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02853311039507389, "weights_seq_no": 132.0, "vf_loss_unclipped": 0.003307887353003025, "total_loss": -0.02522522583603859, "gradients_default_optimizer_global_norm": 0.4493579864501953, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.030257821083068848, "entropy": 0.06251978874206543, "curr_kl_coeff": 4.5438389946289603e-29, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001888363971374929, "num_module_steps_trained_lifetime": 7996672, "vf_loss": 0.003307887353003025}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.049524434806231137, "add_observations_from_episodes_to_batch": 0.0003688023043419209, "add_one_ts_to_episodes_and_truncate": 0.006959235937615616, "add_columns_from_episodes_to_train_batch": 0.07997740068403134, "general_advantage_estimation": 0.08967886936338004, "add_states_from_episodes_to_batch": 1.135876362293905e-05, "numpy_to_tensor": 0.0013396546565091632, "add_time_dim_to_batch_and_zero_pad": 3.235181206870108e-05}}, "connector_pipeline_timer": 0.22842217673018095}, "num_module_steps_trained_lifetime": 7996672, "learner_connector_sum_episodes_length_out": 2016.454116019025, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 126019784, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 264000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.34082905287958, "done": false, "training_iteration": 132, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-23-03", "timestamp": 1747696983, "time_this_iter_s": 40.46659851074219, "time_total_s": 5304.0129425525665, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5304.0129425525665, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 77.3603448275862, "ram_util_percent": 52.715517241379295}}
{"timers": {"training_iteration": 41.08506126710183, "restore_env_runners": 2.7848630101950788e-05, "training_step": 41.08451832575214, "env_runner_sampling_timer": 31.366064564353834, "learner_update_timer": 9.707210406605277, "synch_weights": 0.010152816939088405, "synch_env_connectors": 0.009350650155846487}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3288888888888888, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001672962629934605, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.903635777826955e-06, "un_batch_to_individual_items": 7.447463942555159e-05, "listify_data_for_vector_env": 0.0001426376596039935, "normalize_and_clip_actions": 0.0001282406977934389, "get_actions": 0.0007464598817827862, "tensor_to_numpy": 0.00024048615653131635}}}, "num_module_steps_sampled_lifetime": {"default_policy": 266000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 266000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.5909447330310404e-05, "add_states_from_episodes_to_batch": 2.0587369884232714e-05, "numpy_to_tensor": 0.000171367295161923, "add_time_dim_to_batch_and_zero_pad": 3.945734835836655e-05, "batch_individual_items": 9.770207542171314e-05}}, "connector_pipeline_timer": 0.0006317083479988078}, "episode_return_max": 0.7142222222222224, "episode_duration_sec_mean": 24.058721879018428, "num_episodes_lifetime": 1224, "rlmodule_inference_timer": 0.0005795153735097705, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5279807692307693, "env_to_module_sum_episodes_length_out": 95.86567559841632, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11313676036667004, "num_env_steps_sampled_lifetime": 266000, "weights_seq_no": 132.0, "agent_episode_returns_mean": {"default_agent": 0.5279807692307693}, "module_episode_returns_mean": {"default_policy": 0.5279807692307693}, "num_env_steps_sampled": 2000, "sample": 29.784606593522312, "env_to_module_sum_episodes_length_in": 95.86567559841632, "time_between_sampling": 11.422039125898085, "num_env_steps_sampled_lifetime_throughput": 48.42729680909482}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.16225583851337433, "weights_seq_no": 133.0, "vf_loss_unclipped": 0.008796073496341705, "total_loss": -0.15345977246761322, "gradients_default_optimizer_global_norm": 0.23472528159618378, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06897729635238647, "entropy": 0.07508233934640884, "curr_kl_coeff": 2.2719194973144801e-29, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004506333731114864, "num_module_steps_trained_lifetime": 8057216, "vf_loss": 0.008796073496341705}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.049622438868728504, "add_observations_from_episodes_to_batch": 0.0003689316606668608, "add_one_ts_to_episodes_and_truncate": 0.0069548535237152955, "add_columns_from_episodes_to_train_batch": 0.07999618934846948, "general_advantage_estimation": 0.08923905304953339, "add_states_from_episodes_to_batch": 1.136445024395798e-05, "numpy_to_tensor": 0.001339895162639531, "add_time_dim_to_batch_and_zero_pad": 3.2389725400556434e-05}}, "connector_pipeline_timer": 0.22809447236835925}, "num_module_steps_trained_lifetime": 8057216, "learner_connector_sum_episodes_length_out": 2016.4577816752799, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 126973352, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 266000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.42729680909482, "done": false, "training_iteration": 133, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-23-45", "timestamp": 1747697025, "time_this_iter_s": 41.228455781936646, "time_total_s": 5345.241398334503, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5345.241398334503, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 78.47241379310344, "ram_util_percent": 52.7155172413793}}
{"timers": {"training_iteration": 41.13725840051078, "restore_env_runners": 2.7778143784035226e-05, "training_step": 41.13671676057459, "env_runner_sampling_timer": 31.41423011735027, "learner_update_timer": 9.711197559979217, "synch_weights": 0.010201908769756074, "synch_env_connectors": 0.009354378654281839}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29733333333333367, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016825069552947336, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.836122376333817e-06, "un_batch_to_individual_items": 7.694795322072992e-05, "listify_data_for_vector_env": 0.00014333198882055792, "normalize_and_clip_actions": 0.00012996260099064875, "get_actions": 0.0007494460208605533, "tensor_to_numpy": 0.00024166342935239287}}}, "num_module_steps_sampled_lifetime": {"default_policy": 268000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 268000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.5740918083815174e-05, "add_states_from_episodes_to_batch": 2.0503033999960884e-05, "numpy_to_tensor": 0.00017194104225922566, "add_time_dim_to_batch_and_zero_pad": 4.019376706136487e-05, "batch_individual_items": 9.71177636883056e-05}}, "connector_pipeline_timer": 0.0006317217611375742}, "episode_return_max": 0.7847777777777798, "episode_duration_sec_mean": 25.75342266600812, "num_episodes_lifetime": 1240, "rlmodule_inference_timer": 0.0005857212923600968, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5491517094017104, "env_to_module_sum_episodes_length_out": 97.41308540819372, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11466916235699609, "num_env_steps_sampled_lifetime": 268000, "weights_seq_no": 133.0, "agent_episode_returns_mean": {"default_agent": 0.5491517094017104}, "module_episode_returns_mean": {"default_policy": 0.5491517094017104}, "num_env_steps_sampled": 2000, "sample": 29.79510159045492, "env_to_module_sum_episodes_length_in": 97.41308540819372, "time_between_sampling": 11.414319322294142, "num_env_steps_sampled_lifetime_throughput": 43.11473475728067}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.006021654233336449, "weights_seq_no": 134.0, "vf_loss_unclipped": 0.009320766665041447, "total_loss": 0.015342422761023045, "gradients_default_optimizer_global_norm": 0.2878572344779968, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.12392967939376831, "entropy": 0.0779678076505661, "curr_kl_coeff": 1.1359597486572401e-29, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004445323720574379, "num_module_steps_trained_lifetime": 8118016, "vf_loss": 0.009320766665041447}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.049718808286595334, "add_observations_from_episodes_to_batch": 0.00036907674963463743, "add_one_ts_to_episodes_and_truncate": 0.006950631634499007, "add_columns_from_episodes_to_train_batch": 0.08001603141955073, "general_advantage_estimation": 0.08880024090502685, "add_states_from_episodes_to_batch": 1.1371067256786727e-05, "numpy_to_tensor": 0.0013401391831817167, "add_time_dim_to_batch_and_zero_pad": 3.242868528438228e-05}}, "connector_pipeline_timer": 0.22776738169620087}, "num_module_steps_trained_lifetime": 8118016, "learner_connector_sum_episodes_length_out": 2016.462128606808, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 127934752, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 268000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 43.11473475728067, "done": false, "training_iteration": 134, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-24-31", "timestamp": 1747697071, "time_this_iter_s": 46.32045078277588, "time_total_s": 5391.561849117279, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5391.561849117279, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 78.28333333333335, "ram_util_percent": 52.72272727272726}}
{"timers": {"training_iteration": 41.13150023334571, "restore_env_runners": 2.7724362378371137e-05, "training_step": 41.13095936980884, "env_runner_sampling_timer": 31.415277672886752, "learner_update_timer": 9.704447607509426, "synch_weights": 0.010148689682062634, "synch_env_connectors": 0.009350237867758977}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3120000000000004, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016811041129077497, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.332875474560286e-06, "un_batch_to_individual_items": 7.670438694598719e-05, "listify_data_for_vector_env": 0.00014343105535496995, "normalize_and_clip_actions": 0.0001299967440568187, "get_actions": 0.0007493405422545295, "tensor_to_numpy": 0.00023996758084105811}}}, "num_module_steps_sampled_lifetime": {"default_policy": 270000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 270000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.5825193761684644e-05, "add_states_from_episodes_to_batch": 2.0346937034418856e-05, "numpy_to_tensor": 0.00017365306980056709, "add_time_dim_to_batch_and_zero_pad": 4.0205633986101666e-05, "batch_individual_items": 9.696408878312753e-05}}, "connector_pipeline_timer": 0.0006322411626572301}, "episode_return_max": 0.8885555555555577, "episode_duration_sec_mean": 25.30111766362377, "num_episodes_lifetime": 1248, "rlmodule_inference_timer": 0.0005847375086107773, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4955021367521377, "env_to_module_sum_episodes_length_out": 96.49967423584056, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1151665579685034, "num_env_steps_sampled_lifetime": 270000, "weights_seq_no": 134.0, "agent_episode_returns_mean": {"default_agent": 0.4955021367521377}, "module_episode_returns_mean": {"default_policy": 0.4955021367521377}, "num_env_steps_sampled": 2000, "sample": 29.805158573762565, "env_to_module_sum_episodes_length_in": 96.49967423584056, "time_between_sampling": 11.40732530029425, "num_env_steps_sampled_lifetime_throughput": 49.20284262381956}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.04533985257148743, "weights_seq_no": 135.0, "vf_loss_unclipped": 0.004079320468008518, "total_loss": 0.04941917955875397, "gradients_default_optimizer_global_norm": 0.4668971598148346, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.11004650592803955, "entropy": 0.09812023490667343, "curr_kl_coeff": 5.6797987432862004e-30, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002813409548252821, "num_module_steps_trained_lifetime": 8178560, "vf_loss": 0.004079320468008518}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.049812648112217986, "add_observations_from_episodes_to_batch": 0.0003692146636572665, "add_one_ts_to_episodes_and_truncate": 0.006946663547714597, "add_columns_from_episodes_to_train_batch": 0.08003561511027571, "general_advantage_estimation": 0.08836227575810578, "add_states_from_episodes_to_batch": 1.1377485484478456e-05, "numpy_to_tensor": 0.0013403518337968077, "add_time_dim_to_batch_and_zero_pad": 3.246685699784812e-05}}, "connector_pipeline_timer": 0.22743856271024884}, "num_module_steps_trained_lifetime": 8178560, "learner_connector_sum_episodes_length_out": 2016.4663428215379, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 128888320, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 270000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.20284262381956, "done": false, "training_iteration": 135, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-25-12", "timestamp": 1747697112, "time_this_iter_s": 40.59183382987976, "time_total_s": 5432.153682947159, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5432.153682947159, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 77.89137931034483, "ram_util_percent": 52.71379310344827}}
{"timers": {"training_iteration": 41.12428036808229, "restore_env_runners": 2.8080118699670128e-05, "training_step": 41.12373908518072, "env_runner_sampling_timer": 31.411329682007885, "learner_update_timer": 9.70121111565437, "synch_weights": 0.010113466785293896, "synch_env_connectors": 0.009443310489124763}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3120000000000004, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001686476222682986, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.278377623257409e-06, "un_batch_to_individual_items": 7.558026930523435e-05, "listify_data_for_vector_env": 0.00014414325589297449, "normalize_and_clip_actions": 0.00013174071401712096, "get_actions": 0.000750260528085876, "tensor_to_numpy": 0.00024066726802983752}}}, "num_module_steps_sampled_lifetime": {"default_policy": 272000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 272000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.543252056150484e-05, "add_states_from_episodes_to_batch": 2.0278558817365138e-05, "numpy_to_tensor": 0.00017438256929056022, "add_time_dim_to_batch_and_zero_pad": 3.979615685258346e-05, "batch_individual_items": 9.781723147560052e-05}}, "connector_pipeline_timer": 0.0006315447569172053}, "episode_return_max": 0.8885555555555577, "episode_duration_sec_mean": 24.30556881624111, "num_episodes_lifetime": 1256, "rlmodule_inference_timer": 0.00058144932876423, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4861805555555562, "env_to_module_sum_episodes_length_out": 94.48724800731983, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1151800080437, "num_env_steps_sampled_lifetime": 272000, "weights_seq_no": 135.0, "agent_episode_returns_mean": {"default_agent": 0.4861805555555562}, "module_episode_returns_mean": {"default_policy": 0.4861805555555562}, "num_env_steps_sampled": 2000, "sample": 29.814666779455873, "env_to_module_sum_episodes_length_in": 94.48724800731983, "time_between_sampling": 11.400069005570767, "num_env_steps_sampled_lifetime_throughput": 49.34384296137499}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03815276920795441, "weights_seq_no": 136.0, "vf_loss_unclipped": 0.0036260648630559444, "total_loss": -0.034526705741882324, "gradients_default_optimizer_global_norm": 0.40460047125816345, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.027952730655670166, "entropy": 0.07059246301651001, "curr_kl_coeff": 2.8398993716431002e-30, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0010140725644305348, "num_module_steps_trained_lifetime": 8239104, "vf_loss": 0.0036260648630559444}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04990473257049947, "add_observations_from_episodes_to_batch": 0.0003693571617245439, "add_one_ts_to_episodes_and_truncate": 0.006942692359502448, "add_columns_from_episodes_to_train_batch": 0.08005480006404357, "general_advantage_estimation": 0.0879252677800322, "add_states_from_episodes_to_batch": 1.1383708241034629e-05, "numpy_to_tensor": 0.0013405938374814168, "add_time_dim_to_batch_and_zero_pad": 3.2504872408000576e-05}}, "connector_pipeline_timer": 0.2271085805258463}, "num_module_steps_trained_lifetime": 8239104, "learner_connector_sum_episodes_length_out": 2016.4704265391126, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 129841888, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 272000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.34384296137499, "done": false, "training_iteration": 136, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-25-52", "timestamp": 1747697152, "time_this_iter_s": 40.432419300079346, "time_total_s": 5472.586102247238, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5472.586102247238, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 78.79473684210527, "ram_util_percent": 52.740350877192995}}
{"timers": {"training_iteration": 41.153454889481445, "restore_env_runners": 2.803131753300606e-05, "training_step": 41.15291376240888, "env_runner_sampling_timer": 31.440304544207777, "learner_update_timer": 9.701453252567848, "synch_weights": 0.010072673107462316, "synch_env_connectors": 0.009462456384186977}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.28266666666666657, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017156486175761011, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.264360671158427e-06, "un_batch_to_individual_items": 7.483065454767888e-05, "listify_data_for_vector_env": 0.00014773623902731748, "normalize_and_clip_actions": 0.0001331386405717256, "get_actions": 0.0007651041171201211, "tensor_to_numpy": 0.0002452510769355705}}}, "num_module_steps_sampled_lifetime": {"default_policy": 274000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 274000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.550430764638782e-05, "add_states_from_episodes_to_batch": 2.1067801799257563e-05, "numpy_to_tensor": 0.0001790703975591649, "add_time_dim_to_batch_and_zero_pad": 3.9664721485726155e-05, "batch_individual_items": 9.909748968878337e-05}}, "connector_pipeline_timer": 0.0006411997053004668}, "episode_return_max": 0.7741111111111123, "episode_duration_sec_mean": 24.124304446759968, "num_episodes_lifetime": 1264, "rlmodule_inference_timer": 0.0005899235927217649, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.43925961538461544, "env_to_module_sum_episodes_length_out": 92.90999062424105, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11659355145780921, "num_env_steps_sampled_lifetime": 274000, "weights_seq_no": 136.0, "agent_episode_returns_mean": {"default_agent": 0.43925961538461544}, "module_episode_returns_mean": {"default_policy": 0.43925961538461544}, "num_env_steps_sampled": 2000, "sample": 29.82628185154602, "env_to_module_sum_episodes_length_in": 92.90999062424105, "time_between_sampling": 11.392576685682414, "num_env_steps_sampled_lifetime_throughput": 45.311523946160506}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02854311838746071, "weights_seq_no": 137.0, "vf_loss_unclipped": 0.002710414119064808, "total_loss": -0.025832705199718475, "gradients_default_optimizer_global_norm": 0.33225366473197937, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07688462734222412, "entropy": 0.07058800756931305, "curr_kl_coeff": 1.4199496858215501e-30, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004456508904695511, "num_module_steps_trained_lifetime": 8299648, "vf_loss": 0.002710414119064808}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04999450024470393, "add_observations_from_episodes_to_batch": 0.00036949356836445254, "add_one_ts_to_episodes_and_truncate": 0.00693862207869952, "add_columns_from_episodes_to_train_batch": 0.08007344798712528, "general_advantage_estimation": 0.08748937827394393, "add_states_from_episodes_to_batch": 1.138998879377602e-05, "numpy_to_tensor": 0.0013408534759088966, "add_time_dim_to_batch_and_zero_pad": 3.254300082360769e-05}}, "connector_pipeline_timer": 0.22677678387866057}, "num_module_steps_trained_lifetime": 8299648, "learner_connector_sum_episodes_length_out": 2016.4743819480536, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 130795456, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 274000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.311523946160506, "done": false, "training_iteration": 137, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-26-36", "timestamp": 1747697196, "time_this_iter_s": 44.05911946296692, "time_total_s": 5516.645221710205, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5516.645221710205, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 79.08095238095238, "ram_util_percent": 52.71746031746029}}
{"timers": {"training_iteration": 41.147443929416596, "restore_env_runners": 2.7986004328092537e-05, "training_step": 41.14690220161474, "env_runner_sampling_timer": 31.43384027257572, "learner_update_timer": 9.701957642052156, "synch_weights": 0.010022140386424341, "synch_env_connectors": 0.009451842820344116}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.28266666666666657, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001715547637539863, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.821293837597609e-06, "un_batch_to_individual_items": 7.453956215500192e-05, "listify_data_for_vector_env": 0.00014791583814394965, "normalize_and_clip_actions": 0.00013258979095087987, "get_actions": 0.0007674710146265854, "tensor_to_numpy": 0.00024448210984127054}}}, "num_module_steps_sampled_lifetime": {"default_policy": 276000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 276000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.463805308664404e-05, "add_states_from_episodes_to_batch": 2.093813705455787e-05, "numpy_to_tensor": 0.0001784152510065351, "add_time_dim_to_batch_and_zero_pad": 3.952435933738285e-05, "batch_individual_items": 9.949167521433978e-05}}, "connector_pipeline_timer": 0.0006403766815859425}, "episode_return_max": 0.6667777777777778, "episode_duration_sec_mean": 26.306235986864593, "num_episodes_lifetime": 1272, "rlmodule_inference_timer": 0.0005897060772943597, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.41779166666666695, "env_to_module_sum_episodes_length_out": 92.72359840171904, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11612168167613118, "num_env_steps_sampled_lifetime": 276000, "weights_seq_no": 137.0, "agent_episode_returns_mean": {"default_agent": 0.41779166666666695}, "module_episode_returns_mean": {"default_policy": 0.41779166666666695}, "num_env_steps_sampled": 2000, "sample": 29.836891332030156, "env_to_module_sum_episodes_length_in": 92.72359840171904, "time_between_sampling": 11.385059096772284, "num_env_steps_sampled_lifetime_throughput": 49.214399182964804}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09109529852867126, "weights_seq_no": 138.0, "vf_loss_unclipped": 0.004818566143512726, "total_loss": -0.08627672493457794, "gradients_default_optimizer_global_norm": 0.18916615843772888, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.009278953075408936, "entropy": 0.03430483117699623, "curr_kl_coeff": 7.0997484291077504e-31, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0006308857118710876, "num_module_steps_trained_lifetime": 8360192, "vf_loss": 0.004818566143512726}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05008193874246709, "add_observations_from_episodes_to_batch": 0.0003696355111554128, "add_one_ts_to_episodes_and_truncate": 0.00693444753427644, "add_columns_from_episodes_to_train_batch": 0.08009178320233856, "general_advantage_estimation": 0.0870549463212997, "add_states_from_episodes_to_batch": 1.1396065364706288e-05, "numpy_to_tensor": 0.001341094032183797, "add_time_dim_to_batch_and_zero_pad": 3.257994618338301e-05}}, "connector_pipeline_timer": 0.226443681657366}, "num_module_steps_trained_lifetime": 8360192, "learner_connector_sum_episodes_length_out": 2016.478211206162, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 131749024, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 276000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.214399182964804, "done": false, "training_iteration": 138, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-27-17", "timestamp": 1747697237, "time_this_iter_s": 40.56852889060974, "time_total_s": 5557.213750600815, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5557.213750600815, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 77.78070175438599, "ram_util_percent": 52.72631578947367}}
{"timers": {"training_iteration": 41.147625683372446, "restore_env_runners": 2.796214426961336e-05, "training_step": 41.14708398384862, "env_runner_sampling_timer": 31.439574815819984, "learner_update_timer": 9.696444569911604, "synch_weights": 0.009983163982520861, "synch_env_connectors": 0.009435461402200111}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3004444444444445, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017118102377766406, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.448150922864951e-06, "un_batch_to_individual_items": 7.535289759234871e-05, "listify_data_for_vector_env": 0.00014617571934603311, "normalize_and_clip_actions": 0.00013307582992046907, "get_actions": 0.0007650782035749747, "tensor_to_numpy": 0.00024494247062994013}}}, "num_module_steps_sampled_lifetime": {"default_policy": 278000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 278000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.389686845401941e-05, "add_states_from_episodes_to_batch": 2.069733942855381e-05, "numpy_to_tensor": 0.00017614435271549747, "add_time_dim_to_batch_and_zero_pad": 3.923854209051612e-05, "batch_individual_items": 9.993788290655303e-05}}, "connector_pipeline_timer": 0.0006376976748596955}, "episode_return_max": 0.7390000000000004, "episode_duration_sec_mean": 25.20911148486476, "num_episodes_lifetime": 1280, "rlmodule_inference_timer": 0.0005898556980964554, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4929711538461541, "env_to_module_sum_episodes_length_out": 94.45640746909082, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11558453158887333, "num_env_steps_sampled_lifetime": 278000, "weights_seq_no": 138.0, "agent_episode_returns_mean": {"default_agent": 0.4929711538461541}, "module_episode_returns_mean": {"default_policy": 0.4929711538461541}, "num_env_steps_sampled": 2000, "sample": 29.847176468918246, "env_to_module_sum_episodes_length_in": 94.45640746909082, "time_between_sampling": 11.377738109409062, "num_env_steps_sampled_lifetime_throughput": 48.50076916156169}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.046964120119810104, "weights_seq_no": 139.0, "vf_loss_unclipped": 0.005840673577040434, "total_loss": -0.04112344607710838, "gradients_default_optimizer_global_norm": 0.18676769733428955, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09690302610397339, "entropy": 0.05462867394089699, "curr_kl_coeff": 3.5498742145538752e-31, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002899719635024667, "num_module_steps_trained_lifetime": 8420736, "vf_loss": 0.005840673577040434}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.050167458129750646, "add_observations_from_episodes_to_batch": 0.0003698162157337522, "add_one_ts_to_episodes_and_truncate": 0.006930402698433647, "add_columns_from_episodes_to_train_batch": 0.08010983536754925, "general_advantage_estimation": 0.08662135890978086, "add_states_from_episodes_to_batch": 1.1401931405330239e-05, "numpy_to_tensor": 0.0013412920919855017, "add_time_dim_to_batch_and_zero_pad": 3.261589833616847e-05}}, "connector_pipeline_timer": 0.2261093479305088}, "num_module_steps_trained_lifetime": 8420736, "learner_connector_sum_episodes_length_out": 2016.4819164409134, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 132702592, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 278000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.50076916156169, "done": false, "training_iteration": 139, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-27-58", "timestamp": 1747697278, "time_this_iter_s": 41.18273401260376, "time_total_s": 5598.396484613419, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5598.396484613419, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 77.23559322033897, "ram_util_percent": 52.72033898305083}}
{"timers": {"training_iteration": 41.18231928493868, "restore_env_runners": 2.7895522775334066e-05, "training_step": 41.18177779441015, "env_runner_sampling_timer": 31.47324544162181, "learner_update_timer": 9.697507704652518, "synch_weights": 0.009943752342704542, "synch_env_connectors": 0.009424581778202224}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3175555555555563, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017182413752307687, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.934153682873868e-06, "un_batch_to_individual_items": 7.65671035763181e-05, "listify_data_for_vector_env": 0.00014640097544878916, "normalize_and_clip_actions": 0.00013430633219160013, "get_actions": 0.0007664350926121519, "tensor_to_numpy": 0.0002479614117612656}}}, "num_module_steps_sampled_lifetime": {"default_policy": 280000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 280000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3380810031895226e-05, "add_states_from_episodes_to_batch": 2.055202890401444e-05, "numpy_to_tensor": 0.00017599555521176794, "add_time_dim_to_batch_and_zero_pad": 3.8695272433276284e-05, "batch_individual_items": 0.00010046120097526663}}, "connector_pipeline_timer": 0.000637923683215267}, "episode_return_max": 0.7887777777777797, "episode_duration_sec_mean": 25.072426306644676, "num_episodes_lifetime": 1296, "rlmodule_inference_timer": 0.0005920814691156836, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5322094017094025, "env_to_module_sum_episodes_length_out": 96.97307088740523, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11684705885909709, "num_env_steps_sampled_lifetime": 280000, "weights_seq_no": 139.0, "agent_episode_returns_mean": {"default_agent": 0.5322094017094025}, "module_episode_returns_mean": {"default_policy": 0.5322094017094025}, "num_env_steps_sampled": 2000, "sample": 29.85948450394081, "env_to_module_sum_episodes_length_in": 96.97307088740523, "time_between_sampling": 11.370479191312466, "num_env_steps_sampled_lifetime_throughput": 44.74849521616941}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.01656038872897625, "weights_seq_no": 140.0, "vf_loss_unclipped": 0.006364139262586832, "total_loss": -0.010196242481470108, "gradients_default_optimizer_global_norm": 0.2878780961036682, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.02469867467880249, "entropy": 0.06318386644124985, "curr_kl_coeff": 1.7749371072769376e-31, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0027378953527659178, "num_module_steps_trained_lifetime": 8481536, "vf_loss": 0.006364139262586832}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.050251050345413883, "add_observations_from_episodes_to_batch": 0.00037000267267003233, "add_one_ts_to_episodes_and_truncate": 0.006926347544554651, "add_columns_from_episodes_to_train_batch": 0.08012785530113578, "general_advantage_estimation": 0.08618865414186047, "add_states_from_episodes_to_batch": 1.1407790518664612e-05, "numpy_to_tensor": 0.0013414582511880255, "add_time_dim_to_batch_and_zero_pad": 3.2651703451339574e-05}}, "connector_pipeline_timer": 0.22577389649002338}, "num_module_steps_trained_lifetime": 8481536, "learner_connector_sum_episodes_length_out": 2016.486299749849, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 133663992, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 280000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.74849521616941, "done": false, "training_iteration": 140, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-28-43", "timestamp": 1747697323, "time_this_iter_s": 44.63777017593384, "time_total_s": 5643.034254789352, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5643.034254789352, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 78.76190476190477, "ram_util_percent": 52.7301587301587}}
{"timers": {"training_iteration": 41.17349098438926, "restore_env_runners": 2.782156750784119e-05, "training_step": 41.17294984976599, "env_runner_sampling_timer": 31.466568492405617, "learner_update_timer": 9.695084656705932, "synch_weights": 0.010216041819297242, "synch_env_connectors": 0.00943787596037379}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3175555555555563, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001715957328983319, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.732624969329642e-06, "un_batch_to_individual_items": 7.685170505929178e-05, "listify_data_for_vector_env": 0.00014588032363148829, "normalize_and_clip_actions": 0.00013264869153581857, "get_actions": 0.0007652597632370792, "tensor_to_numpy": 0.00024884534579855573}}}, "num_module_steps_sampled_lifetime": {"default_policy": 282000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 282000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.367958061437791e-05, "add_states_from_episodes_to_batch": 2.0674409094326105e-05, "numpy_to_tensor": 0.0001754429338390948, "add_time_dim_to_batch_and_zero_pad": 3.864932190112658e-05, "batch_individual_items": 0.00010070231467345708}}, "connector_pipeline_timer": 0.0006370534768674532}, "episode_return_max": 0.7887777777777797, "episode_duration_sec_mean": 24.5354136128291, "num_episodes_lifetime": 1304, "rlmodule_inference_timer": 0.0005942875772110784, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5258664529914542, "env_to_module_sum_episodes_length_out": 96.9597834271195, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11708112997150956, "num_env_steps_sampled_lifetime": 282000, "weights_seq_no": 140.0, "agent_episode_returns_mean": {"default_agent": 0.5258664529914542}, "module_episode_returns_mean": {"default_policy": 0.5258664529914542}, "num_env_steps_sampled": 2000, "sample": 29.870665776560827, "env_to_module_sum_episodes_length_in": 96.9597834271195, "time_between_sampling": 11.363716155895904, "num_env_steps_sampled_lifetime_throughput": 49.38368161863565}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.1025022491812706, "weights_seq_no": 141.0, "vf_loss_unclipped": 0.009826220571994781, "total_loss": -0.09267604351043701, "gradients_default_optimizer_global_norm": 0.32063034176826477, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.053637921810150146, "entropy": 0.05494564771652222, "curr_kl_coeff": 8.874685536384688e-32, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0030083938036113977, "num_module_steps_trained_lifetime": 8542080, "vf_loss": 0.009826220571994781}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05033224700095071, "add_observations_from_episodes_to_batch": 0.0003701848188459671, "add_one_ts_to_episodes_and_truncate": 0.006922381283482941, "add_columns_from_episodes_to_train_batch": 0.0801466860725142, "general_advantage_estimation": 0.08575688069340726, "add_states_from_episodes_to_batch": 1.1413362256701865e-05, "numpy_to_tensor": 0.0013415844079971851, "add_time_dim_to_batch_and_zero_pad": 3.2686750874154044e-05}}, "connector_pipeline_timer": 0.2254378309835543}, "num_module_steps_trained_lifetime": 8542080, "learner_connector_sum_episodes_length_out": 2016.4905472009618, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 134617560, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 282000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.38368161863565, "done": false, "training_iteration": 141, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-29-23", "timestamp": 1747697363, "time_this_iter_s": 40.33619141578674, "time_total_s": 5683.370446205139, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5683.370446205139, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 76.60344827586208, "ram_util_percent": 52.7155172413793}}
{"timers": {"training_iteration": 41.17186351921536, "restore_env_runners": 2.7818351816720745e-05, "training_step": 41.171321971938355, "env_runner_sampling_timer": 31.463118219491548, "learner_update_timer": 9.696935577798843, "synch_weights": 0.01018835940105561, "synch_env_connectors": 0.009508938200760148}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.34177777777777874, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017143460353882733, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.553852625033386e-06, "un_batch_to_individual_items": 7.801870109937155e-05, "listify_data_for_vector_env": 0.00014576863311383935, "normalize_and_clip_actions": 0.00013174005003785112, "get_actions": 0.0007614256051536384, "tensor_to_numpy": 0.0002503765041635679}}}, "num_module_steps_sampled_lifetime": {"default_policy": 284000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 284000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3824082766436424e-05, "add_states_from_episodes_to_batch": 2.053249250619002e-05, "numpy_to_tensor": 0.00017451049624030108, "add_time_dim_to_batch_and_zero_pad": 3.8318409100464444e-05, "batch_individual_items": 0.00010053182138441513}}, "connector_pipeline_timer": 0.0006379137167172998}, "episode_return_max": 0.7641111111111125, "episode_duration_sec_mean": 23.79295536148227, "num_episodes_lifetime": 1312, "rlmodule_inference_timer": 0.0005953370021605846, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5787628205128215, "env_to_module_sum_episodes_length_out": 95.1417105393784, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1170341679754847, "num_env_steps_sampled_lifetime": 284000, "weights_seq_no": 141.0, "agent_episode_returns_mean": {"default_agent": 0.5787628205128215}, "module_episode_returns_mean": {"default_policy": 0.5787628205128215}, "num_env_steps_sampled": 2000, "sample": 29.88105014712822, "env_to_module_sum_episodes_length_in": 95.1417105393784, "time_between_sampling": 11.35704392566664, "num_env_steps_sampled_lifetime_throughput": 48.52659386425876}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.021470054984092712, "weights_seq_no": 142.0, "vf_loss_unclipped": 0.0058059412986040115, "total_loss": -0.015664108097553253, "gradients_default_optimizer_global_norm": 0.4805038273334503, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.03776884078979492, "entropy": 0.051596563309431076, "curr_kl_coeff": 4.437342768192344e-32, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0013255857629701495, "num_module_steps_trained_lifetime": 8602624, "vf_loss": 0.0058059412986040115}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05041229766834222, "add_observations_from_episodes_to_batch": 0.00037036786183091807, "add_one_ts_to_episodes_and_truncate": 0.00691836245287843, "add_columns_from_episodes_to_train_batch": 0.0801656329929349, "general_advantage_estimation": 0.08532619516860908, "add_states_from_episodes_to_batch": 1.1418821781603476e-05, "numpy_to_tensor": 0.0013417269458455602, "add_time_dim_to_batch_and_zero_pad": 3.272076217864968e-05}}, "connector_pipeline_timer": 0.22510179421766532}, "num_module_steps_trained_lifetime": 8602624, "learner_connector_sum_episodes_length_out": 2016.4946610730774, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 135571128, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 284000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.52659386425876, "done": false, "training_iteration": 142, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-30-05", "timestamp": 1747697405, "time_this_iter_s": 41.03087401390076, "time_total_s": 5724.40132021904, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5724.40132021904, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 77.13620689655171, "ram_util_percent": 52.71379310344827}}
{"timers": {"training_iteration": 41.16533540670319, "restore_env_runners": 2.7805168351885725e-05, "training_step": 41.16479383089898, "env_runner_sampling_timer": 31.459389807266614, "learner_update_timer": 9.694167029730858, "synch_weights": 0.010137212807028255, "synch_env_connectors": 0.009517908818764942}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3493333333333342, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017107704060862797, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.550652061173407e-06, "un_batch_to_individual_items": 7.855980070764811e-05, "listify_data_for_vector_env": 0.0001449781283796471, "normalize_and_clip_actions": 0.00013094946792046626, "get_actions": 0.0007587952877425849, "tensor_to_numpy": 0.00024981653470063764}}}, "num_module_steps_sampled_lifetime": {"default_policy": 286000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 286000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.4514153129693876e-05, "add_states_from_episodes_to_batch": 2.097700400349462e-05, "numpy_to_tensor": 0.00017341250743059034, "add_time_dim_to_batch_and_zero_pad": 3.821430772388822e-05, "batch_individual_items": 9.918086156999567e-05}}, "connector_pipeline_timer": 0.0006364370552529332}, "episode_return_max": 0.7684444444444447, "episode_duration_sec_mean": 23.826407458567562, "num_episodes_lifetime": 1320, "rlmodule_inference_timer": 0.0005913704455930156, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.560435897435898, "env_to_module_sum_episodes_length_out": 93.28017180872344, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11665551650029346, "num_env_steps_sampled_lifetime": 286000, "weights_seq_no": 142.0, "agent_episode_returns_mean": {"default_agent": 0.560435897435898}, "module_episode_returns_mean": {"default_policy": 0.560435897435898}, "num_env_steps_sampled": 2000, "sample": 29.890478121144305, "env_to_module_sum_episodes_length_in": 93.28017180872344, "time_between_sampling": 11.350684413167933, "num_env_steps_sampled_lifetime_throughput": 49.24597242313216}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.051887620240449905, "weights_seq_no": 143.0, "vf_loss_unclipped": 0.004311338998377323, "total_loss": 0.056198958307504654, "gradients_default_optimizer_global_norm": 0.19209717214107513, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.042385756969451904, "entropy": 0.044804368168115616, "curr_kl_coeff": 2.218671384096172e-32, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0016666559968143702, "num_module_steps_trained_lifetime": 8663168, "vf_loss": 0.004311338998377323}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05048971056768593, "add_observations_from_episodes_to_batch": 0.0003705430154743993, "add_one_ts_to_episodes_and_truncate": 0.006914285810757871, "add_columns_from_episodes_to_train_batch": 0.08018406604634044, "general_advantage_estimation": 0.08489672112623724, "add_states_from_episodes_to_batch": 1.1424210780035337e-05, "numpy_to_tensor": 0.0013418552944964193, "add_time_dim_to_batch_and_zero_pad": 3.2754344581849963e-05}}, "connector_pipeline_timer": 0.22476373799399535}, "num_module_steps_trained_lifetime": 8663168, "learner_connector_sum_episodes_length_out": 2016.4986436130305, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 136524696, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 286000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.24597242313216, "done": false, "training_iteration": 143, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-30-45", "timestamp": 1747697445, "time_this_iter_s": 40.53441023826599, "time_total_s": 5764.935730457306, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5764.935730457306, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 76.46724137931035, "ram_util_percent": 52.75862068965518}}
{"timers": {"training_iteration": 41.16943172709618, "restore_env_runners": 2.777211671492834e-05, "training_step": 41.16889020204998, "env_runner_sampling_timer": 31.461632068463974, "learner_update_timer": 9.696051821623522, "synch_weights": 0.010106511678952008, "synch_env_connectors": 0.009500934730531615}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.355666666666667, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001705360693842512, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.44291914109962e-06, "un_batch_to_individual_items": 7.74405286561198e-05, "listify_data_for_vector_env": 0.00014399635507355042, "normalize_and_clip_actions": 0.00013054686237618925, "get_actions": 0.0007587012157688552, "tensor_to_numpy": 0.0002468254209279753}}}, "num_module_steps_sampled_lifetime": {"default_policy": 288000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 288000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.459034883512195e-05, "add_states_from_episodes_to_batch": 2.1048237217263023e-05, "numpy_to_tensor": 0.00017169393445124517, "add_time_dim_to_batch_and_zero_pad": 3.8789744252803054e-05, "batch_individual_items": 9.928041392547222e-05}}, "connector_pipeline_timer": 0.00063651325688538}, "episode_return_max": 0.7684444444444447, "episode_duration_sec_mean": 23.684074730384125, "num_episodes_lifetime": 1328, "rlmodule_inference_timer": 0.0005936613394462144, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5206346153846159, "env_to_module_sum_episodes_length_out": 92.52941614305423, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11626972721581373, "num_env_steps_sampled_lifetime": 288000, "weights_seq_no": 143.0, "agent_episode_returns_mean": {"default_agent": 0.5206346153846159}, "module_episode_returns_mean": {"default_policy": 0.5206346153846159}, "num_env_steps_sampled": 2000, "sample": 29.89961322869296, "env_to_module_sum_episodes_length_in": 92.52941614305423, "time_between_sampling": 11.344450275438998, "num_env_steps_sampled_lifetime_throughput": 48.003112123171505}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03402353823184967, "weights_seq_no": 144.0, "vf_loss_unclipped": 0.0044996477663517, "total_loss": -0.02952389232814312, "gradients_default_optimizer_global_norm": 0.28073519468307495, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10142344236373901, "entropy": 0.05502527952194214, "curr_kl_coeff": 1.109335692048086e-32, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0014082700945436954, "num_module_steps_trained_lifetime": 8723712, "vf_loss": 0.0044996477663517}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05056484126917553, "add_observations_from_episodes_to_batch": 0.000370719189258782, "add_one_ts_to_episodes_and_truncate": 0.006910287425234415, "add_columns_from_episodes_to_train_batch": 0.08020250122537856, "general_advantage_estimation": 0.08446835687519612, "add_states_from_episodes_to_batch": 1.1429350115931342e-05, "numpy_to_tensor": 0.001341948273479579, "add_time_dim_to_batch_and_zero_pad": 3.278683326064181e-05}}, "connector_pipeline_timer": 0.22442455286527657}, "num_module_steps_trained_lifetime": 8723712, "learner_connector_sum_episodes_length_out": 2016.5024970360773, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 137478264, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 288000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.003112123171505, "done": false, "training_iteration": 144, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-31-27", "timestamp": 1747697487, "time_this_iter_s": 41.59468674659729, "time_total_s": 5806.530417203903, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5806.530417203903, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 77.37288135593221, "ram_util_percent": 52.78305084745764}}
{"timers": {"training_iteration": 41.167181078815204, "restore_env_runners": 2.7768395596882105e-05, "training_step": 41.16663921001942, "env_runner_sampling_timer": 31.454365566769305, "learner_update_timer": 9.701098144407252, "synch_weights": 0.010076619562122743, "synch_env_connectors": 0.009508574383263062}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.35277777777777797, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017008515412141139, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.219802802102735e-06, "un_batch_to_individual_items": 7.654937702066179e-05, "listify_data_for_vector_env": 0.0001431576739287229, "normalize_and_clip_actions": 0.0001305716256571344, "get_actions": 0.0007571599809758385, "tensor_to_numpy": 0.00024906242452955494}}}, "num_module_steps_sampled_lifetime": {"default_policy": 290000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 290000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.388636101360845e-05, "add_states_from_episodes_to_batch": 2.0699898077509277e-05, "numpy_to_tensor": 0.00017038078180052217, "add_time_dim_to_batch_and_zero_pad": 3.9013922398518054e-05, "batch_individual_items": 9.910566131034433e-05}}, "connector_pipeline_timer": 0.000634043839631912}, "episode_return_max": 0.8084444444444441, "episode_duration_sec_mean": 23.94751411546951, "num_episodes_lifetime": 1336, "rlmodule_inference_timer": 0.0005915836053483007, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5597585470085471, "env_to_module_sum_episodes_length_out": 93.54915540908796, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11560150413228355, "num_env_steps_sampled_lifetime": 290000, "weights_seq_no": 144.0, "agent_episode_returns_mean": {"default_agent": 0.5597585470085471}, "module_episode_returns_mean": {"default_policy": 0.5597585470085471}, "num_env_steps_sampled": 2000, "sample": 29.90781932906322, "env_to_module_sum_episodes_length_in": 93.54915540908796, "time_between_sampling": 11.338567541101769, "num_env_steps_sampled_lifetime_throughput": 48.73529331011812}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.09093253314495087, "weights_seq_no": 145.0, "vf_loss_unclipped": 0.003747738664969802, "total_loss": 0.09468024969100952, "gradients_default_optimizer_global_norm": 0.4783562421798706, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07587951421737671, "entropy": 0.05723103508353233, "curr_kl_coeff": 5.54667846024043e-33, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004248213954269886, "num_module_steps_trained_lifetime": 8784256, "vf_loss": 0.003747738664969802}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0506552923455787, "add_observations_from_episodes_to_batch": 0.00037089747526648467, "add_one_ts_to_episodes_and_truncate": 0.006906269388840685, "add_columns_from_episodes_to_train_batch": 0.08022046691423135, "general_advantage_estimation": 0.08404112711706359, "add_states_from_episodes_to_batch": 1.1434224243490072e-05, "numpy_to_tensor": 0.0013422309473535969, "add_time_dim_to_batch_and_zero_pad": 3.281806673208525e-05}}, "connector_pipeline_timer": 0.22410153384533282}, "num_module_steps_trained_lifetime": 8784256, "learner_connector_sum_episodes_length_out": 2016.506223526302, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 138431832, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 290000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.73529331011812, "done": false, "training_iteration": 145, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-32-08", "timestamp": 1747697528, "time_this_iter_s": 40.99939489364624, "time_total_s": 5847.529812097549, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5847.529812097549, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 76.81896551724138, "ram_util_percent": 52.78275862068966}}
{"timers": {"training_iteration": 41.17182577636708, "restore_env_runners": 2.778371161641298e-05, "training_step": 41.17128318625921, "env_runner_sampling_timer": 31.454214990441617, "learner_update_timer": 9.705916950963212, "synch_weights": 0.010051605366476696, "synch_env_connectors": 0.009855913639431526}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3283333333333338, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017033342758105917, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.033913630251382e-06, "un_batch_to_individual_items": 7.761411349986446e-05, "listify_data_for_vector_env": 0.0001426233248293248, "normalize_and_clip_actions": 0.0001292141572295287, "get_actions": 0.0007596827967609437, "tensor_to_numpy": 0.00024975377620269177}}}, "num_module_steps_sampled_lifetime": {"default_policy": 292000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 292000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.4173801789407124e-05, "add_states_from_episodes_to_batch": 2.0429335431163826e-05, "numpy_to_tensor": 0.00016955245178721425, "add_time_dim_to_batch_and_zero_pad": 3.9429518864358086e-05, "batch_individual_items": 9.871019443987687e-05}}, "connector_pipeline_timer": 0.0006339683181201501}, "episode_return_max": 0.8084444444444441, "episode_duration_sec_mean": 23.89935084883613, "num_episodes_lifetime": 1344, "rlmodule_inference_timer": 0.000587320339791968, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4965149572649575, "env_to_module_sum_episodes_length_out": 96.67530324362478, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11498288229630335, "num_env_steps_sampled_lifetime": 292000, "weights_seq_no": 145.0, "agent_episode_returns_mean": {"default_agent": 0.4965149572649575}, "module_episode_returns_mean": {"default_policy": 0.4965149572649575}, "num_env_steps_sampled": 2000, "sample": 29.915637359841398, "env_to_module_sum_episodes_length_in": 96.67530324362478, "time_between_sampling": 11.333219316604652, "num_env_steps_sampled_lifetime_throughput": 47.87224536665298}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.019233204424381256, "weights_seq_no": 146.0, "vf_loss_unclipped": 0.007087279576808214, "total_loss": 0.026320479810237885, "gradients_default_optimizer_global_norm": 0.4377438426017761, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.20283252000808716, "entropy": 0.08921493589878082, "curr_kl_coeff": 2.773339230120215e-33, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0012912984238937497, "num_module_steps_trained_lifetime": 8844800, "vf_loss": 0.007087279576808214}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05074336069632657, "add_observations_from_episodes_to_batch": 0.0003710664936353226, "add_one_ts_to_episodes_and_truncate": 0.006902165124432606, "add_columns_from_episodes_to_train_batch": 0.08023827449918447, "general_advantage_estimation": 0.08361516762840593, "add_states_from_episodes_to_batch": 1.143895795313083e-05, "numpy_to_tensor": 0.0013425606429232572, "add_time_dim_to_batch_and_zero_pad": 3.284829685102791e-05}}, "connector_pipeline_timer": 0.2237771897405018}, "num_module_steps_trained_lifetime": 8844800, "learner_connector_sum_episodes_length_out": 2016.5098252370183, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 139385400, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 292000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.87224536665298, "done": false, "training_iteration": 146, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-32-50", "timestamp": 1747697570, "time_this_iter_s": 41.64755630493164, "time_total_s": 5889.177368402481, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5889.177368402481, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 76.96949152542372, "ram_util_percent": 52.79830508474578}}
{"timers": {"training_iteration": 41.20192431099343, "restore_env_runners": 2.776487450789408e-05, "training_step": 41.201381631786624, "env_runner_sampling_timer": 31.478139404877254, "learner_update_timer": 9.712053009503606, "synch_weights": 0.010090674312809097, "synch_env_connectors": 0.009839507503003848}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.306222222222223, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017048669899731566, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.004774498485611e-06, "un_batch_to_individual_items": 7.67753452201258e-05, "listify_data_for_vector_env": 0.00014425210615334882, "normalize_and_clip_actions": 0.00012923721579307363, "get_actions": 0.0007589021881076927, "tensor_to_numpy": 0.0002505599247082726}}}, "num_module_steps_sampled_lifetime": {"default_policy": 294000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 294000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.345931937267503e-05, "add_states_from_episodes_to_batch": 2.0900812431292718e-05, "numpy_to_tensor": 0.00016927126948464274, "add_time_dim_to_batch_and_zero_pad": 3.952547260123384e-05, "batch_individual_items": 9.785066344567011e-05}}, "connector_pipeline_timer": 0.0006345386325270758}, "episode_return_max": 0.7852222222222239, "episode_duration_sec_mean": 24.639116070768697, "num_episodes_lifetime": 1360, "rlmodule_inference_timer": 0.0005873347246962849, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.4876292735042744, "env_to_module_sum_episodes_length_out": 97.61472595869887, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11575297079986521, "num_env_steps_sampled_lifetime": 294000, "weights_seq_no": 146.0, "agent_episode_returns_mean": {"default_agent": 0.4876292735042744}, "module_episode_returns_mean": {"default_policy": 0.4876292735042744}, "num_env_steps_sampled": 2000, "sample": 29.925009340576835, "env_to_module_sum_episodes_length_in": 97.61472595869887, "time_between_sampling": 11.328374134569707, "num_env_steps_sampled_lifetime_throughput": 45.18646194073263}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.020033249631524086, "weights_seq_no": 147.0, "vf_loss_unclipped": 0.0060153198428452015, "total_loss": 0.026048574596643448, "gradients_default_optimizer_global_norm": 0.9836377501487732, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.020015478134155273, "entropy": 0.08150509744882584, "curr_kl_coeff": 2.773339230120215e-33, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005704904440790415, "num_module_steps_trained_lifetime": 8905600, "vf_loss": 0.0060153198428452015}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.050829457990824715, "add_observations_from_episodes_to_batch": 0.00037125294188921325, "add_one_ts_to_episodes_and_truncate": 0.006898251148373788, "add_columns_from_episodes_to_train_batch": 0.08025629782574709, "general_advantage_estimation": 0.08319043648680949, "add_states_from_episodes_to_batch": 1.144369356613765e-05, "numpy_to_tensor": 0.0013430120914866932, "add_time_dim_to_batch_and_zero_pad": 3.288394056115651e-05}}, "connector_pipeline_timer": 0.22345265960438257}, "num_module_steps_trained_lifetime": 8905600, "learner_connector_sum_episodes_length_out": 2016.5141042911678, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 140346800, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 294000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.18646194073263, "done": false, "training_iteration": 147, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-33-34", "timestamp": 1747697614, "time_this_iter_s": 44.236833572387695, "time_total_s": 5933.414201974869, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5933.414201974869, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 77.18095238095239, "ram_util_percent": 52.803174603174625}}
{"timers": {"training_iteration": 41.19932235394355, "restore_env_runners": 2.7725225756075156e-05, "training_step": 41.19877791252878, "env_runner_sampling_timer": 31.476629098888473, "learner_update_timer": 9.71098326140859, "synch_weights": 0.010066429569745976, "synch_env_connectors": 0.00997980042800055}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3104444444444453, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001709667378171563, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.874078040659088e-06, "un_batch_to_individual_items": 7.588634892962322e-05, "listify_data_for_vector_env": 0.00014601244655361033, "normalize_and_clip_actions": 0.00012944853847139947, "get_actions": 0.0007639206706184407, "tensor_to_numpy": 0.0002498057554650548}}}, "num_module_steps_sampled_lifetime": {"default_policy": 296000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 296000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.339097235458712e-05, "add_states_from_episodes_to_batch": 2.176297392673394e-05, "numpy_to_tensor": 0.0001686919557699595, "add_time_dim_to_batch_and_zero_pad": 3.9211195123495264e-05, "batch_individual_items": 9.87565672478585e-05}}, "connector_pipeline_timer": 0.0006360524707250295}, "episode_return_max": 0.7084444444444455, "episode_duration_sec_mean": 24.329237732095233, "num_episodes_lifetime": 1368, "rlmodule_inference_timer": 0.0005844896594372248, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4762489316239324, "env_to_module_sum_episodes_length_out": 96.17525125683689, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11599024330176509, "num_env_steps_sampled_lifetime": 296000, "weights_seq_no": 147.0, "agent_episode_returns_mean": {"default_agent": 0.4762489316239324}, "module_episode_returns_mean": {"default_policy": 0.4762489316239324}, "num_env_steps_sampled": 2000, "sample": 29.933853284729146, "env_to_module_sum_episodes_length_in": 96.17525125683689, "time_between_sampling": 11.324106144228002, "num_env_steps_sampled_lifetime_throughput": 48.66840079092908}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.140032097697258, "weights_seq_no": 148.0, "vf_loss_unclipped": 0.005753193516284227, "total_loss": -0.13427890837192535, "gradients_default_optimizer_global_norm": 0.1940840184688568, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.003239750862121582, "entropy": 0.059665877372026443, "curr_kl_coeff": 1.3866696150601075e-33, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0012526902137324214, "num_module_steps_trained_lifetime": 8966144, "vf_loss": 0.005753193516284227}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05091295644336355, "add_observations_from_episodes_to_batch": 0.00037142942452870857, "add_one_ts_to_episodes_and_truncate": 0.006894266875323279, "add_columns_from_episodes_to_train_batch": 0.08027431217832859, "general_advantage_estimation": 0.0827668183812823, "add_states_from_episodes_to_batch": 1.1448180571351411e-05, "numpy_to_tensor": 0.0013434642850147969, "add_time_dim_to_batch_and_zero_pad": 3.2918236567203156e-05}}, "connector_pipeline_timer": 0.22312654901201182}, "num_module_steps_trained_lifetime": 8966144, "learner_connector_sum_episodes_length_out": 2016.5182467817106, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 141300368, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 296000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.66840079092908, "done": false, "training_iteration": 148, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-34-15", "timestamp": 1747697655, "time_this_iter_s": 40.96316051483154, "time_total_s": 5974.3773624897, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5974.3773624897, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 77.84827586206897, "ram_util_percent": 52.76724137931033}}
{"timers": {"training_iteration": 41.20208514243409, "restore_env_runners": 2.7639973505305608e-05, "training_step": 41.20154162843349, "env_runner_sampling_timer": 31.47562438787957, "learner_update_timer": 9.71479937084452, "synch_weights": 0.010020329274068552, "synch_env_connectors": 0.009993706423752703}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3537777777777787, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017106026606433153, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.695157567218342e-06, "un_batch_to_individual_items": 7.557918011275943e-05, "listify_data_for_vector_env": 0.0001466707483938523, "normalize_and_clip_actions": 0.0001300240556925599, "get_actions": 0.000766465864852582, "tensor_to_numpy": 0.0002474454236056096}}}, "num_module_steps_sampled_lifetime": {"default_policy": 298000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 298000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3454178903984307e-05, "add_states_from_episodes_to_batch": 2.2313841738207176e-05, "numpy_to_tensor": 0.00016918012951501723, "add_time_dim_to_batch_and_zero_pad": 3.905374959653844e-05, "batch_individual_items": 9.940646789497936e-05}}, "connector_pipeline_timer": 0.0006390985373253236}, "episode_return_max": 0.8436666666666679, "episode_duration_sec_mean": 23.962628643164372, "num_episodes_lifetime": 1376, "rlmodule_inference_timer": 0.0005833580290395158, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5325747863247868, "env_to_module_sum_episodes_length_out": 94.14158822341957, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11598240071683448, "num_env_steps_sampled_lifetime": 298000, "weights_seq_no": 148.0, "agent_episode_returns_mean": {"default_agent": 0.5325747863247868}, "module_episode_returns_mean": {"default_policy": 0.5325747863247868}, "num_env_steps_sampled": 2000, "sample": 29.94229025477115, "env_to_module_sum_episodes_length_in": 94.14158822341957, "time_between_sampling": 11.319761430963446, "num_env_steps_sampled_lifetime_throughput": 48.109347270097665}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02319660782814026, "weights_seq_no": 149.0, "vf_loss_unclipped": 0.004842682741582394, "total_loss": -0.018353909254074097, "gradients_default_optimizer_global_norm": 0.31971898674964905, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0830763578414917, "entropy": 0.0713949054479599, "curr_kl_coeff": 6.9333480753005375e-34, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00030645664082840085, "num_module_steps_trained_lifetime": 9026688, "vf_loss": 0.004842682741582394}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.050995210681152266, "add_observations_from_episodes_to_batch": 0.0003715974822214404, "add_one_ts_to_episodes_and_truncate": 0.00689023498261889, "add_columns_from_episodes_to_train_batch": 0.08029210095407606, "general_advantage_estimation": 0.08234440415421655, "add_states_from_episodes_to_batch": 1.1452453467595108e-05, "numpy_to_tensor": 0.0013439048234633155, "add_time_dim_to_batch_and_zero_pad": 3.295130825891234e-05}}, "connector_pipeline_timer": 0.22280010414562804}, "num_module_steps_trained_lifetime": 9026688, "learner_connector_sum_episodes_length_out": 2016.5222550120134, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 142253936, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 298000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.109347270097665, "done": false, "training_iteration": 149, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-34-57", "timestamp": 1747697697, "time_this_iter_s": 41.49095797538757, "time_total_s": 6015.868320465088, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6015.868320465088, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 76.94745762711865, "ram_util_percent": 52.78305084745764}}
{"timers": {"training_iteration": 41.20683567368977, "restore_env_runners": 2.7719573788907874e-05, "training_step": 41.20629185682914, "env_runner_sampling_timer": 31.475219752240733, "learner_update_timer": 9.72000077457605, "synch_weights": 0.009973871981303811, "synch_env_connectors": 0.009964440359509212}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3427777777777778, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017129804721014291, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.538384891273487e-06, "un_batch_to_individual_items": 7.54421553706477e-05, "listify_data_for_vector_env": 0.0001451889197191986, "normalize_and_clip_actions": 0.00012841262765549594, "get_actions": 0.0007718320692470742, "tensor_to_numpy": 0.0002458187372114379}}}, "num_module_steps_sampled_lifetime": {"default_policy": 300000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 300000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.293676188184715e-05, "add_states_from_episodes_to_batch": 2.2380602712084267e-05, "numpy_to_tensor": 0.00016889737736571517, "add_time_dim_to_batch_and_zero_pad": 3.888177194542986e-05, "batch_individual_items": 9.921940235737925e-05}}, "connector_pipeline_timer": 0.0006379211893931961}, "episode_return_max": 0.8436666666666679, "episode_duration_sec_mean": 24.175633919596223, "num_episodes_lifetime": 1384, "rlmodule_inference_timer": 0.0005837117541618914, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.562717948717949, "env_to_module_sum_episodes_length_out": 92.88010017269711, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11579256427522398, "num_env_steps_sampled_lifetime": 300000, "weights_seq_no": 149.0, "agent_episode_returns_mean": {"default_agent": 0.562717948717949}, "module_episode_returns_mean": {"default_policy": 0.562717948717949}, "num_env_steps_sampled": 2000, "sample": 29.950623588632133, "env_to_module_sum_episodes_length_in": 92.88010017269711, "time_between_sampling": 11.31566916039374, "num_env_steps_sampled_lifetime_throughput": 47.89280853662833}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07356663048267365, "weights_seq_no": 150.0, "vf_loss_unclipped": 0.004558937158435583, "total_loss": 0.07812557369470596, "gradients_default_optimizer_global_norm": 0.6370370984077454, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.02370285987854004, "entropy": 0.051091767847537994, "curr_kl_coeff": 3.4666740376502688e-34, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0005604553734883666, "num_module_steps_trained_lifetime": 9087232, "vf_loss": 0.004558937158435583}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05107496309874086, "add_observations_from_episodes_to_batch": 0.0003717577858184016, "add_one_ts_to_episodes_and_truncate": 0.006886163611081049, "add_columns_from_episodes_to_train_batch": 0.08030973457339041, "general_advantage_estimation": 0.08192342025985397, "add_states_from_episodes_to_batch": 1.1456856088026168e-05, "numpy_to_tensor": 0.0013443580747145246, "add_time_dim_to_batch_and_zero_pad": 3.298782669345299e-05}}, "connector_pipeline_timer": 0.2224724045521701}, "num_module_steps_trained_lifetime": 9087232, "learner_connector_sum_episodes_length_out": 2016.526131253032, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 143207504, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 300000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.89280853662833, "done": false, "training_iteration": 150, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-35-38", "timestamp": 1747697738, "time_this_iter_s": 41.694687366485596, "time_total_s": 6057.5630078315735, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6057.5630078315735, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 76.42333333333335, "ram_util_percent": 52.81333333333335}}
{"timers": {"training_iteration": 41.20510142199289, "restore_env_runners": 2.7639378095882464e-05, "training_step": 41.20455840730086, "env_runner_sampling_timer": 31.472813817838308, "learner_update_timer": 9.72071892975025, "synch_weights": 0.00992851426142703, "synch_env_connectors": 0.00995021095590822}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.31666666666666665, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001716805195617213, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.436951758736305e-06, "un_batch_to_individual_items": 7.576994560031177e-05, "listify_data_for_vector_env": 0.00014514018394859852, "normalize_and_clip_actions": 0.00012861851106499652, "get_actions": 0.0007726803444190923, "tensor_to_numpy": 0.00024532837743963766}}}, "num_module_steps_sampled_lifetime": {"default_policy": 302000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 302000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.264131433629479e-05, "add_states_from_episodes_to_batch": 2.2024632275919986e-05, "numpy_to_tensor": 0.00017085467572163163, "add_time_dim_to_batch_and_zero_pad": 3.863406499503331e-05, "batch_individual_items": 9.987704601373192e-05}}, "connector_pipeline_timer": 0.0006401374393814831}, "episode_return_max": 0.7945555555555555, "episode_duration_sec_mean": 24.19685708335559, "num_episodes_lifetime": 1392, "rlmodule_inference_timer": 0.0005857101175319395, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5127788461538463, "env_to_module_sum_episodes_length_out": 93.20270419859831, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11541054747436749, "num_env_steps_sampled_lifetime": 302000, "weights_seq_no": 150.0, "agent_episode_returns_mean": {"default_agent": 0.5127788461538463}, "module_episode_returns_mean": {"default_policy": 0.5127788461538463}, "num_env_steps_sampled": 2000, "sample": 29.958594318933198, "env_to_module_sum_episodes_length_in": 93.20270419859831, "time_between_sampling": 11.311786199053897, "num_env_steps_sampled_lifetime_throughput": 48.500697914458975}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.01294136606156826, "weights_seq_no": 151.0, "vf_loss_unclipped": 0.00551757775247097, "total_loss": -0.007423793897032738, "gradients_default_optimizer_global_norm": 0.17938199639320374, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04838448762893677, "entropy": 0.06574328243732452, "curr_kl_coeff": 3.4666740376502688e-34, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.00594649463891983, "num_module_steps_trained_lifetime": 9147776, "vf_loss": 0.00551757775247097}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05115345279690944, "add_observations_from_episodes_to_batch": 0.00037191313359489266, "add_one_ts_to_episodes_and_truncate": 0.006882173473475557, "add_columns_from_episodes_to_train_batch": 0.08032723515032306, "general_advantage_estimation": 0.0815037714429635, "add_states_from_episodes_to_batch": 1.1461215411031944e-05, "numpy_to_tensor": 0.0013448102404583211, "add_time_dim_to_batch_and_zero_pad": 3.302727962835933e-05}}, "connector_pipeline_timer": 0.22214474645026674}, "num_module_steps_trained_lifetime": 9147776, "learner_connector_sum_episodes_length_out": 2016.529877743729, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 144161072, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 302000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.500697914458975, "done": false, "training_iteration": 151, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-36-20", "timestamp": 1747697780, "time_this_iter_s": 41.048787355422974, "time_total_s": 6098.6117951869965, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6098.6117951869965, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 78.18103448275862, "ram_util_percent": 52.81724137931035}}
{"timers": {"training_iteration": 41.20248269207295, "restore_env_runners": 2.761998430733988e-05, "training_step": 41.20194018252788, "env_runner_sampling_timer": 31.469587776849874, "learner_update_timer": 9.721340938562722, "synch_weights": 0.009918369118867372, "synch_env_connectors": 0.009917898846321608}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.31666666666666665, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017100657179440026, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.32461314172518e-06, "un_batch_to_individual_items": 7.494941008009806e-05, "listify_data_for_vector_env": 0.00014440685257086764, "normalize_and_clip_actions": 0.00012774442422665462, "get_actions": 0.0007702521700953415, "tensor_to_numpy": 0.00024350947587978283}}}, "num_module_steps_sampled_lifetime": {"default_policy": 304000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 304000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.271812490169917e-05, "add_states_from_episodes_to_batch": 2.191409109188616e-05, "numpy_to_tensor": 0.0001721861681144535, "add_time_dim_to_batch_and_zero_pad": 3.825600316828564e-05, "batch_individual_items": 9.98333879358106e-05}}, "connector_pipeline_timer": 0.0006421379743161535}, "episode_return_max": 0.7945555555555555, "episode_duration_sec_mean": 24.0976554876451, "num_episodes_lifetime": 1400, "rlmodule_inference_timer": 0.0005878387246768942, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5050918803418806, "env_to_module_sum_episodes_length_out": 95.54315455438017, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11480095853385723, "num_env_steps_sampled_lifetime": 304000, "weights_seq_no": 151.0, "agent_episode_returns_mean": {"default_agent": 0.5050918803418806}, "module_episode_returns_mean": {"default_policy": 0.5050918803418806}, "num_env_steps_sampled": 2000, "sample": 29.965892571438868, "env_to_module_sum_episodes_length_in": 95.54315455438017, "time_between_sampling": 11.307768415252168, "num_env_steps_sampled_lifetime_throughput": 48.74983898443018}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.04964036867022514, "weights_seq_no": 152.0, "vf_loss_unclipped": 0.005869201850146055, "total_loss": -0.0437711738049984, "gradients_default_optimizer_global_norm": 0.25293344259262085, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.02204793691635132, "entropy": 0.031788717955350876, "curr_kl_coeff": 1.7333370188251344e-34, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.000761211384087801, "num_module_steps_trained_lifetime": 9208320, "vf_loss": 0.005869201850146055}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05122956730470487, "add_observations_from_episodes_to_batch": 0.0003720663486374543, "add_one_ts_to_episodes_and_truncate": 0.006878116842260724, "add_columns_from_episodes_to_train_batch": 0.08034492133215912, "general_advantage_estimation": 0.08108544899038492, "add_states_from_episodes_to_batch": 1.1465401862036611e-05, "numpy_to_tensor": 0.0013452703370801689, "add_time_dim_to_batch_and_zero_pad": 3.3065564722304634e-05}}, "connector_pipeline_timer": 0.22181615958974632}, "num_module_steps_trained_lifetime": 9208320, "learner_connector_sum_episodes_length_out": 2016.5334966914868, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 145114640, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 304000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.74983898443018, "done": false, "training_iteration": 152, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-37-01", "timestamp": 1747697821, "time_this_iter_s": 40.9602689743042, "time_total_s": 6139.572064161301, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6139.572064161301, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 77.15689655172415, "ram_util_percent": 52.81551724137932}}
{"timers": {"training_iteration": 41.23154760478219, "restore_env_runners": 2.7594784483755338e-05, "training_step": 41.23100573833261, "env_runner_sampling_timer": 31.49485310151136, "learner_update_timer": 9.725189607377143, "synch_weights": 0.009870801427661158, "synch_env_connectors": 0.009913508847885546}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.33277777777777856, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017056695973301133, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.234011218265049e-06, "un_batch_to_individual_items": 7.51001165343007e-05, "listify_data_for_vector_env": 0.00014483064777372296, "normalize_and_clip_actions": 0.00012835087425313617, "get_actions": 0.0007663816391591219, "tensor_to_numpy": 0.00024260478404335522}}}, "num_module_steps_sampled_lifetime": {"default_policy": 306000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 306000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.306820941377043e-05, "add_states_from_episodes_to_batch": 2.1404511685331266e-05, "numpy_to_tensor": 0.0001726929368862201, "add_time_dim_to_batch_and_zero_pad": 3.8204891002749794e-05, "batch_individual_items": 9.881094855149217e-05}}, "connector_pipeline_timer": 0.000641755509553567}, "episode_return_max": 0.754333333333335, "episode_duration_sec_mean": 24.607122060855545, "num_episodes_lifetime": 1416, "rlmodule_inference_timer": 0.0005845822162160142, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.54647435897436, "env_to_module_sum_episodes_length_out": 97.24262117046396, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11563573331033586, "num_env_steps_sampled_lifetime": 306000, "weights_seq_no": 152.0, "agent_episode_returns_mean": {"default_agent": 0.54647435897436}, "module_episode_returns_mean": {"default_policy": 0.54647435897436}, "num_env_steps_sampled": 2000, "sample": 29.974687047263636, "env_to_module_sum_episodes_length_in": 97.24262117046396, "time_between_sampling": 11.303890064171673, "num_env_steps_sampled_lifetime_throughput": 45.26354536817304}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.04759494215250015, "weights_seq_no": 153.0, "vf_loss_unclipped": 0.00864111352711916, "total_loss": -0.038953810930252075, "gradients_default_optimizer_global_norm": 0.3070211112499237, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.062243103981018066, "entropy": 0.06901440769433975, "curr_kl_coeff": 8.666685094125672e-35, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0029652146622538567, "num_module_steps_trained_lifetime": 9269120, "vf_loss": 0.00864111352711916}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05130334648706533, "add_observations_from_episodes_to_batch": 0.0003722240480659628, "add_one_ts_to_episodes_and_truncate": 0.006874107756322758, "add_columns_from_episodes_to_train_batch": 0.08036318850684326, "general_advantage_estimation": 0.08066865465971358, "add_states_from_episodes_to_batch": 1.1469388462319457e-05, "numpy_to_tensor": 0.0013456885607451485, "add_time_dim_to_batch_and_zero_pad": 3.310237138648465e-05}}, "connector_pipeline_timer": 0.22148734439179127}, "num_module_steps_trained_lifetime": 9269120, "learner_connector_sum_episodes_length_out": 2016.537790272515, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 146076040, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 306000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.26354536817304, "done": false, "training_iteration": 153, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-37-45", "timestamp": 1747697865, "time_this_iter_s": 44.12609314918518, "time_total_s": 6183.698157310486, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6183.698157310486, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 77.32539682539682, "ram_util_percent": 52.81904761904764}}
{"timers": {"training_iteration": 41.24049210152437, "restore_env_runners": 2.7536836625407087e-05, "training_step": 41.23995078273922, "env_runner_sampling_timer": 31.504311856636225, "learner_update_timer": 9.724681009953333, "synch_weights": 0.009866609413411035, "synch_env_connectors": 0.009900829759396684}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3277777777777786, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017091708151671168, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.320923547680384e-06, "un_batch_to_individual_items": 7.556927505854946e-05, "listify_data_for_vector_env": 0.00014476572269692443, "normalize_and_clip_actions": 0.00012837935836455428, "get_actions": 0.0007705823951424899, "tensor_to_numpy": 0.00024142091646320882}}}, "num_module_steps_sampled_lifetime": {"default_policy": 308000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 308000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.325125714479989e-05, "add_states_from_episodes_to_batch": 2.273007988919513e-05, "numpy_to_tensor": 0.00017180471918689755, "add_time_dim_to_batch_and_zero_pad": 3.879035849832477e-05, "batch_individual_items": 9.84744358476121e-05}}, "connector_pipeline_timer": 0.0006446589174169346}, "episode_return_max": 0.7885555555555569, "episode_duration_sec_mean": 25.11355715274931, "num_episodes_lifetime": 1424, "rlmodule_inference_timer": 0.0005884560958430619, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5843162393162402, "env_to_module_sum_episodes_length_out": 96.46656710819201, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11656695435007026, "num_env_steps_sampled_lifetime": 308000, "weights_seq_no": 153.0, "agent_episode_returns_mean": {"default_agent": 0.5843162393162402}, "module_episode_returns_mean": {"default_policy": 0.5843162393162402}, "num_env_steps_sampled": 2000, "sample": 29.984127473709606, "env_to_module_sum_episodes_length_in": 96.46656710819201, "time_between_sampling": 11.300471966427988, "num_env_steps_sampled_lifetime_throughput": 47.38959332480578}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08951722830533981, "weights_seq_no": 154.0, "vf_loss_unclipped": 0.009595467709004879, "total_loss": -0.07992174476385117, "gradients_default_optimizer_global_norm": 0.17764337360858917, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09553313255310059, "entropy": 0.04979647696018219, "curr_kl_coeff": 4.333342547062836e-35, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0018301343079656363, "num_module_steps_trained_lifetime": 9329664, "vf_loss": 0.009595467709004879}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.051375343039048005, "add_observations_from_episodes_to_batch": 0.0003723927168711704, "add_one_ts_to_episodes_and_truncate": 0.006870192870419214, "add_columns_from_episodes_to_train_batch": 0.08038211814580047, "general_advantage_estimation": 0.08025326719075664, "add_states_from_episodes_to_batch": 1.1513688790939935e-05, "numpy_to_tensor": 0.0013460758929032014, "add_time_dim_to_batch_and_zero_pad": 3.3138155360621544e-05}}, "connector_pipeline_timer": 0.2211589438517363}, "num_module_steps_trained_lifetime": 9329664, "learner_connector_sum_episodes_length_out": 2016.5419446322535, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 147029608, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 308000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.38959332480578, "done": false, "training_iteration": 154, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-38-27", "timestamp": 1747697907, "time_this_iter_s": 42.14571166038513, "time_total_s": 6225.843868970871, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6225.843868970871, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 78.56, "ram_util_percent": 52.79833333333335}}
{"timers": {"training_iteration": 41.24182835507914, "restore_env_runners": 2.7532468285412587e-05, "training_step": 41.24128704848183, "env_runner_sampling_timer": 31.506633209629857, "learner_update_timer": 9.723731030863766, "synch_weights": 0.009832806319283804, "synch_env_connectors": 0.00991067346177846}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3277777777777786, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017132651854690217, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.21640812190477e-06, "un_batch_to_individual_items": 7.559573732230634e-05, "listify_data_for_vector_env": 0.00014714115655846416, "normalize_and_clip_actions": 0.00013224958141229795, "get_actions": 0.0007709594030969344, "tensor_to_numpy": 0.0002412154804805807}}}, "num_module_steps_sampled_lifetime": {"default_policy": 310000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 310000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.414136022190596e-05, "add_states_from_episodes_to_batch": 2.273424218936516e-05, "numpy_to_tensor": 0.0001740293987952367, "add_time_dim_to_batch_and_zero_pad": 3.8954365802644035e-05, "batch_individual_items": 9.77848963786762e-05}}, "connector_pipeline_timer": 0.0006477776777696416}, "episode_return_max": 0.8817777777777793, "episode_duration_sec_mean": 24.52523346302909, "num_episodes_lifetime": 1432, "rlmodule_inference_timer": 0.0005870049855893779, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.6159497863247873, "env_to_module_sum_episodes_length_out": 94.48113097648307, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11671869983968428, "num_env_steps_sampled_lifetime": 310000, "weights_seq_no": 154.0, "agent_episode_returns_mean": {"default_agent": 0.6159497863247873}, "module_episode_returns_mean": {"default_policy": 0.6159497863247873}, "num_env_steps_sampled": 2000, "sample": 29.99331421431271, "env_to_module_sum_episodes_length_in": 94.48113097648307, "time_between_sampling": 11.296673385081187, "num_env_steps_sampled_lifetime_throughput": 48.23060845340745}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.1650143265724182, "weights_seq_no": 155.0, "vf_loss_unclipped": 0.008142730221152306, "total_loss": -0.15687160193920135, "gradients_default_optimizer_global_norm": 0.1700572669506073, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.056948304176330566, "entropy": 0.05050019174814224, "curr_kl_coeff": 2.166671273531418e-35, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0019915737211704254, "num_module_steps_trained_lifetime": 9390208, "vf_loss": 0.008142730221152306}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05144483808534284, "add_observations_from_episodes_to_batch": 0.00037255322989582647, "add_one_ts_to_episodes_and_truncate": 0.006866230111458497, "add_columns_from_episodes_to_train_batch": 0.08040124638312843, "general_advantage_estimation": 0.07983923066571294, "add_states_from_episodes_to_batch": 1.1556986174708744e-05, "numpy_to_tensor": 0.0013464192195619036, "add_time_dim_to_batch_and_zero_pad": 3.3172913418425065e-05}}, "connector_pipeline_timer": 0.2208294867880431}, "num_module_steps_trained_lifetime": 9390208, "learner_connector_sum_episodes_length_out": 2016.54596212577, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 147983176, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 310000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.23060845340745, "done": false, "training_iteration": 155, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-39-09", "timestamp": 1747697949, "time_this_iter_s": 41.39118814468384, "time_total_s": 6267.235057115555, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6267.235057115555, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 77.65254237288136, "ram_util_percent": 52.867796610169485}}
{"timers": {"training_iteration": 41.226856196438334, "restore_env_runners": 2.7554143608516132e-05, "training_step": 41.22627678590698, "env_runner_sampling_timer": 31.493407835043552, "learner_update_timer": 9.721965496945096, "synch_weights": 0.009808968266101743, "synch_env_connectors": 0.009907615727145888}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.34777777777777796, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017052003212084219, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.117695468272163e-06, "un_batch_to_individual_items": 7.445269456206738e-05, "listify_data_for_vector_env": 0.00014740743631201091, "normalize_and_clip_actions": 0.00013171728911193022, "get_actions": 0.0007679383781565251, "tensor_to_numpy": 0.00024049616138630212}}}, "num_module_steps_sampled_lifetime": {"default_policy": 312000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 312000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.349718784880633e-05, "add_states_from_episodes_to_batch": 2.2519495342666013e-05, "numpy_to_tensor": 0.00017333642387743614, "add_time_dim_to_batch_and_zero_pad": 3.856569999144602e-05, "batch_individual_items": 9.835222473405825e-05}}, "connector_pipeline_timer": 0.0006433898056572414}, "episode_return_max": 0.8817777777777793, "episode_duration_sec_mean": 24.12860125588633, "num_episodes_lifetime": 1440, "rlmodule_inference_timer": 0.0005859274590352432, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5797478632478638, "env_to_module_sum_episodes_length_out": 92.85637108621613, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11606318474862427, "num_env_steps_sampled_lifetime": 312000, "weights_seq_no": 155.0, "agent_episode_returns_mean": {"default_agent": 0.5797478632478638}, "module_episode_returns_mean": {"default_policy": 0.5797478632478638}, "num_env_steps_sampled": 2000, "sample": 30.001104857585357, "env_to_module_sum_episodes_length_in": 92.85637108621613, "time_between_sampling": 11.292777859578697, "num_env_steps_sampled_lifetime_throughput": 50.209044111235144}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.040534235537052155, "weights_seq_no": 156.0, "vf_loss_unclipped": 0.0051671285182237625, "total_loss": 0.04570135846734047, "gradients_default_optimizer_global_norm": 0.3607763350009918, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10621953010559082, "entropy": 0.08971143513917923, "curr_kl_coeff": 1.083335636765709e-35, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0007389112142845988, "num_module_steps_trained_lifetime": 9450752, "vf_loss": 0.0051671285182237625}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.051512399635308376, "add_observations_from_episodes_to_batch": 0.0003727160533886627, "add_one_ts_to_episodes_and_truncate": 0.006862280308190597, "add_columns_from_episodes_to_train_batch": 0.08042916646959515, "general_advantage_estimation": 0.07942640783425078, "add_states_from_episodes_to_batch": 1.1599706241974016e-05, "numpy_to_tensor": 0.0013467351419975688, "add_time_dim_to_batch_and_zero_pad": 3.320706249923228e-05}}, "connector_pipeline_timer": 0.22050809401533847}, "num_module_steps_trained_lifetime": 9450752, "learner_connector_sum_episodes_length_out": 2016.549845074953, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 148936744, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 312000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.209044111235144, "done": false, "training_iteration": 156, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-39-48", "timestamp": 1747697988, "time_this_iter_s": 39.76466631889343, "time_total_s": 6306.999723434448, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6306.999723434448, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 77.83571428571427, "ram_util_percent": 52.89464285714286}}
{"timers": {"training_iteration": 41.227664873794, "restore_env_runners": 2.797260214544031e-05, "training_step": 41.22708445036793, "env_runner_sampling_timer": 31.487639322803066, "learner_update_timer": 9.728561401185624, "synch_weights": 0.009789060583438194, "synch_env_connectors": 0.009899008579903184}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.33277777777777795, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001704537411802576, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.309901715133655e-06, "un_batch_to_individual_items": 7.523163699029936e-05, "listify_data_for_vector_env": 0.00014513723873826577, "normalize_and_clip_actions": 0.00013282751624860885, "get_actions": 0.0007662734877491474, "tensor_to_numpy": 0.0002405342716208457}}}, "num_module_steps_sampled_lifetime": {"default_policy": 314000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 314000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.313512106583148e-05, "add_states_from_episodes_to_batch": 2.260638952617805e-05, "numpy_to_tensor": 0.00017389598915461716, "add_time_dim_to_batch_and_zero_pad": 3.8305108913174595e-05, "batch_individual_items": 9.93941864541623e-05}}, "connector_pipeline_timer": 0.0006434520829878112}, "episode_return_max": 0.8412222222222223, "episode_duration_sec_mean": 23.449810418377847, "num_episodes_lifetime": 1448, "rlmodule_inference_timer": 0.0005869364300981412, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5256089743589745, "env_to_module_sum_episodes_length_out": 92.57905858638796, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1156341923738405, "num_env_steps_sampled_lifetime": 314000, "weights_seq_no": 156.0, "agent_episode_returns_mean": {"default_agent": 0.5256089743589745}, "module_episode_returns_mean": {"default_policy": 0.5256089743589745}, "num_env_steps_sampled": 2000, "sample": 30.008171332114042, "env_to_module_sum_episodes_length_in": 92.57905858638796, "time_between_sampling": 11.288717127783487, "num_env_steps_sampled_lifetime_throughput": 48.2896736384708}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02206352911889553, "weights_seq_no": 157.0, "vf_loss_unclipped": 0.003414429957047105, "total_loss": -0.01864909566938877, "gradients_default_optimizer_global_norm": 0.6170036792755127, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.040181875228881836, "entropy": 0.07174640148878098, "curr_kl_coeff": 5.416678183828545e-36, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004405566956847906, "num_module_steps_trained_lifetime": 9511296, "vf_loss": 0.003414429957047105}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.051596505220365976, "add_observations_from_episodes_to_batch": 0.00037289507508827873, "add_one_ts_to_episodes_and_truncate": 0.0068583268879770076, "add_columns_from_episodes_to_train_batch": 0.08045750156959398, "general_advantage_estimation": 0.07901485806635118, "add_states_from_episodes_to_batch": 1.164154620914974e-05, "numpy_to_tensor": 0.0013470237740629929, "add_time_dim_to_batch_and_zero_pad": 3.3243601306989207e-05}}, "connector_pipeline_timer": 0.22020492204920888}, "num_module_steps_trained_lifetime": 9511296, "learner_connector_sum_episodes_length_out": 2016.5535957689399, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 149890312, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 314000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.2896736384708, "done": false, "training_iteration": 157, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-40-30", "timestamp": 1747698030, "time_this_iter_s": 41.35006022453308, "time_total_s": 6348.349783658981, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6348.349783658981, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 76.06949152542373, "ram_util_percent": 52.87966101694916}}
{"timers": {"training_iteration": 41.22799889139603, "restore_env_runners": 2.7896876149391453e-05, "training_step": 41.22741900320426, "env_runner_sampling_timer": 31.492806054684987, "learner_update_timer": 9.72374972140377, "synch_weights": 0.009756346977600578, "synch_env_connectors": 0.010056360504138284}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.33277777777777795, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017044481379669943, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.496810244118787e-06, "un_batch_to_individual_items": 7.513338326622568e-05, "listify_data_for_vector_env": 0.00014424011470651616, "normalize_and_clip_actions": 0.00013235000334115265, "get_actions": 0.0007661923623581114, "tensor_to_numpy": 0.00024179103072153894}}}, "num_module_steps_sampled_lifetime": {"default_policy": 316000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 316000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.3188985887524844e-05, "add_states_from_episodes_to_batch": 2.2239518684112782e-05, "numpy_to_tensor": 0.00017556223025642456, "add_time_dim_to_batch_and_zero_pad": 3.8515325068500044e-05, "batch_individual_items": 9.925641763317044e-05}}, "connector_pipeline_timer": 0.000644606827057237}, "episode_return_max": 0.7213333333333333, "episode_duration_sec_mean": 23.651804189260055, "num_episodes_lifetime": 1456, "rlmodule_inference_timer": 0.0005905817993534992, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5279380341880342, "env_to_module_sum_episodes_length_out": 94.19804951583266, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11513707411678999, "num_env_steps_sampled_lifetime": 316000, "weights_seq_no": 157.0, "agent_episode_returns_mean": {"default_agent": 0.5279380341880342}, "module_episode_returns_mean": {"default_policy": 0.5279380341880342}, "num_env_steps_sampled": 2000, "sample": 30.01498234719187, "env_to_module_sum_episodes_length_in": 94.19804951583266, "time_between_sampling": 11.285183668433062, "num_env_steps_sampled_lifetime_throughput": 48.30218071467957}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.01782975345849991, "weights_seq_no": 158.0, "vf_loss_unclipped": 0.0069351703859865665, "total_loss": -0.01089457981288433, "gradients_default_optimizer_global_norm": 0.11129406839609146, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06626689434051514, "entropy": 0.05735088512301445, "curr_kl_coeff": 2.7083390919142725e-36, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004806125070899725, "num_module_steps_trained_lifetime": 9571840, "vf_loss": 0.0069351703859865665}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05167925180365893, "add_observations_from_episodes_to_batch": 0.00037306390474919324, "add_one_ts_to_episodes_and_truncate": 0.006854317368136868, "add_columns_from_episodes_to_train_batch": 0.08048565388094597, "general_advantage_estimation": 0.07860464392302612, "add_states_from_episodes_to_batch": 1.1682469405850255e-05, "numpy_to_tensor": 0.0013473124699725277, "add_time_dim_to_batch_and_zero_pad": 3.327944863245992e-05}}, "connector_pipeline_timer": 0.21990147612290015}, "num_module_steps_trained_lifetime": 9571840, "learner_connector_sum_episodes_length_out": 2016.5572164645396, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 150843880, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 316000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.30218071467957, "done": false, "training_iteration": 158, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-41-11", "timestamp": 1747698071, "time_this_iter_s": 41.278581380844116, "time_total_s": 6389.628365039825, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6389.628365039825, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 77.86896551724139, "ram_util_percent": 52.82586206896553}}
{"timers": {"training_iteration": 41.24389696533205, "restore_env_runners": 2.785390736592857e-05, "training_step": 41.243316133022226, "env_runner_sampling_timer": 31.51313255487813, "learner_update_timer": 9.719340954289741, "synch_weights": 0.00973743050787032, "synch_env_connectors": 0.010055910899039452}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2798888888888901, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017004353354998897, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.378469818891453e-06, "un_batch_to_individual_items": 7.542479079295811e-05, "listify_data_for_vector_env": 0.00014486040058570707, "normalize_and_clip_actions": 0.0001318573396350906, "get_actions": 0.0007645105226134748, "tensor_to_numpy": 0.0002398771565843473}}}, "num_module_steps_sampled_lifetime": {"default_policy": 318000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 318000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.283033421894944e-05, "add_states_from_episodes_to_batch": 2.2006979012493313e-05, "numpy_to_tensor": 0.00017577339574750974, "add_time_dim_to_batch_and_zero_pad": 3.8415199713445153e-05, "batch_individual_items": 9.911961066389111e-05}}, "connector_pipeline_timer": 0.0006420851842346713}, "episode_return_max": 0.9303333333333356, "episode_duration_sec_mean": 24.180975488395653, "num_episodes_lifetime": 1472, "rlmodule_inference_timer": 0.0005889764915308228, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5283429487179496, "env_to_module_sum_episodes_length_out": 96.9018142003549, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11564834813131025, "num_env_steps_sampled_lifetime": 318000, "weights_seq_no": 158.0, "agent_episode_returns_mean": {"default_agent": 0.5283429487179496}, "module_episode_returns_mean": {"default_policy": 0.5283429487179496}, "num_env_steps_sampled": 2000, "sample": 30.022836012458242, "env_to_module_sum_episodes_length_in": 96.9018142003549, "time_between_sampling": 11.281639138296999, "num_env_steps_sampled_lifetime_throughput": 46.619493505297875}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.10507655888795853, "weights_seq_no": 159.0, "vf_loss_unclipped": 0.009822893887758255, "total_loss": -0.09525365382432938, "gradients_default_optimizer_global_norm": 0.42826083302497864, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0663406252861023, "entropy": 0.04635252803564072, "curr_kl_coeff": 1.3541695459571362e-36, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0007491155411116779, "num_module_steps_trained_lifetime": 9632640, "vf_loss": 0.009822893887758255}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05175952461476383, "add_observations_from_episodes_to_batch": 0.0003732378483094538, "add_one_ts_to_episodes_and_truncate": 0.006850340216004699, "add_columns_from_episodes_to_train_batch": 0.08051319372601425, "general_advantage_estimation": 0.07819569971676048, "add_states_from_episodes_to_batch": 1.1722439984562815e-05, "numpy_to_tensor": 0.0013475664395869774, "add_time_dim_to_batch_and_zero_pad": 3.3313974650901664e-05}}, "connector_pipeline_timer": 0.21959620406301283}, "num_module_steps_trained_lifetime": 9632640, "learner_connector_sum_episodes_length_out": 2016.5615093866502, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 151805280, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 318000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.619493505297875, "done": false, "training_iteration": 159, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-41-54", "timestamp": 1747698114, "time_this_iter_s": 42.83468055725098, "time_total_s": 6432.463045597076, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6432.463045597076, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 77.82131147540984, "ram_util_percent": 52.86393442622952}}
{"timers": {"training_iteration": 41.23556781498876, "restore_env_runners": 2.7776368294831352e-05, "training_step": 41.23498887200203, "env_runner_sampling_timer": 31.50746296248934, "learner_update_timer": 9.716702619896827, "synch_weights": 0.009716606202731362, "synch_env_connectors": 0.010049517790029817}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2798888888888901, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016940892911962984, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.264957353510576e-06, "un_batch_to_individual_items": 7.477751993899513e-05, "listify_data_for_vector_env": 0.00014622621059738928, "normalize_and_clip_actions": 0.00013089032301482945, "get_actions": 0.0007598145947988413, "tensor_to_numpy": 0.0002407031393525419}}}, "num_module_steps_sampled_lifetime": {"default_policy": 320000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 320000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.291429383876863e-05, "add_states_from_episodes_to_batch": 2.192552685214756e-05, "numpy_to_tensor": 0.00017412207409411506, "add_time_dim_to_batch_and_zero_pad": 3.8666653046452397e-05, "batch_individual_items": 9.852521500818485e-05}}, "connector_pipeline_timer": 0.0006403844453259244}, "episode_return_max": 0.9303333333333356, "episode_duration_sec_mean": 23.827661378605278, "num_episodes_lifetime": 1480, "rlmodule_inference_timer": 0.0005901175544158225, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5713173076923088, "env_to_module_sum_episodes_length_out": 97.06806299378098, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11596762274798003, "num_env_steps_sampled_lifetime": 320000, "weights_seq_no": 159.0, "agent_episode_returns_mean": {"default_agent": 0.5713173076923088}, "module_episode_returns_mean": {"default_policy": 0.5713173076923088}, "num_env_steps_sampled": 2000, "sample": 30.029801092892754, "env_to_module_sum_episodes_length_in": 97.06806299378098, "time_between_sampling": 11.278002948215384, "num_env_steps_sampled_lifetime_throughput": 49.398413607705024}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03882212936878204, "weights_seq_no": 160.0, "vf_loss_unclipped": 0.008630208671092987, "total_loss": -0.030191931873559952, "gradients_default_optimizer_global_norm": 0.39601555466651917, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.024293184280395508, "entropy": 0.04534454643726349, "curr_kl_coeff": 1.3541695459571362e-36, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005374388303607702, "num_module_steps_trained_lifetime": 9693184, "vf_loss": 0.008630208671092987}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05183747180446631, "add_observations_from_episodes_to_batch": 0.0003734265166079816, "add_one_ts_to_episodes_and_truncate": 0.0068464696451777775, "add_columns_from_episodes_to_train_batch": 0.0805425409088935, "general_advantage_estimation": 0.07778838173022821, "add_states_from_episodes_to_batch": 1.176148290467606e-05, "numpy_to_tensor": 0.0013478545485624577, "add_time_dim_to_batch_and_zero_pad": 3.334749220374789e-05}}, "connector_pipeline_timer": 0.21929219516681084}, "num_module_steps_trained_lifetime": 9693184, "learner_connector_sum_episodes_length_out": 2016.5656607286721, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 152758848, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 320000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.398413607705024, "done": false, "training_iteration": 160, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-42-35", "timestamp": 1747698155, "time_this_iter_s": 40.42799973487854, "time_total_s": 6472.891045331955, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6472.891045331955, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 76.59655172413792, "ram_util_percent": 52.82068965517242}}
{"timers": {"training_iteration": 41.23509311478886, "restore_env_runners": 2.7770604572997527e-05, "training_step": 41.23451171923195, "env_runner_sampling_timer": 31.505901118694467, "learner_update_timer": 9.717707684817853, "synch_weights": 0.009796005140705622, "synch_env_connectors": 0.010036323612150917}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32677777777777806, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016935981821516698, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.285589920484836e-06, "un_batch_to_individual_items": 7.486070386872411e-05, "listify_data_for_vector_env": 0.00014566580713981482, "normalize_and_clip_actions": 0.00013054771986488185, "get_actions": 0.0007596334884458762, "tensor_to_numpy": 0.00024050761770971668}}}, "num_module_steps_sampled_lifetime": {"default_policy": 322000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 322000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.31814096191503e-05, "add_states_from_episodes_to_batch": 2.1731781918893836e-05, "numpy_to_tensor": 0.00017307392586479479, "add_time_dim_to_batch_and_zero_pad": 3.905051877072125e-05, "batch_individual_items": 9.767108703883069e-05}}, "connector_pipeline_timer": 0.0006370792055190689}, "episode_return_max": 0.7974444444444455, "episode_duration_sec_mean": 23.939550273229194, "num_episodes_lifetime": 1488, "rlmodule_inference_timer": 0.0005896913427888946, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5187061965811973, "env_to_module_sum_episodes_length_out": 95.30039798872318, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11596839429483767, "num_env_steps_sampled_lifetime": 322000, "weights_seq_no": 160.0, "agent_episode_returns_mean": {"default_agent": 0.5187061965811973}, "module_episode_returns_mean": {"default_policy": 0.5187061965811973}, "num_env_steps_sampled": 2000, "sample": 30.036424213302624, "env_to_module_sum_episodes_length_in": 95.30039798872318, "time_between_sampling": 11.274389485811888, "num_env_steps_sampled_lifetime_throughput": 48.27757303197484}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.059176068753004074, "weights_seq_no": 161.0, "vf_loss_unclipped": 0.004855263512581587, "total_loss": 0.06403133273124695, "gradients_default_optimizer_global_norm": 0.2488916963338852, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04928278923034668, "entropy": 0.047464918345212936, "curr_kl_coeff": 6.770847729785681e-37, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.000497914501465857, "num_module_steps_trained_lifetime": 9753728, "vf_loss": 0.004855263512581587}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05191344314801352, "add_observations_from_episodes_to_batch": 0.0003736065277553395, "add_one_ts_to_episodes_and_truncate": 0.006842586211745306, "add_columns_from_episodes_to_train_batch": 0.0805717250687431, "general_advantage_estimation": 0.07738235270345445, "add_states_from_episodes_to_batch": 1.180085272228733e-05, "numpy_to_tensor": 0.0013481213687150336, "add_time_dim_to_batch_and_zero_pad": 3.338052800795407e-05}}, "connector_pipeline_timer": 0.21898729506822634}, "num_module_steps_trained_lifetime": 9753728, "learner_connector_sum_episodes_length_out": 2016.569672892915, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 153712416, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 322000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.27757303197484, "done": false, "training_iteration": 161, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-43-16", "timestamp": 1747698196, "time_this_iter_s": 41.23355054855347, "time_total_s": 6514.124595880508, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6514.124595880508, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 77.81724137931033, "ram_util_percent": 52.856896551724134}}
{"timers": {"training_iteration": 41.24336976868103, "restore_env_runners": 2.7791898548454208e-05, "training_step": 41.242787525079606, "env_runner_sampling_timer": 31.511675374857475, "learner_update_timer": 9.720212036659621, "synch_weights": 0.009792066089339376, "synch_env_connectors": 0.01020070137602118}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32677777777777806, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001700711086799187, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.30687196094151e-06, "un_batch_to_individual_items": 7.513789530051035e-05, "listify_data_for_vector_env": 0.00014474816463809484, "normalize_and_clip_actions": 0.0001322173405472824, "get_actions": 0.0007624572934519293, "tensor_to_numpy": 0.00024286173539258087}}}, "num_module_steps_sampled_lifetime": {"default_policy": 324000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 324000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.286192145934562e-05, "add_states_from_episodes_to_batch": 2.1384513716190088e-05, "numpy_to_tensor": 0.00017311580204113793, "add_time_dim_to_batch_and_zero_pad": 3.983564161272511e-05, "batch_individual_items": 9.796672577389608e-05}}, "connector_pipeline_timer": 0.0006369880747594017}, "episode_return_max": 0.8608888888888893, "episode_duration_sec_mean": 24.48370596028606, "num_episodes_lifetime": 1496, "rlmodule_inference_timer": 0.000592042928363142, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.49256730769230817, "env_to_module_sum_episodes_length_out": 93.40095348059612, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11606847922324967, "num_env_steps_sampled_lifetime": 324000, "weights_seq_no": 161.0, "agent_episode_returns_mean": {"default_agent": 0.49256730769230817}, "module_episode_returns_mean": {"default_policy": 0.49256730769230817}, "num_env_steps_sampled": 2000, "sample": 30.043524679467247, "env_to_module_sum_episodes_length_in": 93.40095348059612, "time_between_sampling": 11.270907885085624, "num_env_steps_sampled_lifetime_throughput": 47.29947132673113}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08672945946455002, "weights_seq_no": 162.0, "vf_loss_unclipped": 0.004244395066052675, "total_loss": -0.08248506486415863, "gradients_default_optimizer_global_norm": 0.41376793384552, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.017194032669067383, "entropy": 0.07964056730270386, "curr_kl_coeff": 3.3854238648928406e-37, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002224189694970846, "num_module_steps_trained_lifetime": 9814272, "vf_loss": 0.004244395066052675}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05198760631750974, "add_observations_from_episodes_to_batch": 0.0003737797060280681, "add_one_ts_to_episodes_and_truncate": 0.006838633100016962, "add_columns_from_episodes_to_train_batch": 0.08060001784140512, "general_advantage_estimation": 0.07697757434904329, "add_states_from_episodes_to_batch": 1.1839408995281425e-05, "numpy_to_tensor": 0.0013483667870100207, "add_time_dim_to_batch_and_zero_pad": 3.34142283466871e-05}}, "connector_pipeline_timer": 0.21868084720219677}, "num_module_steps_trained_lifetime": 9814272, "learner_connector_sum_episodes_length_out": 2016.5735482478, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 154665984, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 324000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.29947132673113, "done": false, "training_iteration": 162, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-43-58", "timestamp": 1747698238, "time_this_iter_s": 42.078903913497925, "time_total_s": 6556.203499794006, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6556.203499794006, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 77.94833333333334, "ram_util_percent": 52.86666666666667}}
{"timers": {"training_iteration": 41.24917367925417, "restore_env_runners": 2.771697958076072e-05, "training_step": 41.24859243308884, "env_runner_sampling_timer": 31.518846477368907, "learner_update_timer": 9.718887081293008, "synch_weights": 0.009751713428420692, "synch_env_connectors": 0.010175458362302263}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3402222222222223, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0017013101822001538, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.157017972197844e-06, "un_batch_to_individual_items": 7.470271968283696e-05, "listify_data_for_vector_env": 0.00014593638388945036, "normalize_and_clip_actions": 0.0001323564929795604, "get_actions": 0.0007640421466632079, "tensor_to_numpy": 0.00024247601542551906}}}, "num_module_steps_sampled_lifetime": {"default_policy": 326000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 326000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2235164126552794e-05, "add_states_from_episodes_to_batch": 2.1894636145285267e-05, "numpy_to_tensor": 0.00017282310693735324, "add_time_dim_to_batch_and_zero_pad": 4.062030307387675e-05, "batch_individual_items": 9.745474765399323e-05}}, "connector_pipeline_timer": 0.0006349682872325931}, "episode_return_max": 0.8608888888888893, "episode_duration_sec_mean": 24.779559950122977, "num_episodes_lifetime": 1504, "rlmodule_inference_timer": 0.0005902460249723201, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.527127136752137, "env_to_module_sum_episodes_length_out": 92.56009259398016, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11578724037569056, "num_env_steps_sampled_lifetime": 326000, "weights_seq_no": 162.0, "agent_episode_returns_mean": {"default_agent": 0.527127136752137}, "module_episode_returns_mean": {"default_policy": 0.527127136752137}, "num_env_steps_sampled": 2000, "sample": 30.050809425462546, "env_to_module_sum_episodes_length_in": 92.56009259398016, "time_between_sampling": 11.267318819927933, "num_env_steps_sampled_lifetime_throughput": 47.73273525786907}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07943715155124664, "weights_seq_no": 163.0, "vf_loss_unclipped": 0.003962310031056404, "total_loss": 0.0833994597196579, "gradients_default_optimizer_global_norm": 0.4102878272533417, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.021151363849639893, "entropy": 0.048042550683021545, "curr_kl_coeff": 1.6927119324464203e-37, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002173546701669693, "num_module_steps_trained_lifetime": 9874816, "vf_loss": 0.003962310031056404}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05205981735930128, "add_observations_from_episodes_to_batch": 0.0003739606000825555, "add_one_ts_to_episodes_and_truncate": 0.0068346827419015505, "add_columns_from_episodes_to_train_batch": 0.0806284932462072, "general_advantage_estimation": 0.07657429273645018, "add_states_from_episodes_to_batch": 1.1877294057103621e-05, "numpy_to_tensor": 0.0013485887048024364, "add_time_dim_to_batch_and_zero_pad": 3.344899662596373e-05}}, "connector_pipeline_timer": 0.218374115004081}, "num_module_steps_trained_lifetime": 9874816, "learner_connector_sum_episodes_length_out": 2016.5772891282982, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 155619552, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 326000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.73273525786907, "done": false, "training_iteration": 163, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-44-40", "timestamp": 1747698280, "time_this_iter_s": 41.84266424179077, "time_total_s": 6598.046164035797, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6598.046164035797, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 77.02833333333334, "ram_util_percent": 52.91166666666666}}
{"timers": {"training_iteration": 41.24542992791166, "restore_env_runners": 2.7689809796827477e-05, "training_step": 41.24484833920797, "env_runner_sampling_timer": 31.516681968455188, "learner_update_timer": 9.717317537070027, "synch_weights": 0.00974255029417239, "synch_env_connectors": 0.010173899778664104}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.31166666666666654, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016959763446960524, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.120064902992493e-06, "un_batch_to_individual_items": 7.471300616501819e-05, "listify_data_for_vector_env": 0.0001448167893157744, "normalize_and_clip_actions": 0.00013083831587082015, "get_actions": 0.000762055051301869, "tensor_to_numpy": 0.00024121882015341447}}}, "num_module_steps_sampled_lifetime": {"default_policy": 328000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 328000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.251719678647037e-05, "add_states_from_episodes_to_batch": 2.1829399521428477e-05, "numpy_to_tensor": 0.0001718684825781191, "add_time_dim_to_batch_and_zero_pad": 4.0345290794189923e-05, "batch_individual_items": 9.907914064047391e-05}}, "connector_pipeline_timer": 0.0006359497696825224}, "episode_return_max": 0.8820000000000006, "episode_duration_sec_mean": 24.60934946071064, "num_episodes_lifetime": 1512, "rlmodule_inference_timer": 0.0005900556719211306, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5567361111111112, "env_to_module_sum_episodes_length_out": 93.46150088783796, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11534033245546657, "num_env_steps_sampled_lifetime": 328000, "weights_seq_no": 163.0, "agent_episode_returns_mean": {"default_agent": 0.5567361111111112}, "module_episode_returns_mean": {"default_policy": 0.5567361111111112}, "num_env_steps_sampled": 2000, "sample": 30.057784018815113, "env_to_module_sum_episodes_length_in": 93.46150088783796, "time_between_sampling": 11.263708003798047, "num_env_steps_sampled_lifetime_throughput": 48.822050676304066}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.09046148508787155, "weights_seq_no": 164.0, "vf_loss_unclipped": 0.00290381140075624, "total_loss": 0.09336531162261963, "gradients_default_optimizer_global_norm": 0.24716924130916595, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04346984624862671, "entropy": 0.05895979329943657, "curr_kl_coeff": 8.463559662232101e-38, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0025968190748244524, "num_module_steps_trained_lifetime": 9935360, "vf_loss": 0.00290381140075624}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052130169969724666, "add_observations_from_episodes_to_batch": 0.0003741331382850496, "add_one_ts_to_episodes_and_truncate": 0.006830671237638502, "add_columns_from_episodes_to_train_batch": 0.0806569767112292, "general_advantage_estimation": 0.07617231745867349, "add_states_from_episodes_to_batch": 1.1914327477086089e-05, "numpy_to_tensor": 0.0013487899375603594, "add_time_dim_to_batch_and_zero_pad": 3.3486188116533273e-05}}, "connector_pipeline_timer": 0.21806674865540762}, "num_module_steps_trained_lifetime": 9935360, "learner_connector_sum_episodes_length_out": 2016.5808978363616, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 156573120, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 328000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.822050676304066, "done": false, "training_iteration": 164, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-45-21", "timestamp": 1747698321, "time_this_iter_s": 40.89183282852173, "time_total_s": 6638.937996864319, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6638.937996864319, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 78.27931034482758, "ram_util_percent": 52.9103448275862}}
{"timers": {"training_iteration": 41.24267152933249, "restore_env_runners": 2.7631911692962996e-05, "training_step": 41.242090434515916, "env_runner_sampling_timer": 31.51725790904064, "learner_update_timer": 9.714026616129317, "synch_weights": 0.009700718791235597, "synch_env_connectors": 0.01015629878089764}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29366666666666685, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001696103326152315, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.02110862552679e-06, "un_batch_to_individual_items": 7.445101540234953e-05, "listify_data_for_vector_env": 0.00014449642417790329, "normalize_and_clip_actions": 0.0001321907477812191, "get_actions": 0.0007635558753337591, "tensor_to_numpy": 0.00023932020482487676}}}, "num_module_steps_sampled_lifetime": {"default_policy": 330000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 330000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.240333407605018e-05, "add_states_from_episodes_to_batch": 2.1659643018808352e-05, "numpy_to_tensor": 0.00017175934240110262, "add_time_dim_to_batch_and_zero_pad": 4.006282536897095e-05, "batch_individual_items": 9.815481883965524e-05}}, "connector_pipeline_timer": 0.0006341511505609981}, "episode_return_max": 0.8820000000000006, "episode_duration_sec_mean": 24.49874975621032, "num_episodes_lifetime": 1520, "rlmodule_inference_timer": 0.0005891415451231485, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.44653205128205153, "env_to_module_sum_episodes_length_out": 96.45633127323336, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11462449022697876, "num_env_steps_sampled_lifetime": 330000, "weights_seq_no": 164.0, "agent_episode_returns_mean": {"default_agent": 0.44653205128205153}, "module_episode_returns_mean": {"default_policy": 0.44653205128205153}, "num_env_steps_sampled": 2000, "sample": 30.06426677029577, "env_to_module_sum_episodes_length_in": 96.45633127323336, "time_between_sampling": 11.259812759008636, "num_env_steps_sampled_lifetime_throughput": 48.72024715619803}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03292286768555641, "weights_seq_no": 165.0, "vf_loss_unclipped": 0.005401651840656996, "total_loss": -0.027521220967173576, "gradients_default_optimizer_global_norm": 0.44239750504493713, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.02495121955871582, "entropy": 0.04261340573430061, "curr_kl_coeff": 4.231779831116051e-38, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0007520143408328295, "num_module_steps_trained_lifetime": 9995904, "vf_loss": 0.005401651840656996}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052199036946203425, "add_observations_from_episodes_to_batch": 0.0003743052196639896, "add_one_ts_to_episodes_and_truncate": 0.0068266239051866, "add_columns_from_episodes_to_train_batch": 0.08068497670762621, "general_advantage_estimation": 0.075772136587179, "add_states_from_episodes_to_batch": 1.1950562499136426e-05, "numpy_to_tensor": 0.0013490176967926885, "add_time_dim_to_batch_and_zero_pad": 3.352445087762944e-05}}, "connector_pipeline_timer": 0.2177591963322072}, "num_module_steps_trained_lifetime": 9995904, "learner_connector_sum_episodes_length_out": 2016.584376641351, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 157526688, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 330000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.72024715619803, "done": false, "training_iteration": 165, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-46-02", "timestamp": 1747698362, "time_this_iter_s": 40.98699140548706, "time_total_s": 6679.924988269806, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6679.924988269806, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 77.47413793103446, "ram_util_percent": 52.93103448275862}}
{"timers": {"training_iteration": 41.27418194208918, "restore_env_runners": 2.7557592513450353e-05, "training_step": 41.27360189822076, "env_runner_sampling_timer": 31.54589159694023, "learner_update_timer": 9.716940740027983, "synch_weights": 0.00966517160332041, "synch_env_connectors": 0.010137385793056206}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2960000000000005, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016936832383876114, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.071625977238954e-06, "un_batch_to_individual_items": 7.48827013767146e-05, "listify_data_for_vector_env": 0.000144292906563377, "normalize_and_clip_actions": 0.0001319658260765008, "get_actions": 0.0007612161353082127, "tensor_to_numpy": 0.0002398174799811296}}}, "num_module_steps_sampled_lifetime": {"default_policy": 332000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 332000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2126207871077606e-05, "add_states_from_episodes_to_batch": 2.1413373385117008e-05, "numpy_to_tensor": 0.0001705510910528551, "add_time_dim_to_batch_and_zero_pad": 4.050218629389958e-05, "batch_individual_items": 9.893590509785228e-05}}, "connector_pipeline_timer": 0.0006330649274200472}, "episode_return_max": 0.7526666666666679, "episode_duration_sec_mean": 24.376559708191333, "num_episodes_lifetime": 1536, "rlmodule_inference_timer": 0.0005902073458227702, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.4601388888888896, "env_to_module_sum_episodes_length_out": 97.51014163468342, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11528593730242684, "num_env_steps_sampled_lifetime": 332000, "weights_seq_no": 165.0, "agent_episode_returns_mean": {"default_agent": 0.4601388888888896}, "module_episode_returns_mean": {"default_policy": 0.4601388888888896}, "num_env_steps_sampled": 2000, "sample": 30.07227211538759, "env_to_module_sum_episodes_length_in": 97.51014163468342, "time_between_sampling": 11.255930354351445, "num_env_steps_sampled_lifetime_throughput": 44.976724077194035}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.13394202291965485, "weights_seq_no": 166.0, "vf_loss_unclipped": 0.005041728727519512, "total_loss": -0.12890028953552246, "gradients_default_optimizer_global_norm": 0.2337692379951477, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05065906047821045, "entropy": 0.060777466744184494, "curr_kl_coeff": 4.231779831116051e-38, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.010997019708156586, "num_module_steps_trained_lifetime": 10056704, "vf_loss": 0.005041728727519512}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052265868006155264, "add_observations_from_episodes_to_batch": 0.0003744822261015954, "add_one_ts_to_episodes_and_truncate": 0.006822760462260565, "add_columns_from_episodes_to_train_batch": 0.08071260675642397, "general_advantage_estimation": 0.07537334278136883, "add_states_from_episodes_to_batch": 1.198604138809971e-05, "numpy_to_tensor": 0.001349260101846972, "add_time_dim_to_batch_and_zero_pad": 3.356487976448973e-05}}, "connector_pipeline_timer": 0.21745083621060574}, "num_module_steps_trained_lifetime": 10056704, "learner_connector_sum_episodes_length_out": 2016.5885277804568, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 158488088, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 332000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 44.976724077194035, "done": false, "training_iteration": 166, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-46-47", "timestamp": 1747698407, "time_this_iter_s": 44.41215634346008, "time_total_s": 6724.337144613266, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6724.337144613266, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 77.18412698412699, "ram_util_percent": 52.92539682539683}}
{"timers": {"training_iteration": 41.269603591728306, "restore_env_runners": 2.7547016641648037e-05, "training_step": 41.26902418229852, "env_runner_sampling_timer": 31.5430633586108, "learner_update_timer": 9.715183719047698, "synch_weights": 0.009674638887334533, "synch_env_connectors": 0.010121861935157869}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29433333333333334, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016971021302524345, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.642890778337876e-06, "un_batch_to_individual_items": 7.449386394657999e-05, "listify_data_for_vector_env": 0.00014404170845458105, "normalize_and_clip_actions": 0.00013222564678245697, "get_actions": 0.0007634106694979044, "tensor_to_numpy": 0.00023965180154090192}}}, "num_module_steps_sampled_lifetime": {"default_policy": 334000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 334000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.242567500760386e-05, "add_states_from_episodes_to_batch": 2.125193534268081e-05, "numpy_to_tensor": 0.00016933967038402296, "add_time_dim_to_batch_and_zero_pad": 4.023689472621853e-05, "batch_individual_items": 9.795848525255515e-05}}, "connector_pipeline_timer": 0.0006305333505662333}, "episode_return_max": 0.8331111111111129, "episode_duration_sec_mean": 24.158536888527752, "num_episodes_lifetime": 1544, "rlmodule_inference_timer": 0.0005890027608495903, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4575982905982914, "env_to_module_sum_episodes_length_out": 96.16671851760631, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11544843662873616, "num_env_steps_sampled_lifetime": 334000, "weights_seq_no": 166.0, "agent_episode_returns_mean": {"default_agent": 0.4575982905982914}, "module_episode_returns_mean": {"default_policy": 0.4575982905982914}, "num_env_steps_sampled": 2000, "sample": 30.079513200850208, "env_to_module_sum_episodes_length_in": 96.16671851760631, "time_between_sampling": 11.25273747678426, "num_env_steps_sampled_lifetime_throughput": 48.904361352242965}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03474440798163414, "weights_seq_no": 167.0, "vf_loss_unclipped": 0.004286163952201605, "total_loss": -0.0304582379758358, "gradients_default_optimizer_global_norm": 0.7315027713775635, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.1918233036994934, "entropy": 0.07861318439245224, "curr_kl_coeff": 2.1158899155580254e-38, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002904653549194336, "num_module_steps_trained_lifetime": 10117248, "vf_loss": 0.004286163952201605}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05233032358121327, "add_observations_from_episodes_to_batch": 0.0003746525218881483, "add_one_ts_to_episodes_and_truncate": 0.00681894294580271, "add_columns_from_episodes_to_train_batch": 0.08074065619667561, "general_advantage_estimation": 0.0749760722880167, "add_states_from_episodes_to_batch": 1.2020735643558493e-05, "numpy_to_tensor": 0.0013494691870303594, "add_time_dim_to_batch_and_zero_pad": 3.360628762837338e-05}}, "connector_pipeline_timer": 0.2171420450019036}, "num_module_steps_trained_lifetime": 10117248, "learner_connector_sum_episodes_length_out": 2016.5925374591166, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 159441656, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 334000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.904361352242965, "done": false, "training_iteration": 167, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-47-28", "timestamp": 1747698448, "time_this_iter_s": 40.832802295684814, "time_total_s": 6765.169946908951, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6765.169946908951, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 76.85344827586206, "ram_util_percent": 52.9103448275862}}
{"timers": {"training_iteration": 41.26642246854103, "restore_env_runners": 2.7483546488793476e-05, "training_step": 41.26584308720552, "env_runner_sampling_timer": 31.540036986184738, "learner_update_timer": 9.71505495142728, "synch_weights": 0.009648826498420568, "synch_env_connectors": 0.010109428315777103}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29433333333333334, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016964736853505996, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.531369205361857e-06, "un_batch_to_individual_items": 7.373440959968396e-05, "listify_data_for_vector_env": 0.00014352419661260086, "normalize_and_clip_actions": 0.00013259058747512668, "get_actions": 0.0007624765690618053, "tensor_to_numpy": 0.00023992187509247432}}}, "num_module_steps_sampled_lifetime": {"default_policy": 336000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 336000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.254763190251833e-05, "add_states_from_episodes_to_batch": 2.099057660565711e-05, "numpy_to_tensor": 0.0001685613420856617, "add_time_dim_to_batch_and_zero_pad": 3.968501388911671e-05, "batch_individual_items": 9.816719867116406e-05}}, "connector_pipeline_timer": 0.0006288991292407822}, "episode_return_max": 0.8331111111111129, "episode_duration_sec_mean": 23.96026656038325, "num_episodes_lifetime": 1552, "rlmodule_inference_timer": 0.0005896985254816145, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4381752136752141, "env_to_module_sum_episodes_length_out": 94.13328401270536, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1154509781163305, "num_env_steps_sampled_lifetime": 336000, "weights_seq_no": 167.0, "agent_episode_returns_mean": {"default_agent": 0.4381752136752141}, "module_episode_returns_mean": {"default_policy": 0.4381752136752141}, "num_env_steps_sampled": 2000, "sample": 30.086432422119632, "env_to_module_sum_episodes_length_in": 94.13328401270536, "time_between_sampling": 11.24955891777573, "num_env_steps_sampled_lifetime_throughput": 48.745439390492805}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0010508111445233226, "weights_seq_no": 168.0, "vf_loss_unclipped": 0.004087642300873995, "total_loss": 0.005138466600328684, "gradients_default_optimizer_global_norm": 0.26271724700927734, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.017443537712097168, "entropy": 0.06663037091493607, "curr_kl_coeff": 1.0579450278439359e-38, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002192528685554862, "num_module_steps_trained_lifetime": 10177792, "vf_loss": 0.004087642300873995}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05239623708796969, "add_observations_from_episodes_to_batch": 0.0003748185735364575, "add_one_ts_to_episodes_and_truncate": 0.006815187413627689, "add_columns_from_episodes_to_train_batch": 0.08076924395734658, "general_advantage_estimation": 0.07458132692025385, "add_states_from_episodes_to_batch": 1.2055757409938766e-05, "numpy_to_tensor": 0.0013496951245000144, "add_time_dim_to_batch_and_zero_pad": 3.364974084714747e-05}}, "connector_pipeline_timer": 0.2168379006936546}, "num_module_steps_trained_lifetime": 10177792, "learner_connector_sum_episodes_length_out": 2016.596408091425, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 160395224, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 336000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.745439390492805, "done": false, "training_iteration": 168, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-48-09", "timestamp": 1747698489, "time_this_iter_s": 40.98638677597046, "time_total_s": 6806.156333684921, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6806.156333684921, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 78.14827586206897, "ram_util_percent": 52.9103448275862}}
{"timers": {"training_iteration": 41.259821002815656, "restore_env_runners": 2.746971104677975e-05, "training_step": 41.2592413582935, "env_runner_sampling_timer": 31.5411838719029, "learner_update_timer": 9.70733784329303, "synch_weights": 0.009609850233493976, "synch_env_connectors": 0.01016518303266932}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29488888888888903, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016981514724709855, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.549430616178754e-06, "un_batch_to_individual_items": 7.373623219017167e-05, "listify_data_for_vector_env": 0.0001447427941817905, "normalize_and_clip_actions": 0.00013395433131175831, "get_actions": 0.0007602607540436378, "tensor_to_numpy": 0.00024028049663671756}}}, "num_module_steps_sampled_lifetime": {"default_policy": 338000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 338000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.283656432776269e-05, "add_states_from_episodes_to_batch": 2.1140026857397512e-05, "numpy_to_tensor": 0.00016826302019923387, "add_time_dim_to_batch_and_zero_pad": 3.9647264478773756e-05, "batch_individual_items": 9.928183036542228e-05}}, "connector_pipeline_timer": 0.0006293257376786995}, "episode_return_max": 0.8353333333333334, "episode_duration_sec_mean": 23.8905861571521, "num_episodes_lifetime": 1560, "rlmodule_inference_timer": 0.0005921466617340609, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5592713675213679, "env_to_module_sum_episodes_length_out": 92.80834708504115, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11517052651384152, "num_env_steps_sampled_lifetime": 338000, "weights_seq_no": 168.0, "agent_episode_returns_mean": {"default_agent": 0.5592713675213679}, "module_episode_returns_mean": {"default_policy": 0.5592713675213679}, "num_env_steps_sampled": 2000, "sample": 30.09289235521946, "env_to_module_sum_episodes_length_in": 92.80834708504115, "time_between_sampling": 11.246153154947093, "num_env_steps_sampled_lifetime_throughput": 49.10914983792476}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.029483258724212646, "weights_seq_no": 169.0, "vf_loss_unclipped": 0.005033631343394518, "total_loss": -0.024449625983834267, "gradients_default_optimizer_global_norm": 0.432293564081192, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04287809133529663, "entropy": 0.07048722356557846, "curr_kl_coeff": 5.2897251392196795e-39, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0005185084301047027, "num_module_steps_trained_lifetime": 10238336, "vf_loss": 0.005033631343394518}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05247667525213306, "add_observations_from_episodes_to_batch": 0.00037497441889963224, "add_one_ts_to_episodes_and_truncate": 0.006811366167801915, "add_columns_from_episodes_to_train_batch": 0.08079727230718488, "general_advantage_estimation": 0.07418835538261803, "add_states_from_episodes_to_batch": 1.2089846667537175e-05, "numpy_to_tensor": 0.0013498897563015185, "add_time_dim_to_batch_and_zero_pad": 3.369183437280897e-05}}, "connector_pipeline_timer": 0.21654938108696997}, "num_module_steps_trained_lifetime": 10238336, "learner_connector_sum_episodes_length_out": 2016.6001420573411, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 161348792, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 338000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.10914983792476, "done": false, "training_iteration": 169, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-48-49", "timestamp": 1747698529, "time_this_iter_s": 40.6226646900177, "time_total_s": 6846.778998374939, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6846.778998374939, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 77.43620689655172, "ram_util_percent": 52.85862068965518}}
{"timers": {"training_iteration": 41.24810830952752, "restore_env_runners": 2.7434013937186466e-05, "training_step": 41.24752934345054, "env_runner_sampling_timer": 31.530248864503857, "learner_update_timer": 9.706609306280095, "synch_weights": 0.009561638731123284, "synch_env_connectors": 0.010142837202313156}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.303111111111111, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016910335459987675, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.477358324827225e-06, "un_batch_to_individual_items": 7.307523159055672e-05, "listify_data_for_vector_env": 0.000145074367842527, "normalize_and_clip_actions": 0.00013267928771894445, "get_actions": 0.0007573310032090435, "tensor_to_numpy": 0.00023984519195273973}}}, "num_module_steps_sampled_lifetime": {"default_policy": 340000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 340000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.297046878880058e-05, "add_states_from_episodes_to_batch": 2.104474947861513e-05, "numpy_to_tensor": 0.0001684437306160952, "add_time_dim_to_batch_and_zero_pad": 3.975222131543247e-05, "batch_individual_items": 9.909807168506219e-05}}, "connector_pipeline_timer": 0.000628792515080043}, "episode_return_max": 0.8353333333333334, "episode_duration_sec_mean": 23.745836431787772, "num_episodes_lifetime": 1568, "rlmodule_inference_timer": 0.0005903301260536786, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5533440170940174, "env_to_module_sum_episodes_length_out": 93.0311579980742, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11445951141572741, "num_env_steps_sampled_lifetime": 340000, "weights_seq_no": 169.0, "agent_episode_returns_mean": {"default_agent": 0.5533440170940174}, "module_episode_returns_mean": {"default_policy": 0.5533440170940174}, "num_env_steps_sampled": 2000, "sample": 30.098186213669013, "env_to_module_sum_episodes_length_in": 93.0311579980742, "time_between_sampling": 11.242398923740282, "num_env_steps_sampled_lifetime_throughput": 49.795243735452274}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.026178665459156036, "weights_seq_no": 170.0, "vf_loss_unclipped": 0.004042448941618204, "total_loss": 0.0302211195230484, "gradients_default_optimizer_global_norm": 0.2929222881793976, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0349312424659729, "entropy": 0.039760902523994446, "curr_kl_coeff": 2.6448625696098398e-39, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0006689975853078067, "num_module_steps_trained_lifetime": 10298880, "vf_loss": 0.004042448941618204}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0525565888293046, "add_observations_from_episodes_to_batch": 0.0003751454854983149, "add_one_ts_to_episodes_and_truncate": 0.006807516348151616, "add_columns_from_episodes_to_train_batch": 0.08082853091553122, "general_advantage_estimation": 0.07379676037304295, "add_states_from_episodes_to_batch": 1.2123838564775843e-05, "numpy_to_tensor": 0.001350548255954352, "add_time_dim_to_batch_and_zero_pad": 3.373382105380533e-05}}, "connector_pipeline_timer": 0.21626542972224935}, "num_module_steps_trained_lifetime": 10298880, "learner_connector_sum_episodes_length_out": 2016.60374170313, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 162302360, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 340000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.795243735452274, "done": false, "training_iteration": 170, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-49-29", "timestamp": 1747698569, "time_this_iter_s": 40.10776376724243, "time_total_s": 6886.886762142181, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6886.886762142181, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 76.6719298245614, "ram_util_percent": 52.90175438596491}}
{"timers": {"training_iteration": 41.235154273982246, "restore_env_runners": 2.7478673753012396e-05, "training_step": 41.23457577456603, "env_runner_sampling_timer": 31.517211128148812, "learner_update_timer": 9.706720344447275, "synch_weights": 0.009536845373776281, "synch_env_connectors": 0.0101403388203439}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.303111111111111, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016841338120032647, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.510180015792064e-06, "un_batch_to_individual_items": 7.283551308578075e-05, "listify_data_for_vector_env": 0.0001450540503949327, "normalize_and_clip_actions": 0.00013300871572927313, "get_actions": 0.0007543011513832218, "tensor_to_numpy": 0.0002375461867166852}}}, "num_module_steps_sampled_lifetime": {"default_policy": 342000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 342000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.226990517649017e-05, "add_states_from_episodes_to_batch": 2.0701201522770802e-05, "numpy_to_tensor": 0.00016750513680003303, "add_time_dim_to_batch_and_zero_pad": 3.9359337047900325e-05, "batch_individual_items": 9.858230028533962e-05}}, "connector_pipeline_timer": 0.00062520531038588}, "episode_return_max": 0.8291111111111109, "episode_duration_sec_mean": 23.519029322113894, "num_episodes_lifetime": 1576, "rlmodule_inference_timer": 0.0005885806098176038, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5010865384615385, "env_to_module_sum_episodes_length_out": 95.25341892743738, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11364448876258088, "num_env_steps_sampled_lifetime": 342000, "weights_seq_no": 170.0, "agent_episode_returns_mean": {"default_agent": 0.5010865384615385}, "module_episode_returns_mean": {"default_policy": 0.5010865384615385}, "num_env_steps_sampled": 2000, "sample": 30.102499485415546, "env_to_module_sum_episodes_length_in": 95.25341892743738, "time_between_sampling": 11.238761222486312, "num_env_steps_sampled_lifetime_throughput": 49.82129977621951}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09679313749074936, "weights_seq_no": 171.0, "vf_loss_unclipped": 0.008299917913973331, "total_loss": -0.0884932279586792, "gradients_default_optimizer_global_norm": 0.19983245432376862, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10694140195846558, "entropy": 0.0551067516207695, "curr_kl_coeff": 1.3224305841556877e-39, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003000106429681182, "num_module_steps_trained_lifetime": 10359424, "vf_loss": 0.008299917913973331}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052634761907407394, "add_observations_from_episodes_to_batch": 0.0003753251933228861, "add_one_ts_to_episodes_and_truncate": 0.0068038966882776756, "add_columns_from_episodes_to_train_batch": 0.08085985544447997, "general_advantage_estimation": 0.07340656114812141, "add_states_from_episodes_to_batch": 1.2157041639047778e-05, "numpy_to_tensor": 0.0013511653966390021, "add_time_dim_to_batch_and_zero_pad": 3.3775138817778745e-05}}, "connector_pipeline_timer": 0.2159813950167146}, "num_module_steps_trained_lifetime": 10359424, "learner_connector_sum_episodes_length_out": 2016.6072093417974, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 163255928, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 342000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.82129977621951, "done": false, "training_iteration": 171, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-50-10", "timestamp": 1747698610, "time_this_iter_s": 39.96869730949402, "time_total_s": 6926.855459451675, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6926.855459451675, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 76.9140350877193, "ram_util_percent": 52.91052631578947}}
{"timers": {"training_iteration": 41.24929541961248, "restore_env_runners": 2.739688702988797e-05, "training_step": 41.24871839919038, "env_runner_sampling_timer": 31.533636100887282, "learner_update_timer": 9.704454185352827, "synch_weights": 0.009520076920017424, "synch_env_connectors": 0.010126073462134554}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.319111111111112, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016850819071935774, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.410000824066409e-06, "un_batch_to_individual_items": 7.431684811320114e-05, "listify_data_for_vector_env": 0.00014395217549108519, "normalize_and_clip_actions": 0.00013317313037987136, "get_actions": 0.0007566229528054202, "tensor_to_numpy": 0.0002366023991472317}}}, "num_module_steps_sampled_lifetime": {"default_policy": 344000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 344000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.19463039701236e-05, "add_states_from_episodes_to_batch": 2.084699465191868e-05, "numpy_to_tensor": 0.00016692293837014015, "add_time_dim_to_batch_and_zero_pad": 3.876799893318668e-05, "batch_individual_items": 9.907902237717954e-05}}, "connector_pipeline_timer": 0.0006272905598318089}, "episode_return_max": 0.8364444444444464, "episode_duration_sec_mean": 24.122439943049148, "num_episodes_lifetime": 1592, "rlmodule_inference_timer": 0.0005888884311840958, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5272297008547017, "env_to_module_sum_episodes_length_out": 97.10872912209543, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11413564371354801, "num_env_steps_sampled_lifetime": 344000, "weights_seq_no": 171.0, "agent_episode_returns_mean": {"default_agent": 0.5272297008547017}, "module_episode_returns_mean": {"default_policy": 0.5272297008547017}, "num_env_steps_sampled": 2000, "sample": 30.10787284806074, "env_to_module_sum_episodes_length_in": 97.10872912209543, "time_between_sampling": 11.234952013101786, "num_env_steps_sampled_lifetime_throughput": 46.80812169666439}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07231035083532333, "weights_seq_no": 172.0, "vf_loss_unclipped": 0.008378460071980953, "total_loss": 0.08068881183862686, "gradients_default_optimizer_global_norm": 0.1495085209608078, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.04448956251144409, "entropy": 0.0635567232966423, "curr_kl_coeff": 6.6121529207784386e-40, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003007931634783745, "num_module_steps_trained_lifetime": 10420224, "vf_loss": 0.008378460071980953}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052710330414965124, "add_observations_from_episodes_to_batch": 0.000375510192442117, "add_one_ts_to_episodes_and_truncate": 0.0068003565599663715, "add_columns_from_episodes_to_train_batch": 0.080890146949558, "general_advantage_estimation": 0.07301797743166046, "add_states_from_episodes_to_batch": 1.2189358268240187e-05, "numpy_to_tensor": 0.001351739509684554, "add_time_dim_to_batch_and_zero_pad": 3.381515684389387e-05}}, "connector_pipeline_timer": 0.21569537130201796}, "num_module_steps_trained_lifetime": 10420224, "learner_connector_sum_episodes_length_out": 2016.611347253521, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 164217328, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 344000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.80812169666439, "done": false, "training_iteration": 172, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-50-52", "timestamp": 1747698652, "time_this_iter_s": 42.66586995124817, "time_total_s": 6969.521329402924, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6969.521329402924, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 78.76666666666668, "ram_util_percent": 52.93333333333333}}
{"timers": {"training_iteration": 41.24090345968633, "restore_env_runners": 2.732091813930768e-05, "training_step": 41.24032748346848, "env_runner_sampling_timer": 31.529081119258393, "learner_update_timer": 9.700615406389291, "synch_weights": 0.009523796150835801, "synch_env_connectors": 0.010109105727549477}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2953333333333339, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016759993465970033, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.587729094995777e-06, "un_batch_to_individual_items": 7.382764435972017e-05, "listify_data_for_vector_env": 0.0001426431123068002, "normalize_and_clip_actions": 0.00013209420563379704, "get_actions": 0.0007516104100857268, "tensor_to_numpy": 0.00023634625522934164}}}, "num_module_steps_sampled_lifetime": {"default_policy": 346000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 346000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1330538998265575e-05, "add_states_from_episodes_to_batch": 2.0462396437526546e-05, "numpy_to_tensor": 0.00016572400603678843, "add_time_dim_to_batch_and_zero_pad": 3.845279193083575e-05, "batch_individual_items": 9.991909061858081e-05}}, "connector_pipeline_timer": 0.0006246153556438705}, "episode_return_max": 0.7590000000000015, "episode_duration_sec_mean": 23.909073172999413, "num_episodes_lifetime": 1600, "rlmodule_inference_timer": 0.0005867522998171477, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4834380341880351, "env_to_module_sum_episodes_length_out": 96.47500710768995, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11417195251301145, "num_env_steps_sampled_lifetime": 346000, "weights_seq_no": 172.0, "agent_episode_returns_mean": {"default_agent": 0.4834380341880351}, "module_episode_returns_mean": {"default_policy": 0.4834380341880351}, "num_env_steps_sampled": 2000, "sample": 30.11226054434336, "env_to_module_sum_episodes_length_in": 96.47500710768995, "time_between_sampling": 11.231119477904668, "num_env_steps_sampled_lifetime_throughput": 49.3853628292479}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0817071869969368, "weights_seq_no": 173.0, "vf_loss_unclipped": 0.00712431687861681, "total_loss": -0.07458288222551346, "gradients_default_optimizer_global_norm": 0.1507716178894043, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06398475170135498, "entropy": 0.06083652004599571, "curr_kl_coeff": 3.306083466881541e-40, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0034931479021906853, "num_module_steps_trained_lifetime": 10480768, "vf_loss": 0.00712431687861681}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05278367939618074, "add_observations_from_episodes_to_batch": 0.00037568653905960096, "add_one_ts_to_episodes_and_truncate": 0.006796717374552348, "add_columns_from_episodes_to_train_batch": 0.08091987576908942, "general_advantage_estimation": 0.07263090390341377, "add_states_from_episodes_to_batch": 1.222079286087109e-05, "numpy_to_tensor": 0.0013522619539291442, "add_time_dim_to_batch_and_zero_pad": 3.385371699594365e-05}}, "connector_pipeline_timer": 0.21540790531221357}, "num_module_steps_trained_lifetime": 10480768, "learner_connector_sum_episodes_length_out": 2016.615341686076, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 165170896, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 346000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 49.3853628292479, "done": false, "training_iteration": 173, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-51-33", "timestamp": 1747698693, "time_this_iter_s": 40.426292181015015, "time_total_s": 7009.947621583939, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7009.947621583939, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 75.8344827586207, "ram_util_percent": 52.915517241379305}}
{"timers": {"training_iteration": 41.220708404489436, "restore_env_runners": 2.7363708963028494e-05, "training_step": 41.22013188103382, "env_runner_sampling_timer": 31.51582863293582, "learner_update_timer": 9.693713224845409, "synch_weights": 0.009482166199312043, "synch_env_connectors": 0.010086283670279077}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2953333333333339, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00167522865880016, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.46521970612423e-06, "un_batch_to_individual_items": 7.489111085338256e-05, "listify_data_for_vector_env": 0.00014235834102625287, "normalize_and_clip_actions": 0.00013054439679803265, "get_actions": 0.000752247409273502, "tensor_to_numpy": 0.00023803767805660384}}}, "num_module_steps_sampled_lifetime": {"default_policy": 348000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 348000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.151686830919663e-05, "add_states_from_episodes_to_batch": 2.0361329259676182e-05, "numpy_to_tensor": 0.0001659704029993505, "add_time_dim_to_batch_and_zero_pad": 3.844572380764562e-05, "batch_individual_items": 9.98953156167469e-05}}, "connector_pipeline_timer": 0.0006232751056625801}, "episode_return_max": 0.8088888888888905, "episode_duration_sec_mean": 22.904534760317663, "num_episodes_lifetime": 1608, "rlmodule_inference_timer": 0.0005829699145618856, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5398258547008556, "env_to_module_sum_episodes_length_out": 94.51871680679325, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11395538010370924, "num_env_steps_sampled_lifetime": 348000, "weights_seq_no": 173.0, "agent_episode_returns_mean": {"default_agent": 0.5398258547008556}, "module_episode_returns_mean": {"default_policy": 0.5398258547008556}, "num_env_steps_sampled": 2000, "sample": 30.115228446032045, "env_to_module_sum_episodes_length_in": 94.51871680679325, "time_between_sampling": 11.227482909416121, "num_env_steps_sampled_lifetime_throughput": 50.892105606481856}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.14062011241912842, "weights_seq_no": 174.0, "vf_loss_unclipped": 0.0068455953150987625, "total_loss": -0.1337745189666748, "gradients_default_optimizer_global_norm": 0.7076033353805542, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.042173802852630615, "entropy": 0.07734693586826324, "curr_kl_coeff": 1.6530417334407705e-40, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003336280817165971, "num_module_steps_trained_lifetime": 10541312, "vf_loss": 0.0068455953150987625}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05285537828423033, "add_observations_from_episodes_to_batch": 0.0003758519677252239, "add_one_ts_to_episodes_and_truncate": 0.006793004487190427, "add_columns_from_episodes_to_train_batch": 0.08094898132663567, "general_advantage_estimation": 0.07224542616788854, "add_states_from_episodes_to_batch": 1.2252139826127335e-05, "numpy_to_tensor": 0.0013528089453377849, "add_time_dim_to_batch_and_zero_pad": 3.389081442937836e-05}}, "connector_pipeline_timer": 0.21511969986357504}, "num_module_steps_trained_lifetime": 10541312, "learner_connector_sum_episodes_length_out": 2016.6191950952543, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 166124464, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 348000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.892105606481856, "done": false, "training_iteration": 174, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-52-12", "timestamp": 1747698732, "time_this_iter_s": 39.23891615867615, "time_total_s": 7049.186537742615, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7049.186537742615, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 77.84363636363636, "ram_util_percent": 52.91272727272728}}
{"timers": {"training_iteration": 41.20620646937451, "restore_env_runners": 2.737607186835603e-05, "training_step": 41.205629978153446, "env_runner_sampling_timer": 31.503178717886446, "learner_update_timer": 9.691898153246983, "synch_weights": 0.009447674537297343, "synch_env_connectors": 0.010054301833619179}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.36477777777777765, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016660361500650384, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.391696222432541e-06, "un_batch_to_individual_items": 7.479976020668516e-05, "listify_data_for_vector_env": 0.0001428816958837948, "normalize_and_clip_actions": 0.00012965412287016423, "get_actions": 0.0007478687742361185, "tensor_to_numpy": 0.00023650558384714438}}}, "num_module_steps_sampled_lifetime": {"default_policy": 350000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 350000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0985345359348346e-05, "add_states_from_episodes_to_batch": 2.09479166332148e-05, "numpy_to_tensor": 0.00016703448459143484, "add_time_dim_to_batch_and_zero_pad": 3.8263556012752735e-05, "batch_individual_items": 9.87379094263978e-05}}, "connector_pipeline_timer": 0.0006206094514556233}, "episode_return_max": 0.8224444444444443, "episode_duration_sec_mean": 22.934248917567437, "num_episodes_lifetime": 1616, "rlmodule_inference_timer": 0.0005814645867099952, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5439807692307694, "env_to_module_sum_episodes_length_out": 92.84656181441623, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11347151745235423, "num_env_steps_sampled_lifetime": 350000, "weights_seq_no": 174.0, "agent_episode_returns_mean": {"default_agent": 0.5439807692307694}, "module_episode_returns_mean": {"default_policy": 0.5439807692307694}, "num_env_steps_sampled": 2000, "sample": 30.11704074319209, "env_to_module_sum_episodes_length_in": 92.84656181441623, "time_between_sampling": 11.223627747513548, "num_env_steps_sampled_lifetime_throughput": 50.18623485178126}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.048011183738708496, "weights_seq_no": 175.0, "vf_loss_unclipped": 0.00410001166164875, "total_loss": -0.043911173939704895, "gradients_default_optimizer_global_norm": 0.13777899742126465, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.047909677028656006, "entropy": 0.07316732406616211, "curr_kl_coeff": 8.265138602280636e-41, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0036402600817382336, "num_module_steps_trained_lifetime": 10601856, "vf_loss": 0.00410001166164875}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052925629686579476, "add_observations_from_episodes_to_batch": 0.0003760147291635399, "add_one_ts_to_episodes_and_truncate": 0.006789351875838021, "add_columns_from_episodes_to_train_batch": 0.08097859946555389, "general_advantage_estimation": 0.0718613211766833, "add_states_from_episodes_to_batch": 1.2283227772530284e-05, "numpy_to_tensor": 0.0013533190507226019, "add_time_dim_to_batch_and_zero_pad": 3.392779454241987e-05}}, "connector_pipeline_timer": 0.21483195506347863}, "num_module_steps_trained_lifetime": 10601856, "learner_connector_sum_episodes_length_out": 2016.622909902081, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 167078032, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 350000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.18623485178126, "done": false, "training_iteration": 175, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-52-52", "timestamp": 1747698772, "time_this_iter_s": 39.789122581481934, "time_total_s": 7088.975660324097, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7088.975660324097, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 76.1140350877193, "ram_util_percent": 52.887719298245614}}
{"timers": {"training_iteration": 41.18928022601081, "restore_env_runners": 2.730531109470395e-05, "training_step": 41.18870511070193, "env_runner_sampling_timer": 31.494001932547608, "learner_update_timer": 9.684185430204453, "synch_weights": 0.009413706791883355, "synch_env_connectors": 0.01004537381533874}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3356666666666668, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001659252900651071, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.352507403361847e-06, "un_batch_to_individual_items": 7.39695503619448e-05, "listify_data_for_vector_env": 0.00014203011463489735, "normalize_and_clip_actions": 0.00012851602226225374, "get_actions": 0.0007467713286316734, "tensor_to_numpy": 0.00023614196036978832}}}, "num_module_steps_sampled_lifetime": {"default_policy": 352000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 352000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.144193879946502e-05, "add_states_from_episodes_to_batch": 2.083847649789954e-05, "numpy_to_tensor": 0.00016656288318819357, "add_time_dim_to_batch_and_zero_pad": 3.807675227845257e-05, "batch_individual_items": 9.896025568818134e-05}}, "connector_pipeline_timer": 0.0006201222581081528}, "episode_return_max": 0.8224444444444443, "episode_duration_sec_mean": 23.041146645933342, "num_episodes_lifetime": 1624, "rlmodule_inference_timer": 0.0005771812028021104, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5008493589743593, "env_to_module_sum_episodes_length_out": 92.47716991030097, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11292925114980079, "num_env_steps_sampled_lifetime": 352000, "weights_seq_no": 175.0, "agent_episode_returns_mean": {"default_agent": 0.5008493589743593}, "module_episode_returns_mean": {"default_policy": 0.5008493589743593}, "num_env_steps_sampled": 2000, "sample": 30.117938625361894, "env_to_module_sum_episodes_length_in": 92.47716991030097, "time_between_sampling": 11.21985357070634, "num_env_steps_sampled_lifetime_throughput": 50.51290190142019}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.016713164746761322, "weights_seq_no": 176.0, "vf_loss_unclipped": 0.004332826938480139, "total_loss": -0.012380346655845642, "gradients_default_optimizer_global_norm": 0.19838108122348785, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.034747302532196045, "entropy": 0.06600991636514664, "curr_kl_coeff": 4.132569301140318e-41, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0011247362708672881, "num_module_steps_trained_lifetime": 10662400, "vf_loss": 0.004332826938480139}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052994157683152694, "add_observations_from_episodes_to_batch": 0.0003762094101766473, "add_one_ts_to_episodes_and_truncate": 0.006786785606264256, "add_columns_from_episodes_to_train_batch": 0.08101382594356141, "general_advantage_estimation": 0.07147872354268571, "add_states_from_episodes_to_batch": 1.2313508745938081e-05, "numpy_to_tensor": 0.001353870823104881, "add_time_dim_to_batch_and_zero_pad": 3.3963475971478756e-05}}, "connector_pipeline_timer": 0.21455076665949796}, "num_module_steps_trained_lifetime": 10662400, "learner_connector_sum_episodes_length_out": 2016.6264884932611, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 168031600, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 352000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.51290190142019, "done": false, "training_iteration": 176, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-53-32", "timestamp": 1747698812, "time_this_iter_s": 39.53348398208618, "time_total_s": 7128.509144306183, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7128.509144306183, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 77.35535714285713, "ram_util_percent": 52.99107142857143}}
{"timers": {"training_iteration": 41.16597786184074, "restore_env_runners": 2.7256257943173597e-05, "training_step": 41.165400510684876, "env_runner_sampling_timer": 31.479696242842138, "learner_update_timer": 9.675215264372449, "synch_weights": 0.009386050723995284, "synch_env_connectors": 0.010050515077171704}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3334444444444445, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016571068245943114, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.652887738127649e-06, "un_batch_to_individual_items": 7.388713188549834e-05, "listify_data_for_vector_env": 0.00014084166271216388, "normalize_and_clip_actions": 0.0001284126053361657, "get_actions": 0.0007445095227674286, "tensor_to_numpy": 0.00023602214650749628}}}, "num_module_steps_sampled_lifetime": {"default_policy": 354000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 354000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.111440939552694e-05, "add_states_from_episodes_to_batch": 2.0510227822100806e-05, "numpy_to_tensor": 0.00016824095908174133, "add_time_dim_to_batch_and_zero_pad": 3.799067705246343e-05, "batch_individual_items": 9.8900215933037e-05}}, "connector_pipeline_timer": 0.0006206755741406596}, "episode_return_max": 0.8096666666666666, "episode_duration_sec_mean": 23.150319939404724, "num_episodes_lifetime": 1632, "rlmodule_inference_timer": 0.0005774877557802752, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.520596153846154, "env_to_module_sum_episodes_length_out": 93.98045010501482, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11225247688985449, "num_env_steps_sampled_lifetime": 354000, "weights_seq_no": 176.0, "agent_episode_returns_mean": {"default_agent": 0.520596153846154}, "module_episode_returns_mean": {"default_policy": 0.520596153846154}, "num_env_steps_sampled": 2000, "sample": 30.11795459560265, "env_to_module_sum_episodes_length_in": 93.98045010501482, "time_between_sampling": 11.215839223421666, "num_env_steps_sampled_lifetime_throughput": 51.325961681950986}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.1464562863111496, "weights_seq_no": 177.0, "vf_loss_unclipped": 0.0068060122430324554, "total_loss": 0.15326231718063354, "gradients_default_optimizer_global_norm": 0.2700267434120178, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.11486077308654785, "entropy": 0.03993842378258705, "curr_kl_coeff": 2.0663547154933753e-41, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0014235125854611397, "num_module_steps_trained_lifetime": 10722944, "vf_loss": 0.0068060122430324554}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.053060482806825626, "add_observations_from_episodes_to_batch": 0.00037640241609637786, "add_one_ts_to_episodes_and_truncate": 0.006784198836994482, "add_columns_from_episodes_to_train_batch": 0.081048873182062, "general_advantage_estimation": 0.07109760658925099, "add_states_from_episodes_to_batch": 1.234301577716828e-05, "numpy_to_tensor": 0.0013543905281345745, "add_time_dim_to_batch_and_zero_pad": 3.399818099232493e-05}}, "connector_pipeline_timer": 0.21426861966819058}, "num_module_steps_trained_lifetime": 10722944, "learner_connector_sum_episodes_length_out": 2016.6299332216277, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 168985168, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 354000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 51.325961681950986, "done": false, "training_iteration": 177, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-54-11", "timestamp": 1747698851, "time_this_iter_s": 38.877591133117676, "time_total_s": 7167.3867354393005, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7167.3867354393005, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 78.55454545454548, "ram_util_percent": 52.94545454545455}}
{"timers": {"training_iteration": 41.17892685043234, "restore_env_runners": 2.728469532739793e-05, "training_step": 41.17834955278799, "env_runner_sampling_timer": 31.498121251153695, "learner_update_timer": 9.66974258919874, "synch_weights": 0.009378591216763085, "synch_env_connectors": 0.010041870926437158}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.36244444444444496, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016528387384350223, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.758650624211308e-06, "un_batch_to_individual_items": 7.347717938172761e-05, "listify_data_for_vector_env": 0.00013981415582690613, "normalize_and_clip_actions": 0.00012759176702914314, "get_actions": 0.0007410614491421587, "tensor_to_numpy": 0.0002364495382783803}}}, "num_module_steps_sampled_lifetime": {"default_policy": 356000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 356000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.080694337766046e-05, "add_states_from_episodes_to_batch": 2.0517870058812496e-05, "numpy_to_tensor": 0.0001690556835677455, "add_time_dim_to_batch_and_zero_pad": 3.8520763249982216e-05, "batch_individual_items": 9.853933531155765e-05}}, "connector_pipeline_timer": 0.0006219662218687655}, "episode_return_max": 0.7762222222222235, "episode_duration_sec_mean": 23.833286138538824, "num_episodes_lifetime": 1648, "rlmodule_inference_timer": 0.0005761326979304152, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5785854700854709, "env_to_module_sum_episodes_length_out": 96.87534134882388, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.1129235272679899, "num_env_steps_sampled_lifetime": 356000, "weights_seq_no": 177.0, "agent_episode_returns_mean": {"default_agent": 0.5785854700854709}, "module_episode_returns_mean": {"default_policy": 0.5785854700854709}, "num_env_steps_sampled": 2000, "sample": 30.11930204252881, "env_to_module_sum_episodes_length_in": 96.87534134882388, "time_between_sampling": 11.211144465099876, "num_env_steps_sampled_lifetime_throughput": 46.9860430100198}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.001831216155551374, "weights_seq_no": 178.0, "vf_loss_unclipped": 0.006978127174079418, "total_loss": 0.008809348568320274, "gradients_default_optimizer_global_norm": 0.07685256004333496, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.054320454597473145, "entropy": 0.06098662689328194, "curr_kl_coeff": 1.0331773577466876e-41, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.003212705021724105, "num_module_steps_trained_lifetime": 10783744, "vf_loss": 0.006978127174079418}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.053125045292356884, "add_observations_from_episodes_to_batch": 0.0003766128109567624, "add_one_ts_to_episodes_and_truncate": 0.006781824094549519, "add_columns_from_episodes_to_train_batch": 0.08108280898319845, "general_advantage_estimation": 0.07071785618253058, "add_states_from_episodes_to_batch": 1.2372561317237919e-05, "numpy_to_tensor": 0.001354870361980911, "add_time_dim_to_batch_and_zero_pad": 3.403227556546202e-05}}, "connector_pipeline_timer": 0.21398515820014316}, "num_module_steps_trained_lifetime": 10783744, "learner_connector_sum_episodes_length_out": 2016.6340464065775, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 169946568, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 356000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 46.9860430100198, "done": false, "training_iteration": 178, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-54-53", "timestamp": 1747698893, "time_this_iter_s": 42.47772407531738, "time_total_s": 7209.864459514618, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7209.864459514618, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 77.95573770491802, "ram_util_percent": 52.97377049180328}}
{"timers": {"training_iteration": 41.11475936368797, "restore_env_runners": 2.724584840968557e-05, "training_step": 41.11418196002012, "env_runner_sampling_timer": 31.450302954992146, "learner_update_timer": 9.653382622716755, "synch_weights": 0.009357857304602465, "synch_env_connectors": 0.010024108217186018}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3482222222222231, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016417647933806006, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.675451510222638e-06, "un_batch_to_individual_items": 7.563666415494947e-05, "listify_data_for_vector_env": 0.00013857684483216964, "normalize_and_clip_actions": 0.0001264049236833803, "get_actions": 0.0007345227576744777, "tensor_to_numpy": 0.00023392577125842424}}}, "num_module_steps_sampled_lifetime": {"default_policy": 358000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 358000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.056078297415549e-05, "add_states_from_episodes_to_batch": 2.0287895053014958e-05, "numpy_to_tensor": 0.0001679850341996591, "add_time_dim_to_batch_and_zero_pad": 3.8193261278174306e-05, "batch_individual_items": 9.717248488175768e-05}}, "connector_pipeline_timer": 0.0006170933649355425}, "episode_return_max": 0.8157777777777794, "episode_duration_sec_mean": 22.184853742451686, "num_episodes_lifetime": 1656, "rlmodule_inference_timer": 0.0005705514599942688, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.566386752136753, "env_to_module_sum_episodes_length_out": 97.22671841749711, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11242756624827732, "num_env_steps_sampled_lifetime": 358000, "weights_seq_no": 178.0, "agent_episode_returns_mean": {"default_agent": 0.566386752136753}, "module_episode_returns_mean": {"default_policy": 0.566386752136753}, "num_env_steps_sampled": 2000, "sample": 30.117489956655753, "env_to_module_sum_episodes_length_in": 97.22671841749711, "time_between_sampling": 11.206455191294738, "num_env_steps_sampled_lifetime_throughput": 57.41077522681045}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.028092417865991592, "weights_seq_no": 179.0, "vf_loss_unclipped": 0.008409379050135612, "total_loss": 0.03650178015232086, "gradients_default_optimizer_global_norm": 0.6242011785507202, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.08049726486206055, "entropy": 0.06443341076374054, "curr_kl_coeff": 5.165186139501276e-42, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0019157505594193935, "num_module_steps_trained_lifetime": 10844288, "vf_loss": 0.008409379050135612}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05318707414989716, "add_observations_from_episodes_to_batch": 0.00037681238767886625, "add_one_ts_to_episodes_and_truncate": 0.006779335417070079, "add_columns_from_episodes_to_train_batch": 0.08111556534109413, "general_advantage_estimation": 0.07033961866328606, "add_states_from_episodes_to_batch": 1.2401261645114695e-05, "numpy_to_tensor": 0.001355309720097689, "add_time_dim_to_batch_and_zero_pad": 3.4065188429291294e-05}}, "connector_pipeline_timer": 0.2136993255395894}, "num_module_steps_trained_lifetime": 10844288, "learner_connector_sum_episodes_length_out": 2016.6380143345061, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 170900136, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 358000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.41077522681045, "done": false, "training_iteration": 179, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-55-28", "timestamp": 1747698928, "time_this_iter_s": 34.780914306640625, "time_total_s": 7244.6453738212585, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7244.6453738212585, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 79.26326530612245, "ram_util_percent": 52.94285714285715}}
{"timers": {"training_iteration": 41.04284273673113, "restore_env_runners": 2.720138998822295e-05, "training_step": 41.04226561909986, "env_runner_sampling_timer": 31.391581709722267, "learner_update_timer": 9.640231086889628, "synch_weights": 0.009315893731531286, "synch_env_connectors": 0.010016358135046326}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29477777777777786, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016236127310681181, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.519662570569874e-06, "un_batch_to_individual_items": 7.427714966724181e-05, "listify_data_for_vector_env": 0.000137962874083361, "normalize_and_clip_actions": 0.0001249820116483179, "get_actions": 0.0007253490794047923, "tensor_to_numpy": 0.00023212969899960765}}}, "num_module_steps_sampled_lifetime": {"default_policy": 360000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 360000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.066682646655341e-05, "add_states_from_episodes_to_batch": 1.9959300642961816e-05, "numpy_to_tensor": 0.00016569880592110992, "add_time_dim_to_batch_and_zero_pad": 3.770390850798069e-05, "batch_individual_items": 9.658605356943886e-05}}, "connector_pipeline_timer": 0.0006107116111821977}, "episode_return_max": 0.8157777777777794, "episode_duration_sec_mean": 20.366106468008955, "num_episodes_lifetime": 1664, "rlmodule_inference_timer": 0.0005635647349422676, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5491367521367532, "env_to_module_sum_episodes_length_out": 95.51181916528431, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.11119368549202528, "num_env_steps_sampled_lifetime": 360000, "weights_seq_no": 179.0, "agent_episode_returns_mean": {"default_agent": 0.5491367521367532}, "module_episode_returns_mean": {"default_policy": 0.5491367521367532}, "num_env_steps_sampled": 2000, "sample": 30.111774226838772, "env_to_module_sum_episodes_length_in": 95.51181916528431, "time_between_sampling": 11.200223913305095, "num_env_steps_sampled_lifetime_throughput": 58.778274344899074}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.014858730137348175, "weights_seq_no": 180.0, "vf_loss_unclipped": 0.004664846230298281, "total_loss": -0.010193899273872375, "gradients_default_optimizer_global_norm": 0.8987506628036499, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.019315123558044434, "entropy": 0.06593552976846695, "curr_kl_coeff": 2.582593069750638e-42, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002893565222620964, "num_module_steps_trained_lifetime": 10904832, "vf_loss": 0.004664846230298281}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0532465775158577, "add_observations_from_episodes_to_batch": 0.00037700119158555446, "add_one_ts_to_episodes_and_truncate": 0.006776730660730538, "add_columns_from_episodes_to_train_batch": 0.08114682839093403, "general_advantage_estimation": 0.06996273744880824, "add_states_from_episodes_to_batch": 1.2429140709837005e-05, "numpy_to_tensor": 0.0013556997640157753, "add_time_dim_to_batch_and_zero_pad": 3.409670980824546e-05}}, "connector_pipeline_timer": 0.21341064469652715}, "num_module_steps_trained_lifetime": 10904832, "learner_connector_sum_episodes_length_out": 2016.6418394992356, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 171853704, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 360000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.778274344899074, "done": false, "training_iteration": 180, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-56-02", "timestamp": 1747698962, "time_this_iter_s": 33.938066482543945, "time_total_s": 7278.5834403038025, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7278.5834403038025, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 76.12448979591836, "ram_util_percent": 52.967346938775506}}
{"timers": {"training_iteration": 40.97651668027386, "restore_env_runners": 2.7152376112902494e-05, "training_step": 40.975940495818804, "env_runner_sampling_timer": 31.34080455500505, "learner_update_timer": 9.624724313550745, "synch_weights": 0.009270274794230095, "synch_env_connectors": 0.009983658553717436}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.29477777777777786, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0016094554710375459, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.374771250059754e-06, "un_batch_to_individual_items": 7.350510353631125e-05, "listify_data_for_vector_env": 0.00013745203346873618, "normalize_and_clip_actions": 0.0001239145697615577, "get_actions": 0.0007186914047567793, "tensor_to_numpy": 0.00023109473288961124}}}, "num_module_steps_sampled_lifetime": {"default_policy": 362000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 362000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.043874798747129e-05, "add_states_from_episodes_to_batch": 1.970465348060977e-05, "numpy_to_tensor": 0.0001633770042883875, "add_time_dim_to_batch_and_zero_pad": 3.740118491957989e-05, "batch_individual_items": 9.542082740891122e-05}}, "connector_pipeline_timer": 0.0006040107083291975}, "episode_return_max": 0.8257777777777784, "episode_duration_sec_mean": 20.072433162479264, "num_episodes_lifetime": 1672, "rlmodule_inference_timer": 0.0005603047424102297, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.6082393162393168, "env_to_module_sum_episodes_length_out": 93.5744661514454, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10996336394139035, "num_env_steps_sampled_lifetime": 362000, "weights_seq_no": 180.0, "agent_episode_returns_mean": {"default_agent": 0.6082393162393168}, "module_episode_returns_mean": {"default_policy": 0.6082393162393168}, "num_env_steps_sampled": 2000, "sample": 30.102940596143714, "env_to_module_sum_episodes_length_in": 93.5744661514454, "time_between_sampling": 11.193014058703247, "num_env_steps_sampled_lifetime_throughput": 57.825891965906386}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.18719133734703064, "weights_seq_no": 181.0, "vf_loss_unclipped": 0.007416715379804373, "total_loss": -0.17977462708950043, "gradients_default_optimizer_global_norm": 0.627974808216095, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06034201383590698, "entropy": 0.08660570532083511, "curr_kl_coeff": 2.582593069750638e-42, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.006495215464383364, "num_module_steps_trained_lifetime": 10965376, "vf_loss": 0.007416715379804373}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05331970963688387, "add_observations_from_episodes_to_batch": 0.0003771794781751924, "add_one_ts_to_episodes_and_truncate": 0.0067740262759760335, "add_columns_from_episodes_to_train_batch": 0.08117698491324311, "general_advantage_estimation": 0.06958733863675348, "add_states_from_episodes_to_batch": 1.2456222066711298e-05, "numpy_to_tensor": 0.0013560729260837336, "add_time_dim_to_batch_and_zero_pad": 3.412735424082874e-05}}, "connector_pipeline_timer": 0.21313583690757226}, "num_module_steps_trained_lifetime": 10965376, "learner_connector_sum_episodes_length_out": 2016.645524359237, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 172807272, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 362000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.825891965906386, "done": false, "training_iteration": 181, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-56-37", "timestamp": 1747698997, "time_this_iter_s": 34.42451500892639, "time_total_s": 7313.007955312729, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7313.007955312729, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 77.42448979591838, "ram_util_percent": 52.99183673469388}}
{"timers": {"training_iteration": 40.90611354024115, "restore_env_runners": 2.7091852357720895e-05, "training_step": 40.9055387066306, "env_runner_sampling_timer": 31.288447051725022, "learner_update_timer": 9.60671601891524, "synch_weights": 0.009238754046278162, "synch_env_connectors": 0.009953079968183435}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3400000000000002, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015984120708825782, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.112240392325587e-06, "un_batch_to_individual_items": 7.253165488922454e-05, "listify_data_for_vector_env": 0.00013675403745696827, "normalize_and_clip_actions": 0.00012314754168500666, "get_actions": 0.0007128519578308014, "tensor_to_numpy": 0.00023090587281649158}}}, "num_module_steps_sampled_lifetime": {"default_policy": 364000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 364000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0086715820692274e-05, "add_states_from_episodes_to_batch": 1.986017272745201e-05, "numpy_to_tensor": 0.00016174468782767466, "add_time_dim_to_batch_and_zero_pad": 3.682978470063286e-05, "batch_individual_items": 9.451519406249825e-05}}, "connector_pipeline_timer": 0.0005978904524083494}, "episode_return_max": 0.8257777777777784, "episode_duration_sec_mean": 20.056505466211654, "num_episodes_lifetime": 1680, "rlmodule_inference_timer": 0.0005540137844130789, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5706944444444447, "env_to_module_sum_episodes_length_out": 92.64203731063374, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10875571868606912, "num_env_steps_sampled_lifetime": 364000, "weights_seq_no": 181.0, "agent_episode_returns_mean": {"default_agent": 0.5706944444444447}, "module_episode_returns_mean": {"default_policy": 0.5706944444444447}, "num_env_steps_sampled": 2000, "sample": 30.09132034681729, "env_to_module_sum_episodes_length_in": 92.64203731063374, "time_between_sampling": 11.184767539007272, "num_env_steps_sampled_lifetime_throughput": 58.813737656156135}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.02284845896065235, "weights_seq_no": 182.0, "vf_loss_unclipped": 0.003102750750258565, "total_loss": 0.025951208546757698, "gradients_default_optimizer_global_norm": 0.2976587116718292, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.03332722187042236, "entropy": 0.04989328235387802, "curr_kl_coeff": 1.2919971841074813e-42, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0023546305019408464, "num_module_steps_trained_lifetime": 11025920, "vf_loss": 0.003102750750258565}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05339016543763793, "add_observations_from_episodes_to_batch": 0.00037734690891406036, "add_one_ts_to_episodes_and_truncate": 0.006771276605850598, "add_columns_from_episodes_to_train_batch": 0.0812056810722671, "general_advantage_estimation": 0.06921355709719502, "add_states_from_episodes_to_batch": 1.2482538882867947e-05, "numpy_to_tensor": 0.0013564046149338249, "add_time_dim_to_batch_and_zero_pad": 3.415659611408442e-05}}, "connector_pipeline_timer": 0.2128584060598267}, "num_module_steps_trained_lifetime": 11025920, "learner_connector_sum_episodes_length_out": 2016.6490713380886, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 173760840, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 364000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.813737656156135, "done": false, "training_iteration": 182, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-57-11", "timestamp": 1747699031, "time_this_iter_s": 33.95255422592163, "time_total_s": 7346.9605095386505, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7346.9605095386505, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 78.80833333333332, "ram_util_percent": 52.979166666666664}}
{"timers": {"training_iteration": 40.8512090617787, "restore_env_runners": 2.7034933862934593e-05, "training_step": 40.8506308375043, "env_runner_sampling_timer": 31.250743822487706, "learner_update_timer": 9.589545702386056, "synch_weights": 0.00920645350583523, "synch_env_connectors": 0.009937761168503171}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3400000000000002, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015836984461482023, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.962683318443603e-06, "un_batch_to_individual_items": 7.170068605380302e-05, "listify_data_for_vector_env": 0.00013665533136327296, "normalize_and_clip_actions": 0.00012166327023988062, "get_actions": 0.0007065152064753935, "tensor_to_numpy": 0.00022825182475206285}}}, "num_module_steps_sampled_lifetime": {"default_policy": 366000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 366000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.978708131367805e-05, "add_states_from_episodes_to_batch": 1.957584106380584e-05, "numpy_to_tensor": 0.00015970318316951926, "add_time_dim_to_batch_and_zero_pad": 3.6340142626932774e-05, "batch_individual_items": 9.450832884206524e-05}}, "connector_pipeline_timer": 0.0005925820778500461}, "episode_return_max": 0.7839999999999998, "episode_duration_sec_mean": 20.877768658797113, "num_episodes_lifetime": 1688, "rlmodule_inference_timer": 0.0005493333842485146, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5111442307692309, "env_to_module_sum_episodes_length_out": 93.42280736507733, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10751777695534115, "num_env_steps_sampled_lifetime": 366000, "weights_seq_no": 182.0, "agent_episode_returns_mean": {"default_agent": 0.5111442307692309}, "module_episode_returns_mean": {"default_policy": 0.5111442307692309}, "num_env_steps_sampled": 2000, "sample": 30.077898206649362, "env_to_module_sum_episodes_length_in": 93.42280736507733, "time_between_sampling": 11.175169799916915, "num_env_steps_sampled_lifetime_throughput": 56.34038733464755}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.1389622837305069, "weights_seq_no": 183.0, "vf_loss_unclipped": 0.002996882190927863, "total_loss": 0.14195916056632996, "gradients_default_optimizer_global_norm": 0.2748754322528839, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0216483473777771, "entropy": 0.05980841815471649, "curr_kl_coeff": 6.459985920537407e-43, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0010520719224587083, "num_module_steps_trained_lifetime": 11086464, "vf_loss": 0.002996882190927863}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.053457957731313545, "add_observations_from_episodes_to_batch": 0.00037750661309026974, "add_one_ts_to_episodes_and_truncate": 0.006768431246500272, "add_columns_from_episodes_to_train_batch": 0.08123317613951923, "general_advantage_estimation": 0.0688412367245641, "add_states_from_episodes_to_batch": 1.2508283740901034e-05, "numpy_to_tensor": 0.0013567681927145383, "add_time_dim_to_batch_and_zero_pad": 3.4190610414291206e-05}}, "connector_pipeline_timer": 0.21257851623514584}, "num_module_steps_trained_lifetime": 11086464, "learner_connector_sum_episodes_length_out": 2016.6524828249271, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 174714408, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 366000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.34038733464755, "done": false, "training_iteration": 183, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-57-46", "timestamp": 1747699066, "time_this_iter_s": 35.432523012161255, "time_total_s": 7382.393032550812, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7382.393032550812, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 78.76, "ram_util_percent": 53.01}}
{"timers": {"training_iteration": 40.78175316944092, "restore_env_runners": 2.6959584481180354e-05, "training_step": 40.781175342419196, "env_runner_sampling_timer": 31.195502020032848, "learner_update_timer": 9.575373287872251, "synch_weights": 0.009165409980780628, "synch_env_connectors": 0.009918553546778407}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.32133333333333375, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015664576529187423, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.762184657818613e-06, "un_batch_to_individual_items": 7.166921602369926e-05, "listify_data_for_vector_env": 0.00013484976420502872, "normalize_and_clip_actions": 0.00012033177377109834, "get_actions": 0.0006992152140112018, "tensor_to_numpy": 0.0002255110637475912}}}, "num_module_steps_sampled_lifetime": {"default_policy": 368000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 368000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.911451487083229e-05, "add_states_from_episodes_to_batch": 1.9397112552526375e-05, "numpy_to_tensor": 0.00015883302264573315, "add_time_dim_to_batch_and_zero_pad": 3.599754678567379e-05, "batch_individual_items": 9.55222034111021e-05}}, "connector_pipeline_timer": 0.0005893815439276147}, "episode_return_max": 0.7839999999999998, "episode_duration_sec_mean": 20.476329550729133, "num_episodes_lifetime": 1696, "rlmodule_inference_timer": 0.0005434372966885691, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.44853632478632516, "env_to_module_sum_episodes_length_out": 96.28356918381145, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10601562011183674, "num_env_steps_sampled_lifetime": 368000, "weights_seq_no": 183.0, "agent_episode_returns_mean": {"default_agent": 0.44853632478632516}, "module_episode_returns_mean": {"default_policy": 0.44853632478632516}, "num_env_steps_sampled": 2000, "sample": 30.06153258235754, "env_to_module_sum_episodes_length_in": 96.28356918381145, "time_between_sampling": 11.164749040212923, "num_env_steps_sampled_lifetime_throughput": 58.85055579388824}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02943124994635582, "weights_seq_no": 184.0, "vf_loss_unclipped": 0.009875615127384663, "total_loss": -0.019555624574422836, "gradients_default_optimizer_global_norm": 0.7294883728027344, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.11245524883270264, "entropy": 0.06758367270231247, "curr_kl_coeff": 3.2229864679470793e-43, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0010682812426239252, "num_module_steps_trained_lifetime": 11147008, "vf_loss": 0.009875615127384663}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05352308969247183, "add_observations_from_episodes_to_batch": 0.00037765540849218557, "add_one_ts_to_episodes_and_truncate": 0.006765481456676285, "add_columns_from_episodes_to_train_batch": 0.0812594007671193, "general_advantage_estimation": 0.06847030197367615, "add_states_from_episodes_to_batch": 1.2533295447724547e-05, "numpy_to_tensor": 0.0013570877284779274, "add_time_dim_to_batch_and_zero_pad": 3.422371876916202e-05}}, "connector_pipeline_timer": 0.2122959149260531}, "num_module_steps_trained_lifetime": 11147008, "learner_connector_sum_episodes_length_out": 2016.6557611748951, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 175667976, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 368000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.85055579388824, "done": false, "training_iteration": 184, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-58-20", "timestamp": 1747699100, "time_this_iter_s": 33.92221212387085, "time_total_s": 7416.315244674683, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7416.315244674683, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 76.95208333333333, "ram_util_percent": 53.01458333333333}}
{"timers": {"training_iteration": 40.7427392281665, "restore_env_runners": 2.6982988684627823e-05, "training_step": 40.74216179741498, "env_runner_sampling_timer": 31.167772784522505, "learner_update_timer": 9.564132094723513, "synch_weights": 0.00912278688098966, "synch_env_connectors": 0.009894326011278941}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3005555555555564, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001555146714600388, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.567210536724576e-06, "un_batch_to_individual_items": 7.129756494555777e-05, "listify_data_for_vector_env": 0.00013364073559273942, "normalize_and_clip_actions": 0.00012043253557558174, "get_actions": 0.0006933353866894486, "tensor_to_numpy": 0.00022309017128636008}}}, "num_module_steps_sampled_lifetime": {"default_policy": 370000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 370000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.857095568996418e-05, "add_states_from_episodes_to_batch": 1.935333815150743e-05, "numpy_to_tensor": 0.0001579304051034499, "add_time_dim_to_batch_and_zero_pad": 3.580850249816065e-05, "batch_individual_items": 9.469171798815139e-05}}, "connector_pipeline_timer": 0.0005869126728353046}, "episode_return_max": 0.9154444444444466, "episode_duration_sec_mean": 20.18675746754854, "num_episodes_lifetime": 1712, "rlmodule_inference_timer": 0.0005390270730158715, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5991591880341891, "env_to_module_sum_episodes_length_out": 97.45388289112411, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10571064292767057, "num_env_steps_sampled_lifetime": 370000, "weights_seq_no": 184.0, "agent_episode_returns_mean": {"default_agent": 0.5991591880341891}, "module_episode_returns_mean": {"default_policy": 0.5991591880341891}, "num_env_steps_sampled": 2000, "sample": 30.044471981139566, "env_to_module_sum_episodes_length_in": 97.45388289112411, "time_between_sampling": 11.153719972173343, "num_env_steps_sampled_lifetime_throughput": 54.12542450586736}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.10885787010192871, "weights_seq_no": 185.0, "vf_loss_unclipped": 0.010059732012450695, "total_loss": -0.09879813343286514, "gradients_default_optimizer_global_norm": 0.4937267601490021, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.05774509906768799, "entropy": 0.0566612109541893, "curr_kl_coeff": 4.834479701920619e-43, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.029741108417510986, "num_module_steps_trained_lifetime": 11207808, "vf_loss": 0.010059732012450695}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05358557571863403, "add_observations_from_episodes_to_batch": 0.0003778079073247339, "add_one_ts_to_episodes_and_truncate": 0.006762532359524268, "add_columns_from_episodes_to_train_batch": 0.08128451624455353, "general_advantage_estimation": 0.06810077172413355, "add_states_from_episodes_to_batch": 1.2557516092071457e-05, "numpy_to_tensor": 0.0013573743667064095, "add_time_dim_to_batch_and_zero_pad": 3.425528589631732e-05}}, "connector_pipeline_timer": 0.21201092450151837}, "num_module_steps_trained_lifetime": 11207808, "learner_connector_sum_episodes_length_out": 2016.6597087095813, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 176629376, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 370000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.12542450586736, "done": false, "training_iteration": 185, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-58-57", "timestamp": 1747699137, "time_this_iter_s": 36.89580202102661, "time_total_s": 7453.211046695709, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7453.211046695709, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 76.95849056603772, "ram_util_percent": 53.02075471698114}}
{"timers": {"training_iteration": 40.676674675504806, "restore_env_runners": 2.6913158865488694e-05, "training_step": 40.676098665060834, "env_runner_sampling_timer": 31.11754766608725, "learner_update_timer": 9.54833440098627, "synch_weights": 0.009083808012180066, "synch_env_connectors": 0.009866348751223676}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3005555555555564, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001542736071669635, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.402805849987558e-06, "un_batch_to_individual_items": 7.063730009260874e-05, "listify_data_for_vector_env": 0.00013230926688004115, "normalize_and_clip_actions": 0.00011914303335506187, "get_actions": 0.0006880320735294745, "tensor_to_numpy": 0.00022198953412960973}}}, "num_module_steps_sampled_lifetime": {"default_policy": 372000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 372000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.8291561390213006e-05, "add_states_from_episodes_to_batch": 1.9152028734353203e-05, "numpy_to_tensor": 0.00015619667370511255, "add_time_dim_to_batch_and_zero_pad": 3.565252824804025e-05, "batch_individual_items": 9.359907712594908e-05}}, "connector_pipeline_timer": 0.0005811214112441917}, "episode_return_max": 0.8241111111111129, "episode_duration_sec_mean": 20.01313100790314, "num_episodes_lifetime": 1720, "rlmodule_inference_timer": 0.0005329862152539261, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5462072649572659, "env_to_module_sum_episodes_length_out": 96.20966432786481, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10508243100728026, "num_env_steps_sampled_lifetime": 372000, "weights_seq_no": 185.0, "agent_episode_returns_mean": {"default_agent": 0.5462072649572659}, "module_episode_returns_mean": {"default_policy": 0.5462072649572659}, "num_env_steps_sampled": 2000, "sample": 30.024943365924248, "env_to_module_sum_episodes_length_in": 96.20966432786481, "time_between_sampling": 11.142457861694218, "num_env_steps_sampled_lifetime_throughput": 58.47314908262402}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03766945004463196, "weights_seq_no": 186.0, "vf_loss_unclipped": 0.009050482884049416, "total_loss": -0.02861897647380829, "gradients_default_optimizer_global_norm": 0.36019253730773926, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.020309507846832275, "entropy": 0.03436930850148201, "curr_kl_coeff": 2.4102333586386854e-43, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0006095507997088134, "num_module_steps_trained_lifetime": 11268352, "vf_loss": 0.009050482884049416}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05364548733530386, "add_observations_from_episodes_to_batch": 0.00037795688063996426, "add_one_ts_to_episodes_and_truncate": 0.00675954495616971, "add_columns_from_episodes_to_train_batch": 0.08130829612226242, "general_advantage_estimation": 0.06773264874938506, "add_states_from_episodes_to_batch": 1.258106899413061e-05, "numpy_to_tensor": 0.001357623803397402, "add_time_dim_to_batch_and_zero_pad": 3.428558930846915e-05}}, "connector_pipeline_timer": 0.21172334804388204}, "num_module_steps_trained_lifetime": 11268352, "learner_connector_sum_episodes_length_out": 2016.6635117174562, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 177582944, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 372000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.47314908262402, "done": false, "training_iteration": 186, "trial_id": "c3e2f_00000", "date": "2025-05-20_09-59-31", "timestamp": 1747699171, "time_this_iter_s": 34.151540994644165, "time_total_s": 7487.362587690353, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7487.362587690353, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 76.39795918367346, "ram_util_percent": 52.98775510204081}}
{"timers": {"training_iteration": 40.61883646931974, "restore_env_runners": 2.6841027248937904e-05, "training_step": 40.61826185698024, "env_runner_sampling_timer": 31.06523648329637, "learner_update_timer": 9.542790923676414, "synch_weights": 0.009104530932070708, "synch_env_connectors": 0.009848011263736238}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3235555555555559, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015330968596705406, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.248009375970945e-06, "un_batch_to_individual_items": 6.972989981604201e-05, "listify_data_for_vector_env": 0.00013141247646886, "normalize_and_clip_actions": 0.00011865756001235329, "get_actions": 0.0006838390003768629, "tensor_to_numpy": 0.00022051897474218527}}}, "num_module_steps_sampled_lifetime": {"default_policy": 374000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 374000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7887364364675555e-05, "add_states_from_episodes_to_batch": 1.9258403914638547e-05, "numpy_to_tensor": 0.0001545610794266312, "add_time_dim_to_batch_and_zero_pad": 3.5495202478966155e-05, "batch_individual_items": 9.208245660632029e-05}}, "connector_pipeline_timer": 0.0005770533389172882}, "episode_return_max": 0.8046666666666682, "episode_duration_sec_mean": 19.645702189116353, "num_episodes_lifetime": 1728, "rlmodule_inference_timer": 0.0005280545293558345, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5453664529914537, "env_to_module_sum_episodes_length_out": 94.17720255058771, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10422417296208066, "num_env_steps_sampled_lifetime": 374000, "weights_seq_no": 186.0, "agent_episode_returns_mean": {"default_agent": 0.5453664529914537}, "module_episode_returns_mean": {"default_policy": 0.5453664529914537}, "num_env_steps_sampled": 2000, "sample": 30.003145463014, "env_to_module_sum_episodes_length_in": 94.17720255058771, "time_between_sampling": 11.130719094679963, "num_env_steps_sampled_lifetime_throughput": 57.20740727121779}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.010405926033854485, "weights_seq_no": 187.0, "vf_loss_unclipped": 0.0059008351527154446, "total_loss": 0.016306763514876366, "gradients_default_optimizer_global_norm": 0.5005823969841003, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.060415804386138916, "entropy": 0.05905942991375923, "curr_kl_coeff": 2.4102333586386854e-43, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.009156771935522556, "num_module_steps_trained_lifetime": 11328896, "vf_loss": 0.0059008351527154446}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05370287296206876, "add_observations_from_episodes_to_batch": 0.00037809536369872793, "add_one_ts_to_episodes_and_truncate": 0.006756463807745848, "add_columns_from_episodes_to_train_batch": 0.08133070162079234, "general_advantage_estimation": 0.06736594668695942, "add_states_from_episodes_to_batch": 1.2603865085921878e-05, "numpy_to_tensor": 0.0013578600839179447, "add_time_dim_to_batch_and_zero_pad": 3.4314351123830915e-05}}, "connector_pipeline_timer": 0.21143316557304895}, "num_module_steps_trained_lifetime": 11328896, "learner_connector_sum_episodes_length_out": 2016.6671726943027, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 178536512, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 374000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.20740727121779, "done": false, "training_iteration": 187, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-00-06", "timestamp": 1747699206, "time_this_iter_s": 34.912941694259644, "time_total_s": 7522.275529384613, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7522.275529384613, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 76.15102040816326, "ram_util_percent": 53.053061224489795}}
{"timers": {"training_iteration": 40.554266705966555, "restore_env_runners": 2.734461696131174e-05, "training_step": 40.55369155575048, "env_runner_sampling_timer": 31.01295176535337, "learner_update_timer": 9.530548729889667, "synch_weights": 0.009063254622711089, "synch_env_connectors": 0.009860308161148662}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3288888888888891, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015276278829480627, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.153918298022689e-06, "un_batch_to_individual_items": 6.934399765965582e-05, "listify_data_for_vector_env": 0.00013058923559346904, "normalize_and_clip_actions": 0.00011900717571405775, "get_actions": 0.0006804373866668611, "tensor_to_numpy": 0.0002201168954016922}}}, "num_module_steps_sampled_lifetime": {"default_policy": 376000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 376000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.772122214450144e-05, "add_states_from_episodes_to_batch": 1.8978806244670083e-05, "numpy_to_tensor": 0.00015298988889659874, "add_time_dim_to_batch_and_zero_pad": 3.575114976419566e-05, "batch_individual_items": 9.127669135265984e-05}}, "connector_pipeline_timer": 0.0005725979787831173}, "episode_return_max": 0.8216666666666668, "episode_duration_sec_mean": 19.737301827463714, "num_episodes_lifetime": 1736, "rlmodule_inference_timer": 0.0005244695670962268, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.6123440170940173, "env_to_module_sum_episodes_length_out": 92.78783863897253, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10345616482585965, "num_env_steps_sampled_lifetime": 376000, "weights_seq_no": 187.0, "agent_episode_returns_mean": {"default_agent": 0.6123440170940173}, "module_episode_returns_mean": {"default_policy": 0.6123440170940173}, "num_env_steps_sampled": 2000, "sample": 29.979550876597127, "env_to_module_sum_episodes_length_in": 92.78783863897253, "time_between_sampling": 11.119183401990155, "num_env_steps_sampled_lifetime_throughput": 58.39326459258008}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.032683365046978, "weights_seq_no": 188.0, "vf_loss_unclipped": 0.005072082858532667, "total_loss": -0.02761128917336464, "gradients_default_optimizer_global_norm": 0.2812514007091522, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.017908751964569092, "entropy": 0.03566812723875046, "curr_kl_coeff": 1.2051166793193427e-43, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0039536235854029655, "num_module_steps_trained_lifetime": 11389440, "vf_loss": 0.005072082858532667}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05376022247756463, "add_observations_from_episodes_to_batch": 0.00037822425140833217, "add_one_ts_to_episodes_and_truncate": 0.006753279067794145, "add_columns_from_episodes_to_train_batch": 0.08135725400983938, "general_advantage_estimation": 0.06700062707090736, "add_states_from_episodes_to_batch": 1.26267971492404e-05, "numpy_to_tensor": 0.0013580587164471905, "add_time_dim_to_batch_and_zero_pad": 3.4343649144327396e-05}}, "connector_pipeline_timer": 0.21114832786692783}, "num_module_steps_trained_lifetime": 11389440, "learner_connector_sum_episodes_length_out": 2016.6706941004404, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 179490080, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 376000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.39326459258008, "done": false, "training_iteration": 188, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-00-40", "timestamp": 1747699240, "time_this_iter_s": 34.17773985862732, "time_total_s": 7556.45326924324, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7556.45326924324, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 76.97551020408163, "ram_util_percent": 53.018367346938774}}
{"timers": {"training_iteration": 40.506385173586914, "restore_env_runners": 2.72961707587298e-05, "training_step": 40.505811066872944, "env_runner_sampling_timer": 30.970848886829806, "learner_update_timer": 9.52481886714075, "synch_weights": 0.009017312076479149, "synch_env_connectors": 0.009842987079492712}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3326666666666669, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015183412414649117, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.01893151112914e-06, "un_batch_to_individual_items": 6.867406874387186e-05, "listify_data_for_vector_env": 0.00012994536279447048, "normalize_and_clip_actions": 0.00011756062342890012, "get_actions": 0.0006770369269915298, "tensor_to_numpy": 0.00021812809941393666}}}, "num_module_steps_sampled_lifetime": {"default_policy": 378000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 378000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7689408710341156e-05, "add_states_from_episodes_to_batch": 1.875906861429919e-05, "numpy_to_tensor": 0.00015192109457615958, "add_time_dim_to_batch_and_zero_pad": 3.5534317313522757e-05, "batch_individual_items": 9.052161001227901e-05}}, "connector_pipeline_timer": 0.00056883601807193}, "episode_return_max": 0.8336666666666666, "episode_duration_sec_mean": 20.352849177298875, "num_episodes_lifetime": 1744, "rlmodule_inference_timer": 0.0005219265542677128, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.553556623931624, "env_to_module_sum_episodes_length_out": 92.90884316220128, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10267164302492873, "num_env_steps_sampled_lifetime": 378000, "weights_seq_no": 188.0, "agent_episode_returns_mean": {"default_agent": 0.553556623931624}, "module_episode_returns_mean": {"default_policy": 0.553556623931624}, "num_env_steps_sampled": 2000, "sample": 29.955000964426894, "env_to_module_sum_episodes_length_in": 92.90884316220128, "time_between_sampling": 11.10700582879128, "num_env_steps_sampled_lifetime_throughput": 55.805781599110944}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.022331075742840767, "weights_seq_no": 189.0, "vf_loss_unclipped": 0.00692648533731699, "total_loss": -0.015404603444039822, "gradients_default_optimizer_global_norm": 0.21732665598392487, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.03745269775390625, "entropy": 0.06754906475543976, "curr_kl_coeff": 6.025583396596713e-44, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0027676853351294994, "num_module_steps_trained_lifetime": 11449984, "vf_loss": 0.00692648533731699}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.053815243075454634, "add_observations_from_episodes_to_batch": 0.0003783430418273696, "add_one_ts_to_episodes_and_truncate": 0.0067499929362608135, "add_columns_from_episodes_to_train_batch": 0.08138239153104339, "general_advantage_estimation": 0.06663676829260803, "add_states_from_episodes_to_batch": 1.2648990184970205e-05, "numpy_to_tensor": 0.0013582774203172163, "add_time_dim_to_batch_and_zero_pad": 3.437188976928499e-05}}, "connector_pipeline_timer": 0.2108611091785719}, "num_module_steps_trained_lifetime": 11449984, "learner_connector_sum_episodes_length_out": 2016.674078361186, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 180443648, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 378000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 55.805781599110944, "done": false, "training_iteration": 189, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-01-16", "timestamp": 1747699276, "time_this_iter_s": 35.782655000686646, "time_total_s": 7592.235924243927, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7592.235924243927, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 76.49607843137255, "ram_util_percent": 53.02549019607843}}
{"timers": {"training_iteration": 40.44197084548103, "restore_env_runners": 2.72192090156321e-05, "training_step": 40.44139810183418, "env_runner_sampling_timer": 30.920366655451517, "learner_update_timer": 9.510928590639331, "synch_weights": 0.008978045935746226, "synch_env_connectors": 0.009827513218707878}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3326666666666669, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015119033054998318, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.123670997367764e-06, "un_batch_to_individual_items": 6.789497879661145e-05, "listify_data_for_vector_env": 0.00012899227031278645, "normalize_and_clip_actions": 0.00011648987689017807, "get_actions": 0.0006740774438212777, "tensor_to_numpy": 0.0002184968825535643}}}, "num_module_steps_sampled_lifetime": {"default_policy": 380000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 380000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.788743627505473e-05, "add_states_from_episodes_to_batch": 1.8493508201116315e-05, "numpy_to_tensor": 0.00015171777053787003, "add_time_dim_to_batch_and_zero_pad": 3.527649290207055e-05, "batch_individual_items": 9.016608721878934e-05}}, "connector_pipeline_timer": 0.0005678421306664014}, "episode_return_max": 0.8561111111111115, "episode_duration_sec_mean": 20.22483518113425, "num_episodes_lifetime": 1752, "rlmodule_inference_timer": 0.0005188462279356412, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5680854700854704, "env_to_module_sum_episodes_length_out": 95.01033199170838, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10173104988384075, "num_env_steps_sampled_lifetime": 380000, "weights_seq_no": 189.0, "agent_episode_returns_mean": {"default_agent": 0.5680854700854704}, "module_episode_returns_mean": {"default_policy": 0.5680854700854704}, "num_env_steps_sampled": 2000, "sample": 29.92878379320057, "env_to_module_sum_episodes_length_in": 95.01033199170838, "time_between_sampling": 11.094820547286083, "num_env_steps_sampled_lifetime_throughput": 58.58949631216021}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.05608176440000534, "weights_seq_no": 190.0, "vf_loss_unclipped": 0.0059058465994894505, "total_loss": -0.05017591267824173, "gradients_default_optimizer_global_norm": 0.31729209423065186, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.07063496112823486, "entropy": 0.054250262677669525, "curr_kl_coeff": 3.0828566215145976e-44, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0014561052666977048, "num_module_steps_trained_lifetime": 11510528, "vf_loss": 0.0059058465994894505}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05386814962883905, "add_observations_from_episodes_to_batch": 0.000378452584012813, "add_one_ts_to_episodes_and_truncate": 0.006746625389351438, "add_columns_from_episodes_to_train_batch": 0.08140651152602243, "general_advantage_estimation": 0.06627442451706742, "add_states_from_episodes_to_batch": 1.267051668018601e-05, "numpy_to_tensor": 0.0013584563842382936, "add_time_dim_to_batch_and_zero_pad": 3.439902121700701e-05}}, "connector_pipeline_timer": 0.21057214308029637}, "num_module_steps_trained_lifetime": 11510528, "learner_connector_sum_episodes_length_out": 2016.6773278673068, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 181397216, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 380000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.58949631216021, "done": false, "training_iteration": 190, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-01-50", "timestamp": 1747699310, "time_this_iter_s": 34.0814368724823, "time_total_s": 7626.317361116409, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7626.317361116409, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 77.87708333333333, "ram_util_percent": 53.01458333333333}}
{"timers": {"training_iteration": 40.40235033893621, "restore_env_runners": 2.7152016885736245e-05, "training_step": 40.4017798027258, "env_runner_sampling_timer": 30.892943051377028, "learner_update_timer": 9.498728194152934, "synch_weights": 0.008987416486388095, "synch_env_connectors": 0.009812518046538333}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3056666666666673, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0015083918927246897, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.046650956069103e-06, "un_batch_to_individual_items": 6.795214012579443e-05, "listify_data_for_vector_env": 0.0001280021322134207, "normalize_and_clip_actions": 0.0001155059341106173, "get_actions": 0.0006742335795085091, "tensor_to_numpy": 0.00021760911973468062}}}, "num_module_steps_sampled_lifetime": {"default_policy": 382000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 382000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7567520221904394e-05, "add_states_from_episodes_to_batch": 1.8490972950358657e-05, "numpy_to_tensor": 0.00015189946310049257, "add_time_dim_to_batch_and_zero_pad": 3.4882429423216715e-05, "batch_individual_items": 8.93321409826612e-05}}, "connector_pipeline_timer": 0.0005648580926760358}, "episode_return_max": 0.7954444444444462, "episode_duration_sec_mean": 20.512830896673783, "num_episodes_lifetime": 1768, "rlmodule_inference_timer": 0.000516326673837899, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.47686431623931713, "env_to_module_sum_episodes_length_out": 97.02433653960284, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10185601087346904, "num_env_steps_sampled_lifetime": 382000, "weights_seq_no": 190.0, "agent_episode_returns_mean": {"default_agent": 0.47686431623931713}, "module_episode_returns_mean": {"default_policy": 0.47686431623931713}, "num_env_steps_sampled": 2000, "sample": 29.902608887373965, "env_to_module_sum_episodes_length_in": 97.02433653960284, "time_between_sampling": 11.082224497794558, "num_env_steps_sampled_lifetime_throughput": 54.55269190826885}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.05760740116238594, "weights_seq_no": 191.0, "vf_loss_unclipped": 0.005569323431700468, "total_loss": -0.05203807353973389, "gradients_default_optimizer_global_norm": 0.46141570806503296, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.10599267482757568, "entropy": 0.04152552783489227, "curr_kl_coeff": 1.5414283107572988e-44, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.001866958336904645, "num_module_steps_trained_lifetime": 11571328, "vf_loss": 0.005569323431700468}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05391873913664833, "add_observations_from_episodes_to_batch": 0.00037856820105069175, "add_one_ts_to_episodes_and_truncate": 0.006743256404086739, "add_columns_from_episodes_to_train_batch": 0.08142943260164857, "general_advantage_estimation": 0.0659135428402083, "add_states_from_episodes_to_batch": 1.269130774651296e-05, "numpy_to_tensor": 0.001358617361138695, "add_time_dim_to_batch_and_zero_pad": 3.4424912846561105e-05}}, "connector_pipeline_timer": 0.21028110873256867}, "num_module_steps_trained_lifetime": 11571328, "learner_connector_sum_episodes_length_out": 2016.6812449754689, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 182358616, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 382000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 54.55269190826885, "done": false, "training_iteration": 191, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-02-27", "timestamp": 1747699347, "time_this_iter_s": 36.493828773498535, "time_total_s": 7662.811189889908, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7662.811189889908, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 77.31153846153846, "ram_util_percent": 53.02884615384615}}
{"timers": {"training_iteration": 40.338268822276824, "restore_env_runners": 2.7069496773586183e-05, "training_step": 40.3376988294285, "env_runner_sampling_timer": 30.846401786823257, "learner_update_timer": 9.481232627981415, "synch_weights": 0.00894338832151783, "synch_env_connectors": 0.009790041866064195}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.31900000000000067, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0014979155055416863, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.957803717130037e-06, "un_batch_to_individual_items": 6.769421325708389e-05, "listify_data_for_vector_env": 0.00012678706856451215, "normalize_and_clip_actions": 0.00011439287477461414, "get_actions": 0.0006692790843915147, "tensor_to_numpy": 0.00021592281659083928}}}, "num_module_steps_sampled_lifetime": {"default_policy": 384000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 384000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7149407685938915e-05, "add_states_from_episodes_to_batch": 1.8475400089955427e-05, "numpy_to_tensor": 0.00015216502392164792, "add_time_dim_to_batch_and_zero_pad": 3.475919185855204e-05, "batch_individual_items": 8.901277519974287e-05}}, "connector_pipeline_timer": 0.0005620993241234478}, "episode_return_max": 0.7954444444444462, "episode_duration_sec_mean": 20.43693421322237, "num_episodes_lifetime": 1776, "rlmodule_inference_timer": 0.0005134906430216471, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.44694551282051354, "env_to_module_sum_episodes_length_out": 96.53711911906481, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10164426048770332, "num_env_steps_sampled_lifetime": 384000, "weights_seq_no": 191.0, "agent_episode_returns_mean": {"default_agent": 0.44694551282051354}, "module_episode_returns_mean": {"default_policy": 0.44694551282051354}, "num_env_steps_sampled": 2000, "sample": 29.875014627240724, "env_to_module_sum_episodes_length_in": 96.53711911906481, "time_between_sampling": 11.069498174114504, "num_env_steps_sampled_lifetime_throughput": 58.70870541309697}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03763141110539436, "weights_seq_no": 192.0, "vf_loss_unclipped": 0.005395121406763792, "total_loss": -0.03223627805709839, "gradients_default_optimizer_global_norm": 0.0865379124879837, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.0350339412689209, "entropy": 0.027505021542310715, "curr_kl_coeff": 8.407790785948902e-45, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0017199021531268954, "num_module_steps_trained_lifetime": 11631872, "vf_loss": 0.005395121406763792}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.053966938809339206, "add_observations_from_episodes_to_batch": 0.00037867583048917014, "add_one_ts_to_episodes_and_truncate": 0.006739790075988883, "add_columns_from_episodes_to_train_batch": 0.08145116767460948, "general_advantage_estimation": 0.06555419481443434, "add_states_from_episodes_to_batch": 1.2711405940107742e-05, "numpy_to_tensor": 0.0013587367728622025, "add_time_dim_to_batch_and_zero_pad": 3.4449386741825734e-05}}, "connector_pipeline_timer": 0.20998787644748712}, "num_module_steps_trained_lifetime": 11631872, "learner_connector_sum_episodes_length_out": 2016.685016008681, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 183312184, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 384000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.70870541309697, "done": false, "training_iteration": 192, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-03-01", "timestamp": 1747699381, "time_this_iter_s": 34.00963854789734, "time_total_s": 7696.820828437805, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7696.820828437805, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 76.75102040816326, "ram_util_percent": 53.05714285714285}}
{"timers": {"training_iteration": 40.28149292304401, "restore_env_runners": 2.7082801785579156e-05, "training_step": 40.28092306812424, "env_runner_sampling_timer": 30.803089203795032, "learner_update_timer": 9.46780690585163, "synch_weights": 0.008906972438337733, "synch_env_connectors": 0.009768938447405087}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.33044444444444493, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001488236438086924, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.864282186516654e-06, "un_batch_to_individual_items": 6.711590807305167e-05, "listify_data_for_vector_env": 0.00012697607726653364, "normalize_and_clip_actions": 0.00011348055870254101, "get_actions": 0.0006649792495523961, "tensor_to_numpy": 0.00021379011397435968}}}, "num_module_steps_sampled_lifetime": {"default_policy": 386000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 386000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6727424053867584e-05, "add_states_from_episodes_to_batch": 1.829198731582201e-05, "numpy_to_tensor": 0.00015043573169741347, "add_time_dim_to_batch_and_zero_pad": 3.465453060934606e-05, "batch_individual_items": 8.901087100410562e-05}}, "connector_pipeline_timer": 0.0005586623515838584}, "episode_return_max": 0.7957777777777792, "episode_duration_sec_mean": 20.011153068009943, "num_episodes_lifetime": 1784, "rlmodule_inference_timer": 0.0005104934403350684, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4967831196581204, "env_to_module_sum_episodes_length_out": 94.61133222556522, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.101236236894831, "num_env_steps_sampled_lifetime": 386000, "weights_seq_no": 192.0, "agent_episode_returns_mean": {"default_agent": 0.4967831196581204}, "module_episode_returns_mean": {"default_policy": 0.4967831196581204}, "num_env_steps_sampled": 2000, "sample": 29.84624991492921, "env_to_module_sum_episodes_length_in": 94.61133222556522, "time_between_sampling": 11.056222236505699, "num_env_steps_sampled_lifetime_throughput": 57.57834785280617}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.1040746346116066, "weights_seq_no": 193.0, "vf_loss_unclipped": 0.005189305171370506, "total_loss": 0.10926393419504166, "gradients_default_optimizer_global_norm": 0.1773189902305603, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.02878594398498535, "entropy": 0.05043540522456169, "curr_kl_coeff": 4.203895392974451e-45, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.002074903342872858, "num_module_steps_trained_lifetime": 11692416, "vf_loss": 0.005189305171370506}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.054012838654662304, "add_observations_from_episodes_to_batch": 0.0003787739005185322, "add_one_ts_to_episodes_and_truncate": 0.006736235748812248, "add_columns_from_episodes_to_train_batch": 0.08147156540275116, "general_advantage_estimation": 0.06519631962489143, "add_states_from_episodes_to_batch": 1.2730813039242222e-05, "numpy_to_tensor": 0.0013588211546152905, "add_time_dim_to_batch_and_zero_pad": 3.447280866800229e-05}}, "connector_pipeline_timer": 0.2096923410971333}, "num_module_steps_trained_lifetime": 11692416, "learner_connector_sum_episodes_length_out": 2016.6886434967314, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 184265752, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 386000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 57.57834785280617, "done": false, "training_iteration": 193, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-03-36", "timestamp": 1747699416, "time_this_iter_s": 34.685476541519165, "time_total_s": 7731.506304979324, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7731.506304979324, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 76.78163265306122, "ram_util_percent": 53.01632653061225}}
{"timers": {"training_iteration": 40.212691920833564, "restore_env_runners": 2.701197376267094e-05, "training_step": 40.21212366946302, "env_runner_sampling_timer": 30.752219914477088, "learner_update_timer": 9.449918903093058, "synch_weights": 0.008865548713975262, "synch_env_connectors": 0.009803512052940657}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3353333333333335, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001475524952213412, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.865393064743712e-06, "un_batch_to_individual_items": 6.695119512239666e-05, "listify_data_for_vector_env": 0.00012617602665556863, "normalize_and_clip_actions": 0.00011225303941737707, "get_actions": 0.000657746584975824, "tensor_to_numpy": 0.00021162062616417144}}}, "num_module_steps_sampled_lifetime": {"default_policy": 388000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 388000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.641380178444329e-05, "add_states_from_episodes_to_batch": 1.8167175306427904e-05, "numpy_to_tensor": 0.00014944900657890036, "add_time_dim_to_batch_and_zero_pad": 3.430606567479952e-05, "batch_individual_items": 8.827486035638816e-05}}, "connector_pipeline_timer": 0.0005552252660094384}, "episode_return_max": 0.8448888888888892, "episode_duration_sec_mean": 19.84246594723978, "num_episodes_lifetime": 1792, "rlmodule_inference_timer": 0.0005081884912303482, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.586089743589744, "env_to_module_sum_episodes_length_out": 92.89110647481371, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.10053756612463743, "num_env_steps_sampled_lifetime": 388000, "weights_seq_no": 193.0, "agent_episode_returns_mean": {"default_agent": 0.586089743589744}, "module_episode_returns_mean": {"default_policy": 0.586089743589744}, "num_env_steps_sampled": 2000, "sample": 29.816089704223895, "env_to_module_sum_episodes_length_in": 92.89110647481371, "time_between_sampling": 11.042881504877423, "num_env_steps_sampled_lifetime_throughput": 59.701885502256545}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.1367012858390808, "weights_seq_no": 194.0, "vf_loss_unclipped": 0.006376686505973339, "total_loss": 0.1430779993534088, "gradients_default_optimizer_global_norm": 0.5973234176635742, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.11485296487808228, "entropy": 0.07890808582305908, "curr_kl_coeff": 2.802596928649634e-45, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0005225818604230881, "num_module_steps_trained_lifetime": 11752960, "vf_loss": 0.006376686505973339}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.054056400489198055, "add_observations_from_episodes_to_batch": 0.0003788664815645329, "add_one_ts_to_episodes_and_truncate": 0.006732594239171582, "add_columns_from_episodes_to_train_batch": 0.08149089842966287, "general_advantage_estimation": 0.06483990338965824, "add_states_from_episodes_to_batch": 1.2749570855487087e-05, "numpy_to_tensor": 0.0013588796650559338, "add_time_dim_to_batch_and_zero_pad": 3.449507721689685e-05}}, "connector_pipeline_timer": 0.20939474461624127}, "num_module_steps_trained_lifetime": 11752960, "learner_connector_sum_episodes_length_out": 2016.69212993342, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 185219320, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 388000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.701885502256545, "done": false, "training_iteration": 194, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-04-09", "timestamp": 1747699449, "time_this_iter_s": 33.41685724258423, "time_total_s": 7764.923162221909, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7764.923162221909, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 78.36170212765957, "ram_util_percent": 53.05957446808509}}
{"timers": {"training_iteration": 40.1457653672452, "restore_env_runners": 2.703585400815842e-05, "training_step": 40.14519717138836, "env_runner_sampling_timer": 30.704211615652333, "learner_update_timer": 9.431040947362172, "synch_weights": 0.008826569226816046, "synch_env_connectors": 0.009774974932422914}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3212222222222224, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.001466896573616959, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.809933879810247e-06, "un_batch_to_individual_items": 6.619697051458335e-05, "listify_data_for_vector_env": 0.00012566619387787968, "normalize_and_clip_actions": 0.00011120888045958436, "get_actions": 0.0006549450834158772, "tensor_to_numpy": 0.00020971723425282414}}}, "num_module_steps_sampled_lifetime": {"default_policy": 390000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 390000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6274267384236794e-05, "add_states_from_episodes_to_batch": 1.8011405175778224e-05, "numpy_to_tensor": 0.00014853196069298917, "add_time_dim_to_batch_and_zero_pad": 3.4180729785686094e-05, "batch_individual_items": 8.81827036993213e-05}}, "connector_pipeline_timer": 0.0005523524403570695}, "episode_return_max": 0.8965555555555556, "episode_duration_sec_mean": 19.833522174209204, "num_episodes_lifetime": 1800, "rlmodule_inference_timer": 0.0005056679553297139, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5608162393162396, "env_to_module_sum_episodes_length_out": 92.42772179126304, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.0999031893740076, "num_env_steps_sampled_lifetime": 390000, "weights_seq_no": 194.0, "agent_episode_returns_mean": {"default_agent": 0.5608162393162396}, "module_episode_returns_mean": {"default_policy": 0.5608162393162396}, "num_env_steps_sampled": 2000, "sample": 29.7850278901188, "env_to_module_sum_episodes_length_in": 92.42772179126304, "time_between_sampling": 11.028851182072707, "num_env_steps_sampled_lifetime_throughput": 59.5368251207591}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.025404049083590508, "weights_seq_no": 195.0, "vf_loss_unclipped": 0.004353798925876617, "total_loss": 0.029757840558886528, "gradients_default_optimizer_global_norm": 0.26407942175865173, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.020482897758483887, "entropy": 0.05927533283829689, "curr_kl_coeff": 1.401298464324817e-45, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0033814185298979282, "num_module_steps_trained_lifetime": 11813504, "vf_loss": 0.004353798925876617}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05409795542317755, "add_observations_from_episodes_to_batch": 0.0003789498936001576, "add_one_ts_to_episodes_and_truncate": 0.006728925266148891, "add_columns_from_episodes_to_train_batch": 0.08150900272959632, "general_advantage_estimation": 0.06448507773716704, "add_states_from_episodes_to_batch": 1.2767640434137087e-05, "numpy_to_tensor": 0.0013589004031722978, "add_time_dim_to_batch_and_zero_pad": 3.451611311382859e-05}}, "connector_pipeline_timer": 0.20909542864095726}, "num_module_steps_trained_lifetime": 11813504, "learner_connector_sum_episodes_length_out": 2016.695477777025, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 186172888, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 390000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.5368251207591, "done": false, "training_iteration": 195, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-04-43", "timestamp": 1747699483, "time_this_iter_s": 33.53684735298157, "time_total_s": 7798.46000957489, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7798.46000957489, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 78.49583333333334, "ram_util_percent": 53.114583333333336}}
{"timers": {"training_iteration": 40.08073069051268, "restore_env_runners": 2.705649550110712e-05, "training_step": 40.08016247861447, "env_runner_sampling_timer": 30.654424278255846, "learner_update_timer": 9.415829392058557, "synch_weights": 0.00879211054451982, "synch_env_connectors": 0.009760755183073101}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.28744444444444434, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0014617795886741483, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.883471775922633e-06, "un_batch_to_individual_items": 6.650553541078103e-05, "listify_data_for_vector_env": 0.00012521761356128764, "normalize_and_clip_actions": 0.00011102697823782055, "get_actions": 0.000652955490081645, "tensor_to_numpy": 0.00020839102363809898}}}, "num_module_steps_sampled_lifetime": {"default_policy": 392000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 392000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.633525295256989e-05, "add_states_from_episodes_to_batch": 1.8010012979790513e-05, "numpy_to_tensor": 0.00014786072822579286, "add_time_dim_to_batch_and_zero_pad": 3.388485456679843e-05, "batch_individual_items": 8.736323171834863e-05}}, "connector_pipeline_timer": 0.0005493996841051351}, "episode_return_max": 0.8965555555555556, "episode_duration_sec_mean": 19.844029907805286, "num_episodes_lifetime": 1808, "rlmodule_inference_timer": 0.0005052811359169178, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4902019230769231, "env_to_module_sum_episodes_length_out": 93.81268159017638, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.09917139222457104, "num_env_steps_sampled_lifetime": 392000, "weights_seq_no": 195.0, "agent_episode_returns_mean": {"default_agent": 0.4902019230769231}, "module_episode_returns_mean": {"default_policy": 0.4902019230769231}, "num_env_steps_sampled": 2000, "sample": 29.752999038624512, "env_to_module_sum_episodes_length_in": 93.81268159017638, "time_between_sampling": 11.01394104827772, "num_env_steps_sampled_lifetime_throughput": 59.321067251967875}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.01288323849439621, "weights_seq_no": 196.0, "vf_loss_unclipped": 0.007072400767356157, "total_loss": 0.019955631345510483, "gradients_default_optimizer_global_norm": 0.1751779168844223, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09341782331466675, "entropy": 0.046948954463005066, "curr_kl_coeff": 0.0, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.004114496521651745, "num_module_steps_trained_lifetime": 11874048, "vf_loss": 0.007072400767356157}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05413725438842845, "add_observations_from_episodes_to_batch": 0.0003790257007464518, "add_one_ts_to_episodes_and_truncate": 0.006725239953162671, "add_columns_from_episodes_to_train_batch": 0.08152633691368769, "general_advantage_estimation": 0.06413181399738643, "add_states_from_episodes_to_batch": 1.278510366469551e-05, "numpy_to_tensor": 0.0013588911185600106, "add_time_dim_to_batch_and_zero_pad": 3.4536248785159584e-05}}, "connector_pipeline_timer": 0.2087945883907173}, "num_module_steps_trained_lifetime": 11874048, "learner_connector_sum_episodes_length_out": 2016.6986894507645, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 187126456, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 392000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.321067251967875, "done": false, "training_iteration": 196, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-05-17", "timestamp": 1747699517, "time_this_iter_s": 33.65751075744629, "time_total_s": 7832.117520332336, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7832.117520332336, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 77.89375, "ram_util_percent": 53.10833333333334}}
{"timers": {"training_iteration": 40.03149507372759, "restore_env_runners": 2.705093052666866e-05, "training_step": 40.03092772094838, "env_runner_sampling_timer": 30.620212828863302, "learner_update_timer": 9.400800883868008, "synch_weights": 0.008766066439118373, "synch_env_connectors": 0.009739883631215977}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.31311111111111173, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0014560522039575874, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.773398489113855e-06, "un_batch_to_individual_items": 6.619559994810335e-05, "listify_data_for_vector_env": 0.0001246709727125725, "normalize_and_clip_actions": 0.00011096739349373954, "get_actions": 0.0006501222761914198, "tensor_to_numpy": 0.00020742156665866168}}}, "num_module_steps_sampled_lifetime": {"default_policy": 394000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 394000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6014312144307036e-05, "add_states_from_episodes_to_batch": 1.793170484926408e-05, "numpy_to_tensor": 0.0001469338515382566, "add_time_dim_to_batch_and_zero_pad": 3.383684561041371e-05, "batch_individual_items": 8.730693841326042e-05}}, "connector_pipeline_timer": 0.0005477176695893624}, "episode_return_max": 0.7686666666666685, "episode_duration_sec_mean": 19.909455111067754, "num_episodes_lifetime": 1824, "rlmodule_inference_timer": 0.0005043884024725052, "num_episodes": 16, "episode_len_min": 216, "episode_return_mean": 0.5390950854700862, "env_to_module_sum_episodes_length_out": 96.90217702112001, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.09941352847673166, "num_env_steps_sampled_lifetime": 394000, "weights_seq_no": 196.0, "agent_episode_returns_mean": {"default_agent": 0.5390950854700862}, "module_episode_returns_mean": {"default_policy": 0.5390950854700862}, "num_env_steps_sampled": 2000, "sample": 29.721097542895, "env_to_module_sum_episodes_length_in": 96.90217702112001, "time_between_sampling": 10.998497051140095, "num_env_steps_sampled_lifetime_throughput": 56.777333733189444}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08485564589500427, "weights_seq_no": 197.0, "vf_loss_unclipped": 0.007920685224235058, "total_loss": -0.07693495601415634, "gradients_default_optimizer_global_norm": 0.5023179650306702, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.06622880697250366, "entropy": 0.0415232889354229, "curr_kl_coeff": 0.0, "num_module_steps_trained": 60800, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0004948058631271124, "num_module_steps_trained_lifetime": 11934848, "vf_loss": 0.007920685224235058}, "__all_modules__": {"num_module_steps_trained": 60800, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05417432185883223, "add_observations_from_episodes_to_batch": 0.0003791073967605163, "add_one_ts_to_episodes_and_truncate": 0.0067215648339098025, "add_columns_from_episodes_to_train_batch": 0.08154258618382475, "general_advantage_estimation": 0.0637801404747277, "add_states_from_episodes_to_batch": 1.2801970866438725e-05, "numpy_to_tensor": 0.0013588496495991905, "add_time_dim_to_batch_and_zero_pad": 3.45551801315583e-05}}, "connector_pipeline_timer": 0.20849200176271795}, "num_module_steps_trained_lifetime": 11934848, "learner_connector_sum_episodes_length_out": 2016.7025673432515, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 188087856, "num_env_steps_trained": 961400, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 394000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 56.777333733189444, "done": false, "training_iteration": 197, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-05-52", "timestamp": 1747699552, "time_this_iter_s": 35.17131733894348, "time_total_s": 7867.28883767128, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7867.28883767128, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 78.332, "ram_util_percent": 53.086000000000006}}
{"timers": {"training_iteration": 39.967643243310285, "restore_env_runners": 2.697842120112056e-05, "training_step": 39.9670768780589, "env_runner_sampling_timer": 30.57333963501465, "learner_update_timer": 9.383861061919283, "synch_weights": 0.00872991876475765, "synch_env_connectors": 0.009719893804876869}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2882222222222227, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0014509816146662312, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.682228713060908e-06, "un_batch_to_individual_items": 6.565265184441677e-05, "listify_data_for_vector_env": 0.00012542219334169544, "normalize_and_clip_actions": 0.00011114392653930206, "get_actions": 0.0006454657105784687, "tensor_to_numpy": 0.00020600377960867825}}}, "num_module_steps_sampled_lifetime": {"default_policy": 396000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 396000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.585492566855134e-05, "add_states_from_episodes_to_batch": 1.7855170877017547e-05, "numpy_to_tensor": 0.00014592027246161294, "add_time_dim_to_batch_and_zero_pad": 3.36107129155999e-05, "batch_individual_items": 8.668872795628212e-05}}, "connector_pipeline_timer": 0.000544871810925257}, "episode_return_max": 0.7686666666666685, "episode_duration_sec_mean": 20.040250811028972, "num_episodes_lifetime": 1832, "rlmodule_inference_timer": 0.000502501900542659, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.4348322649572656, "env_to_module_sum_episodes_length_out": 97.44384239000587, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.09951051203182436, "num_env_steps_sampled_lifetime": 396000, "weights_seq_no": 197.0, "agent_episode_returns_mean": {"default_agent": 0.4348322649572656}, "module_episode_returns_mean": {"default_policy": 0.4348322649572656}, "num_env_steps_sampled": 2000, "sample": 29.68833883577486, "env_to_module_sum_episodes_length_in": 97.44384239000587, "time_between_sampling": 10.982761321132445, "num_env_steps_sampled_lifetime_throughput": 59.321087241579576}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02848019264638424, "weights_seq_no": 198.0, "vf_loss_unclipped": 0.005691946484148502, "total_loss": -0.022788243368268013, "gradients_default_optimizer_global_norm": 0.13765865564346313, "module_train_batch_size_mean": 128.0, "vf_explained_var": -0.031403422355651855, "entropy": 0.037474408745765686, "curr_kl_coeff": 0.0, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0011836886405944824, "num_module_steps_trained_lifetime": 11995392, "vf_loss": 0.005691946484148502}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.054209237794189125, "add_observations_from_episodes_to_batch": 0.00037918582628391616, "add_one_ts_to_episodes_and_truncate": 0.006717865523047225, "add_columns_from_episodes_to_train_batch": 0.08155811839446783, "general_advantage_estimation": 0.0634299279510222, "add_states_from_episodes_to_batch": 1.2818182213814561e-05, "numpy_to_tensor": 0.0013587796809058621, "add_time_dim_to_batch_and_zero_pad": 3.4572879226303126e-05}}, "connector_pipeline_timer": 0.20818795490774006}, "num_module_steps_trained_lifetime": 11995392, "learner_connector_sum_episodes_length_out": 2016.7062978089436, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 189041424, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 396000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 59.321087241579576, "done": false, "training_iteration": 198, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-06-26", "timestamp": 1747699586, "time_this_iter_s": 33.66077947616577, "time_total_s": 7900.949617147446, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7900.949617147446, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 77.68958333333335, "ram_util_percent": 53.052083333333336}}
{"timers": {"training_iteration": 39.90807751273714, "restore_env_runners": 2.6894637022973173e-05, "training_step": 39.90751255913834, "env_runner_sampling_timer": 30.525995222074474, "learner_update_timer": 9.371680539750077, "synch_weights": 0.00869310057710847, "synch_env_connectors": 0.00968639386684838}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.2882222222222227, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0014494311789874296, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.587861712399275e-06, "un_batch_to_individual_items": 6.5059245611802e-05, "listify_data_for_vector_env": 0.00012449109287262304, "normalize_and_clip_actions": 0.0001106183526217184, "get_actions": 0.0006455044998608468, "tensor_to_numpy": 0.00020646369297721076}}}, "num_module_steps_sampled_lifetime": {"default_policy": 398000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 398000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5959033779765666e-05, "add_states_from_episodes_to_batch": 1.7911043252954293e-05, "numpy_to_tensor": 0.00014529025885609141, "add_time_dim_to_batch_and_zero_pad": 3.341602223434129e-05, "batch_individual_items": 8.636959587715446e-05}}, "connector_pipeline_timer": 0.0005441186307843281}, "episode_return_max": 0.9121111111111134, "episode_duration_sec_mean": 20.050273958557927, "num_episodes_lifetime": 1840, "rlmodule_inference_timer": 0.0005009354289265456, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5201036324786334, "env_to_module_sum_episodes_length_out": 95.78360186037611, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.09926924022619721, "num_env_steps_sampled_lifetime": 398000, "weights_seq_no": 198.0, "agent_episode_returns_mean": {"default_agent": 0.5201036324786334}, "module_episode_returns_mean": {"default_policy": 0.5201036324786334}, "num_env_steps_sampled": 2000, "sample": 29.654800888439336, "env_to_module_sum_episodes_length_in": 95.78360186037611, "time_between_sampling": 10.966599187559861, "num_env_steps_sampled_lifetime_throughput": 58.69699873443475}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.13669373095035553, "weights_seq_no": 199.0, "vf_loss_unclipped": 0.007516690995544195, "total_loss": 0.14421042799949646, "gradients_default_optimizer_global_norm": 0.41708266735076904, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09751278162002563, "entropy": 0.036691199988126755, "curr_kl_coeff": 0.0, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0008367146365344524, "num_module_steps_trained_lifetime": 12055936, "vf_loss": 0.007516690995544195}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05424215420855295, "add_observations_from_episodes_to_batch": 0.0003792558164770572, "add_one_ts_to_episodes_and_truncate": 0.0067141508519179775, "add_columns_from_episodes_to_train_batch": 0.08157270871227998, "general_advantage_estimation": 0.0630812393337436, "add_states_from_episodes_to_batch": 1.2833759137266338e-05, "numpy_to_tensor": 0.0013587194666210853, "add_time_dim_to_batch_and_zero_pad": 3.458945882052261e-05}}, "connector_pipeline_timer": 0.20788247103958596}, "num_module_steps_trained_lifetime": 12055936, "learner_connector_sum_episodes_length_out": 2016.7098834085878, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 189994992, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 398000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.69699873443475, "done": false, "training_iteration": 199, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-07-00", "timestamp": 1747699620, "time_this_iter_s": 34.02562427520752, "time_total_s": 7934.975241422653, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7934.975241422653, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 77.59583333333335, "ram_util_percent": 53.114583333333336}}
{"timers": {"training_iteration": 39.84759052700973, "restore_env_runners": 2.6828690670534495e-05, "training_step": 39.84702683494691, "env_runner_sampling_timer": 30.481199071373748, "learner_update_timer": 9.356013385232561, "synch_weights": 0.008672510571393512, "synch_env_connectors": 0.009665908928199992}, "env_runners": {"num_module_steps_sampled": {"default_policy": 2000}, "episode_return_min": 0.3307777777777787, "episode_len_mean": 216.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0014452667292199249, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.504208755714865e-06, "un_batch_to_individual_items": 6.518485387421209e-05, "listify_data_for_vector_env": 0.0001235592694250331, "normalize_and_clip_actions": 0.00011042907623653734, "get_actions": 0.0006448131028583241, "tensor_to_numpy": 0.00020561938421219197}}}, "num_module_steps_sampled_lifetime": {"default_policy": 400000}, "env_reset_timer": 2.2797914155007675, "num_agent_steps_sampled_lifetime": {"default_agent": 400000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.599341986870943e-05, "add_states_from_episodes_to_batch": 1.782324471920001e-05, "numpy_to_tensor": 0.00014522870225714156, "add_time_dim_to_batch_and_zero_pad": 3.3154137448502634e-05, "batch_individual_items": 8.655294719377161e-05}}, "connector_pipeline_timer": 0.0005438934679167711}, "episode_return_max": 0.9121111111111134, "episode_duration_sec_mean": 19.779181262539097, "num_episodes_lifetime": 1848, "rlmodule_inference_timer": 0.000498681085474027, "num_episodes": 8, "episode_len_min": 216, "episode_return_mean": 0.5644401709401716, "env_to_module_sum_episodes_length_out": 93.80785496779632, "episode_len_max": 216, "num_agent_steps_sampled": {"default_agent": 2000}, "env_step_timer": 0.09891967745545552, "num_env_steps_sampled_lifetime": 400000, "weights_seq_no": 199.0, "agent_episode_returns_mean": {"default_agent": 0.5644401709401716}, "module_episode_returns_mean": {"default_policy": 0.5644401709401716}, "num_env_steps_sampled": 2000, "sample": 29.620736162568154, "env_to_module_sum_episodes_length_in": 93.80785496779632, "time_between_sampling": 10.950372019592903, "num_env_steps_sampled_lifetime_throughput": 58.93730781688902}, "learners": {"default_policy": {"num_trainable_parameters": 72452.0, "default_optimizer_learning_rate": 5e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06732937693595886, "weights_seq_no": 200.0, "vf_loss_unclipped": 0.005374824162572622, "total_loss": 0.07270421832799911, "gradients_default_optimizer_global_norm": 1.5415748357772827, "module_train_batch_size_mean": 128.0, "vf_explained_var": 0.09267789125442505, "entropy": 0.0721251592040062, "curr_kl_coeff": 0.0, "num_module_steps_trained": 60544, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0015140012837946415, "num_module_steps_trained_lifetime": 12116480, "vf_loss": 0.005374824162572622}, "__all_modules__": {"num_module_steps_trained": 60544, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05427315723085001, "add_observations_from_episodes_to_batch": 0.00037933186828364475, "add_one_ts_to_episodes_and_truncate": 0.006710344997658775, "add_columns_from_episodes_to_train_batch": 0.08158632302199648, "general_advantage_estimation": 0.06273410615601535, "add_states_from_episodes_to_batch": 1.2848742703638637e-05, "numpy_to_tensor": 0.0013586231886538996, "add_time_dim_to_batch_and_zero_pad": 3.460532953437705e-05}}, "connector_pipeline_timer": 0.2075755301134042}, "num_module_steps_trained_lifetime": 12116480, "learner_connector_sum_episodes_length_out": 2016.713326666458, "num_trainable_parameters": 72452.0, "num_env_steps_trained_lifetime": 190948560, "num_env_steps_trained": 953568, "learner_connector_sum_episodes_length_in": 2000.0, "num_non_trainable_parameters": 0.0, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 400000, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 58.93730781688902, "done": true, "training_iteration": 200, "trial_id": "c3e2f_00000", "date": "2025-05-20_10-07-34", "timestamp": 1747699654, "time_this_iter_s": 33.87416672706604, "time_total_s": 7968.849408149719, "pid": 66070, "hostname": "LAPTOP-PMD67645", "node_ip": "192.168.1.107", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.WorkerScaling'>", "env_config": {"observe_length": 3}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 0.1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": 1, "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 2000, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f97f88c4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": "DefaultModelConfig(fcnet_hiddens=[256, 256], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None)", "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7968.849408149719, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 78.17916666666667, "ram_util_percent": 53.116666666666674}}
